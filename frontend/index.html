<!DOCTYPE html>

<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology</title>
<!--Generated on Tue Feb  6 18:55:46 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2402.05137v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S1" title="1 Introduction ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2" title="2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Implicit Likelihood Inference</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS1" title="2.1 Approximate Bayesian Computation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Approximate Bayesian Computation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2" title="2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Neural Density Estimation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2.SSS1" title="2.2.1 Neural Posterior Estimation (NPE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>Neural Posterior Estimation (NPE)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2.SSS2" title="2.2.2 Neural Likelihood Estimation (NLE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.2 </span>Neural Likelihood Estimation (NLE)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2.SSS3" title="2.2.3 Neural Ratio Estimation (NRE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.3 </span>Neural Ratio Estimation (NRE)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2.SSS4" title="2.2.4 Choosing an Estimator ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.4 </span>Choosing an Estimator</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS3" title="2.3 Sequential Learning ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Sequential Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS4" title="2.4 Validation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Validation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S3" title="3 Code Structure ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Code Structure</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S3.SS1" title="3.1 Data ‣ 3 Code Structure ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S3.SS2" title="3.2 Inference ‣ 3 Code Structure ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Inference</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S3.SS3" title="3.3 Validation ‣ 3 Code Structure ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Validation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S4" title="4 Synthetic Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Synthetic Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S4.SS1" title="4.1 Toy Problem ‣ 4 Synthetic Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Toy Problem</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S4.SS2" title="4.2 Benchmarking ‣ 4 Synthetic Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Benchmarking</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5" title="5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Science Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS1" title="5.1 X-ray Mass Estimation of Galaxy Clusters ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>X-ray Mass Estimation of Galaxy Clusters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS2" title="5.2 Quijote Dark Matter Power Spectrum ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Quijote Dark Matter Power Spectrum</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS3" title="5.3 Field-level Inference with Graph Neural Networks ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Field-level Inference with Graph Neural Networks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS4" title="5.4 Multi-round Inference for Gravitational Waves ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Multi-round Inference for Gravitational Waves</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS5" title="5.5 Inferring Dust Parameters ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Inferring Dust Parameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS6" title="5.6 The Mass and Energy Loading of Galactic Winds ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.6 </span>The Mass and Energy Loading of Galactic Winds</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S6" title="6 Discussion ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S7" title="7 Conclusion ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content"><div class="section" id="target-section"><div id="license-tr">License: arXiv.org perpetual non-exclusive license</div><div id="watermark-tr">arXiv:2402.05137v1 [astro-ph.IM] 06 Feb 2024</div></div>
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_smallcaps" id="id32.id1">LtU-ILI</span>: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Matthew Ho<math alttext="{}^{1*}" class="ltx_Math" display="inline" id="id1.1.m1.2"><semantics id="id1.1.m1.2a"><msup id="id1.1.m1.2.2" xref="id1.1.m1.2.2.cmml"><mi id="id1.1.m1.2.2a" xref="id1.1.m1.2.2.cmml"></mi><mrow id="id1.1.m1.2.2.2.4" xref="id1.1.m1.2.2.2.3.cmml"><mn id="id1.1.m1.1.1.1.1" xref="id1.1.m1.1.1.1.1.cmml">1</mn><mo id="id1.1.m1.2.2.2.4.1" lspace="0.222em" xref="id1.1.m1.2.2.2.3.cmml">⁣</mo><mo id="id1.1.m1.2.2.2.2" xref="id1.1.m1.2.2.2.2.cmml">*</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.2b"><apply id="id1.1.m1.2.2.cmml" xref="id1.1.m1.2.2"><list id="id1.1.m1.2.2.2.3.cmml" xref="id1.1.m1.2.2.2.4"><cn id="id1.1.m1.1.1.1.1.cmml" type="integer" xref="id1.1.m1.1.1.1.1">1</cn><times id="id1.1.m1.2.2.2.2.cmml" xref="id1.1.m1.2.2.2.2"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.2c">{}^{1*}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.2d">start_FLOATSUPERSCRIPT 1 * end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:matthew.ho@iap.fr"><math alttext="{}^{*}" class="ltx_Math" display="inline" id="id2.2.m1.1"><semantics id="id2.2.m1.1a"><msup id="id2.2.m1.1.1" xref="id2.2.m1.1.1.cmml"><mi id="id2.2.m1.1.1a" xref="id2.2.m1.1.1.cmml"></mi><mo id="id2.2.m1.1.1.1" xref="id2.2.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="id2.2.m1.1b"><apply id="id2.2.m1.1.1.cmml" xref="id2.2.m1.1.1"><times id="id2.2.m1.1.1.1.cmml" xref="id2.2.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m1.1c">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="id2.2.m1.1d">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math>matthew.ho@iap.fr</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Deaglan J. Bartlett<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id3.1.m1.1"><semantics id="id3.1.m1.1a"><msup id="id3.1.m1.1.1" xref="id3.1.m1.1.1.cmml"><mi id="id3.1.m1.1.1a" xref="id3.1.m1.1.1.cmml"></mi><mn id="id3.1.m1.1.1.1" xref="id3.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id3.1.m1.1b"><apply id="id3.1.m1.1.1.cmml" xref="id3.1.m1.1.1"><cn id="id3.1.m1.1.1.1.cmml" type="integer" xref="id3.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id3.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nicolas Chartier<math alttext="{}^{2}" class="ltx_Math" display="inline" id="id4.1.m1.1"><semantics id="id4.1.m1.1a"><msup id="id4.1.m1.1.1" xref="id4.1.m1.1.1.cmml"><mi id="id4.1.m1.1.1a" xref="id4.1.m1.1.1.cmml"></mi><mn id="id4.1.m1.1.1.1" xref="id4.1.m1.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id4.1.m1.1b"><apply id="id4.1.m1.1.1.cmml" xref="id4.1.m1.1.1"><cn id="id4.1.m1.1.1.1.cmml" type="integer" xref="id4.1.m1.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.1.m1.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id4.1.m1.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Carolina Cuesta-Lazaro<math alttext="{}^{3,4,5}" class="ltx_Math" display="inline" id="id5.1.m1.3"><semantics id="id5.1.m1.3a"><msup id="id5.1.m1.3.3" xref="id5.1.m1.3.3.cmml"><mi id="id5.1.m1.3.3a" xref="id5.1.m1.3.3.cmml"></mi><mrow id="id5.1.m1.3.3.3.5" xref="id5.1.m1.3.3.3.4.cmml"><mn id="id5.1.m1.1.1.1.1" xref="id5.1.m1.1.1.1.1.cmml">3</mn><mo id="id5.1.m1.3.3.3.5.1" xref="id5.1.m1.3.3.3.4.cmml">,</mo><mn id="id5.1.m1.2.2.2.2" xref="id5.1.m1.2.2.2.2.cmml">4</mn><mo id="id5.1.m1.3.3.3.5.2" xref="id5.1.m1.3.3.3.4.cmml">,</mo><mn id="id5.1.m1.3.3.3.3" xref="id5.1.m1.3.3.3.3.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id5.1.m1.3b"><apply id="id5.1.m1.3.3.cmml" xref="id5.1.m1.3.3"><list id="id5.1.m1.3.3.3.4.cmml" xref="id5.1.m1.3.3.3.5"><cn id="id5.1.m1.1.1.1.1.cmml" type="integer" xref="id5.1.m1.1.1.1.1">3</cn><cn id="id5.1.m1.2.2.2.2.cmml" type="integer" xref="id5.1.m1.2.2.2.2">4</cn><cn id="id5.1.m1.3.3.3.3.cmml" type="integer" xref="id5.1.m1.3.3.3.3">5</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.1.m1.3c">{}^{3,4,5}</annotation><annotation encoding="application/x-llamapun" id="id5.1.m1.3d">start_FLOATSUPERSCRIPT 3 , 4 , 5 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Simon Ding<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id6.1.m1.1"><semantics id="id6.1.m1.1a"><msup id="id6.1.m1.1.1" xref="id6.1.m1.1.1.cmml"><mi id="id6.1.m1.1.1a" xref="id6.1.m1.1.1.cmml"></mi><mn id="id6.1.m1.1.1.1" xref="id6.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id6.1.m1.1b"><apply id="id6.1.m1.1.1.cmml" xref="id6.1.m1.1.1"><cn id="id6.1.m1.1.1.1.cmml" type="integer" xref="id6.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id6.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id6.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Axel Lapel<math alttext="{}^{1,15}" class="ltx_Math" display="inline" id="id7.1.m1.2"><semantics id="id7.1.m1.2a"><msup id="id7.1.m1.2.2" xref="id7.1.m1.2.2.cmml"><mi id="id7.1.m1.2.2a" xref="id7.1.m1.2.2.cmml"></mi><mrow id="id7.1.m1.2.2.2.4" xref="id7.1.m1.2.2.2.3.cmml"><mn id="id7.1.m1.1.1.1.1" xref="id7.1.m1.1.1.1.1.cmml">1</mn><mo id="id7.1.m1.2.2.2.4.1" xref="id7.1.m1.2.2.2.3.cmml">,</mo><mn id="id7.1.m1.2.2.2.2" xref="id7.1.m1.2.2.2.2.cmml">15</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id7.1.m1.2b"><apply id="id7.1.m1.2.2.cmml" xref="id7.1.m1.2.2"><list id="id7.1.m1.2.2.2.3.cmml" xref="id7.1.m1.2.2.2.4"><cn id="id7.1.m1.1.1.1.1.cmml" type="integer" xref="id7.1.m1.1.1.1.1">1</cn><cn id="id7.1.m1.2.2.2.2.cmml" type="integer" xref="id7.1.m1.2.2.2.2">15</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.1.m1.2c">{}^{1,15}</annotation><annotation encoding="application/x-llamapun" id="id7.1.m1.2d">start_FLOATSUPERSCRIPT 1 , 15 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pablo Lemos<math alttext="{}^{6,7,8,9}" class="ltx_Math" display="inline" id="id8.1.m1.4"><semantics id="id8.1.m1.4a"><msup id="id8.1.m1.4.4" xref="id8.1.m1.4.4.cmml"><mi id="id8.1.m1.4.4a" xref="id8.1.m1.4.4.cmml"></mi><mrow id="id8.1.m1.4.4.4.6" xref="id8.1.m1.4.4.4.5.cmml"><mn id="id8.1.m1.1.1.1.1" xref="id8.1.m1.1.1.1.1.cmml">6</mn><mo id="id8.1.m1.4.4.4.6.1" xref="id8.1.m1.4.4.4.5.cmml">,</mo><mn id="id8.1.m1.2.2.2.2" xref="id8.1.m1.2.2.2.2.cmml">7</mn><mo id="id8.1.m1.4.4.4.6.2" xref="id8.1.m1.4.4.4.5.cmml">,</mo><mn id="id8.1.m1.3.3.3.3" xref="id8.1.m1.3.3.3.3.cmml">8</mn><mo id="id8.1.m1.4.4.4.6.3" xref="id8.1.m1.4.4.4.5.cmml">,</mo><mn id="id8.1.m1.4.4.4.4" xref="id8.1.m1.4.4.4.4.cmml">9</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id8.1.m1.4b"><apply id="id8.1.m1.4.4.cmml" xref="id8.1.m1.4.4"><list id="id8.1.m1.4.4.4.5.cmml" xref="id8.1.m1.4.4.4.6"><cn id="id8.1.m1.1.1.1.1.cmml" type="integer" xref="id8.1.m1.1.1.1.1">6</cn><cn id="id8.1.m1.2.2.2.2.cmml" type="integer" xref="id8.1.m1.2.2.2.2">7</cn><cn id="id8.1.m1.3.3.3.3.cmml" type="integer" xref="id8.1.m1.3.3.3.3">8</cn><cn id="id8.1.m1.4.4.4.4.cmml" type="integer" xref="id8.1.m1.4.4.4.4">9</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.1.m1.4c">{}^{6,7,8,9}</annotation><annotation encoding="application/x-llamapun" id="id8.1.m1.4d">start_FLOATSUPERSCRIPT 6 , 7 , 8 , 9 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Christopher C. Lovell<math alttext="{}^{10}" class="ltx_Math" display="inline" id="id9.1.m1.1"><semantics id="id9.1.m1.1a"><msup id="id9.1.m1.1.1" xref="id9.1.m1.1.1.cmml"><mi id="id9.1.m1.1.1a" xref="id9.1.m1.1.1.cmml"></mi><mn id="id9.1.m1.1.1.1" xref="id9.1.m1.1.1.1.cmml">10</mn></msup><annotation-xml encoding="MathML-Content" id="id9.1.m1.1b"><apply id="id9.1.m1.1.1.cmml" xref="id9.1.m1.1.1"><cn id="id9.1.m1.1.1.1.cmml" type="integer" xref="id9.1.m1.1.1.1">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id9.1.m1.1c">{}^{10}</annotation><annotation encoding="application/x-llamapun" id="id9.1.m1.1d">start_FLOATSUPERSCRIPT 10 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">T. Lucas Makinen<math alttext="{}^{11}" class="ltx_Math" display="inline" id="id10.1.m1.1"><semantics id="id10.1.m1.1a"><msup id="id10.1.m1.1.1" xref="id10.1.m1.1.1.cmml"><mi id="id10.1.m1.1.1a" xref="id10.1.m1.1.1.cmml"></mi><mn id="id10.1.m1.1.1.1" xref="id10.1.m1.1.1.1.cmml">11</mn></msup><annotation-xml encoding="MathML-Content" id="id10.1.m1.1b"><apply id="id10.1.m1.1.1.cmml" xref="id10.1.m1.1.1"><cn id="id10.1.m1.1.1.1.cmml" type="integer" xref="id10.1.m1.1.1.1">11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id10.1.m1.1c">{}^{11}</annotation><annotation encoding="application/x-llamapun" id="id10.1.m1.1d">start_FLOATSUPERSCRIPT 11 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chirag Modi<math alttext="{}^{9,12}" class="ltx_Math" display="inline" id="id11.1.m1.2"><semantics id="id11.1.m1.2a"><msup id="id11.1.m1.2.2" xref="id11.1.m1.2.2.cmml"><mi id="id11.1.m1.2.2a" xref="id11.1.m1.2.2.cmml"></mi><mrow id="id11.1.m1.2.2.2.4" xref="id11.1.m1.2.2.2.3.cmml"><mn id="id11.1.m1.1.1.1.1" xref="id11.1.m1.1.1.1.1.cmml">9</mn><mo id="id11.1.m1.2.2.2.4.1" xref="id11.1.m1.2.2.2.3.cmml">,</mo><mn id="id11.1.m1.2.2.2.2" xref="id11.1.m1.2.2.2.2.cmml">12</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id11.1.m1.2b"><apply id="id11.1.m1.2.2.cmml" xref="id11.1.m1.2.2"><list id="id11.1.m1.2.2.2.3.cmml" xref="id11.1.m1.2.2.2.4"><cn id="id11.1.m1.1.1.1.1.cmml" type="integer" xref="id11.1.m1.1.1.1.1">9</cn><cn id="id11.1.m1.2.2.2.2.cmml" type="integer" xref="id11.1.m1.2.2.2.2">12</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id11.1.m1.2c">{}^{9,12}</annotation><annotation encoding="application/x-llamapun" id="id11.1.m1.2d">start_FLOATSUPERSCRIPT 9 , 12 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Viraj Pandya<math alttext="{}^{13,14}" class="ltx_Math" display="inline" id="id12.1.m1.2"><semantics id="id12.1.m1.2a"><msup id="id12.1.m1.2.2" xref="id12.1.m1.2.2.cmml"><mi id="id12.1.m1.2.2a" xref="id12.1.m1.2.2.cmml"></mi><mrow id="id12.1.m1.2.2.2.4" xref="id12.1.m1.2.2.2.3.cmml"><mn id="id12.1.m1.1.1.1.1" xref="id12.1.m1.1.1.1.1.cmml">13</mn><mo id="id12.1.m1.2.2.2.4.1" xref="id12.1.m1.2.2.2.3.cmml">,</mo><mn id="id12.1.m1.2.2.2.2" xref="id12.1.m1.2.2.2.2.cmml">14</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id12.1.m1.2b"><apply id="id12.1.m1.2.2.cmml" xref="id12.1.m1.2.2"><list id="id12.1.m1.2.2.2.3.cmml" xref="id12.1.m1.2.2.2.4"><cn id="id12.1.m1.1.1.1.1.cmml" type="integer" xref="id12.1.m1.1.1.1.1">13</cn><cn id="id12.1.m1.2.2.2.2.cmml" type="integer" xref="id12.1.m1.2.2.2.2">14</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id12.1.m1.2c">{}^{13,14}</annotation><annotation encoding="application/x-llamapun" id="id12.1.m1.2d">start_FLOATSUPERSCRIPT 13 , 14 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shivam Pandey<math alttext="{}^{13}" class="ltx_Math" display="inline" id="id13.1.m1.1"><semantics id="id13.1.m1.1a"><msup id="id13.1.m1.1.1" xref="id13.1.m1.1.1.cmml"><mi id="id13.1.m1.1.1a" xref="id13.1.m1.1.1.cmml"></mi><mn id="id13.1.m1.1.1.1" xref="id13.1.m1.1.1.1.cmml">13</mn></msup><annotation-xml encoding="MathML-Content" id="id13.1.m1.1b"><apply id="id13.1.m1.1.1.cmml" xref="id13.1.m1.1.1"><cn id="id13.1.m1.1.1.1.cmml" type="integer" xref="id13.1.m1.1.1.1">13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id13.1.m1.1c">{}^{13}</annotation><annotation encoding="application/x-llamapun" id="id13.1.m1.1d">start_FLOATSUPERSCRIPT 13 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lucia A. Perez<math alttext="{}^{9}" class="ltx_Math" display="inline" id="id14.1.m1.1"><semantics id="id14.1.m1.1a"><msup id="id14.1.m1.1.1" xref="id14.1.m1.1.1.cmml"><mi id="id14.1.m1.1.1a" xref="id14.1.m1.1.1.cmml"></mi><mn id="id14.1.m1.1.1.1" xref="id14.1.m1.1.1.1.cmml">9</mn></msup><annotation-xml encoding="MathML-Content" id="id14.1.m1.1b"><apply id="id14.1.m1.1.1.cmml" xref="id14.1.m1.1.1"><cn id="id14.1.m1.1.1.1.cmml" type="integer" xref="id14.1.m1.1.1.1">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id14.1.m1.1c">{}^{9}</annotation><annotation encoding="application/x-llamapun" id="id14.1.m1.1d">start_FLOATSUPERSCRIPT 9 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Benjamin Wandelt<math alttext="{}^{1,9}" class="ltx_Math" display="inline" id="id15.1.m1.2"><semantics id="id15.1.m1.2a"><msup id="id15.1.m1.2.2" xref="id15.1.m1.2.2.cmml"><mi id="id15.1.m1.2.2a" xref="id15.1.m1.2.2.cmml"></mi><mrow id="id15.1.m1.2.2.2.4" xref="id15.1.m1.2.2.2.3.cmml"><mn id="id15.1.m1.1.1.1.1" xref="id15.1.m1.1.1.1.1.cmml">1</mn><mo id="id15.1.m1.2.2.2.4.1" xref="id15.1.m1.2.2.2.3.cmml">,</mo><mn id="id15.1.m1.2.2.2.2" xref="id15.1.m1.2.2.2.2.cmml">9</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id15.1.m1.2b"><apply id="id15.1.m1.2.2.cmml" xref="id15.1.m1.2.2"><list id="id15.1.m1.2.2.2.3.cmml" xref="id15.1.m1.2.2.2.4"><cn id="id15.1.m1.1.1.1.1.cmml" type="integer" xref="id15.1.m1.1.1.1.1">1</cn><cn id="id15.1.m1.2.2.2.2.cmml" type="integer" xref="id15.1.m1.2.2.2.2">9</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id15.1.m1.2c">{}^{1,9}</annotation><annotation encoding="application/x-llamapun" id="id15.1.m1.2d">start_FLOATSUPERSCRIPT 1 , 9 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Greg L. Bryan<math alttext="{}^{13}" class="ltx_Math" display="inline" id="id16.1.m1.1"><semantics id="id16.1.m1.1a"><msup id="id16.1.m1.1.1" xref="id16.1.m1.1.1.cmml"><mi id="id16.1.m1.1.1a" xref="id16.1.m1.1.1.cmml"></mi><mn id="id16.1.m1.1.1.1" xref="id16.1.m1.1.1.1.cmml">13</mn></msup><annotation-xml encoding="MathML-Content" id="id16.1.m1.1b"><apply id="id16.1.m1.1.1.cmml" xref="id16.1.m1.1.1"><cn id="id16.1.m1.1.1.1.cmml" type="integer" xref="id16.1.m1.1.1.1">13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id16.1.m1.1c">{}^{13}</annotation><annotation encoding="application/x-llamapun" id="id16.1.m1.1d">start_FLOATSUPERSCRIPT 13 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{1}" class="ltx_Math" display="inline" id="id17.2.m1.1"><semantics id="id17.2.m1.1a"><msup id="id17.2.m1.1.1" xref="id17.2.m1.1.1.cmml"><mi id="id17.2.m1.1.1a" xref="id17.2.m1.1.1.cmml"></mi><mn id="id17.2.m1.1.1.1" xref="id17.2.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id17.2.m1.1b"><apply id="id17.2.m1.1.1.cmml" xref="id17.2.m1.1.1"><cn id="id17.2.m1.1.1.1.cmml" type="integer" xref="id17.2.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id17.2.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id17.2.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math> CNRS &amp; Sorbonne Université, Institut d’Astrophysique de Paris (IAP), UMR 7095, 98 bis bd Arago, F-75014 Paris, France
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{2}" class="ltx_Math" display="inline" id="id18.3.m1.1"><semantics id="id18.3.m1.1a"><msup id="id18.3.m1.1.1" xref="id18.3.m1.1.1.cmml"><mi id="id18.3.m1.1.1a" xref="id18.3.m1.1.1.cmml"></mi><mn id="id18.3.m1.1.1.1" xref="id18.3.m1.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id18.3.m1.1b"><apply id="id18.3.m1.1.1.cmml" xref="id18.3.m1.1.1"><cn id="id18.3.m1.1.1.1.cmml" type="integer" xref="id18.3.m1.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id18.3.m1.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id18.3.m1.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math> Center for the Gravitational-Wave Universe, Astronomy Program Department of Physics and Astronomy, Seoul National University, Seoul 08826, Korea
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{3}" class="ltx_Math" display="inline" id="id19.4.m1.1"><semantics id="id19.4.m1.1a"><msup id="id19.4.m1.1.1" xref="id19.4.m1.1.1.cmml"><mi id="id19.4.m1.1.1a" xref="id19.4.m1.1.1.cmml"></mi><mn id="id19.4.m1.1.1.1" xref="id19.4.m1.1.1.1.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="id19.4.m1.1b"><apply id="id19.4.m1.1.1.cmml" xref="id19.4.m1.1.1"><cn id="id19.4.m1.1.1.1.cmml" type="integer" xref="id19.4.m1.1.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id19.4.m1.1c">{}^{3}</annotation><annotation encoding="application/x-llamapun" id="id19.4.m1.1d">start_FLOATSUPERSCRIPT 3 end_FLOATSUPERSCRIPT</annotation></semantics></math> Center for Astrophysics — Harvard &amp; Smithsonian, 60 Garden St, Cambridge, MA 02138, USA
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{4}" class="ltx_Math" display="inline" id="id20.5.m1.1"><semantics id="id20.5.m1.1a"><msup id="id20.5.m1.1.1" xref="id20.5.m1.1.1.cmml"><mi id="id20.5.m1.1.1a" xref="id20.5.m1.1.1.cmml"></mi><mn id="id20.5.m1.1.1.1" xref="id20.5.m1.1.1.1.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="id20.5.m1.1b"><apply id="id20.5.m1.1.1.cmml" xref="id20.5.m1.1.1"><cn id="id20.5.m1.1.1.1.cmml" type="integer" xref="id20.5.m1.1.1.1">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id20.5.m1.1c">{}^{4}</annotation><annotation encoding="application/x-llamapun" id="id20.5.m1.1d">start_FLOATSUPERSCRIPT 4 end_FLOATSUPERSCRIPT</annotation></semantics></math> The NSF AI Institute for Artificial Intelligence and Fundamental Interactions
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{5}" class="ltx_Math" display="inline" id="id21.6.m1.1"><semantics id="id21.6.m1.1a"><msup id="id21.6.m1.1.1" xref="id21.6.m1.1.1.cmml"><mi id="id21.6.m1.1.1a" xref="id21.6.m1.1.1.cmml"></mi><mn id="id21.6.m1.1.1.1" xref="id21.6.m1.1.1.1.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="id21.6.m1.1b"><apply id="id21.6.m1.1.1.cmml" xref="id21.6.m1.1.1"><cn id="id21.6.m1.1.1.1.cmml" type="integer" xref="id21.6.m1.1.1.1">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id21.6.m1.1c">{}^{5}</annotation><annotation encoding="application/x-llamapun" id="id21.6.m1.1d">start_FLOATSUPERSCRIPT 5 end_FLOATSUPERSCRIPT</annotation></semantics></math> Department of Physics, Massachusetts Institute of Technology, Cambridge, MA 02139, USA
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{6}" class="ltx_Math" display="inline" id="id22.7.m1.1"><semantics id="id22.7.m1.1a"><msup id="id22.7.m1.1.1" xref="id22.7.m1.1.1.cmml"><mi id="id22.7.m1.1.1a" xref="id22.7.m1.1.1.cmml"></mi><mn id="id22.7.m1.1.1.1" xref="id22.7.m1.1.1.1.cmml">6</mn></msup><annotation-xml encoding="MathML-Content" id="id22.7.m1.1b"><apply id="id22.7.m1.1.1.cmml" xref="id22.7.m1.1.1"><cn id="id22.7.m1.1.1.1.cmml" type="integer" xref="id22.7.m1.1.1.1">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id22.7.m1.1c">{}^{6}</annotation><annotation encoding="application/x-llamapun" id="id22.7.m1.1d">start_FLOATSUPERSCRIPT 6 end_FLOATSUPERSCRIPT</annotation></semantics></math> Department of Physics, Université de Montréal, Montréal, Canada
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{7}" class="ltx_Math" display="inline" id="id23.8.m1.1"><semantics id="id23.8.m1.1a"><msup id="id23.8.m1.1.1" xref="id23.8.m1.1.1.cmml"><mi id="id23.8.m1.1.1a" xref="id23.8.m1.1.1.cmml"></mi><mn id="id23.8.m1.1.1.1" xref="id23.8.m1.1.1.1.cmml">7</mn></msup><annotation-xml encoding="MathML-Content" id="id23.8.m1.1b"><apply id="id23.8.m1.1.1.cmml" xref="id23.8.m1.1.1"><cn id="id23.8.m1.1.1.1.cmml" type="integer" xref="id23.8.m1.1.1.1">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id23.8.m1.1c">{}^{7}</annotation><annotation encoding="application/x-llamapun" id="id23.8.m1.1d">start_FLOATSUPERSCRIPT 7 end_FLOATSUPERSCRIPT</annotation></semantics></math> Mila - Quebec Artificial Intelligence Institute, Montréal, Canada
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{8}" class="ltx_Math" display="inline" id="id24.9.m1.1"><semantics id="id24.9.m1.1a"><msup id="id24.9.m1.1.1" xref="id24.9.m1.1.1.cmml"><mi id="id24.9.m1.1.1a" xref="id24.9.m1.1.1.cmml"></mi><mn id="id24.9.m1.1.1.1" xref="id24.9.m1.1.1.1.cmml">8</mn></msup><annotation-xml encoding="MathML-Content" id="id24.9.m1.1b"><apply id="id24.9.m1.1.1.cmml" xref="id24.9.m1.1.1"><cn id="id24.9.m1.1.1.1.cmml" type="integer" xref="id24.9.m1.1.1.1">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id24.9.m1.1c">{}^{8}</annotation><annotation encoding="application/x-llamapun" id="id24.9.m1.1d">start_FLOATSUPERSCRIPT 8 end_FLOATSUPERSCRIPT</annotation></semantics></math> Ciela - Montreal Institute for Astrophysical Data Analysis and Machine Learning, Montréal, Canada
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{9}" class="ltx_Math" display="inline" id="id25.10.m1.1"><semantics id="id25.10.m1.1a"><msup id="id25.10.m1.1.1" xref="id25.10.m1.1.1.cmml"><mi id="id25.10.m1.1.1a" xref="id25.10.m1.1.1.cmml"></mi><mn id="id25.10.m1.1.1.1" xref="id25.10.m1.1.1.1.cmml">9</mn></msup><annotation-xml encoding="MathML-Content" id="id25.10.m1.1b"><apply id="id25.10.m1.1.1.cmml" xref="id25.10.m1.1.1"><cn id="id25.10.m1.1.1.1.cmml" type="integer" xref="id25.10.m1.1.1.1">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id25.10.m1.1c">{}^{9}</annotation><annotation encoding="application/x-llamapun" id="id25.10.m1.1d">start_FLOATSUPERSCRIPT 9 end_FLOATSUPERSCRIPT</annotation></semantics></math> Center for Computational Astrophysics, Flatiron Institute, 162 5th Avenue, New York, NY 10010, USA
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{10}" class="ltx_Math" display="inline" id="id26.11.m1.1"><semantics id="id26.11.m1.1a"><msup id="id26.11.m1.1.1" xref="id26.11.m1.1.1.cmml"><mi id="id26.11.m1.1.1a" xref="id26.11.m1.1.1.cmml"></mi><mn id="id26.11.m1.1.1.1" xref="id26.11.m1.1.1.1.cmml">10</mn></msup><annotation-xml encoding="MathML-Content" id="id26.11.m1.1b"><apply id="id26.11.m1.1.1.cmml" xref="id26.11.m1.1.1"><cn id="id26.11.m1.1.1.1.cmml" type="integer" xref="id26.11.m1.1.1.1">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id26.11.m1.1c">{}^{10}</annotation><annotation encoding="application/x-llamapun" id="id26.11.m1.1d">start_FLOATSUPERSCRIPT 10 end_FLOATSUPERSCRIPT</annotation></semantics></math> Institute of Cosmology and Gravitation, University of Portsmouth, Burnaby Road, Portsmouth, PO1 3FX, United Kingdom
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{11}" class="ltx_Math" display="inline" id="id27.12.m1.1"><semantics id="id27.12.m1.1a"><msup id="id27.12.m1.1.1" xref="id27.12.m1.1.1.cmml"><mi id="id27.12.m1.1.1a" xref="id27.12.m1.1.1.cmml"></mi><mn id="id27.12.m1.1.1.1" xref="id27.12.m1.1.1.1.cmml">11</mn></msup><annotation-xml encoding="MathML-Content" id="id27.12.m1.1b"><apply id="id27.12.m1.1.1.cmml" xref="id27.12.m1.1.1"><cn id="id27.12.m1.1.1.1.cmml" type="integer" xref="id27.12.m1.1.1.1">11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id27.12.m1.1c">{}^{11}</annotation><annotation encoding="application/x-llamapun" id="id27.12.m1.1d">start_FLOATSUPERSCRIPT 11 end_FLOATSUPERSCRIPT</annotation></semantics></math>Imperial Centre for Inference and Cosmology (ICIC) &amp; Astrophysics Group, Imperial College London, Blackett Laboratory, Prince Consort Road, London SW7 2AZ, United Kingdom
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{12}" class="ltx_Math" display="inline" id="id28.13.m1.1"><semantics id="id28.13.m1.1a"><msup id="id28.13.m1.1.1" xref="id28.13.m1.1.1.cmml"><mi id="id28.13.m1.1.1a" xref="id28.13.m1.1.1.cmml"></mi><mn id="id28.13.m1.1.1.1" xref="id28.13.m1.1.1.1.cmml">12</mn></msup><annotation-xml encoding="MathML-Content" id="id28.13.m1.1b"><apply id="id28.13.m1.1.1.cmml" xref="id28.13.m1.1.1"><cn id="id28.13.m1.1.1.1.cmml" type="integer" xref="id28.13.m1.1.1.1">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id28.13.m1.1c">{}^{12}</annotation><annotation encoding="application/x-llamapun" id="id28.13.m1.1d">start_FLOATSUPERSCRIPT 12 end_FLOATSUPERSCRIPT</annotation></semantics></math> Center for Computational Mathematics, Flatiron Institute, 162 5th Avenue, New York, NY 10010, USA
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{13}" class="ltx_Math" display="inline" id="id29.14.m1.1"><semantics id="id29.14.m1.1a"><msup id="id29.14.m1.1.1" xref="id29.14.m1.1.1.cmml"><mi id="id29.14.m1.1.1a" xref="id29.14.m1.1.1.cmml"></mi><mn id="id29.14.m1.1.1.1" xref="id29.14.m1.1.1.1.cmml">13</mn></msup><annotation-xml encoding="MathML-Content" id="id29.14.m1.1b"><apply id="id29.14.m1.1.1.cmml" xref="id29.14.m1.1.1"><cn id="id29.14.m1.1.1.1.cmml" type="integer" xref="id29.14.m1.1.1.1">13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id29.14.m1.1c">{}^{13}</annotation><annotation encoding="application/x-llamapun" id="id29.14.m1.1d">start_FLOATSUPERSCRIPT 13 end_FLOATSUPERSCRIPT</annotation></semantics></math> Columbia Astrophysics Laboratory, Columbia University, 550 West 120th Street, New York, NY 10027, USA
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{14}" class="ltx_Math" display="inline" id="id30.15.m1.1"><semantics id="id30.15.m1.1a"><msup id="id30.15.m1.1.1" xref="id30.15.m1.1.1.cmml"><mi id="id30.15.m1.1.1a" xref="id30.15.m1.1.1.cmml"></mi><mn id="id30.15.m1.1.1.1" xref="id30.15.m1.1.1.1.cmml">14</mn></msup><annotation-xml encoding="MathML-Content" id="id30.15.m1.1b"><apply id="id30.15.m1.1.1.cmml" xref="id30.15.m1.1.1"><cn id="id30.15.m1.1.1.1.cmml" type="integer" xref="id30.15.m1.1.1.1">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id30.15.m1.1c">{}^{14}</annotation><annotation encoding="application/x-llamapun" id="id30.15.m1.1d">start_FLOATSUPERSCRIPT 14 end_FLOATSUPERSCRIPT</annotation></semantics></math> Hubble Fellow
</span>
<span class="ltx_contact ltx_role_affiliation"><math alttext="{}^{15}" class="ltx_Math" display="inline" id="id31.16.m1.1"><semantics id="id31.16.m1.1a"><msup id="id31.16.m1.1.1" xref="id31.16.m1.1.1.cmml"><mi id="id31.16.m1.1.1a" xref="id31.16.m1.1.1.cmml"></mi><mn id="id31.16.m1.1.1.1" xref="id31.16.m1.1.1.1.cmml">15</mn></msup><annotation-xml encoding="MathML-Content" id="id31.16.m1.1b"><apply id="id31.16.m1.1.1.cmml" xref="id31.16.m1.1.1"><cn id="id31.16.m1.1.1.1.cmml" type="integer" xref="id31.16.m1.1.1.1">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id31.16.m1.1c">{}^{15}</annotation><annotation encoding="application/x-llamapun" id="id31.16.m1.1d">start_FLOATSUPERSCRIPT 15 end_FLOATSUPERSCRIPT</annotation></semantics></math> Sorbonne Université, Université Paris Diderot, Sorbonne Paris Cité, CNRS,
Laboratoire de Physique Nucléaire et de Hautes Energies (LPNHE). 4 place Jussieu, F-75252, Paris Cedex 5, France
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id34.id1">This paper presents the Learning the Universe Implicit Likelihood Inference (<span class="ltx_text ltx_font_smallcaps" id="id34.id1.1">LtU-ILI</span>) pipeline, a codebase for rapid, user-friendly, and cutting-edge machine learning (ML) inference in astrophysics and cosmology. The pipeline includes software for implementing various neural architectures, training schema, priors, and density estimators in a manner easily adaptable to any research workflow. It includes comprehensive validation metrics to assess posterior estimate coverage, enhancing the reliability of inferred results. Additionally, the pipeline is easily parallelizable, designed for efficient exploration of modeling hyperparameters. To demonstrate its capabilities, we present real applications across a range of astrophysics and cosmology problems, such as: estimating galaxy cluster masses from X-ray photometry; inferring cosmology from matter power spectra and halo point clouds; characterising progenitors in gravitational wave signals; capturing physical dust parameters from galaxy colors and luminosities; and establishing properties of semi-analytic models of galaxy formation. We also include exhaustive benchmarking and comparisons of all implemented methods as well as discussions about the challenges and pitfalls of ML inference in astronomical sciences. All code and examples are made publicly available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/maho3/ltu-ili" title="">https://github.com/maho3/ltu-ili</a>.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>cosmology, astrophysics, statistical methods, machine learning
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Statistical inference of unknown quantities is a fundamental problem in science. In the astronomical sciences, we largely rely on Bayesian inference to test new physical models <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx1" title="">Feigelson and Babu(2012)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx2" title="">Dodelson and Schmidt(2020)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx3" title="">Eadie <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Eadie, Speagle, Cisewski-Kehe, Foreman-Mackey, Huppenkothen, Jones, Springford, and Tak</a>)</cite>, wherein we assume some prior hypothesis of an observed system and calculate constraints on model parameters which would be consistent with our observations.
For nearly a century, the practice of building linear or perturbative physical models from first-principles allowed us to make substantial progress towards understanding the universe. Yet, as highlighted in the 2020 Decadal Survey <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx4" title="">National Academies of Sciences, Engineering, and Medicine(2023)</a>)</cite>, exploring the complex, nonlinear regime of physical phenomena through data-driven inference promises significant gains in constraining power. The large data volume of next-generation surveys, the improvements in high-resolution simulations, and the rapid rise of machine learning (ML) techniques have driven an explosion of inquiry into how one can automatically and rapidly learn complex physical phenomena <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx5" title="">Carleo <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Carleo, Cirac, Cranmer, Daudet, Schuld, Tishby, Vogt-Maranto, and Zdeborová</a>)</cite>. Despite the growing enthusiasm, a major hurdle to the widespread adoption of data science methods in astronomy is in their limited accessibility to the general community, which when compounded by the rapid pace of developments in the field, makes it challenging for individuals to stay well-informed on best practices <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx6" title="">Huppenkothen <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Huppenkothen, Ntampaka, Ho, Fouesneau, Nord, Peek, Walmsley, Wu, Avestruz, Buck <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>. There is currently no widespread consensus within the field regarding the approach to building a framework for implicit inference problems that is both reliable, robust, and accessible.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Implicit Likelihood Inference <cite class="ltx_cite ltx_citemacro_citep">(ILI, <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx7" title="">Cranmer <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Cranmer, Brehmer, and Louppe</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx8" title="">Marin <em class="ltx_emph ltx_font_italic">et al.</em>(2012)Marin, Pudlo, Robert, and Ryder</a>)</cite>, also known as simulation-based inference (SBI) and likelihood-free inference (LFI), is an approach for learning the statistical relationship between parameters and data. ILI is a mathematically rigorous way of framing ML under the umbrella of Bayesian statistics, a language common to astrophysicists and cosmologists since the turn of the century <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx9" title="">Christensen <em class="ltx_emph ltx_font_italic">et al.</em>(2001)Christensen, Meyer, Knox, and Luey</a>)</cite>. It aims to estimate a full posterior distribution over parameters, including predictive uncertainties.
It is best explained in contrast to traditional explicit likelihood analyses, wherein one might write down an analytic likelihood to represent the probability of observations given a model and its parameters, and then use sampling methods such as Markov Chain Monte Carlo <cite class="ltx_cite ltx_citemacro_citep">(MCMC; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx10" title="">Brooks <em class="ltx_emph ltx_font_italic">et al.</em>(2011)Brooks, Gelman, Jones, and Meng</a>)</cite> to sample from the posterior. In ILI, one seeks to automatically learn the likelihood, i.e. to model the relationship between model parameters and observations through training on simulations. As such, ILI can be applied to infer parameters for any phenomenon that can be simulated, without the need for assumptions about the analytical form of the likelihood.
Furthermore, ILI can accommodate complex data cuts (provided that consistent filters are applied to both the data and the forward model) something that can be hard to model in likelihood-based approaches.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Given a prescribed training set of model parameters and observations or a fast physical simulator, ILI can produce robust, tightly-constraining inference without analytic likelihoods. In astronomy and cosmology, ILI has consistently been shown to accelerate and improve upon traditional analyses such as cosmological galaxy lensing and clustering <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S1.p3.1.1.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx11" title="">Jeffrey <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Jeffrey, Alsing, and Lanusse</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx12" title="">Makinen <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Makinen, Charnock, Alsing, and Wandelt</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx13" title="">Makinen <em class="ltx_emph ltx_font_italic">et al.</em>(2022a)Makinen, Charnock, Lemos, Porqueres, Heavens, and Wandelt</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx14" title="">de Santi <em class="ltx_emph ltx_font_italic">et al.</em>(2023a)de Santi, Shao, Villaescusa-Navarro, Abramo, Teyssier, Villanueva-Domingo, Ni, Anglés-Alcázar, Genel, Hernandez-Martinez <em class="ltx_emph ltx_font_italic">et al.</em></a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx15" title="">Hahn <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Hahn, Lemos, Parker, Blancard, Eickenberg, Ho, Hou, Massara, Modi, Dizgah <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>, gravitational waves <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S1.p3.1.2.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx16" title="">Dax <em class="ltx_emph ltx_font_italic">et al.</em>(2021a)Dax, Green, Gair, Macke, Buonanno, and Schölkopf</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx17" title="">Cheung <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Cheung, Wong, Hannuksela, Li, and Ho</a>)</cite>, galaxy cluster mass estimation <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S1.p3.1.3.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx18" title="">Ho <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Ho, Ntampaka, Rau, Chen, Lansberry, Ruehle, and Trac</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx19" title="">de Andres <em class="ltx_emph ltx_font_italic">et al.</em>(2022)de Andres, Cui, Ruppin, De Petris, Yepes, Gianfagna, Lahouli, Aversano, Dupuis, Jarraya <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>, galaxy morphology <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S1.p3.1.4.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx20" title="">Walmsley <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Walmsley, Smith, Lintott, Gal, Bamford, Dickinson, Fortson, Kruk, Masters, Scarlata <em class="ltx_emph ltx_font_italic">et al.</em></a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx21" title="">Ghosh <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Ghosh, Urry, Rau, Perreault-Levasseur, Cranmer, Schawinski, Stark, Tian, Ofman, Ananna <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>, stellar streams <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S1.p3.1.5.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx22" title="">Hermans <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Hermans, Banik, Weniger, Bertone, and Louppe</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx23" title="">Alvey <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Alvey, Gerdes, and Weniger</a>)</cite>, and exoplanets <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S1.p3.1.6.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx24" title="">Rogers <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Rogers, Janó Muñoz, Owen, and Makinen</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx25" title="">Aubin <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Aubin, Cuesta-Lazaro, Tregidga, Viaña, Garraffo, Gordon, López-Morales, Hargreaves, Makhnev, Drake <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Despite its popularity, robust applications of ILI have their challenges. First, fully Bayesian models include capturing epistemic (modeling) uncertainty, which requires marginalizing over model parameter uncertainty (<em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">i.e.,</em> network weights and biases) and is intractable for large architectures. However, approximations to this method using dropout marginalization <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx26" title="">Gal and Ghahramani(2016)</a>)</cite>, model ensembling <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx27" title="">Lakshminarayanan <em class="ltx_emph ltx_font_italic">et al.</em>(2017)Lakshminarayanan, Pritzel, and Blundell</a>)</cite> or stochastic weight averaging <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx28" title="">Maddox <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Maddox, Izmailov, Garipov, Vetrov, and Wilson</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx29" title="">Lemos <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Lemos, Cranmer, Abidi, Hahn, Eickenberg, Massara, Yallup, and Ho</a>)</cite>
prove to be empirically sufficient surrogates. Second, choices of modeling hyperparameters (<em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">e.g.,</em> preprocessing, architecture, learning procedures, etc.) can greatly affect the quality of a trained ILI model. This is generally addressed through model ensembling or hyperparameter searches <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S1.p4.1.3.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx30" title="">Jin <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Jin, Song, and Hu</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx31" title="">White <em class="ltx_emph ltx_font_italic">et al.</em>(2021)White, Neiswanger, and Savani</a>)</cite>. Lastly, a pervasive problem in ILI is model misspecification, wherein the simulator or training catalog used to learn likelihoods is not representative of reality. Methods such as <span class="ltx_text ltx_font_typewriter" id="S1.p4.1.4">SBI++</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx32" title="">Wang <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Wang, Leja, Villar, and Speagle</a>)</cite> deal with missing data and outliers and present applications to galactic photometric redshift inference <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx33" title="">Modi <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Modi, Pandey, Ho, Hahn, Blancard, and Wandelt</a>)</cite>. For a thorough discussion of caveats, see Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S6" title="6 Discussion ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">6</span></a>.
We argue that addressing these common problems is paramount to responsible application of ILI, and testing them exhaustively necessitates a unified, accessible framework.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We introduce the first version of the Learning the Universe Implicit Likelihood Inference code (<span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.1">LtU-ILI</span>), a pipeline for training ML models for regressive parameter estimation. Given a labeled training set of observed data and parameters, <span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.2">LtU-ILI</span> trains neural networks to emulate posterior probability distributions. The code also provides scientists with a diverse toolkit for testing and validation. It was built under the following design principles:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">The code includes state-of-the-art neural architectures, validation tools, and samplers for enabling ILI.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">The pipeline is modular, easily customizable, and parallelizable for rapid testing of design choices and hyperparameters.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">The interface is accessible to non-specialists while being practical for high-level production.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">The methodologies automatically implement standard best practices for machine learning <cite class="ltx_cite ltx_citemacro_citep">(See <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx6" title="">Huppenkothen <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Huppenkothen, Ntampaka, Ho, Fouesneau, Nord, Peek, Walmsley, Wu, Avestruz, Buck <em class="ltx_emph ltx_font_italic">et al.</em></a>,  for a review)</cite>.
</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S1.p5.2">These attributes are paramount to make ILI a relevant tool for a wide range of inference problems, whether in the context of exploratory analysis or exhaustive empirical testing.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The novel contributions of this work are as follows:</p>
<ul class="ltx_itemize" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1">We unify several leading implicit inference codes–<span class="ltx_text ltx_font_typewriter" id="S1.I2.i1.p1.1.1">sbi</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx34" title="">Tejero-Cantero <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Tejero-Cantero, Boelts, Deistler, Lueckmann, Durkan, Gonçalves, Greenberg, and Macke</a>)</cite>, <span class="ltx_text ltx_font_typewriter" id="S1.I2.i1.p1.1.2">pydelfi</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx35" title="">Alsing <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Alsing, Charnock, Feeney, and Wandelt</a>)</cite>, and <span class="ltx_text ltx_font_typewriter" id="S1.I2.i1.p1.1.3">lampe</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx36" title="">Rozet <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Rozet, Delaunoy, Miller <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>–under a single common interface, for the first time allowing rigorous apples-to-apples comparisons of their performance.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.1">We supply extensions to these codes, enabling them to utilize new types of embedding networks (<em class="ltx_emph ltx_font_italic" id="S1.I2.i2.p1.1.1">e.g.,</em> for image- and graph-like datasets) and providing state-of-the-art validation metrics for enabling robust, maximally-informative inference.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i3.p1">
<p class="ltx_p" id="S1.I2.i3.p1.1">We provide an accessible, comprehensive, dual Jupyter and command-line interface, for rapid research and development.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i4.p1">
<p class="ltx_p" id="S1.I2.i4.p1.1">We demonstrate the abilities of ILI in an extensive selection of inference problems in astrophysics and cosmology, and we provide these as public benchmarks for future works.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S1.p6.2">At the time of publishing, <span class="ltx_text ltx_font_smallcaps" id="S1.p6.2.1">LtU-ILI</span> offers the broadest and most complete toolbox of features among ILI software. Over <span class="ltx_text ltx_font_typewriter" id="S1.p6.2.2">sbi</span>, we include the capacity for custom data-loading procedures, additional neural density estimators (NDEs), and adaptability to exotic embedding architectures (including sequential and graph encoders). Over <span class="ltx_text ltx_font_typewriter" id="S1.p6.2.3">pydelfi</span>, we allow the capacity for neural posterior and ratio estimation. Over <span class="ltx_text ltx_font_typewriter" id="S1.p6.2.4">lampe</span>, we provide a configuration-based interface to training procedures, the ability to specify separate proposal and prior distributions, and automated validation tests. We also include new multivariate coverage tests such as TARP <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx37" title="">Lemos <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Lemos, Coogan, Hezaveh, and Levasseur</a>)</cite> and adaptive, automatic integration of data-loading, inference, and validation. We also remark that, during the development of this work, <span class="ltx_text ltx_font_typewriter" id="S1.p6.2.5">nbi</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx38" title="">Zhang <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Zhang, Bloom, and Hernitschek</a>)</cite> was released as a neural posterior estimation toolkit focused on spectra and light-curve analysis. Though we do not natively integrate <span class="ltx_text ltx_font_typewriter" id="S1.p6.2.6">nbi</span>, we remark that we encompass the functionality of <span class="ltx_text ltx_font_typewriter" id="S1.p6.2.7">nbi</span> in our various neural posterior estimation implementations and extend them with alternatives and additional features.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">In this software release paper, we provide background, details, and example applications of the <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.1">LtU-ILI</span> pipeline. The code is publicly available on Github<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/maho3/ltu-ili" title="">https://github.com/maho3/ltu-ili</a></span></span></span>.
In Section <span class="ltx_ref ltx_nolink ltx_ref_self"><span class="ltx_text ltx_ref_tag">2</span></span>, we review the theoretical foundations of ILI. In Section <span class="ltx_ref ltx_nolink ltx_ref_self"><span class="ltx_text ltx_ref_tag">3</span></span>, we describe the structure of our pipeline and the various configurations that users can interact with. In Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S4" title="4 Synthetic Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">4</span></a>, we apply <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.2">LtU-ILI</span> on several synthetic problems where the true solution is known, to demonstrate and benchmark its performance relative to traditional methods. In Section <span class="ltx_ref ltx_nolink ltx_ref_self"><span class="ltx_text ltx_ref_tag">5</span></span>, we provide numerous diverse examples of parameter inference in science using <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.3">LtU-ILI</span>. In <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S6" title="6 Discussion ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">6</span></a>, we discuss the important considerations to take into account when designing an ILI pipeline, as well as possible failure modes and relevant solutions. Lastly, we provide a summary of our findings in Section <span class="ltx_ref ltx_nolink ltx_ref_self"><span class="ltx_text ltx_ref_tag">7</span></span>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Implicit Likelihood Inference</h2>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="1069" id="S2.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Demonstration of the differences between a likelihood (top-left), posterior (top-right), prior (bottom-right), and joint distribution (bottom-left) for an arbitrary one-dimensional inference problem. Here, the univariate data <math alttext="x" class="ltx_Math" display="inline" id="S2.F1.6.m1.1"><semantics id="S2.F1.6.m1.1b"><mi id="S2.F1.6.m1.1.1" xref="S2.F1.6.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.F1.6.m1.1c"><ci id="S2.F1.6.m1.1.1.cmml" xref="S2.F1.6.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.6.m1.1d">x</annotation><annotation encoding="application/x-llamapun" id="S2.F1.6.m1.1e">italic_x</annotation></semantics></math> and parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S2.F1.7.m2.1"><semantics id="S2.F1.7.m2.1b"><mi id="S2.F1.7.m2.1.1" xref="S2.F1.7.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.F1.7.m2.1c"><ci id="S2.F1.7.m2.1.1.cmml" xref="S2.F1.7.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.7.m2.1d">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.F1.7.m2.1e">italic_θ</annotation></semantics></math> are associated by a quadratic relationship with Gaussian scatter. Given the observed data point <math alttext="x_{o}" class="ltx_Math" display="inline" id="S2.F1.8.m3.1"><semantics id="S2.F1.8.m3.1b"><msub id="S2.F1.8.m3.1.1" xref="S2.F1.8.m3.1.1.cmml"><mi id="S2.F1.8.m3.1.1.2" xref="S2.F1.8.m3.1.1.2.cmml">x</mi><mi id="S2.F1.8.m3.1.1.3" xref="S2.F1.8.m3.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.8.m3.1c"><apply id="S2.F1.8.m3.1.1.cmml" xref="S2.F1.8.m3.1.1"><csymbol cd="ambiguous" id="S2.F1.8.m3.1.1.1.cmml" xref="S2.F1.8.m3.1.1">subscript</csymbol><ci id="S2.F1.8.m3.1.1.2.cmml" xref="S2.F1.8.m3.1.1.2">𝑥</ci><ci id="S2.F1.8.m3.1.1.3.cmml" xref="S2.F1.8.m3.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.8.m3.1d">x_{o}</annotation><annotation encoding="application/x-llamapun" id="S2.F1.8.m3.1e">italic_x start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> (in black), our goal is to recover posterior constraints on <math alttext="\theta" class="ltx_Math" display="inline" id="S2.F1.9.m4.1"><semantics id="S2.F1.9.m4.1b"><mi id="S2.F1.9.m4.1.1" xref="S2.F1.9.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.F1.9.m4.1c"><ci id="S2.F1.9.m4.1.1.cmml" xref="S2.F1.9.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.9.m4.1d">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.F1.9.m4.1e">italic_θ</annotation></semantics></math>.
In an ILI framework, we seek to capture knowledge of the joint distribution, <math alttext="P(x,\theta)" class="ltx_Math" display="inline" id="S2.F1.10.m5.2"><semantics id="S2.F1.10.m5.2b"><mrow id="S2.F1.10.m5.2.3" xref="S2.F1.10.m5.2.3.cmml"><mi id="S2.F1.10.m5.2.3.2" xref="S2.F1.10.m5.2.3.2.cmml">P</mi><mo id="S2.F1.10.m5.2.3.1" xref="S2.F1.10.m5.2.3.1.cmml">⁢</mo><mrow id="S2.F1.10.m5.2.3.3.2" xref="S2.F1.10.m5.2.3.3.1.cmml"><mo id="S2.F1.10.m5.2.3.3.2.1" stretchy="false" xref="S2.F1.10.m5.2.3.3.1.cmml">(</mo><mi id="S2.F1.10.m5.1.1" xref="S2.F1.10.m5.1.1.cmml">x</mi><mo id="S2.F1.10.m5.2.3.3.2.2" xref="S2.F1.10.m5.2.3.3.1.cmml">,</mo><mi id="S2.F1.10.m5.2.2" xref="S2.F1.10.m5.2.2.cmml">θ</mi><mo id="S2.F1.10.m5.2.3.3.2.3" stretchy="false" xref="S2.F1.10.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F1.10.m5.2c"><apply id="S2.F1.10.m5.2.3.cmml" xref="S2.F1.10.m5.2.3"><times id="S2.F1.10.m5.2.3.1.cmml" xref="S2.F1.10.m5.2.3.1"></times><ci id="S2.F1.10.m5.2.3.2.cmml" xref="S2.F1.10.m5.2.3.2">𝑃</ci><interval closure="open" id="S2.F1.10.m5.2.3.3.1.cmml" xref="S2.F1.10.m5.2.3.3.2"><ci id="S2.F1.10.m5.1.1.cmml" xref="S2.F1.10.m5.1.1">𝑥</ci><ci id="S2.F1.10.m5.2.2.cmml" xref="S2.F1.10.m5.2.2">𝜃</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.10.m5.2d">P(x,\theta)</annotation><annotation encoding="application/x-llamapun" id="S2.F1.10.m5.2e">italic_P ( italic_x , italic_θ )</annotation></semantics></math>, by building neural-network emulators for the likelihood (in red) or the posterior (in blue).</figcaption>
</figure>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.7">The goal of ILI is the same as any Bayesian inference problem: given a model and observed data <math alttext="\bm{x}_{\rm o}" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><msub id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><mi id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml">𝒙</mi><mi id="S2.p1.1.m1.1.1.3" mathvariant="normal" xref="S2.p1.1.m1.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2">𝒙</ci><ci id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3">o</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">\bm{x}_{\rm o}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT</annotation></semantics></math>, we wish to know the distribution of model parameters <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">bold_italic_θ</annotation></semantics></math> which are consistent with our data, <em class="ltx_emph ltx_font_italic" id="S2.p1.7.1">i.e.,</em> the <span class="ltx_text ltx_font_italic" id="S2.p1.7.2">posterior distribution</span> <math alttext="\mathcal{P}\left(\bm{\theta}|\bm{x}_{\rm o}\right)" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mrow id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">𝒫</mi><mo id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.p1.3.m3.1.1.1.1" xref="S2.p1.3.m3.1.1.1.1.1.cmml"><mo id="S2.p1.3.m3.1.1.1.1.2" xref="S2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.p1.3.m3.1.1.1.1.1" xref="S2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S2.p1.3.m3.1.1.1.1.1.2" xref="S2.p1.3.m3.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.p1.3.m3.1.1.1.1.1.1" xref="S2.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S2.p1.3.m3.1.1.1.1.1.3" xref="S2.p1.3.m3.1.1.1.1.1.3.cmml"><mi id="S2.p1.3.m3.1.1.1.1.1.3.2" xref="S2.p1.3.m3.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.p1.3.m3.1.1.1.1.1.3.3" mathvariant="normal" xref="S2.p1.3.m3.1.1.1.1.1.3.3.cmml">o</mi></msub></mrow><mo id="S2.p1.3.m3.1.1.1.1.3" xref="S2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><times id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2"></times><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝒫</ci><apply id="S2.p1.3.m3.1.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1.1.1.2">𝜽</ci><apply id="S2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S2.p1.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="S2.p1.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p1.3.m3.1.1.1.1.1.3.2.cmml" xref="S2.p1.3.m3.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.p1.3.m3.1.1.1.1.1.3.3.cmml" xref="S2.p1.3.m3.1.1.1.1.1.3.3">o</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\mathcal{P}\left(\bm{\theta}|\bm{x}_{\rm o}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">caligraphic_P ( bold_italic_θ | bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT )</annotation></semantics></math>. The data and parameters can take many forms. In astronomy, we might consider the observed data <math alttext="\bm{x}_{\rm o}" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><msub id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><mi id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml">𝒙</mi><mi id="S2.p1.4.m4.1.1.3" mathvariant="normal" xref="S2.p1.4.m4.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2">𝒙</ci><ci id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3">o</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\bm{x}_{\rm o}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT</annotation></semantics></math> to be, for example, the observed X-ray photon count of a galaxy cluster, the gravitational wave signal from a collapsing black hole binary, or the full 2D sky projection of galaxy weak lensing measurements. From this data, we might wish to infer parameters <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">bold_italic_θ</annotation></semantics></math> such as, respectively, the mass of a galaxy cluster, the mass ratio and ellipticity of the black hole binary, or the cosmological parameters governing dark matter and dark energy. For Bayesians, the posterior <math alttext="\mathcal{P}\left(\bm{\theta}|\bm{x}_{\rm o}\right)" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><mrow id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml">𝒫</mi><mo id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S2.p1.6.m6.1.1.1.1" xref="S2.p1.6.m6.1.1.1.1.1.cmml"><mo id="S2.p1.6.m6.1.1.1.1.2" xref="S2.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.p1.6.m6.1.1.1.1.1" xref="S2.p1.6.m6.1.1.1.1.1.cmml"><mi id="S2.p1.6.m6.1.1.1.1.1.2" xref="S2.p1.6.m6.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.p1.6.m6.1.1.1.1.1.1" xref="S2.p1.6.m6.1.1.1.1.1.1.cmml">|</mo><msub id="S2.p1.6.m6.1.1.1.1.1.3" xref="S2.p1.6.m6.1.1.1.1.1.3.cmml"><mi id="S2.p1.6.m6.1.1.1.1.1.3.2" xref="S2.p1.6.m6.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.p1.6.m6.1.1.1.1.1.3.3" mathvariant="normal" xref="S2.p1.6.m6.1.1.1.1.1.3.3.cmml">o</mi></msub></mrow><mo id="S2.p1.6.m6.1.1.1.1.3" xref="S2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><times id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2"></times><ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">𝒫</ci><apply id="S2.p1.6.m6.1.1.1.1.1.cmml" xref="S2.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="S2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.p1.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p1.6.m6.1.1.1.1.1.2.cmml" xref="S2.p1.6.m6.1.1.1.1.1.2">𝜽</ci><apply id="S2.p1.6.m6.1.1.1.1.1.3.cmml" xref="S2.p1.6.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.1.1.3.1.cmml" xref="S2.p1.6.m6.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p1.6.m6.1.1.1.1.1.3.2.cmml" xref="S2.p1.6.m6.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.p1.6.m6.1.1.1.1.1.3.3.cmml" xref="S2.p1.6.m6.1.1.1.1.1.3.3">o</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">\mathcal{P}\left(\bm{\theta}|\bm{x}_{\rm o}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">caligraphic_P ( bold_italic_θ | bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT )</annotation></semantics></math> is the key to constraining our belief in physical laws after observing new data <math alttext="\bm{x}_{\rm o}" class="ltx_Math" display="inline" id="S2.p1.7.m7.1"><semantics id="S2.p1.7.m7.1a"><msub id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><mi id="S2.p1.7.m7.1.1.2" xref="S2.p1.7.m7.1.1.2.cmml">𝒙</mi><mi id="S2.p1.7.m7.1.1.3" mathvariant="normal" xref="S2.p1.7.m7.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.1.cmml" xref="S2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1.2">𝒙</ci><ci id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3">o</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">\bm{x}_{\rm o}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m7.1d">bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.3">According to Bayes’ theorem, the posterior is composed of</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{P}\left(\bm{\theta}|\bm{x}\right)\propto\mathcal{P}\left(\bm{x}|\bm{%
\theta}\right)\ \mathcal{P}\left(\bm{\theta}\right)," class="ltx_Math" display="block" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.3.cmml">𝒫</mi><mo id="S2.E1.m1.2.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.2.2.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.E1.m1.2.2.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.E1.m1.2.2.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.3" xref="S2.E1.m1.2.2.1.1.3.cmml">∝</mo><mrow id="S2.E1.m1.2.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.1.1.2.3" xref="S2.E1.m1.2.2.1.1.2.3.cmml">𝒫</mi><mo id="S2.E1.m1.2.2.1.1.2.2" xref="S2.E1.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.1.1.2.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S2.E1.m1.2.2.1.1.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.E1.m1.2.2.1.1.2.1.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml">|</mo><mi id="S2.E1.m1.2.2.1.1.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.E1.m1.2.2.1.1.2.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.2.2.1.1.2.2a" lspace="0.500em" xref="S2.E1.m1.2.2.1.1.2.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.1.1.2.4" xref="S2.E1.m1.2.2.1.1.2.4.cmml">𝒫</mi><mo id="S2.E1.m1.2.2.1.1.2.2b" xref="S2.E1.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.1.1.2.5.2" xref="S2.E1.m1.2.2.1.1.2.cmml"><mo id="S2.E1.m1.2.2.1.1.2.5.2.1" xref="S2.E1.m1.2.2.1.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝜽</mi><mo id="S2.E1.m1.2.2.1.1.2.5.2.2" xref="S2.E1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.3">proportional-to</csymbol><apply id="S2.E1.m1.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1"><times id="S2.E1.m1.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.2"></times><ci id="S2.E1.m1.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.3">𝒫</ci><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2">𝜽</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3">𝒙</ci></apply></apply><apply id="S2.E1.m1.2.2.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2"><times id="S2.E1.m1.2.2.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2"></times><ci id="S2.E1.m1.2.2.1.1.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.3">𝒫</ci><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1">conditional</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2">𝒙</ci><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.3">𝜽</ci></apply><ci id="S2.E1.m1.2.2.1.1.2.4.cmml" xref="S2.E1.m1.2.2.1.1.2.4">𝒫</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\mathcal{P}\left(\bm{\theta}|\bm{x}\right)\propto\mathcal{P}\left(\bm{x}|\bm{%
\theta}\right)\ \mathcal{P}\left(\bm{\theta}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">caligraphic_P ( bold_italic_θ | bold_italic_x ) ∝ caligraphic_P ( bold_italic_x | bold_italic_θ ) caligraphic_P ( bold_italic_θ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p2.2">where <math alttext="\mathcal{P}\left(\bm{x}|\bm{\theta}\right)" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">𝒫</mi><mo id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p2.1.m1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.cmml"><mo id="S2.p2.1.m1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p2.1.m1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.p2.1.m1.1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p2.1.m1.1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.p2.1.m1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><times id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2"></times><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">𝒫</ci><apply id="S2.p2.1.m1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.2">𝒙</ci><ci id="S2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.3">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathcal{P}\left(\bm{x}|\bm{\theta}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">caligraphic_P ( bold_italic_x | bold_italic_θ )</annotation></semantics></math> is the <span class="ltx_text ltx_font_italic" id="S2.p2.2.1">likelihood</span>, which defines the probability of the data given the model and some parameters, and <math alttext="\mathcal{P}\left(\bm{\theta}\right)" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.2" xref="S2.p2.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.2.m2.1.2.2" xref="S2.p2.2.m2.1.2.2.cmml">𝒫</mi><mo id="S2.p2.2.m2.1.2.1" xref="S2.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.p2.2.m2.1.2.3.2" xref="S2.p2.2.m2.1.2.cmml"><mo id="S2.p2.2.m2.1.2.3.2.1" xref="S2.p2.2.m2.1.2.cmml">(</mo><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">𝜽</mi><mo id="S2.p2.2.m2.1.2.3.2.2" xref="S2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.2.cmml" xref="S2.p2.2.m2.1.2"><times id="S2.p2.2.m2.1.2.1.cmml" xref="S2.p2.2.m2.1.2.1"></times><ci id="S2.p2.2.m2.1.2.2.cmml" xref="S2.p2.2.m2.1.2.2">𝒫</ci><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathcal{P}\left(\bm{\theta}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">caligraphic_P ( bold_italic_θ )</annotation></semantics></math> is the <span class="ltx_text ltx_font_italic" id="S2.p2.2.2">prior</span>, which specifies our prior belief on the true distribution of the parameters. A demonstration of the differences of the prior, posterior, and likelihood in an inference problem is given in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.F1" title="Figure 1 ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.2">There are two approaches to modeling the terms in Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E1" title="1 ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">1</span></a>: explicit (theory-driven) analyses or implicit (data-driven) analyses. In a classical <span class="ltx_text ltx_font_italic" id="S2.p3.2.1">explicit</span> likelihood-based analysis, we assume an analytic form for the likelihood, <math alttext="\mathcal{P}\left(\bm{x}|\bm{\theta}\right)" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mrow id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml">𝒫</mi><mo id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p3.1.m1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.cmml"><mo id="S2.p3.1.m1.1.1.1.1.2" xref="S2.p3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p3.1.m1.1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.1.1.1.2" xref="S2.p3.1.m1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.p3.1.m1.1.1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p3.1.m1.1.1.1.1.1.3" xref="S2.p3.1.m1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.p3.1.m1.1.1.1.1.3" xref="S2.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><times id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2"></times><ci id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3">𝒫</ci><apply id="S2.p3.1.m1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.1.1.1.2">𝒙</ci><ci id="S2.p3.1.m1.1.1.1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.1.1.1.3">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\mathcal{P}\left(\bm{x}|\bm{\theta}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">caligraphic_P ( bold_italic_x | bold_italic_θ )</annotation></semantics></math>, and substitute it into Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E1" title="1 ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">1</span></a>. Typically, this expression is derived from analytic theory or simple simulations, coupled with strong assumptions on the statistical distribution of noise or unknown physics. Sometimes, these statistical assumptions are relatively simple, <em class="ltx_emph ltx_font_italic" id="S2.p3.2.2">e.g.,</em> a Gaussian distribution for continuous data <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S2.p3.2.3.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx39" title="">Tegmark <em class="ltx_emph ltx_font_italic">et al.</em>(2004)Tegmark, Blanton, Strauss, Hoyle, Schlegel, Scoccimarro, Vogeley, Weinberg, Zehavi, Berlind, Budavari, Connolly, Eisenstein, Finkbeiner, Frieman, Gunn, Hamilton, Hui, Jain, Johnston, Kent, Lin, Nakajima, Nichol, Ostriker, Pope, Scranton, Seljak, Sheth, Stebbins, Szalay, Szapudi, Verde, Xu, Annis, Bahcall,
Brinkmann, Burles, Castander, Csabai, Loveday, Doi, Fukugita, Gott, Hennessy, Hogg, Ivezić, Knapp, Lamb, Lee, Lupton, McKay, Kunszt, Munn, O’Connell, Peoples, Pier, Richmond, Rockosi, Schneider, Stoughton, Tucker, Vanden Berk, Yanny, York, and SDSS Collaboration</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx40" title="">Christensen and Meyer(2022)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx41" title="">Porqueres <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Porqueres, Heavens, Mortlock, and Lavaux</a>)</cite> or a Poisson distribution for discrete counts <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S2.p3.2.4.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx42" title="">Boese and Doebereiner(2001)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx43" title="">Braun <em class="ltx_emph ltx_font_italic">et al.</em>(2008)Braun, Dumm, De Palma, Finley, Karle, and Montaruli</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx44" title="">Tsaprazi <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Tsaprazi, Nguyen, Jasche, Schmidt, and Lavaux</a>)</cite>. Although these may be appropriate distributions for many situations, for a general inference problem we may not know which distribution to choose or whether this choice is valid.
Also, MCMC-like samplers scale poorly with dimensionality and have bad mode coverage. This can cause problems for high-dimensional inference problems, especially if the likelihood is not differentiable with respect to the parameters.
However, if we have access to a set of examples of the data-parameter relationship (<em class="ltx_emph ltx_font_italic" id="S2.p3.2.5">i.e.,</em> samples from the joint distribution, <math alttext="(\bm{x},\bm{\theta})\sim\mathcal{P}(\bm{x},\bm{\theta})" class="ltx_Math" display="inline" id="S2.p3.2.m2.4"><semantics id="S2.p3.2.m2.4a"><mrow id="S2.p3.2.m2.4.5" xref="S2.p3.2.m2.4.5.cmml"><mrow id="S2.p3.2.m2.4.5.2.2" xref="S2.p3.2.m2.4.5.2.1.cmml"><mo id="S2.p3.2.m2.4.5.2.2.1" stretchy="false" xref="S2.p3.2.m2.4.5.2.1.cmml">(</mo><mi id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">𝒙</mi><mo id="S2.p3.2.m2.4.5.2.2.2" xref="S2.p3.2.m2.4.5.2.1.cmml">,</mo><mi id="S2.p3.2.m2.2.2" xref="S2.p3.2.m2.2.2.cmml">𝜽</mi><mo id="S2.p3.2.m2.4.5.2.2.3" stretchy="false" xref="S2.p3.2.m2.4.5.2.1.cmml">)</mo></mrow><mo id="S2.p3.2.m2.4.5.1" xref="S2.p3.2.m2.4.5.1.cmml">∼</mo><mrow id="S2.p3.2.m2.4.5.3" xref="S2.p3.2.m2.4.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p3.2.m2.4.5.3.2" xref="S2.p3.2.m2.4.5.3.2.cmml">𝒫</mi><mo id="S2.p3.2.m2.4.5.3.1" xref="S2.p3.2.m2.4.5.3.1.cmml">⁢</mo><mrow id="S2.p3.2.m2.4.5.3.3.2" xref="S2.p3.2.m2.4.5.3.3.1.cmml"><mo id="S2.p3.2.m2.4.5.3.3.2.1" stretchy="false" xref="S2.p3.2.m2.4.5.3.3.1.cmml">(</mo><mi id="S2.p3.2.m2.3.3" xref="S2.p3.2.m2.3.3.cmml">𝒙</mi><mo id="S2.p3.2.m2.4.5.3.3.2.2" xref="S2.p3.2.m2.4.5.3.3.1.cmml">,</mo><mi id="S2.p3.2.m2.4.4" xref="S2.p3.2.m2.4.4.cmml">𝜽</mi><mo id="S2.p3.2.m2.4.5.3.3.2.3" stretchy="false" xref="S2.p3.2.m2.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.4b"><apply id="S2.p3.2.m2.4.5.cmml" xref="S2.p3.2.m2.4.5"><csymbol cd="latexml" id="S2.p3.2.m2.4.5.1.cmml" xref="S2.p3.2.m2.4.5.1">similar-to</csymbol><interval closure="open" id="S2.p3.2.m2.4.5.2.1.cmml" xref="S2.p3.2.m2.4.5.2.2"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">𝒙</ci><ci id="S2.p3.2.m2.2.2.cmml" xref="S2.p3.2.m2.2.2">𝜽</ci></interval><apply id="S2.p3.2.m2.4.5.3.cmml" xref="S2.p3.2.m2.4.5.3"><times id="S2.p3.2.m2.4.5.3.1.cmml" xref="S2.p3.2.m2.4.5.3.1"></times><ci id="S2.p3.2.m2.4.5.3.2.cmml" xref="S2.p3.2.m2.4.5.3.2">𝒫</ci><interval closure="open" id="S2.p3.2.m2.4.5.3.3.1.cmml" xref="S2.p3.2.m2.4.5.3.3.2"><ci id="S2.p3.2.m2.3.3.cmml" xref="S2.p3.2.m2.3.3">𝒙</ci><ci id="S2.p3.2.m2.4.4.cmml" xref="S2.p3.2.m2.4.4">𝜽</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.4c">(\bm{x},\bm{\theta})\sim\mathcal{P}(\bm{x},\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.4d">( bold_italic_x , bold_italic_θ ) ∼ caligraphic_P ( bold_italic_x , bold_italic_θ )</annotation></semantics></math>), we can use <span class="ltx_text ltx_font_italic" id="S2.p3.2.6">implicit</span> likelihood analyses to learn the shape of a likelihood or posterior automatically with full differentiability. This flexibility makes ILI an extremely powerful tool for modeling complex or otherwise poorly-understood physical phenomena.
</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.3">ILI learns approximate posteriors, <math alttext="\hat{\mathcal{P}}(\bm{\theta}|\bm{x})" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><mrow id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml"><mover accent="true" id="S2.p4.1.m1.1.1.3" xref="S2.p4.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.1.m1.1.1.3.2" xref="S2.p4.1.m1.1.1.3.2.cmml">𝒫</mi><mo id="S2.p4.1.m1.1.1.3.1" xref="S2.p4.1.m1.1.1.3.1.cmml">^</mo></mover><mo id="S2.p4.1.m1.1.1.2" xref="S2.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p4.1.m1.1.1.1.1" xref="S2.p4.1.m1.1.1.1.1.1.cmml"><mo id="S2.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S2.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p4.1.m1.1.1.1.1.1" xref="S2.p4.1.m1.1.1.1.1.1.cmml"><mi id="S2.p4.1.m1.1.1.1.1.1.2" xref="S2.p4.1.m1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.p4.1.m1.1.1.1.1.1.1" xref="S2.p4.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p4.1.m1.1.1.1.1.1.3" xref="S2.p4.1.m1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S2.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"><times id="S2.p4.1.m1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.2"></times><apply id="S2.p4.1.m1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.3"><ci id="S2.p4.1.m1.1.1.3.1.cmml" xref="S2.p4.1.m1.1.1.3.1">^</ci><ci id="S2.p4.1.m1.1.1.3.2.cmml" xref="S2.p4.1.m1.1.1.3.2">𝒫</ci></apply><apply id="S2.p4.1.m1.1.1.1.1.1.cmml" xref="S2.p4.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.p4.1.m1.1.1.1.1.1.1.cmml" xref="S2.p4.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p4.1.m1.1.1.1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.1.1.1.2">𝜽</ci><ci id="S2.p4.1.m1.1.1.1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">\hat{\mathcal{P}}(\bm{\theta}|\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x )</annotation></semantics></math>, or likelihoods from the distribution of example data-parameter pairs in a training catalog, <math alttext="\mathcal{D}_{\rm train}:=\{(\bm{x}_{i},\bm{\theta}_{i})\}_{i=1}^{N_{\rm train}}" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><mrow id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml"><msub id="S2.p4.2.m2.1.1.3" xref="S2.p4.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.2.m2.1.1.3.2" xref="S2.p4.2.m2.1.1.3.2.cmml">𝒟</mi><mi id="S2.p4.2.m2.1.1.3.3" xref="S2.p4.2.m2.1.1.3.3.cmml">train</mi></msub><mo id="S2.p4.2.m2.1.1.2" lspace="0.278em" rspace="0.278em" xref="S2.p4.2.m2.1.1.2.cmml">:=</mo><msubsup id="S2.p4.2.m2.1.1.1" xref="S2.p4.2.m2.1.1.1.cmml"><mrow id="S2.p4.2.m2.1.1.1.1.1.1" xref="S2.p4.2.m2.1.1.1.1.1.2.cmml"><mo id="S2.p4.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S2.p4.2.m2.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.p4.2.m2.1.1.1.1.1.1.1.2" xref="S2.p4.2.m2.1.1.1.1.1.1.1.3.cmml"><mo id="S2.p4.2.m2.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.p4.2.m2.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S2.p4.2.m2.1.1.1.1.1.1.1.1.1" xref="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p4.2.m2.1.1.1.1.1.1.1.2.4" xref="S2.p4.2.m2.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.p4.2.m2.1.1.1.1.1.1.1.2.2" xref="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.2" xref="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.2.cmml">𝜽</mi><mi id="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.3" xref="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S2.p4.2.m2.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.p4.2.m2.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.p4.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S2.p4.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p4.2.m2.1.1.1.1.3" xref="S2.p4.2.m2.1.1.1.1.3.cmml"><mi id="S2.p4.2.m2.1.1.1.1.3.2" xref="S2.p4.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S2.p4.2.m2.1.1.1.1.3.1" xref="S2.p4.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p4.2.m2.1.1.1.1.3.3" xref="S2.p4.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S2.p4.2.m2.1.1.1.3" xref="S2.p4.2.m2.1.1.1.3.cmml"><mi id="S2.p4.2.m2.1.1.1.3.2" xref="S2.p4.2.m2.1.1.1.3.2.cmml">N</mi><mi id="S2.p4.2.m2.1.1.1.3.3" xref="S2.p4.2.m2.1.1.1.3.3.cmml">train</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><apply id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1"><csymbol cd="latexml" id="S2.p4.2.m2.1.1.2.cmml" xref="S2.p4.2.m2.1.1.2">assign</csymbol><apply id="S2.p4.2.m2.1.1.3.cmml" xref="S2.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.3.1.cmml" xref="S2.p4.2.m2.1.1.3">subscript</csymbol><ci id="S2.p4.2.m2.1.1.3.2.cmml" xref="S2.p4.2.m2.1.1.3.2">𝒟</ci><ci id="S2.p4.2.m2.1.1.3.3.cmml" xref="S2.p4.2.m2.1.1.3.3">train</ci></apply><apply id="S2.p4.2.m2.1.1.1.cmml" xref="S2.p4.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.1.2.cmml" xref="S2.p4.2.m2.1.1.1">superscript</csymbol><apply id="S2.p4.2.m2.1.1.1.1.cmml" xref="S2.p4.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.1.1.2.cmml" xref="S2.p4.2.m2.1.1.1">subscript</csymbol><set id="S2.p4.2.m2.1.1.1.1.1.2.cmml" xref="S2.p4.2.m2.1.1.1.1.1.1"><interval closure="open" id="S2.p4.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.p4.2.m2.1.1.1.1.1.1.1.2"><apply id="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p4.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p4.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p4.2.m2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p4.2.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.p4.2.m2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.2">𝜽</ci><ci id="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.p4.2.m2.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S2.p4.2.m2.1.1.1.1.3.cmml" xref="S2.p4.2.m2.1.1.1.1.3"><eq id="S2.p4.2.m2.1.1.1.1.3.1.cmml" xref="S2.p4.2.m2.1.1.1.1.3.1"></eq><ci id="S2.p4.2.m2.1.1.1.1.3.2.cmml" xref="S2.p4.2.m2.1.1.1.1.3.2">𝑖</ci><cn id="S2.p4.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="S2.p4.2.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.p4.2.m2.1.1.1.3.cmml" xref="S2.p4.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.1.3.1.cmml" xref="S2.p4.2.m2.1.1.1.3">subscript</csymbol><ci id="S2.p4.2.m2.1.1.1.3.2.cmml" xref="S2.p4.2.m2.1.1.1.3.2">𝑁</ci><ci id="S2.p4.2.m2.1.1.1.3.3.cmml" xref="S2.p4.2.m2.1.1.1.3.3">train</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">\mathcal{D}_{\rm train}:=\{(\bm{x}_{i},\bm{\theta}_{i})\}_{i=1}^{N_{\rm train}}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT := { ( bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
These data can take any form; they can be sensor readings in an experiment <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S2.p4.3.1.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx45" title="">Dingeldein <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Dingeldein, Cossio, and Covino</a>)</cite>, images of the night sky <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S2.p4.3.2.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx46" title="">Ntampaka <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Ntampaka, ZuHone, Eisenstein, Nagai, Vikhlinin, Hernquist, Marinacci, Nelson, Pakmor, Pillepich <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>, or even compressed summaries of high-dimensional stochastic properties <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S2.p4.3.3.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx33" title="">Modi <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Modi, Pandey, Ho, Hahn, Blancard, and Wandelt</a>)</cite>. They can be gathered from a pre-run simulation <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S2.p4.3.4.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx47" title="">Fluri <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Fluri, Kacprzak, Lucchi, Schneider, Refregier, and Hofmann</a>)</cite>, be simulated on-the-fly <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S2.p4.3.5.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx35" title="">Alsing <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Alsing, Charnock, Feeney, and Wandelt</a>)</cite>, or curated from manually-labeled observations <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S2.p4.3.6.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx48" title="">Lanusse <em class="ltx_emph ltx_font_italic">et al.</em>(2018)Lanusse, Ma, Li, Collett, Li, Ravanbakhsh, Mandelbaum, and Póczos</a>)</cite>, but they must be representative of the true underlying problem. Given these data-parameter pairs, we wish to construct a model capable of doing inference on real data, <em class="ltx_emph ltx_font_italic" id="S2.p4.3.7">i.e.,</em> to evaluate the posterior at some observed value <math alttext="\bm{x}=\bm{x}_{\rm o}" class="ltx_Math" display="inline" id="S2.p4.3.m3.1"><semantics id="S2.p4.3.m3.1a"><mrow id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml"><mi id="S2.p4.3.m3.1.1.2" xref="S2.p4.3.m3.1.1.2.cmml">𝒙</mi><mo id="S2.p4.3.m3.1.1.1" xref="S2.p4.3.m3.1.1.1.cmml">=</mo><msub id="S2.p4.3.m3.1.1.3" xref="S2.p4.3.m3.1.1.3.cmml"><mi id="S2.p4.3.m3.1.1.3.2" xref="S2.p4.3.m3.1.1.3.2.cmml">𝒙</mi><mi id="S2.p4.3.m3.1.1.3.3" mathvariant="normal" xref="S2.p4.3.m3.1.1.3.3.cmml">o</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.1b"><apply id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1"><eq id="S2.p4.3.m3.1.1.1.cmml" xref="S2.p4.3.m3.1.1.1"></eq><ci id="S2.p4.3.m3.1.1.2.cmml" xref="S2.p4.3.m3.1.1.2">𝒙</ci><apply id="S2.p4.3.m3.1.1.3.cmml" xref="S2.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.p4.3.m3.1.1.3.1.cmml" xref="S2.p4.3.m3.1.1.3">subscript</csymbol><ci id="S2.p4.3.m3.1.1.3.2.cmml" xref="S2.p4.3.m3.1.1.3.2">𝒙</ci><ci id="S2.p4.3.m3.1.1.3.3.cmml" xref="S2.p4.3.m3.1.1.3.3">o</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.1c">\bm{x}=\bm{x}_{\rm o}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.3.m3.1d">bold_italic_x = bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1">In this section, we describe the theoretical foundations of <span class="ltx_text ltx_font_smallcaps" id="S2.p5.1.1">LtU-ILI</span>. We begin by providing a simple introductory example for posterior inference with Approximate Bayesian Computation (ABC; Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS1" title="2.1 Approximate Bayesian Computation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.1</span></a>). We then explain how one can vastly accelerate this process using neural networks to emulate probability distributions (Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2" title="2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.2</span></a>). We then discuss how to practically frame machine learning in the context of Bayesian inference (Sections <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2.SSS1" title="2.2.1 Neural Posterior Estimation (NPE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.2.1</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2.SSS2" title="2.2.2 Neural Likelihood Estimation (NLE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.2.2</span></a> &amp; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2.SSS3" title="2.2.3 Neural Ratio Estimation (NRE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.2.3</span></a>). Lastly, we discuss auxiliary topics on utilizing active learning to accelerate training (Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS3" title="2.3 Sequential Learning ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.3</span></a>) and validating black-box models to ensure robustness in real-world applications (Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS4" title="2.4 Validation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.4</span></a>).</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Approximate Bayesian Computation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.13">Approximate Bayesian Computation <cite class="ltx_cite ltx_citemacro_citep">(ABC; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx49" title="">Rubin(1984)</a>)</cite> is the original basis of ILI. Given a prior <math alttext="\mathcal{P}(\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.2" xref="S2.SS1.p1.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.2.2" xref="S2.SS1.p1.1.m1.1.2.2.cmml">𝒫</mi><mo id="S2.SS1.p1.1.m1.1.2.1" xref="S2.SS1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.1.m1.1.2.3.2" xref="S2.SS1.p1.1.m1.1.2.cmml"><mo id="S2.SS1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS1.p1.1.m1.1.2.cmml">(</mo><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">𝜽</mi><mo id="S2.SS1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.2"><times id="S2.SS1.p1.1.m1.1.2.1.cmml" xref="S2.SS1.p1.1.m1.1.2.1"></times><ci id="S2.SS1.p1.1.m1.1.2.2.cmml" xref="S2.SS1.p1.1.m1.1.2.2">𝒫</ci><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathcal{P}(\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">caligraphic_P ( bold_italic_θ )</annotation></semantics></math>, a simulator (<math alttext="\bm{\theta}\rightarrow\bm{x}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">𝜽</mi><mo id="S2.SS1.p1.2.m2.1.1.1" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.cmml">→</mo><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">𝒙</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><ci id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1">→</ci><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝜽</ci><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\bm{\theta}\rightarrow\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">bold_italic_θ → bold_italic_x</annotation></semantics></math>), and an observation <math alttext="\bm{x}_{\rm o}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.3.m3.1.1.3" mathvariant="normal" xref="S2.SS1.p1.3.m3.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝒙</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">o</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\bm{x}_{\rm o}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT</annotation></semantics></math>, ABC can construct a posterior.
The general procedure of Rejection ABC is straightforward: (1) first, draw candidate parameter values from the prior <math alttext="\bm{\theta}\sim\mathcal{P}(\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.2" xref="S2.SS1.p1.4.m4.1.2.cmml"><mi id="S2.SS1.p1.4.m4.1.2.2" xref="S2.SS1.p1.4.m4.1.2.2.cmml">𝜽</mi><mo id="S2.SS1.p1.4.m4.1.2.1" xref="S2.SS1.p1.4.m4.1.2.1.cmml">∼</mo><mrow id="S2.SS1.p1.4.m4.1.2.3" xref="S2.SS1.p1.4.m4.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.1.2.3.2" xref="S2.SS1.p1.4.m4.1.2.3.2.cmml">𝒫</mi><mo id="S2.SS1.p1.4.m4.1.2.3.1" xref="S2.SS1.p1.4.m4.1.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p1.4.m4.1.2.3.3.2" xref="S2.SS1.p1.4.m4.1.2.3.cmml"><mo id="S2.SS1.p1.4.m4.1.2.3.3.2.1" stretchy="false" xref="S2.SS1.p1.4.m4.1.2.3.cmml">(</mo><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">𝜽</mi><mo id="S2.SS1.p1.4.m4.1.2.3.3.2.2" stretchy="false" xref="S2.SS1.p1.4.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.2.cmml" xref="S2.SS1.p1.4.m4.1.2"><csymbol cd="latexml" id="S2.SS1.p1.4.m4.1.2.1.cmml" xref="S2.SS1.p1.4.m4.1.2.1">similar-to</csymbol><ci id="S2.SS1.p1.4.m4.1.2.2.cmml" xref="S2.SS1.p1.4.m4.1.2.2">𝜽</ci><apply id="S2.SS1.p1.4.m4.1.2.3.cmml" xref="S2.SS1.p1.4.m4.1.2.3"><times id="S2.SS1.p1.4.m4.1.2.3.1.cmml" xref="S2.SS1.p1.4.m4.1.2.3.1"></times><ci id="S2.SS1.p1.4.m4.1.2.3.2.cmml" xref="S2.SS1.p1.4.m4.1.2.3.2">𝒫</ci><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\bm{\theta}\sim\mathcal{P}(\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">bold_italic_θ ∼ caligraphic_P ( bold_italic_θ )</annotation></semantics></math>, (2) forward-simulate these parameter values to observations <math alttext="\bm{x}\sim\mathcal{P}(\bm{x}|\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mrow id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">𝒙</mi><mo id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">∼</mo><mrow id="S2.SS1.p1.5.m5.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.5.m5.1.1.1.3" xref="S2.SS1.p1.5.m5.1.1.1.3.cmml">𝒫</mi><mo id="S2.SS1.p1.5.m5.1.1.1.2" xref="S2.SS1.p1.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.5.m5.1.1.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.5.m5.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.5.m5.1.1.1.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.1.1.1.1.2" xref="S2.SS1.p1.5.m5.1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.SS1.p1.5.m5.1.1.1.1.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p1.5.m5.1.1.1.1.1.1.3" xref="S2.SS1.p1.5.m5.1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.SS1.p1.5.m5.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="latexml" id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">similar-to</csymbol><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">𝒙</ci><apply id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1"><times id="S2.SS1.p1.5.m5.1.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.1.2"></times><ci id="S2.SS1.p1.5.m5.1.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.1.3">𝒫</ci><apply id="S2.SS1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS1.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1.1.1.3">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\bm{x}\sim\mathcal{P}(\bm{x}|\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">bold_italic_x ∼ caligraphic_P ( bold_italic_x | bold_italic_θ )</annotation></semantics></math>, (3) measure a distance metric between the candidate observations and the real observation, <math alttext="d(\bm{x},\bm{x}_{\rm o})" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.2"><semantics id="S2.SS1.p1.6.m6.2a"><mrow id="S2.SS1.p1.6.m6.2.2" xref="S2.SS1.p1.6.m6.2.2.cmml"><mi id="S2.SS1.p1.6.m6.2.2.3" xref="S2.SS1.p1.6.m6.2.2.3.cmml">d</mi><mo id="S2.SS1.p1.6.m6.2.2.2" xref="S2.SS1.p1.6.m6.2.2.2.cmml">⁢</mo><mrow id="S2.SS1.p1.6.m6.2.2.1.1" xref="S2.SS1.p1.6.m6.2.2.1.2.cmml"><mo id="S2.SS1.p1.6.m6.2.2.1.1.2" stretchy="false" xref="S2.SS1.p1.6.m6.2.2.1.2.cmml">(</mo><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">𝒙</mi><mo id="S2.SS1.p1.6.m6.2.2.1.1.3" xref="S2.SS1.p1.6.m6.2.2.1.2.cmml">,</mo><msub id="S2.SS1.p1.6.m6.2.2.1.1.1" xref="S2.SS1.p1.6.m6.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.6.m6.2.2.1.1.1.2" xref="S2.SS1.p1.6.m6.2.2.1.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.6.m6.2.2.1.1.1.3" mathvariant="normal" xref="S2.SS1.p1.6.m6.2.2.1.1.1.3.cmml">o</mi></msub><mo id="S2.SS1.p1.6.m6.2.2.1.1.4" stretchy="false" xref="S2.SS1.p1.6.m6.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.2b"><apply id="S2.SS1.p1.6.m6.2.2.cmml" xref="S2.SS1.p1.6.m6.2.2"><times id="S2.SS1.p1.6.m6.2.2.2.cmml" xref="S2.SS1.p1.6.m6.2.2.2"></times><ci id="S2.SS1.p1.6.m6.2.2.3.cmml" xref="S2.SS1.p1.6.m6.2.2.3">𝑑</ci><interval closure="open" id="S2.SS1.p1.6.m6.2.2.1.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝒙</ci><apply id="S2.SS1.p1.6.m6.2.2.1.1.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.2">𝒙</ci><ci id="S2.SS1.p1.6.m6.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.6.m6.2.2.1.1.1.3">o</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.2c">d(\bm{x},\bm{x}_{\rm o})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.2d">italic_d ( bold_italic_x , bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT )</annotation></semantics></math>, and (4) if the distance is sufficiently close to the real observation (<em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.13.1">i.e.,</em> <math alttext="d(\bm{x},\bm{x}_{\rm o})&lt;\epsilon" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.2"><semantics id="S2.SS1.p1.7.m7.2a"><mrow id="S2.SS1.p1.7.m7.2.2" xref="S2.SS1.p1.7.m7.2.2.cmml"><mrow id="S2.SS1.p1.7.m7.2.2.1" xref="S2.SS1.p1.7.m7.2.2.1.cmml"><mi id="S2.SS1.p1.7.m7.2.2.1.3" xref="S2.SS1.p1.7.m7.2.2.1.3.cmml">d</mi><mo id="S2.SS1.p1.7.m7.2.2.1.2" xref="S2.SS1.p1.7.m7.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.7.m7.2.2.1.1.1" xref="S2.SS1.p1.7.m7.2.2.1.1.2.cmml"><mo id="S2.SS1.p1.7.m7.2.2.1.1.1.2" stretchy="false" xref="S2.SS1.p1.7.m7.2.2.1.1.2.cmml">(</mo><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">𝒙</mi><mo id="S2.SS1.p1.7.m7.2.2.1.1.1.3" xref="S2.SS1.p1.7.m7.2.2.1.1.2.cmml">,</mo><msub id="S2.SS1.p1.7.m7.2.2.1.1.1.1" xref="S2.SS1.p1.7.m7.2.2.1.1.1.1.cmml"><mi id="S2.SS1.p1.7.m7.2.2.1.1.1.1.2" xref="S2.SS1.p1.7.m7.2.2.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.7.m7.2.2.1.1.1.1.3" mathvariant="normal" xref="S2.SS1.p1.7.m7.2.2.1.1.1.1.3.cmml">o</mi></msub><mo id="S2.SS1.p1.7.m7.2.2.1.1.1.4" stretchy="false" xref="S2.SS1.p1.7.m7.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.7.m7.2.2.2" xref="S2.SS1.p1.7.m7.2.2.2.cmml">&lt;</mo><mi id="S2.SS1.p1.7.m7.2.2.3" xref="S2.SS1.p1.7.m7.2.2.3.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.2b"><apply id="S2.SS1.p1.7.m7.2.2.cmml" xref="S2.SS1.p1.7.m7.2.2"><lt id="S2.SS1.p1.7.m7.2.2.2.cmml" xref="S2.SS1.p1.7.m7.2.2.2"></lt><apply id="S2.SS1.p1.7.m7.2.2.1.cmml" xref="S2.SS1.p1.7.m7.2.2.1"><times id="S2.SS1.p1.7.m7.2.2.1.2.cmml" xref="S2.SS1.p1.7.m7.2.2.1.2"></times><ci id="S2.SS1.p1.7.m7.2.2.1.3.cmml" xref="S2.SS1.p1.7.m7.2.2.1.3">𝑑</ci><interval closure="open" id="S2.SS1.p1.7.m7.2.2.1.1.2.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1.1"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝒙</ci><apply id="S2.SS1.p1.7.m7.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m7.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1.1.1.2">𝒙</ci><ci id="S2.SS1.p1.7.m7.2.2.1.1.1.1.3.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1.1.1.3">o</ci></apply></interval></apply><ci id="S2.SS1.p1.7.m7.2.2.3.cmml" xref="S2.SS1.p1.7.m7.2.2.3">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.2c">d(\bm{x},\bm{x}_{\rm o})&lt;\epsilon</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.2d">italic_d ( bold_italic_x , bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT ) &lt; italic_ϵ</annotation></semantics></math> for small <math alttext="\epsilon" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_ϵ</annotation></semantics></math>), accept the candidate parameters <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.1"><semantics id="S2.SS1.p1.9.m9.1a"><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">bold_italic_θ</annotation></semantics></math> as samples from the inferred posterior. ABC has been widely adopted in statistical inference because it does not require explicit knowledge of the likelihood and the accepted samples are guaranteed to converge to the true posterior as <math alttext="\epsilon\rightarrow 0" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.1"><semantics id="S2.SS1.p1.10.m10.1a"><mrow id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">ϵ</mi><mo id="S2.SS1.p1.10.m10.1.1.1" stretchy="false" xref="S2.SS1.p1.10.m10.1.1.1.cmml">→</mo><mn id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><ci id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1">→</ci><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">italic-ϵ</ci><cn id="S2.SS1.p1.10.m10.1.1.3.cmml" type="integer" xref="S2.SS1.p1.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\epsilon\rightarrow 0</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">italic_ϵ → 0</annotation></semantics></math>. When <math alttext="\epsilon" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.1"><semantics id="S2.SS1.p1.11.m11.1a"><mi id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><ci id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.1d">italic_ϵ</annotation></semantics></math> is non-zero, the inferred posterior is guaranteed to be broader than the true posterior, enabling conservative inference. Despite successful applications in astrophysics and cosmology <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.13.2.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx50" title="">Schafer and Freeman(2012)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx51" title="">Cameron and Pettitt(2012)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx52" title="">Hahn <em class="ltx_emph ltx_font_italic">et al.</em>(2017)Hahn, Vakili, Walsh, Hearin, Hogg, and Campbell</a>)</cite>, the ultimate problem with ABC methods is that the acceptance rate vanishes exponentially as the dimensionality of <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p1.12.m12.1"><semantics id="S2.SS1.p1.12.m12.1a"><mi id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><ci id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m12.1d">bold_italic_θ</annotation></semantics></math> increases, requiring thus significantly more simulations, which can be alleviated with a larger <math alttext="\epsilon" class="ltx_Math" display="inline" id="S2.SS1.p1.13.m13.1"><semantics id="S2.SS1.p1.13.m13.1a"><mi id="S2.SS1.p1.13.m13.1.1" xref="S2.SS1.p1.13.m13.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.1b"><ci id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.13.m13.1d">italic_ϵ</annotation></semantics></math> at the cost of targeting a broader posterior than the true posterior <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx53" title="">Alsing <em class="ltx_emph ltx_font_italic">et al.</em>(2018)Alsing, Wandelt, and Feeney</a>)</cite>. This limitation makes ABC highly intractable in regimes where running simulations is expensive.
Occasionally ABC is used as a synonym for LFI/SBI/ILI, however throughout the paper we exclusively use ABC to refer to the algorithm discussed above.
</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Neural Density Estimation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.8">In modern applications, implicit inference is made tractable by using machine learning models to emulate conditional probability distributions, a procedure called Neural Density Estimation <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx54" title="">Papamakarios(2019)</a>)</cite>. As an example, consider a situation wherein we seek to train a mixture density network <cite class="ltx_cite ltx_citemacro_citep">(MDN; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx55" title="">Bishop(1994)</a>)</cite> to directly model the conditional distribution <math alttext="\mathcal{P}(\bm{v}|\bm{u})" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">𝒫</mi><mo id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.cmml">𝒗</mi><mo fence="false" id="S2.SS2.p1.1.m1.1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml">𝒖</mi></mrow><mo id="S2.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><times id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2"></times><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝒫</ci><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2">𝒗</ci><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3">𝒖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\mathcal{P}(\bm{v}|\bm{u})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">caligraphic_P ( bold_italic_v | bold_italic_u )</annotation></semantics></math> using our training set of data-parameter pairs <math alttext="(\bm{x},\bm{\theta})\sim\mathcal{D}_{\rm train}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.2"><semantics id="S2.SS2.p1.2.m2.2a"><mrow id="S2.SS2.p1.2.m2.2.3" xref="S2.SS2.p1.2.m2.2.3.cmml"><mrow id="S2.SS2.p1.2.m2.2.3.2.2" xref="S2.SS2.p1.2.m2.2.3.2.1.cmml"><mo id="S2.SS2.p1.2.m2.2.3.2.2.1" stretchy="false" xref="S2.SS2.p1.2.m2.2.3.2.1.cmml">(</mo><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">𝒙</mi><mo id="S2.SS2.p1.2.m2.2.3.2.2.2" xref="S2.SS2.p1.2.m2.2.3.2.1.cmml">,</mo><mi id="S2.SS2.p1.2.m2.2.2" xref="S2.SS2.p1.2.m2.2.2.cmml">𝜽</mi><mo id="S2.SS2.p1.2.m2.2.3.2.2.3" stretchy="false" xref="S2.SS2.p1.2.m2.2.3.2.1.cmml">)</mo></mrow><mo id="S2.SS2.p1.2.m2.2.3.1" xref="S2.SS2.p1.2.m2.2.3.1.cmml">∼</mo><msub id="S2.SS2.p1.2.m2.2.3.3" xref="S2.SS2.p1.2.m2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.2.m2.2.3.3.2" xref="S2.SS2.p1.2.m2.2.3.3.2.cmml">𝒟</mi><mi id="S2.SS2.p1.2.m2.2.3.3.3" xref="S2.SS2.p1.2.m2.2.3.3.3.cmml">train</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.2b"><apply id="S2.SS2.p1.2.m2.2.3.cmml" xref="S2.SS2.p1.2.m2.2.3"><csymbol cd="latexml" id="S2.SS2.p1.2.m2.2.3.1.cmml" xref="S2.SS2.p1.2.m2.2.3.1">similar-to</csymbol><interval closure="open" id="S2.SS2.p1.2.m2.2.3.2.1.cmml" xref="S2.SS2.p1.2.m2.2.3.2.2"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝒙</ci><ci id="S2.SS2.p1.2.m2.2.2.cmml" xref="S2.SS2.p1.2.m2.2.2">𝜽</ci></interval><apply id="S2.SS2.p1.2.m2.2.3.3.cmml" xref="S2.SS2.p1.2.m2.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.2.3.3.1.cmml" xref="S2.SS2.p1.2.m2.2.3.3">subscript</csymbol><ci id="S2.SS2.p1.2.m2.2.3.3.2.cmml" xref="S2.SS2.p1.2.m2.2.3.3.2">𝒟</ci><ci id="S2.SS2.p1.2.m2.2.3.3.3.cmml" xref="S2.SS2.p1.2.m2.2.3.3.3">train</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.2c">(\bm{x},\bm{\theta})\sim\mathcal{D}_{\rm train}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.2d">( bold_italic_x , bold_italic_θ ) ∼ caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT</annotation></semantics></math>. For this subsection only, we have <math alttext="(\bm{u},\bm{v})=(\bm{x},\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.4"><semantics id="S2.SS2.p1.3.m3.4a"><mrow id="S2.SS2.p1.3.m3.4.5" xref="S2.SS2.p1.3.m3.4.5.cmml"><mrow id="S2.SS2.p1.3.m3.4.5.2.2" xref="S2.SS2.p1.3.m3.4.5.2.1.cmml"><mo id="S2.SS2.p1.3.m3.4.5.2.2.1" stretchy="false" xref="S2.SS2.p1.3.m3.4.5.2.1.cmml">(</mo><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">𝒖</mi><mo id="S2.SS2.p1.3.m3.4.5.2.2.2" xref="S2.SS2.p1.3.m3.4.5.2.1.cmml">,</mo><mi id="S2.SS2.p1.3.m3.2.2" xref="S2.SS2.p1.3.m3.2.2.cmml">𝒗</mi><mo id="S2.SS2.p1.3.m3.4.5.2.2.3" stretchy="false" xref="S2.SS2.p1.3.m3.4.5.2.1.cmml">)</mo></mrow><mo id="S2.SS2.p1.3.m3.4.5.1" xref="S2.SS2.p1.3.m3.4.5.1.cmml">=</mo><mrow id="S2.SS2.p1.3.m3.4.5.3.2" xref="S2.SS2.p1.3.m3.4.5.3.1.cmml"><mo id="S2.SS2.p1.3.m3.4.5.3.2.1" stretchy="false" xref="S2.SS2.p1.3.m3.4.5.3.1.cmml">(</mo><mi id="S2.SS2.p1.3.m3.3.3" xref="S2.SS2.p1.3.m3.3.3.cmml">𝒙</mi><mo id="S2.SS2.p1.3.m3.4.5.3.2.2" xref="S2.SS2.p1.3.m3.4.5.3.1.cmml">,</mo><mi id="S2.SS2.p1.3.m3.4.4" xref="S2.SS2.p1.3.m3.4.4.cmml">𝜽</mi><mo id="S2.SS2.p1.3.m3.4.5.3.2.3" stretchy="false" xref="S2.SS2.p1.3.m3.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.4b"><apply id="S2.SS2.p1.3.m3.4.5.cmml" xref="S2.SS2.p1.3.m3.4.5"><eq id="S2.SS2.p1.3.m3.4.5.1.cmml" xref="S2.SS2.p1.3.m3.4.5.1"></eq><interval closure="open" id="S2.SS2.p1.3.m3.4.5.2.1.cmml" xref="S2.SS2.p1.3.m3.4.5.2.2"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝒖</ci><ci id="S2.SS2.p1.3.m3.2.2.cmml" xref="S2.SS2.p1.3.m3.2.2">𝒗</ci></interval><interval closure="open" id="S2.SS2.p1.3.m3.4.5.3.1.cmml" xref="S2.SS2.p1.3.m3.4.5.3.2"><ci id="S2.SS2.p1.3.m3.3.3.cmml" xref="S2.SS2.p1.3.m3.3.3">𝒙</ci><ci id="S2.SS2.p1.3.m3.4.4.cmml" xref="S2.SS2.p1.3.m3.4.4">𝜽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.4c">(\bm{u},\bm{v})=(\bm{x},\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.4d">( bold_italic_u , bold_italic_v ) = ( bold_italic_x , bold_italic_θ )</annotation></semantics></math> or <math alttext="(\bm{u},\bm{v})=(\bm{x},\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.4"><semantics id="S2.SS2.p1.4.m4.4a"><mrow id="S2.SS2.p1.4.m4.4.5" xref="S2.SS2.p1.4.m4.4.5.cmml"><mrow id="S2.SS2.p1.4.m4.4.5.2.2" xref="S2.SS2.p1.4.m4.4.5.2.1.cmml"><mo id="S2.SS2.p1.4.m4.4.5.2.2.1" stretchy="false" xref="S2.SS2.p1.4.m4.4.5.2.1.cmml">(</mo><mi id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">𝒖</mi><mo id="S2.SS2.p1.4.m4.4.5.2.2.2" xref="S2.SS2.p1.4.m4.4.5.2.1.cmml">,</mo><mi id="S2.SS2.p1.4.m4.2.2" xref="S2.SS2.p1.4.m4.2.2.cmml">𝒗</mi><mo id="S2.SS2.p1.4.m4.4.5.2.2.3" stretchy="false" xref="S2.SS2.p1.4.m4.4.5.2.1.cmml">)</mo></mrow><mo id="S2.SS2.p1.4.m4.4.5.1" xref="S2.SS2.p1.4.m4.4.5.1.cmml">=</mo><mrow id="S2.SS2.p1.4.m4.4.5.3.2" xref="S2.SS2.p1.4.m4.4.5.3.1.cmml"><mo id="S2.SS2.p1.4.m4.4.5.3.2.1" stretchy="false" xref="S2.SS2.p1.4.m4.4.5.3.1.cmml">(</mo><mi id="S2.SS2.p1.4.m4.3.3" xref="S2.SS2.p1.4.m4.3.3.cmml">𝒙</mi><mo id="S2.SS2.p1.4.m4.4.5.3.2.2" xref="S2.SS2.p1.4.m4.4.5.3.1.cmml">,</mo><mi id="S2.SS2.p1.4.m4.4.4" xref="S2.SS2.p1.4.m4.4.4.cmml">𝜽</mi><mo id="S2.SS2.p1.4.m4.4.5.3.2.3" stretchy="false" xref="S2.SS2.p1.4.m4.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.4b"><apply id="S2.SS2.p1.4.m4.4.5.cmml" xref="S2.SS2.p1.4.m4.4.5"><eq id="S2.SS2.p1.4.m4.4.5.1.cmml" xref="S2.SS2.p1.4.m4.4.5.1"></eq><interval closure="open" id="S2.SS2.p1.4.m4.4.5.2.1.cmml" xref="S2.SS2.p1.4.m4.4.5.2.2"><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">𝒖</ci><ci id="S2.SS2.p1.4.m4.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2">𝒗</ci></interval><interval closure="open" id="S2.SS2.p1.4.m4.4.5.3.1.cmml" xref="S2.SS2.p1.4.m4.4.5.3.2"><ci id="S2.SS2.p1.4.m4.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3">𝒙</ci><ci id="S2.SS2.p1.4.m4.4.4.cmml" xref="S2.SS2.p1.4.m4.4.4">𝜽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.4c">(\bm{u},\bm{v})=(\bm{x},\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.4d">( bold_italic_u , bold_italic_v ) = ( bold_italic_x , bold_italic_θ )</annotation></semantics></math> interchangeably. The goal is to build a neural architecture <math alttext="q_{\bm{w}}(\bm{v}|\bm{u})" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><mrow id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><msub id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml"><mi id="S2.SS2.p1.5.m5.1.1.3.2" xref="S2.SS2.p1.5.m5.1.1.3.2.cmml">q</mi><mi id="S2.SS2.p1.5.m5.1.1.3.3" xref="S2.SS2.p1.5.m5.1.1.3.3.cmml">𝒘</mi></msub><mo id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.5.m5.1.1.1.1" xref="S2.SS2.p1.5.m5.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.5.m5.1.1.1.1.1" xref="S2.SS2.p1.5.m5.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.1.1.1.2" xref="S2.SS2.p1.5.m5.1.1.1.1.1.2.cmml">𝒗</mi><mo fence="false" id="S2.SS2.p1.5.m5.1.1.1.1.1.1" xref="S2.SS2.p1.5.m5.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p1.5.m5.1.1.1.1.1.3" xref="S2.SS2.p1.5.m5.1.1.1.1.1.3.cmml">𝒖</mi></mrow><mo id="S2.SS2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><times id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2"></times><apply id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.3.1.cmml" xref="S2.SS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.3.2.cmml" xref="S2.SS2.p1.5.m5.1.1.3.2">𝑞</ci><ci id="S2.SS2.p1.5.m5.1.1.3.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3.3">𝒘</ci></apply><apply id="S2.SS2.p1.5.m5.1.1.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.1.1.1.2">𝒗</ci><ci id="S2.SS2.p1.5.m5.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.1.1.1.3">𝒖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">q_{\bm{w}}(\bm{v}|\bm{u})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_q start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_v | bold_italic_u )</annotation></semantics></math> with weights <math alttext="\bm{w}" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.1"><semantics id="S2.SS2.p1.6.m6.1a"><mi id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><ci id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">\bm{w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.1d">bold_italic_w</annotation></semantics></math> that outputs a probability distribution over <math alttext="\bm{v}" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.1"><semantics id="S2.SS2.p1.7.m7.1a"><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">𝒗</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">𝒗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">\bm{v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.1d">bold_italic_v</annotation></semantics></math> which targets the conditional probability <math alttext="\mathcal{P}(\bm{v}|\bm{u})" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.1"><semantics id="S2.SS2.p1.8.m8.1a"><mrow id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.8.m8.1.1.3" xref="S2.SS2.p1.8.m8.1.1.3.cmml">𝒫</mi><mo id="S2.SS2.p1.8.m8.1.1.2" xref="S2.SS2.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.8.m8.1.1.1.1" xref="S2.SS2.p1.8.m8.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.8.m8.1.1.1.1.1" xref="S2.SS2.p1.8.m8.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.8.m8.1.1.1.1.1.2" xref="S2.SS2.p1.8.m8.1.1.1.1.1.2.cmml">𝒗</mi><mo fence="false" id="S2.SS2.p1.8.m8.1.1.1.1.1.1" xref="S2.SS2.p1.8.m8.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p1.8.m8.1.1.1.1.1.3" xref="S2.SS2.p1.8.m8.1.1.1.1.1.3.cmml">𝒖</mi></mrow><mo id="S2.SS2.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><apply id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1"><times id="S2.SS2.p1.8.m8.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.2"></times><ci id="S2.SS2.p1.8.m8.1.1.3.cmml" xref="S2.SS2.p1.8.m8.1.1.3">𝒫</ci><apply id="S2.SS2.p1.8.m8.1.1.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1.1.2">𝒗</ci><ci id="S2.SS2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1.1.3">𝒖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">\mathcal{P}(\bm{v}|\bm{u})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.1d">caligraphic_P ( bold_italic_v | bold_italic_u )</annotation></semantics></math>. An MDN outputs probability distributions by allowing the neural network to specify the statistical parameters of a mixture density distribution. In the independent Gaussian case, this means the neural network outputs a mean and a variance for each component of the mixture density distribution, <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.8.1">i.e.,</em></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q_{\bm{w}}(\bm{v}|\bm{u})=\frac{1}{N_{\rm c}\sqrt{2\pi}}\sum_{i=1}^{N_{\rm c}}%
\frac{1}{\sigma_{i}(\bm{u};\bm{w})}e^{-\frac{(\bm{v}-\mu_{i}(\bm{u};\bm{w}))^{%
2}}{2\sigma_{i}^{2}(\bm{u};\bm{w})}}," class="ltx_Math" display="block" id="S2.E2.m1.8"><semantics id="S2.E2.m1.8a"><mrow id="S2.E2.m1.8.8.1" xref="S2.E2.m1.8.8.1.1.cmml"><mrow id="S2.E2.m1.8.8.1.1" xref="S2.E2.m1.8.8.1.1.cmml"><mrow id="S2.E2.m1.8.8.1.1.1" xref="S2.E2.m1.8.8.1.1.1.cmml"><msub id="S2.E2.m1.8.8.1.1.1.3" xref="S2.E2.m1.8.8.1.1.1.3.cmml"><mi id="S2.E2.m1.8.8.1.1.1.3.2" xref="S2.E2.m1.8.8.1.1.1.3.2.cmml">q</mi><mi id="S2.E2.m1.8.8.1.1.1.3.3" xref="S2.E2.m1.8.8.1.1.1.3.3.cmml">𝒘</mi></msub><mo id="S2.E2.m1.8.8.1.1.1.2" xref="S2.E2.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.8.8.1.1.1.1.1" xref="S2.E2.m1.8.8.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.8.8.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.8.8.1.1.1.1.1.1" xref="S2.E2.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.8.8.1.1.1.1.1.1.2" xref="S2.E2.m1.8.8.1.1.1.1.1.1.2.cmml">𝒗</mi><mo fence="false" id="S2.E2.m1.8.8.1.1.1.1.1.1.1" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E2.m1.8.8.1.1.1.1.1.1.3" xref="S2.E2.m1.8.8.1.1.1.1.1.1.3.cmml">𝒖</mi></mrow><mo id="S2.E2.m1.8.8.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.8.8.1.1.2" xref="S2.E2.m1.8.8.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.8.8.1.1.3" xref="S2.E2.m1.8.8.1.1.3.cmml"><mfrac id="S2.E2.m1.8.8.1.1.3.2" xref="S2.E2.m1.8.8.1.1.3.2.cmml"><mn id="S2.E2.m1.8.8.1.1.3.2.2" xref="S2.E2.m1.8.8.1.1.3.2.2.cmml">1</mn><mrow id="S2.E2.m1.8.8.1.1.3.2.3" xref="S2.E2.m1.8.8.1.1.3.2.3.cmml"><msub id="S2.E2.m1.8.8.1.1.3.2.3.2" xref="S2.E2.m1.8.8.1.1.3.2.3.2.cmml"><mi id="S2.E2.m1.8.8.1.1.3.2.3.2.2" xref="S2.E2.m1.8.8.1.1.3.2.3.2.2.cmml">N</mi><mi id="S2.E2.m1.8.8.1.1.3.2.3.2.3" mathvariant="normal" xref="S2.E2.m1.8.8.1.1.3.2.3.2.3.cmml">c</mi></msub><mo id="S2.E2.m1.8.8.1.1.3.2.3.1" xref="S2.E2.m1.8.8.1.1.3.2.3.1.cmml">⁢</mo><msqrt id="S2.E2.m1.8.8.1.1.3.2.3.3" xref="S2.E2.m1.8.8.1.1.3.2.3.3.cmml"><mrow id="S2.E2.m1.8.8.1.1.3.2.3.3.2" xref="S2.E2.m1.8.8.1.1.3.2.3.3.2.cmml"><mn id="S2.E2.m1.8.8.1.1.3.2.3.3.2.2" xref="S2.E2.m1.8.8.1.1.3.2.3.3.2.2.cmml">2</mn><mo id="S2.E2.m1.8.8.1.1.3.2.3.3.2.1" xref="S2.E2.m1.8.8.1.1.3.2.3.3.2.1.cmml">⁢</mo><mi id="S2.E2.m1.8.8.1.1.3.2.3.3.2.3" xref="S2.E2.m1.8.8.1.1.3.2.3.3.2.3.cmml">π</mi></mrow></msqrt></mrow></mfrac><mo id="S2.E2.m1.8.8.1.1.3.1" xref="S2.E2.m1.8.8.1.1.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.8.8.1.1.3.3" xref="S2.E2.m1.8.8.1.1.3.3.cmml"><munderover id="S2.E2.m1.8.8.1.1.3.3.1" xref="S2.E2.m1.8.8.1.1.3.3.1.cmml"><mo id="S2.E2.m1.8.8.1.1.3.3.1.2.2" movablelimits="false" xref="S2.E2.m1.8.8.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.8.8.1.1.3.3.1.2.3" xref="S2.E2.m1.8.8.1.1.3.3.1.2.3.cmml"><mi id="S2.E2.m1.8.8.1.1.3.3.1.2.3.2" xref="S2.E2.m1.8.8.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S2.E2.m1.8.8.1.1.3.3.1.2.3.1" xref="S2.E2.m1.8.8.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S2.E2.m1.8.8.1.1.3.3.1.2.3.3" xref="S2.E2.m1.8.8.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S2.E2.m1.8.8.1.1.3.3.1.3" xref="S2.E2.m1.8.8.1.1.3.3.1.3.cmml"><mi id="S2.E2.m1.8.8.1.1.3.3.1.3.2" xref="S2.E2.m1.8.8.1.1.3.3.1.3.2.cmml">N</mi><mi id="S2.E2.m1.8.8.1.1.3.3.1.3.3" mathvariant="normal" xref="S2.E2.m1.8.8.1.1.3.3.1.3.3.cmml">c</mi></msub></munderover><mrow id="S2.E2.m1.8.8.1.1.3.3.2" xref="S2.E2.m1.8.8.1.1.3.3.2.cmml"><mfrac id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><mn id="S2.E2.m1.2.2.4" xref="S2.E2.m1.2.2.4.cmml">1</mn><mrow id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><msub id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.4.cmml"><mi id="S2.E2.m1.2.2.2.4.2" xref="S2.E2.m1.2.2.2.4.2.cmml">σ</mi><mi id="S2.E2.m1.2.2.2.4.3" xref="S2.E2.m1.2.2.2.4.3.cmml">i</mi></msub><mo id="S2.E2.m1.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.2.5.2" xref="S2.E2.m1.2.2.2.5.1.cmml"><mo id="S2.E2.m1.2.2.2.5.2.1" stretchy="false" xref="S2.E2.m1.2.2.2.5.1.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">𝒖</mi><mo id="S2.E2.m1.2.2.2.5.2.2" xref="S2.E2.m1.2.2.2.5.1.cmml">;</mo><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">𝒘</mi><mo id="S2.E2.m1.2.2.2.5.2.3" stretchy="false" xref="S2.E2.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.E2.m1.8.8.1.1.3.3.2.1" xref="S2.E2.m1.8.8.1.1.3.3.2.1.cmml">⁢</mo><msup id="S2.E2.m1.8.8.1.1.3.3.2.2" xref="S2.E2.m1.8.8.1.1.3.3.2.2.cmml"><mi id="S2.E2.m1.8.8.1.1.3.3.2.2.2" xref="S2.E2.m1.8.8.1.1.3.3.2.2.2.cmml">e</mi><mrow id="S2.E2.m1.7.7.5" xref="S2.E2.m1.7.7.5.cmml"><mo id="S2.E2.m1.7.7.5a" xref="S2.E2.m1.7.7.5.cmml">−</mo><mfrac id="S2.E2.m1.7.7.5.5" xref="S2.E2.m1.7.7.5.5.cmml"><msup id="S2.E2.m1.5.5.3.3.3" xref="S2.E2.m1.5.5.3.3.3.cmml"><mrow id="S2.E2.m1.5.5.3.3.3.3.1" xref="S2.E2.m1.5.5.3.3.3.3.1.1.cmml"><mo id="S2.E2.m1.5.5.3.3.3.3.1.2" stretchy="false" xref="S2.E2.m1.5.5.3.3.3.3.1.1.cmml">(</mo><mrow id="S2.E2.m1.5.5.3.3.3.3.1.1" xref="S2.E2.m1.5.5.3.3.3.3.1.1.cmml"><mi id="S2.E2.m1.5.5.3.3.3.3.1.1.2" xref="S2.E2.m1.5.5.3.3.3.3.1.1.2.cmml">𝒗</mi><mo id="S2.E2.m1.5.5.3.3.3.3.1.1.1" xref="S2.E2.m1.5.5.3.3.3.3.1.1.1.cmml">−</mo><mrow id="S2.E2.m1.5.5.3.3.3.3.1.1.3" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.cmml"><msub id="S2.E2.m1.5.5.3.3.3.3.1.1.3.2" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.cmml"><mi id="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.2" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.2.cmml">μ</mi><mi id="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.3" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.3.cmml">i</mi></msub><mo id="S2.E2.m1.5.5.3.3.3.3.1.1.3.1" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.3.3.3.3.1.1.3.3.2" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.3.1.cmml"><mo id="S2.E2.m1.5.5.3.3.3.3.1.1.3.3.2.1" stretchy="false" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.3.1.cmml">(</mo><mi id="S2.E2.m1.3.3.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.cmml">𝒖</mi><mo id="S2.E2.m1.5.5.3.3.3.3.1.1.3.3.2.2" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.3.1.cmml">;</mo><mi id="S2.E2.m1.4.4.2.2.2.2" xref="S2.E2.m1.4.4.2.2.2.2.cmml">𝒘</mi><mo id="S2.E2.m1.5.5.3.3.3.3.1.1.3.3.2.3" stretchy="false" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.5.5.3.3.3.3.1.3" stretchy="false" xref="S2.E2.m1.5.5.3.3.3.3.1.1.cmml">)</mo></mrow><mn id="S2.E2.m1.5.5.3.3.3.5" xref="S2.E2.m1.5.5.3.3.3.5.cmml">2</mn></msup><mrow id="S2.E2.m1.7.7.5.5.5" xref="S2.E2.m1.7.7.5.5.5.cmml"><mn id="S2.E2.m1.7.7.5.5.5.4" xref="S2.E2.m1.7.7.5.5.5.4.cmml">2</mn><mo id="S2.E2.m1.7.7.5.5.5.3" xref="S2.E2.m1.7.7.5.5.5.3.cmml">⁢</mo><msubsup id="S2.E2.m1.7.7.5.5.5.5" xref="S2.E2.m1.7.7.5.5.5.5.cmml"><mi id="S2.E2.m1.7.7.5.5.5.5.2.2" xref="S2.E2.m1.7.7.5.5.5.5.2.2.cmml">σ</mi><mi id="S2.E2.m1.7.7.5.5.5.5.2.3" xref="S2.E2.m1.7.7.5.5.5.5.2.3.cmml">i</mi><mn id="S2.E2.m1.7.7.5.5.5.5.3" xref="S2.E2.m1.7.7.5.5.5.5.3.cmml">2</mn></msubsup><mo id="S2.E2.m1.7.7.5.5.5.3a" xref="S2.E2.m1.7.7.5.5.5.3.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.5.5.5.6.2" xref="S2.E2.m1.7.7.5.5.5.6.1.cmml"><mo id="S2.E2.m1.7.7.5.5.5.6.2.1" stretchy="false" xref="S2.E2.m1.7.7.5.5.5.6.1.cmml">(</mo><mi id="S2.E2.m1.6.6.4.4.4.1" xref="S2.E2.m1.6.6.4.4.4.1.cmml">𝒖</mi><mo id="S2.E2.m1.7.7.5.5.5.6.2.2" xref="S2.E2.m1.7.7.5.5.5.6.1.cmml">;</mo><mi id="S2.E2.m1.7.7.5.5.5.2" xref="S2.E2.m1.7.7.5.5.5.2.cmml">𝒘</mi><mo id="S2.E2.m1.7.7.5.5.5.6.2.3" stretchy="false" xref="S2.E2.m1.7.7.5.5.5.6.1.cmml">)</mo></mrow></mrow></mfrac></mrow></msup></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.8.8.1.2" xref="S2.E2.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.8b"><apply id="S2.E2.m1.8.8.1.1.cmml" xref="S2.E2.m1.8.8.1"><eq id="S2.E2.m1.8.8.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.2"></eq><apply id="S2.E2.m1.8.8.1.1.1.cmml" xref="S2.E2.m1.8.8.1.1.1"><times id="S2.E2.m1.8.8.1.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.1.2"></times><apply id="S2.E2.m1.8.8.1.1.1.3.cmml" xref="S2.E2.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.1.3.1.cmml" xref="S2.E2.m1.8.8.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.8.8.1.1.1.3.2.cmml" xref="S2.E2.m1.8.8.1.1.1.3.2">𝑞</ci><ci id="S2.E2.m1.8.8.1.1.1.3.3.cmml" xref="S2.E2.m1.8.8.1.1.1.3.3">𝒘</ci></apply><apply id="S2.E2.m1.8.8.1.1.1.1.1.1.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E2.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.2">𝒗</ci><ci id="S2.E2.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.3">𝒖</ci></apply></apply><apply id="S2.E2.m1.8.8.1.1.3.cmml" xref="S2.E2.m1.8.8.1.1.3"><times id="S2.E2.m1.8.8.1.1.3.1.cmml" xref="S2.E2.m1.8.8.1.1.3.1"></times><apply id="S2.E2.m1.8.8.1.1.3.2.cmml" xref="S2.E2.m1.8.8.1.1.3.2"><divide id="S2.E2.m1.8.8.1.1.3.2.1.cmml" xref="S2.E2.m1.8.8.1.1.3.2"></divide><cn id="S2.E2.m1.8.8.1.1.3.2.2.cmml" type="integer" xref="S2.E2.m1.8.8.1.1.3.2.2">1</cn><apply id="S2.E2.m1.8.8.1.1.3.2.3.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3"><times id="S2.E2.m1.8.8.1.1.3.2.3.1.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3.1"></times><apply id="S2.E2.m1.8.8.1.1.3.2.3.2.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.3.2.3.2.1.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3.2">subscript</csymbol><ci id="S2.E2.m1.8.8.1.1.3.2.3.2.2.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3.2.2">𝑁</ci><ci id="S2.E2.m1.8.8.1.1.3.2.3.2.3.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3.2.3">c</ci></apply><apply id="S2.E2.m1.8.8.1.1.3.2.3.3.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3.3"><root id="S2.E2.m1.8.8.1.1.3.2.3.3a.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3.3"></root><apply id="S2.E2.m1.8.8.1.1.3.2.3.3.2.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3.3.2"><times id="S2.E2.m1.8.8.1.1.3.2.3.3.2.1.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3.3.2.1"></times><cn id="S2.E2.m1.8.8.1.1.3.2.3.3.2.2.cmml" type="integer" xref="S2.E2.m1.8.8.1.1.3.2.3.3.2.2">2</cn><ci id="S2.E2.m1.8.8.1.1.3.2.3.3.2.3.cmml" xref="S2.E2.m1.8.8.1.1.3.2.3.3.2.3">𝜋</ci></apply></apply></apply></apply><apply id="S2.E2.m1.8.8.1.1.3.3.cmml" xref="S2.E2.m1.8.8.1.1.3.3"><apply id="S2.E2.m1.8.8.1.1.3.3.1.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.3.3.1.1.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1">superscript</csymbol><apply id="S2.E2.m1.8.8.1.1.3.3.1.2.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.3.3.1.2.1.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1">subscript</csymbol><sum id="S2.E2.m1.8.8.1.1.3.3.1.2.2.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1.2.2"></sum><apply id="S2.E2.m1.8.8.1.1.3.3.1.2.3.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1.2.3"><eq id="S2.E2.m1.8.8.1.1.3.3.1.2.3.1.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1.2.3.1"></eq><ci id="S2.E2.m1.8.8.1.1.3.3.1.2.3.2.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S2.E2.m1.8.8.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S2.E2.m1.8.8.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.8.8.1.1.3.3.1.3.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.3.3.1.3.1.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1.3">subscript</csymbol><ci id="S2.E2.m1.8.8.1.1.3.3.1.3.2.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1.3.2">𝑁</ci><ci id="S2.E2.m1.8.8.1.1.3.3.1.3.3.cmml" xref="S2.E2.m1.8.8.1.1.3.3.1.3.3">c</ci></apply></apply><apply id="S2.E2.m1.8.8.1.1.3.3.2.cmml" xref="S2.E2.m1.8.8.1.1.3.3.2"><times id="S2.E2.m1.8.8.1.1.3.3.2.1.cmml" xref="S2.E2.m1.8.8.1.1.3.3.2.1"></times><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2"><divide id="S2.E2.m1.2.2.3.cmml" xref="S2.E2.m1.2.2"></divide><cn id="S2.E2.m1.2.2.4.cmml" type="integer" xref="S2.E2.m1.2.2.4">1</cn><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><times id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.3"></times><apply id="S2.E2.m1.2.2.2.4.cmml" xref="S2.E2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.4.1.cmml" xref="S2.E2.m1.2.2.2.4">subscript</csymbol><ci id="S2.E2.m1.2.2.2.4.2.cmml" xref="S2.E2.m1.2.2.2.4.2">𝜎</ci><ci id="S2.E2.m1.2.2.2.4.3.cmml" xref="S2.E2.m1.2.2.2.4.3">𝑖</ci></apply><list id="S2.E2.m1.2.2.2.5.1.cmml" xref="S2.E2.m1.2.2.2.5.2"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝒖</ci><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">𝒘</ci></list></apply></apply><apply id="S2.E2.m1.8.8.1.1.3.3.2.2.cmml" xref="S2.E2.m1.8.8.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.3.3.2.2.1.cmml" xref="S2.E2.m1.8.8.1.1.3.3.2.2">superscript</csymbol><ci id="S2.E2.m1.8.8.1.1.3.3.2.2.2.cmml" xref="S2.E2.m1.8.8.1.1.3.3.2.2.2">𝑒</ci><apply id="S2.E2.m1.7.7.5.cmml" xref="S2.E2.m1.7.7.5"><minus id="S2.E2.m1.7.7.5.6.cmml" xref="S2.E2.m1.7.7.5"></minus><apply id="S2.E2.m1.7.7.5.5.cmml" xref="S2.E2.m1.7.7.5.5"><divide id="S2.E2.m1.7.7.5.5.6.cmml" xref="S2.E2.m1.7.7.5.5"></divide><apply id="S2.E2.m1.5.5.3.3.3.cmml" xref="S2.E2.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.3.3.3.4.cmml" xref="S2.E2.m1.5.5.3.3.3">superscript</csymbol><apply id="S2.E2.m1.5.5.3.3.3.3.1.1.cmml" xref="S2.E2.m1.5.5.3.3.3.3.1"><minus id="S2.E2.m1.5.5.3.3.3.3.1.1.1.cmml" xref="S2.E2.m1.5.5.3.3.3.3.1.1.1"></minus><ci id="S2.E2.m1.5.5.3.3.3.3.1.1.2.cmml" xref="S2.E2.m1.5.5.3.3.3.3.1.1.2">𝒗</ci><apply id="S2.E2.m1.5.5.3.3.3.3.1.1.3.cmml" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3"><times id="S2.E2.m1.5.5.3.3.3.3.1.1.3.1.cmml" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.1"></times><apply id="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.cmml" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.1.cmml" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.2.cmml" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.2">𝜇</ci><ci id="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.3.cmml" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.2.3">𝑖</ci></apply><list id="S2.E2.m1.5.5.3.3.3.3.1.1.3.3.1.cmml" xref="S2.E2.m1.5.5.3.3.3.3.1.1.3.3.2"><ci id="S2.E2.m1.3.3.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1">𝒖</ci><ci id="S2.E2.m1.4.4.2.2.2.2.cmml" xref="S2.E2.m1.4.4.2.2.2.2">𝒘</ci></list></apply></apply><cn id="S2.E2.m1.5.5.3.3.3.5.cmml" type="integer" xref="S2.E2.m1.5.5.3.3.3.5">2</cn></apply><apply id="S2.E2.m1.7.7.5.5.5.cmml" xref="S2.E2.m1.7.7.5.5.5"><times id="S2.E2.m1.7.7.5.5.5.3.cmml" xref="S2.E2.m1.7.7.5.5.5.3"></times><cn id="S2.E2.m1.7.7.5.5.5.4.cmml" type="integer" xref="S2.E2.m1.7.7.5.5.5.4">2</cn><apply id="S2.E2.m1.7.7.5.5.5.5.cmml" xref="S2.E2.m1.7.7.5.5.5.5"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.5.5.5.5.1.cmml" xref="S2.E2.m1.7.7.5.5.5.5">superscript</csymbol><apply id="S2.E2.m1.7.7.5.5.5.5.2.cmml" xref="S2.E2.m1.7.7.5.5.5.5"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.5.5.5.5.2.1.cmml" xref="S2.E2.m1.7.7.5.5.5.5">subscript</csymbol><ci id="S2.E2.m1.7.7.5.5.5.5.2.2.cmml" xref="S2.E2.m1.7.7.5.5.5.5.2.2">𝜎</ci><ci id="S2.E2.m1.7.7.5.5.5.5.2.3.cmml" xref="S2.E2.m1.7.7.5.5.5.5.2.3">𝑖</ci></apply><cn id="S2.E2.m1.7.7.5.5.5.5.3.cmml" type="integer" xref="S2.E2.m1.7.7.5.5.5.5.3">2</cn></apply><list id="S2.E2.m1.7.7.5.5.5.6.1.cmml" xref="S2.E2.m1.7.7.5.5.5.6.2"><ci id="S2.E2.m1.6.6.4.4.4.1.cmml" xref="S2.E2.m1.6.6.4.4.4.1">𝒖</ci><ci id="S2.E2.m1.7.7.5.5.5.2.cmml" xref="S2.E2.m1.7.7.5.5.5.2">𝒘</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.8c">q_{\bm{w}}(\bm{v}|\bm{u})=\frac{1}{N_{\rm c}\sqrt{2\pi}}\sum_{i=1}^{N_{\rm c}}%
\frac{1}{\sigma_{i}(\bm{u};\bm{w})}e^{-\frac{(\bm{v}-\mu_{i}(\bm{u};\bm{w}))^{%
2}}{2\sigma_{i}^{2}(\bm{u};\bm{w})}},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.8d">italic_q start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_v | bold_italic_u ) = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT roman_c end_POSTSUBSCRIPT square-root start_ARG 2 italic_π end_ARG end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT roman_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_u ; bold_italic_w ) end_ARG italic_e start_POSTSUPERSCRIPT - divide start_ARG ( bold_italic_v - italic_μ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_u ; bold_italic_w ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( bold_italic_u ; bold_italic_w ) end_ARG end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.14">where <math alttext="N_{c}" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m1.1"><semantics id="S2.SS2.p1.9.m1.1a"><msub id="S2.SS2.p1.9.m1.1.1" xref="S2.SS2.p1.9.m1.1.1.cmml"><mi id="S2.SS2.p1.9.m1.1.1.2" xref="S2.SS2.p1.9.m1.1.1.2.cmml">N</mi><mi id="S2.SS2.p1.9.m1.1.1.3" xref="S2.SS2.p1.9.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m1.1b"><apply id="S2.SS2.p1.9.m1.1.1.cmml" xref="S2.SS2.p1.9.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.9.m1.1.1.1.cmml" xref="S2.SS2.p1.9.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.9.m1.1.1.2.cmml" xref="S2.SS2.p1.9.m1.1.1.2">𝑁</ci><ci id="S2.SS2.p1.9.m1.1.1.3.cmml" xref="S2.SS2.p1.9.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m1.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m1.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the chosen number of components of the mixture density distribution, <math alttext="\bm{w}" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m2.1"><semantics id="S2.SS2.p1.10.m2.1a"><mi id="S2.SS2.p1.10.m2.1.1" xref="S2.SS2.p1.10.m2.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m2.1b"><ci id="S2.SS2.p1.10.m2.1.1.cmml" xref="S2.SS2.p1.10.m2.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m2.1c">\bm{w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m2.1d">bold_italic_w</annotation></semantics></math> are the learned weights and biases of the neural network, and <math alttext="\mu_{i}(\bm{u};\bm{w})" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m3.2"><semantics id="S2.SS2.p1.11.m3.2a"><mrow id="S2.SS2.p1.11.m3.2.3" xref="S2.SS2.p1.11.m3.2.3.cmml"><msub id="S2.SS2.p1.11.m3.2.3.2" xref="S2.SS2.p1.11.m3.2.3.2.cmml"><mi id="S2.SS2.p1.11.m3.2.3.2.2" xref="S2.SS2.p1.11.m3.2.3.2.2.cmml">μ</mi><mi id="S2.SS2.p1.11.m3.2.3.2.3" xref="S2.SS2.p1.11.m3.2.3.2.3.cmml">i</mi></msub><mo id="S2.SS2.p1.11.m3.2.3.1" xref="S2.SS2.p1.11.m3.2.3.1.cmml">⁢</mo><mrow id="S2.SS2.p1.11.m3.2.3.3.2" xref="S2.SS2.p1.11.m3.2.3.3.1.cmml"><mo id="S2.SS2.p1.11.m3.2.3.3.2.1" stretchy="false" xref="S2.SS2.p1.11.m3.2.3.3.1.cmml">(</mo><mi id="S2.SS2.p1.11.m3.1.1" xref="S2.SS2.p1.11.m3.1.1.cmml">𝒖</mi><mo id="S2.SS2.p1.11.m3.2.3.3.2.2" xref="S2.SS2.p1.11.m3.2.3.3.1.cmml">;</mo><mi id="S2.SS2.p1.11.m3.2.2" xref="S2.SS2.p1.11.m3.2.2.cmml">𝒘</mi><mo id="S2.SS2.p1.11.m3.2.3.3.2.3" stretchy="false" xref="S2.SS2.p1.11.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m3.2b"><apply id="S2.SS2.p1.11.m3.2.3.cmml" xref="S2.SS2.p1.11.m3.2.3"><times id="S2.SS2.p1.11.m3.2.3.1.cmml" xref="S2.SS2.p1.11.m3.2.3.1"></times><apply id="S2.SS2.p1.11.m3.2.3.2.cmml" xref="S2.SS2.p1.11.m3.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m3.2.3.2.1.cmml" xref="S2.SS2.p1.11.m3.2.3.2">subscript</csymbol><ci id="S2.SS2.p1.11.m3.2.3.2.2.cmml" xref="S2.SS2.p1.11.m3.2.3.2.2">𝜇</ci><ci id="S2.SS2.p1.11.m3.2.3.2.3.cmml" xref="S2.SS2.p1.11.m3.2.3.2.3">𝑖</ci></apply><list id="S2.SS2.p1.11.m3.2.3.3.1.cmml" xref="S2.SS2.p1.11.m3.2.3.3.2"><ci id="S2.SS2.p1.11.m3.1.1.cmml" xref="S2.SS2.p1.11.m3.1.1">𝒖</ci><ci id="S2.SS2.p1.11.m3.2.2.cmml" xref="S2.SS2.p1.11.m3.2.2">𝒘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m3.2c">\mu_{i}(\bm{u};\bm{w})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m3.2d">italic_μ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_u ; bold_italic_w )</annotation></semantics></math> and <math alttext="\sigma_{i}(\bm{u};\bm{w})" class="ltx_Math" display="inline" id="S2.SS2.p1.12.m4.2"><semantics id="S2.SS2.p1.12.m4.2a"><mrow id="S2.SS2.p1.12.m4.2.3" xref="S2.SS2.p1.12.m4.2.3.cmml"><msub id="S2.SS2.p1.12.m4.2.3.2" xref="S2.SS2.p1.12.m4.2.3.2.cmml"><mi id="S2.SS2.p1.12.m4.2.3.2.2" xref="S2.SS2.p1.12.m4.2.3.2.2.cmml">σ</mi><mi id="S2.SS2.p1.12.m4.2.3.2.3" xref="S2.SS2.p1.12.m4.2.3.2.3.cmml">i</mi></msub><mo id="S2.SS2.p1.12.m4.2.3.1" xref="S2.SS2.p1.12.m4.2.3.1.cmml">⁢</mo><mrow id="S2.SS2.p1.12.m4.2.3.3.2" xref="S2.SS2.p1.12.m4.2.3.3.1.cmml"><mo id="S2.SS2.p1.12.m4.2.3.3.2.1" stretchy="false" xref="S2.SS2.p1.12.m4.2.3.3.1.cmml">(</mo><mi id="S2.SS2.p1.12.m4.1.1" xref="S2.SS2.p1.12.m4.1.1.cmml">𝒖</mi><mo id="S2.SS2.p1.12.m4.2.3.3.2.2" xref="S2.SS2.p1.12.m4.2.3.3.1.cmml">;</mo><mi id="S2.SS2.p1.12.m4.2.2" xref="S2.SS2.p1.12.m4.2.2.cmml">𝒘</mi><mo id="S2.SS2.p1.12.m4.2.3.3.2.3" stretchy="false" xref="S2.SS2.p1.12.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m4.2b"><apply id="S2.SS2.p1.12.m4.2.3.cmml" xref="S2.SS2.p1.12.m4.2.3"><times id="S2.SS2.p1.12.m4.2.3.1.cmml" xref="S2.SS2.p1.12.m4.2.3.1"></times><apply id="S2.SS2.p1.12.m4.2.3.2.cmml" xref="S2.SS2.p1.12.m4.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m4.2.3.2.1.cmml" xref="S2.SS2.p1.12.m4.2.3.2">subscript</csymbol><ci id="S2.SS2.p1.12.m4.2.3.2.2.cmml" xref="S2.SS2.p1.12.m4.2.3.2.2">𝜎</ci><ci id="S2.SS2.p1.12.m4.2.3.2.3.cmml" xref="S2.SS2.p1.12.m4.2.3.2.3">𝑖</ci></apply><list id="S2.SS2.p1.12.m4.2.3.3.1.cmml" xref="S2.SS2.p1.12.m4.2.3.3.2"><ci id="S2.SS2.p1.12.m4.1.1.cmml" xref="S2.SS2.p1.12.m4.1.1">𝒖</ci><ci id="S2.SS2.p1.12.m4.2.2.cmml" xref="S2.SS2.p1.12.m4.2.2">𝒘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m4.2c">\sigma_{i}(\bm{u};\bm{w})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.12.m4.2d">italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_u ; bold_italic_w )</annotation></semantics></math> are the neural network outputs representing the mean and standard deviation (or <span class="ltx_text ltx_font_italic" id="S2.SS2.p1.14.1">scale</span>) of the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.p1.13.m5.1"><semantics id="S2.SS2.p1.13.m5.1a"><mi id="S2.SS2.p1.13.m5.1.1" xref="S2.SS2.p1.13.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m5.1b"><ci id="S2.SS2.p1.13.m5.1.1.cmml" xref="S2.SS2.p1.13.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.13.m5.1d">italic_i</annotation></semantics></math>-th Gaussian component as a function of the input <math alttext="\bm{u}" class="ltx_Math" display="inline" id="S2.SS2.p1.14.m6.1"><semantics id="S2.SS2.p1.14.m6.1a"><mi id="S2.SS2.p1.14.m6.1.1" xref="S2.SS2.p1.14.m6.1.1.cmml">𝒖</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m6.1b"><ci id="S2.SS2.p1.14.m6.1.1.cmml" xref="S2.SS2.p1.14.m6.1.1">𝒖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m6.1c">\bm{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.14.m6.1d">bold_italic_u</annotation></semantics></math> and the weights. </p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">To train such a network to properly emulate the conditional probability, all we need to do is maximize the joint likelihood of our training data <math alttext="\mathcal{D}_{\rm train}" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">𝒟</mi><mi id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">train</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝒟</ci><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">train</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\mathcal{D}_{\rm train}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT</annotation></semantics></math>. This is equivalently and often more conveniently expressed in the form of minimizing the negative log-probability loss (typically log-likelihood or log-posterior, see sections <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2.SSS1" title="2.2.1 Neural Posterior Estimation (NPE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.2.1</span></a> to <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2.SSS3" title="2.2.3 Neural Ratio Estimation (NRE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.2.3</span></a>)</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\rm MDN}:=-\mathbb{E}_{\mathcal{D}_{\rm train}}\left[\log q_{\bm{%
w}}(\bm{v}|\bm{u})\right]," class="ltx_Math" display="block" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml">ℒ</mi><mi id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml">MDN</mi></msub><mo id="S2.E3.m1.1.1.1.1.2" lspace="0.278em" rspace="0.278em" xref="S2.E3.m1.1.1.1.1.2.cmml">:=</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1a" xref="S2.E3.m1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><msub id="S2.E3.m1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.1.1.1.1.1.1.3.3.2" xref="S2.E3.m1.1.1.1.1.1.1.3.3.2.cmml">𝒟</mi><mi id="S2.E3.m1.1.1.1.1.1.1.3.3.3" xref="S2.E3.m1.1.1.1.1.1.1.3.3.3.cmml">train</mi></msub></msub><mo id="S2.E3.m1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">q</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">𝒘</mi></msub></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mo fence="false" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝒖</mi></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2">assign</csymbol><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2">ℒ</ci><ci id="S2.E3.m1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3">MDN</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><minus id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.2">𝔼</ci><apply id="S2.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3.2">𝒟</ci><ci id="S2.E3.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3.3">train</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3"><log id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.1"></log><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑞</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝒘</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝒖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\mathcal{L}_{\rm MDN}:=-\mathbb{E}_{\mathcal{D}_{\rm train}}\left[\log q_{\bm{%
w}}(\bm{v}|\bm{u})\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_MDN end_POSTSUBSCRIPT := - blackboard_E start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_log italic_q start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_v | bold_italic_u ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p2.8">where the expectation <math alttext="\mathbb{E}_{\mathcal{D}_{\rm train}}" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m1.1"><semantics id="S2.SS2.p2.2.m1.1a"><msub id="S2.SS2.p2.2.m1.1.1" xref="S2.SS2.p2.2.m1.1.1.cmml"><mi id="S2.SS2.p2.2.m1.1.1.2" xref="S2.SS2.p2.2.m1.1.1.2.cmml">𝔼</mi><msub id="S2.SS2.p2.2.m1.1.1.3" xref="S2.SS2.p2.2.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.2.m1.1.1.3.2" xref="S2.SS2.p2.2.m1.1.1.3.2.cmml">𝒟</mi><mi id="S2.SS2.p2.2.m1.1.1.3.3" xref="S2.SS2.p2.2.m1.1.1.3.3.cmml">train</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m1.1b"><apply id="S2.SS2.p2.2.m1.1.1.cmml" xref="S2.SS2.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m1.1.1.1.cmml" xref="S2.SS2.p2.2.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m1.1.1.2.cmml" xref="S2.SS2.p2.2.m1.1.1.2">𝔼</ci><apply id="S2.SS2.p2.2.m1.1.1.3.cmml" xref="S2.SS2.p2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m1.1.1.3.1.cmml" xref="S2.SS2.p2.2.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.2.m1.1.1.3.2.cmml" xref="S2.SS2.p2.2.m1.1.1.3.2">𝒟</ci><ci id="S2.SS2.p2.2.m1.1.1.3.3.cmml" xref="S2.SS2.p2.2.m1.1.1.3.3">train</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m1.1c">\mathbb{E}_{\mathcal{D}_{\rm train}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m1.1d">blackboard_E start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is taken over all data-parameter pairs in the training set <math alttext="\sim\mathcal{D}_{\rm train}" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m2.1"><semantics id="S2.SS2.p2.3.m2.1a"><mrow id="S2.SS2.p2.3.m2.1.1" xref="S2.SS2.p2.3.m2.1.1.cmml"><mi id="S2.SS2.p2.3.m2.1.1.2" xref="S2.SS2.p2.3.m2.1.1.2.cmml"></mi><mo id="S2.SS2.p2.3.m2.1.1.1" xref="S2.SS2.p2.3.m2.1.1.1.cmml">∼</mo><msub id="S2.SS2.p2.3.m2.1.1.3" xref="S2.SS2.p2.3.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.3.m2.1.1.3.2" xref="S2.SS2.p2.3.m2.1.1.3.2.cmml">𝒟</mi><mi id="S2.SS2.p2.3.m2.1.1.3.3" xref="S2.SS2.p2.3.m2.1.1.3.3.cmml">train</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m2.1b"><apply id="S2.SS2.p2.3.m2.1.1.cmml" xref="S2.SS2.p2.3.m2.1.1"><csymbol cd="latexml" id="S2.SS2.p2.3.m2.1.1.1.cmml" xref="S2.SS2.p2.3.m2.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.SS2.p2.3.m2.1.1.2.cmml" xref="S2.SS2.p2.3.m2.1.1.2">absent</csymbol><apply id="S2.SS2.p2.3.m2.1.1.3.cmml" xref="S2.SS2.p2.3.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m2.1.1.3.1.cmml" xref="S2.SS2.p2.3.m2.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.3.m2.1.1.3.2.cmml" xref="S2.SS2.p2.3.m2.1.1.3.2">𝒟</ci><ci id="S2.SS2.p2.3.m2.1.1.3.3.cmml" xref="S2.SS2.p2.3.m2.1.1.3.3">train</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m2.1c">\sim\mathcal{D}_{\rm train}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m2.1d">∼ caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT</annotation></semantics></math>.
For the case of the the posterior distribution (<math alttext="\bm{v}=\bm{\theta},\bm{u}=\bm{x}" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m3.2"><semantics id="S2.SS2.p2.4.m3.2a"><mrow id="S2.SS2.p2.4.m3.2.2.2" xref="S2.SS2.p2.4.m3.2.2.3.cmml"><mrow id="S2.SS2.p2.4.m3.1.1.1.1" xref="S2.SS2.p2.4.m3.1.1.1.1.cmml"><mi id="S2.SS2.p2.4.m3.1.1.1.1.2" xref="S2.SS2.p2.4.m3.1.1.1.1.2.cmml">𝒗</mi><mo id="S2.SS2.p2.4.m3.1.1.1.1.1" xref="S2.SS2.p2.4.m3.1.1.1.1.1.cmml">=</mo><mi id="S2.SS2.p2.4.m3.1.1.1.1.3" xref="S2.SS2.p2.4.m3.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.SS2.p2.4.m3.2.2.2.3" xref="S2.SS2.p2.4.m3.2.2.3a.cmml">,</mo><mrow id="S2.SS2.p2.4.m3.2.2.2.2" xref="S2.SS2.p2.4.m3.2.2.2.2.cmml"><mi id="S2.SS2.p2.4.m3.2.2.2.2.2" xref="S2.SS2.p2.4.m3.2.2.2.2.2.cmml">𝒖</mi><mo id="S2.SS2.p2.4.m3.2.2.2.2.1" xref="S2.SS2.p2.4.m3.2.2.2.2.1.cmml">=</mo><mi id="S2.SS2.p2.4.m3.2.2.2.2.3" xref="S2.SS2.p2.4.m3.2.2.2.2.3.cmml">𝒙</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m3.2b"><apply id="S2.SS2.p2.4.m3.2.2.3.cmml" xref="S2.SS2.p2.4.m3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m3.2.2.3a.cmml" xref="S2.SS2.p2.4.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p2.4.m3.1.1.1.1.cmml" xref="S2.SS2.p2.4.m3.1.1.1.1"><eq id="S2.SS2.p2.4.m3.1.1.1.1.1.cmml" xref="S2.SS2.p2.4.m3.1.1.1.1.1"></eq><ci id="S2.SS2.p2.4.m3.1.1.1.1.2.cmml" xref="S2.SS2.p2.4.m3.1.1.1.1.2">𝒗</ci><ci id="S2.SS2.p2.4.m3.1.1.1.1.3.cmml" xref="S2.SS2.p2.4.m3.1.1.1.1.3">𝜽</ci></apply><apply id="S2.SS2.p2.4.m3.2.2.2.2.cmml" xref="S2.SS2.p2.4.m3.2.2.2.2"><eq id="S2.SS2.p2.4.m3.2.2.2.2.1.cmml" xref="S2.SS2.p2.4.m3.2.2.2.2.1"></eq><ci id="S2.SS2.p2.4.m3.2.2.2.2.2.cmml" xref="S2.SS2.p2.4.m3.2.2.2.2.2">𝒖</ci><ci id="S2.SS2.p2.4.m3.2.2.2.2.3.cmml" xref="S2.SS2.p2.4.m3.2.2.2.2.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m3.2c">\bm{v}=\bm{\theta},\bm{u}=\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m3.2d">bold_italic_v = bold_italic_θ , bold_italic_u = bold_italic_x</annotation></semantics></math>), if the training data is sufficiently diverse and if the MDN is sufficiently flexible, then the minimization of <math alttext="\mathcal{L}_{\rm MDN}" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m4.1"><semantics id="S2.SS2.p2.5.m4.1a"><msub id="S2.SS2.p2.5.m4.1.1" xref="S2.SS2.p2.5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.5.m4.1.1.2" xref="S2.SS2.p2.5.m4.1.1.2.cmml">ℒ</mi><mi id="S2.SS2.p2.5.m4.1.1.3" xref="S2.SS2.p2.5.m4.1.1.3.cmml">MDN</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m4.1b"><apply id="S2.SS2.p2.5.m4.1.1.cmml" xref="S2.SS2.p2.5.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m4.1.1.1.cmml" xref="S2.SS2.p2.5.m4.1.1">subscript</csymbol><ci id="S2.SS2.p2.5.m4.1.1.2.cmml" xref="S2.SS2.p2.5.m4.1.1.2">ℒ</ci><ci id="S2.SS2.p2.5.m4.1.1.3.cmml" xref="S2.SS2.p2.5.m4.1.1.3">MDN</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m4.1c">\mathcal{L}_{\rm MDN}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m4.1d">caligraphic_L start_POSTSUBSCRIPT roman_MDN end_POSTSUBSCRIPT</annotation></semantics></math> over the network weights <math alttext="\bm{w}" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m5.1"><semantics id="S2.SS2.p2.6.m5.1a"><mi id="S2.SS2.p2.6.m5.1.1" xref="S2.SS2.p2.6.m5.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m5.1b"><ci id="S2.SS2.p2.6.m5.1.1.cmml" xref="S2.SS2.p2.6.m5.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m5.1c">\bm{w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m5.1d">bold_italic_w</annotation></semantics></math> will converge <math alttext="q_{\bm{w}}(\bm{\theta}|\bm{x})" class="ltx_Math" display="inline" id="S2.SS2.p2.7.m6.1"><semantics id="S2.SS2.p2.7.m6.1a"><mrow id="S2.SS2.p2.7.m6.1.1" xref="S2.SS2.p2.7.m6.1.1.cmml"><msub id="S2.SS2.p2.7.m6.1.1.3" xref="S2.SS2.p2.7.m6.1.1.3.cmml"><mi id="S2.SS2.p2.7.m6.1.1.3.2" xref="S2.SS2.p2.7.m6.1.1.3.2.cmml">q</mi><mi id="S2.SS2.p2.7.m6.1.1.3.3" xref="S2.SS2.p2.7.m6.1.1.3.3.cmml">𝒘</mi></msub><mo id="S2.SS2.p2.7.m6.1.1.2" xref="S2.SS2.p2.7.m6.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.7.m6.1.1.1.1" xref="S2.SS2.p2.7.m6.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.7.m6.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.7.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.7.m6.1.1.1.1.1" xref="S2.SS2.p2.7.m6.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.7.m6.1.1.1.1.1.2" xref="S2.SS2.p2.7.m6.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.SS2.p2.7.m6.1.1.1.1.1.1" xref="S2.SS2.p2.7.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p2.7.m6.1.1.1.1.1.3" xref="S2.SS2.p2.7.m6.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.SS2.p2.7.m6.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.7.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m6.1b"><apply id="S2.SS2.p2.7.m6.1.1.cmml" xref="S2.SS2.p2.7.m6.1.1"><times id="S2.SS2.p2.7.m6.1.1.2.cmml" xref="S2.SS2.p2.7.m6.1.1.2"></times><apply id="S2.SS2.p2.7.m6.1.1.3.cmml" xref="S2.SS2.p2.7.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m6.1.1.3.1.cmml" xref="S2.SS2.p2.7.m6.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.7.m6.1.1.3.2.cmml" xref="S2.SS2.p2.7.m6.1.1.3.2">𝑞</ci><ci id="S2.SS2.p2.7.m6.1.1.3.3.cmml" xref="S2.SS2.p2.7.m6.1.1.3.3">𝒘</ci></apply><apply id="S2.SS2.p2.7.m6.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m6.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.7.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p2.7.m6.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.7.m6.1.1.1.1.1.2">𝜽</ci><ci id="S2.SS2.p2.7.m6.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.7.m6.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m6.1c">q_{\bm{w}}(\bm{\theta}|\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m6.1d">italic_q start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_θ | bold_italic_x )</annotation></semantics></math> to the true posterior <math alttext="\mathcal{P}(\bm{\theta}|\bm{x})" class="ltx_Math" display="inline" id="S2.SS2.p2.8.m7.1"><semantics id="S2.SS2.p2.8.m7.1a"><mrow id="S2.SS2.p2.8.m7.1.1" xref="S2.SS2.p2.8.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.8.m7.1.1.3" xref="S2.SS2.p2.8.m7.1.1.3.cmml">𝒫</mi><mo id="S2.SS2.p2.8.m7.1.1.2" xref="S2.SS2.p2.8.m7.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.8.m7.1.1.1.1" xref="S2.SS2.p2.8.m7.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.8.m7.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.8.m7.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.8.m7.1.1.1.1.1" xref="S2.SS2.p2.8.m7.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.8.m7.1.1.1.1.1.2" xref="S2.SS2.p2.8.m7.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.SS2.p2.8.m7.1.1.1.1.1.1" xref="S2.SS2.p2.8.m7.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p2.8.m7.1.1.1.1.1.3" xref="S2.SS2.p2.8.m7.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.SS2.p2.8.m7.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.8.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m7.1b"><apply id="S2.SS2.p2.8.m7.1.1.cmml" xref="S2.SS2.p2.8.m7.1.1"><times id="S2.SS2.p2.8.m7.1.1.2.cmml" xref="S2.SS2.p2.8.m7.1.1.2"></times><ci id="S2.SS2.p2.8.m7.1.1.3.cmml" xref="S2.SS2.p2.8.m7.1.1.3">𝒫</ci><apply id="S2.SS2.p2.8.m7.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m7.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.8.m7.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m7.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p2.8.m7.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.8.m7.1.1.1.1.1.2">𝜽</ci><ci id="S2.SS2.p2.8.m7.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.8.m7.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m7.1c">\mathcal{P}(\bm{\theta}|\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.8.m7.1d">caligraphic_P ( bold_italic_θ | bold_italic_x )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx56" title="">Papamakarios and Murray(2016)</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">The MDN is just one example of an ever-increasing variety of neural density estimators in the literature. Another very popular class of methods is normalizing flows <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx57" title="">Papamakarios <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Papamakarios, Nalisnick, Rezende, Mohamed, and Lakshminarayanan</a>)</cite>, which output a flexible conditional distribution defined via learnable, invertible transformations of a base Gaussian distribution. Normalizing flows are often better equipped for handling cases wherein the target distribution is non-Gaussian, but low-dimensional and uni-modal. For any type of neural density estimator, the training procedure always involves minimizing the negative log-probability of training data, as in Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E3" title="3 ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">Now we have established the tools for neural density estimation, we can apply them to fitting components of Bayes’ theorem (Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E1" title="1 ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">1</span></a>).
</p>
</div>
<section class="ltx_subsubsection" id="S2.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>Neural Posterior Estimation (NPE)</h4>
<div class="ltx_para" id="S2.SS2.SSS1.p1">
<p class="ltx_p" id="S2.SS2.SSS1.p1.1">The most straightforward method to do this is to train neural networks to directly emulate the posterior distribution, also known as Neural Posterior Estimation <cite class="ltx_cite ltx_citemacro_citep">(NPE; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx56" title="">Papamakarios and Murray(2016)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx58" title="">Greenberg <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Greenberg, Nonnenmacher, and Macke</a>)</cite>. As in the MDN example in the previous section, the loss function for NPE is simply the negative log-posterior of our learned neural density estimator <math alttext="\hat{\mathcal{P}}(\bm{\theta}|\bm{x})" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.1.m1.1"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><mrow id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.1.m1.1.1.3" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.1.m1.1.1.3.2" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.2.cmml">𝒫</mi><mo id="S2.SS2.SSS1.p1.1.m1.1.1.3.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.1.cmml">^</mo></mover><mo id="S2.SS2.SSS1.p1.1.m1.1.1.2" xref="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p1.1.m1.1.1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.2" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.3" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><apply id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1"><times id="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.2"></times><apply id="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3"><ci id="S2.SS2.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.1">^</ci><ci id="S2.SS2.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.2">𝒫</ci></apply><apply id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.2">𝜽</ci><ci id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">\hat{\mathcal{P}}(\bm{\theta}|\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.1.m1.1d">over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x )</annotation></semantics></math>, and can be trained using a loss function like that of <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx56" title="">Papamakarios and Murray(2016)</a></cite>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\rm NPE}" class="ltx_Math" display="inline" id="S2.E4X.2.1.1.m1.1"><semantics id="S2.E4X.2.1.1.m1.1a"><msub id="S2.E4X.2.1.1.m1.1.1" xref="S2.E4X.2.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4X.2.1.1.m1.1.1.2" xref="S2.E4X.2.1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S2.E4X.2.1.1.m1.1.1.3" xref="S2.E4X.2.1.1.m1.1.1.3.cmml">NPE</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E4X.2.1.1.m1.1b"><apply id="S2.E4X.2.1.1.m1.1.1.cmml" xref="S2.E4X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.1.1.1.cmml" xref="S2.E4X.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E4X.2.1.1.m1.1.1.2.cmml" xref="S2.E4X.2.1.1.m1.1.1.2">ℒ</ci><ci id="S2.E4X.2.1.1.m1.1.1.3.cmml" xref="S2.E4X.2.1.1.m1.1.1.3">NPE</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{\rm NPE}</annotation><annotation encoding="application/x-llamapun" id="S2.E4X.2.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_NPE end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:=-\mathbb{E}_{\mathcal{D}_{\rm train}}\log\hat{\mathcal{P}}(\bm{%
\theta}_{i}|\bm{x}_{i})" class="ltx_Math" display="inline" id="S2.E4X.3.2.2.m1.1"><semantics id="S2.E4X.3.2.2.m1.1a"><mrow id="S2.E4X.3.2.2.m1.1.1" xref="S2.E4X.3.2.2.m1.1.1.cmml"><mi id="S2.E4X.3.2.2.m1.1.1.3" xref="S2.E4X.3.2.2.m1.1.1.3.cmml"></mi><mo id="S2.E4X.3.2.2.m1.1.1.2" lspace="0.278em" rspace="0.278em" xref="S2.E4X.3.2.2.m1.1.1.2.cmml">:=</mo><mrow id="S2.E4X.3.2.2.m1.1.1.1" xref="S2.E4X.3.2.2.m1.1.1.1.cmml"><mo id="S2.E4X.3.2.2.m1.1.1.1a" xref="S2.E4X.3.2.2.m1.1.1.1.cmml">−</mo><mrow id="S2.E4X.3.2.2.m1.1.1.1.1" xref="S2.E4X.3.2.2.m1.1.1.1.1.cmml"><msub id="S2.E4X.3.2.2.m1.1.1.1.1.3" xref="S2.E4X.3.2.2.m1.1.1.1.1.3.cmml"><mi id="S2.E4X.3.2.2.m1.1.1.1.1.3.2" xref="S2.E4X.3.2.2.m1.1.1.1.1.3.2.cmml">𝔼</mi><msub id="S2.E4X.3.2.2.m1.1.1.1.1.3.3" xref="S2.E4X.3.2.2.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4X.3.2.2.m1.1.1.1.1.3.3.2" xref="S2.E4X.3.2.2.m1.1.1.1.1.3.3.2.cmml">𝒟</mi><mi id="S2.E4X.3.2.2.m1.1.1.1.1.3.3.3" xref="S2.E4X.3.2.2.m1.1.1.1.1.3.3.3.cmml">train</mi></msub></msub><mo id="S2.E4X.3.2.2.m1.1.1.1.1.2" lspace="0.167em" xref="S2.E4X.3.2.2.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4X.3.2.2.m1.1.1.1.1.4" xref="S2.E4X.3.2.2.m1.1.1.1.1.4.cmml"><mi id="S2.E4X.3.2.2.m1.1.1.1.1.4.1" xref="S2.E4X.3.2.2.m1.1.1.1.1.4.1.cmml">log</mi><mo id="S2.E4X.3.2.2.m1.1.1.1.1.4a" lspace="0.167em" xref="S2.E4X.3.2.2.m1.1.1.1.1.4.cmml">⁡</mo><mover accent="true" id="S2.E4X.3.2.2.m1.1.1.1.1.4.2" xref="S2.E4X.3.2.2.m1.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4X.3.2.2.m1.1.1.1.1.4.2.2" xref="S2.E4X.3.2.2.m1.1.1.1.1.4.2.2.cmml">𝒫</mi><mo id="S2.E4X.3.2.2.m1.1.1.1.1.4.2.1" xref="S2.E4X.3.2.2.m1.1.1.1.1.4.2.1.cmml">^</mo></mover></mrow><mo id="S2.E4X.3.2.2.m1.1.1.1.1.2a" xref="S2.E4X.3.2.2.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4X.3.2.2.m1.1.1.1.1.1.1" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><msub id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.2" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml">𝜽</mi><mi id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.3" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.2" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.3" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4X.3.2.2.m1.1b"><apply id="S2.E4X.3.2.2.m1.1.1.cmml" xref="S2.E4X.3.2.2.m1.1.1"><csymbol cd="latexml" id="S2.E4X.3.2.2.m1.1.1.2.cmml" xref="S2.E4X.3.2.2.m1.1.1.2">assign</csymbol><csymbol cd="latexml" id="S2.E4X.3.2.2.m1.1.1.3.cmml" xref="S2.E4X.3.2.2.m1.1.1.3">absent</csymbol><apply id="S2.E4X.3.2.2.m1.1.1.1.cmml" xref="S2.E4X.3.2.2.m1.1.1.1"><minus id="S2.E4X.3.2.2.m1.1.1.1.2.cmml" xref="S2.E4X.3.2.2.m1.1.1.1"></minus><apply id="S2.E4X.3.2.2.m1.1.1.1.1.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1"><times id="S2.E4X.3.2.2.m1.1.1.1.1.2.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.2"></times><apply id="S2.E4X.3.2.2.m1.1.1.1.1.3.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4X.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4X.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.3.2">𝔼</ci><apply id="S2.E4X.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E4X.3.2.2.m1.1.1.1.1.3.3.1.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E4X.3.2.2.m1.1.1.1.1.3.3.2.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.3.3.2">𝒟</ci><ci id="S2.E4X.3.2.2.m1.1.1.1.1.3.3.3.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.3.3.3">train</ci></apply></apply><apply id="S2.E4X.3.2.2.m1.1.1.1.1.4.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.4"><log id="S2.E4X.3.2.2.m1.1.1.1.1.4.1.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.4.1"></log><apply id="S2.E4X.3.2.2.m1.1.1.1.1.4.2.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.4.2"><ci id="S2.E4X.3.2.2.m1.1.1.1.1.4.2.1.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.4.2.1">^</ci><ci id="S2.E4X.3.2.2.m1.1.1.1.1.4.2.2.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.4.2.2">𝒫</ci></apply></apply><apply id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.2">𝜽</ci><ci id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4X.3.2.2.m1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4X.3.2.2.m1.1c">\displaystyle:=-\mathbb{E}_{\mathcal{D}_{\rm train}}\log\hat{\mathcal{P}}(\bm{%
\theta}_{i}|\bm{x}_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.E4X.3.2.2.m1.1d">:= - blackboard_E start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\mathbb{E}_{\mathcal{D}_{\rm train}}\log\left[\frac{p(\bm{%
\theta})}{\tilde{p}(\bm{\theta})}q_{\bm{w}}(\bm{\theta}|\bm{x})\right]," class="ltx_Math" display="inline" id="S2.E4Xa.2.1.1.m1.4"><semantics id="S2.E4Xa.2.1.1.m1.4a"><mrow id="S2.E4Xa.2.1.1.m1.4.4.1" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.cmml"><mrow id="S2.E4Xa.2.1.1.m1.4.4.1.1" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.cmml"><mi id="S2.E4Xa.2.1.1.m1.4.4.1.1.3" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.3.cmml"></mi><mo id="S2.E4Xa.2.1.1.m1.4.4.1.1.2" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.E4Xa.2.1.1.m1.4.4.1.1.1" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.cmml"><mo id="S2.E4Xa.2.1.1.m1.4.4.1.1.1a" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.cmml">−</mo><mrow id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.cmml"><msub id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.2" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.2.cmml">𝔼</mi><msub id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.2" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.2.cmml">𝒟</mi><mi id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.3" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.3.cmml">train</mi></msub></msub><mo id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.2" lspace="0.167em" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3" xref="S2.E4Xa.2.1.1.m1.3.3.cmml">log</mi><mo id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1a" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">[</mo><mrow id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E4Xa.2.1.1.m1.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.cmml"><mfrac id="S2.E4Xa.2.1.1.m1.2.2a" xref="S2.E4Xa.2.1.1.m1.2.2.cmml"><mrow id="S2.E4Xa.2.1.1.m1.1.1.1" xref="S2.E4Xa.2.1.1.m1.1.1.1.cmml"><mi id="S2.E4Xa.2.1.1.m1.1.1.1.3" xref="S2.E4Xa.2.1.1.m1.1.1.1.3.cmml">p</mi><mo id="S2.E4Xa.2.1.1.m1.1.1.1.2" xref="S2.E4Xa.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4Xa.2.1.1.m1.1.1.1.4.2" xref="S2.E4Xa.2.1.1.m1.1.1.1.cmml"><mo id="S2.E4Xa.2.1.1.m1.1.1.1.4.2.1" stretchy="false" xref="S2.E4Xa.2.1.1.m1.1.1.1.cmml">(</mo><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.cmml">𝜽</mi><mo id="S2.E4Xa.2.1.1.m1.1.1.1.4.2.2" stretchy="false" xref="S2.E4Xa.2.1.1.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E4Xa.2.1.1.m1.2.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.2.cmml"><mover accent="true" id="S2.E4Xa.2.1.1.m1.2.2.2.3" xref="S2.E4Xa.2.1.1.m1.2.2.2.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.2.3.2" xref="S2.E4Xa.2.1.1.m1.2.2.2.3.2.cmml">p</mi><mo id="S2.E4Xa.2.1.1.m1.2.2.2.3.1" xref="S2.E4Xa.2.1.1.m1.2.2.2.3.1.cmml">~</mo></mover><mo id="S2.E4Xa.2.1.1.m1.2.2.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.2.4.2" xref="S2.E4Xa.2.1.1.m1.2.2.2.cmml"><mo id="S2.E4Xa.2.1.1.m1.2.2.2.4.2.1" stretchy="false" xref="S2.E4Xa.2.1.1.m1.2.2.2.cmml">(</mo><mi id="S2.E4Xa.2.1.1.m1.2.2.2.1" xref="S2.E4Xa.2.1.1.m1.2.2.2.1.cmml">𝜽</mi><mo id="S2.E4Xa.2.1.1.m1.2.2.2.4.2.2" stretchy="false" xref="S2.E4Xa.2.1.1.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml">q</mi><mi id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml">𝒘</mi></msub><mo id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2a" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E4Xa.2.1.1.m1.4.4.1.2" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4Xa.2.1.1.m1.4b"><apply id="S2.E4Xa.2.1.1.m1.4.4.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1"><eq id="S2.E4Xa.2.1.1.m1.4.4.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.2"></eq><csymbol cd="latexml" id="S2.E4Xa.2.1.1.m1.4.4.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.3">absent</csymbol><apply id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1"><minus id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1"></minus><apply id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1"><times id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.2"></times><apply id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.2">𝔼</ci><apply id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.2">𝒟</ci><ci id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.3.3.3">train</ci></apply></apply><apply id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1"><log id="S2.E4Xa.2.1.1.m1.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3"></log><apply id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"><times id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E4Xa.2.1.1.m1.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2"><divide id="S2.E4Xa.2.1.1.m1.2.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2"></divide><apply id="S2.E4Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1"><times id="S2.E4Xa.2.1.1.m1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.2"></times><ci id="S2.E4Xa.2.1.1.m1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.3">𝑝</ci><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1">𝜽</ci></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2"><times id="S2.E4Xa.2.1.1.m1.2.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2"></times><apply id="S2.E4Xa.2.1.1.m1.2.2.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.3"><ci id="S2.E4Xa.2.1.1.m1.2.2.2.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.3.1">~</ci><ci id="S2.E4Xa.2.1.1.m1.2.2.2.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.3.2">𝑝</ci></apply><ci id="S2.E4Xa.2.1.1.m1.2.2.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.1">𝜽</ci></apply></apply><apply id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2">𝑞</ci><ci id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3">𝒘</ci></apply><apply id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">𝜽</ci><ci id="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4Xa.2.1.1.m1.4c">\displaystyle=-\mathbb{E}_{\mathcal{D}_{\rm train}}\log\left[\frac{p(\bm{%
\theta})}{\tilde{p}(\bm{\theta})}q_{\bm{w}}(\bm{\theta}|\bm{x})\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E4Xa.2.1.1.m1.4d">= - blackboard_E start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log [ divide start_ARG italic_p ( bold_italic_θ ) end_ARG start_ARG over~ start_ARG italic_p end_ARG ( bold_italic_θ ) end_ARG italic_q start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_θ | bold_italic_x ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS1.p1.12">where our neural posterior <math alttext="\hat{\mathcal{P}}(\bm{\theta}_{i}|\bm{x}_{i})" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.2.m1.1"><semantics id="S2.SS2.SSS1.p1.2.m1.1a"><mrow id="S2.SS2.SSS1.p1.2.m1.1.1" xref="S2.SS2.SSS1.p1.2.m1.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.2.m1.1.1.3" xref="S2.SS2.SSS1.p1.2.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.2.m1.1.1.3.2" xref="S2.SS2.SSS1.p1.2.m1.1.1.3.2.cmml">𝒫</mi><mo id="S2.SS2.SSS1.p1.2.m1.1.1.3.1" xref="S2.SS2.SSS1.p1.2.m1.1.1.3.1.cmml">^</mo></mover><mo id="S2.SS2.SSS1.p1.2.m1.1.1.2" xref="S2.SS2.SSS1.p1.2.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p1.2.m1.1.1.1.1" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.cmml"><msub id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.cmml"><mi id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.2" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.2.cmml">𝜽</mi><mi id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.3" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.1" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.2" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.3" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m1.1b"><apply id="S2.SS2.SSS1.p1.2.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1"><times id="S2.SS2.SSS1.p1.2.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.2"></times><apply id="S2.SS2.SSS1.p1.2.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.3"><ci id="S2.SS2.SSS1.p1.2.m1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.3.1">^</ci><ci id="S2.SS2.SSS1.p1.2.m1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.3.2">𝒫</ci></apply><apply id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.2">𝜽</ci><ci id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.SSS1.p1.2.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m1.1c">\hat{\mathcal{P}}(\bm{\theta}_{i}|\bm{x}_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.2.m1.1d">over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is decomposed into a neural network output <math alttext="q_{\bm{w}}(\bm{x},\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.3.m2.2"><semantics id="S2.SS2.SSS1.p1.3.m2.2a"><mrow id="S2.SS2.SSS1.p1.3.m2.2.3" xref="S2.SS2.SSS1.p1.3.m2.2.3.cmml"><msub id="S2.SS2.SSS1.p1.3.m2.2.3.2" xref="S2.SS2.SSS1.p1.3.m2.2.3.2.cmml"><mi id="S2.SS2.SSS1.p1.3.m2.2.3.2.2" xref="S2.SS2.SSS1.p1.3.m2.2.3.2.2.cmml">q</mi><mi id="S2.SS2.SSS1.p1.3.m2.2.3.2.3" xref="S2.SS2.SSS1.p1.3.m2.2.3.2.3.cmml">𝒘</mi></msub><mo id="S2.SS2.SSS1.p1.3.m2.2.3.1" xref="S2.SS2.SSS1.p1.3.m2.2.3.1.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p1.3.m2.2.3.3.2" xref="S2.SS2.SSS1.p1.3.m2.2.3.3.1.cmml"><mo id="S2.SS2.SSS1.p1.3.m2.2.3.3.2.1" stretchy="false" xref="S2.SS2.SSS1.p1.3.m2.2.3.3.1.cmml">(</mo><mi id="S2.SS2.SSS1.p1.3.m2.1.1" xref="S2.SS2.SSS1.p1.3.m2.1.1.cmml">𝒙</mi><mo id="S2.SS2.SSS1.p1.3.m2.2.3.3.2.2" xref="S2.SS2.SSS1.p1.3.m2.2.3.3.1.cmml">,</mo><mi id="S2.SS2.SSS1.p1.3.m2.2.2" xref="S2.SS2.SSS1.p1.3.m2.2.2.cmml">𝜽</mi><mo id="S2.SS2.SSS1.p1.3.m2.2.3.3.2.3" stretchy="false" xref="S2.SS2.SSS1.p1.3.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.3.m2.2b"><apply id="S2.SS2.SSS1.p1.3.m2.2.3.cmml" xref="S2.SS2.SSS1.p1.3.m2.2.3"><times id="S2.SS2.SSS1.p1.3.m2.2.3.1.cmml" xref="S2.SS2.SSS1.p1.3.m2.2.3.1"></times><apply id="S2.SS2.SSS1.p1.3.m2.2.3.2.cmml" xref="S2.SS2.SSS1.p1.3.m2.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.3.m2.2.3.2.1.cmml" xref="S2.SS2.SSS1.p1.3.m2.2.3.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.3.m2.2.3.2.2.cmml" xref="S2.SS2.SSS1.p1.3.m2.2.3.2.2">𝑞</ci><ci id="S2.SS2.SSS1.p1.3.m2.2.3.2.3.cmml" xref="S2.SS2.SSS1.p1.3.m2.2.3.2.3">𝒘</ci></apply><interval closure="open" id="S2.SS2.SSS1.p1.3.m2.2.3.3.1.cmml" xref="S2.SS2.SSS1.p1.3.m2.2.3.3.2"><ci id="S2.SS2.SSS1.p1.3.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m2.1.1">𝒙</ci><ci id="S2.SS2.SSS1.p1.3.m2.2.2.cmml" xref="S2.SS2.SSS1.p1.3.m2.2.2">𝜽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.3.m2.2c">q_{\bm{w}}(\bm{x},\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.3.m2.2d">italic_q start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_θ )</annotation></semantics></math> and a weighting factor taken as the ratio of the assumed prior <math alttext="p(\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.4.m3.1"><semantics id="S2.SS2.SSS1.p1.4.m3.1a"><mrow id="S2.SS2.SSS1.p1.4.m3.1.2" xref="S2.SS2.SSS1.p1.4.m3.1.2.cmml"><mi id="S2.SS2.SSS1.p1.4.m3.1.2.2" xref="S2.SS2.SSS1.p1.4.m3.1.2.2.cmml">p</mi><mo id="S2.SS2.SSS1.p1.4.m3.1.2.1" xref="S2.SS2.SSS1.p1.4.m3.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p1.4.m3.1.2.3.2" xref="S2.SS2.SSS1.p1.4.m3.1.2.cmml"><mo id="S2.SS2.SSS1.p1.4.m3.1.2.3.2.1" stretchy="false" xref="S2.SS2.SSS1.p1.4.m3.1.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.4.m3.1.1" xref="S2.SS2.SSS1.p1.4.m3.1.1.cmml">𝜽</mi><mo id="S2.SS2.SSS1.p1.4.m3.1.2.3.2.2" stretchy="false" xref="S2.SS2.SSS1.p1.4.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.4.m3.1b"><apply id="S2.SS2.SSS1.p1.4.m3.1.2.cmml" xref="S2.SS2.SSS1.p1.4.m3.1.2"><times id="S2.SS2.SSS1.p1.4.m3.1.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m3.1.2.1"></times><ci id="S2.SS2.SSS1.p1.4.m3.1.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m3.1.2.2">𝑝</ci><ci id="S2.SS2.SSS1.p1.4.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m3.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.4.m3.1c">p(\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.4.m3.1d">italic_p ( bold_italic_θ )</annotation></semantics></math> to the proposal prior <math alttext="\tilde{p}(\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.5.m4.1"><semantics id="S2.SS2.SSS1.p1.5.m4.1a"><mrow id="S2.SS2.SSS1.p1.5.m4.1.2" xref="S2.SS2.SSS1.p1.5.m4.1.2.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.5.m4.1.2.2" xref="S2.SS2.SSS1.p1.5.m4.1.2.2.cmml"><mi id="S2.SS2.SSS1.p1.5.m4.1.2.2.2" xref="S2.SS2.SSS1.p1.5.m4.1.2.2.2.cmml">p</mi><mo id="S2.SS2.SSS1.p1.5.m4.1.2.2.1" xref="S2.SS2.SSS1.p1.5.m4.1.2.2.1.cmml">~</mo></mover><mo id="S2.SS2.SSS1.p1.5.m4.1.2.1" xref="S2.SS2.SSS1.p1.5.m4.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p1.5.m4.1.2.3.2" xref="S2.SS2.SSS1.p1.5.m4.1.2.cmml"><mo id="S2.SS2.SSS1.p1.5.m4.1.2.3.2.1" stretchy="false" xref="S2.SS2.SSS1.p1.5.m4.1.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.5.m4.1.1" xref="S2.SS2.SSS1.p1.5.m4.1.1.cmml">𝜽</mi><mo id="S2.SS2.SSS1.p1.5.m4.1.2.3.2.2" stretchy="false" xref="S2.SS2.SSS1.p1.5.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.5.m4.1b"><apply id="S2.SS2.SSS1.p1.5.m4.1.2.cmml" xref="S2.SS2.SSS1.p1.5.m4.1.2"><times id="S2.SS2.SSS1.p1.5.m4.1.2.1.cmml" xref="S2.SS2.SSS1.p1.5.m4.1.2.1"></times><apply id="S2.SS2.SSS1.p1.5.m4.1.2.2.cmml" xref="S2.SS2.SSS1.p1.5.m4.1.2.2"><ci id="S2.SS2.SSS1.p1.5.m4.1.2.2.1.cmml" xref="S2.SS2.SSS1.p1.5.m4.1.2.2.1">~</ci><ci id="S2.SS2.SSS1.p1.5.m4.1.2.2.2.cmml" xref="S2.SS2.SSS1.p1.5.m4.1.2.2.2">𝑝</ci></apply><ci id="S2.SS2.SSS1.p1.5.m4.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m4.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.5.m4.1c">\tilde{p}(\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.5.m4.1d">over~ start_ARG italic_p end_ARG ( bold_italic_θ )</annotation></semantics></math>. The proposal prior is representative of the distribution of <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.6.m5.1"><semantics id="S2.SS2.SSS1.p1.6.m5.1a"><mi id="S2.SS2.SSS1.p1.6.m5.1.1" xref="S2.SS2.SSS1.p1.6.m5.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.6.m5.1b"><ci id="S2.SS2.SSS1.p1.6.m5.1.1.cmml" xref="S2.SS2.SSS1.p1.6.m5.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.6.m5.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.6.m5.1d">bold_italic_θ</annotation></semantics></math> in the training dataset <math alttext="\mathcal{D}_{\rm train}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.7.m6.1"><semantics id="S2.SS2.SSS1.p1.7.m6.1a"><msub id="S2.SS2.SSS1.p1.7.m6.1.1" xref="S2.SS2.SSS1.p1.7.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.7.m6.1.1.2" xref="S2.SS2.SSS1.p1.7.m6.1.1.2.cmml">𝒟</mi><mi id="S2.SS2.SSS1.p1.7.m6.1.1.3" xref="S2.SS2.SSS1.p1.7.m6.1.1.3.cmml">train</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.7.m6.1b"><apply id="S2.SS2.SSS1.p1.7.m6.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m6.1.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m6.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.7.m6.1.1.2.cmml" xref="S2.SS2.SSS1.p1.7.m6.1.1.2">𝒟</ci><ci id="S2.SS2.SSS1.p1.7.m6.1.1.3.cmml" xref="S2.SS2.SSS1.p1.7.m6.1.1.3">train</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.7.m6.1c">\mathcal{D}_{\rm train}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.7.m6.1d">caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT</annotation></semantics></math> and is often taken to be equal to the assumed prior. Note, that the normalization factor <math alttext="\log p(\bm{\theta})/\tilde{p}(\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.8.m7.2"><semantics id="S2.SS2.SSS1.p1.8.m7.2a"><mrow id="S2.SS2.SSS1.p1.8.m7.2.3" xref="S2.SS2.SSS1.p1.8.m7.2.3.cmml"><mrow id="S2.SS2.SSS1.p1.8.m7.2.3.2" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.cmml"><mrow id="S2.SS2.SSS1.p1.8.m7.2.3.2.2" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.cmml"><mrow id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.cmml"><mi id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.1" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.1.cmml">log</mi><mo id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2a" lspace="0.167em" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.cmml">⁡</mo><mi id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.2" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.2.cmml">p</mi></mrow><mo id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.1" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.1.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.3.2" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.cmml"><mo id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.3.2.1" stretchy="false" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.8.m7.1.1" xref="S2.SS2.SSS1.p1.8.m7.1.1.cmml">𝜽</mi><mo id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.3.2.2" stretchy="false" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.cmml">)</mo></mrow></mrow><mo id="S2.SS2.SSS1.p1.8.m7.2.3.2.1" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.1.cmml">/</mo><mover accent="true" id="S2.SS2.SSS1.p1.8.m7.2.3.2.3" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.3.cmml"><mi id="S2.SS2.SSS1.p1.8.m7.2.3.2.3.2" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.3.2.cmml">p</mi><mo id="S2.SS2.SSS1.p1.8.m7.2.3.2.3.1" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.3.1.cmml">~</mo></mover></mrow><mo id="S2.SS2.SSS1.p1.8.m7.2.3.1" xref="S2.SS2.SSS1.p1.8.m7.2.3.1.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p1.8.m7.2.3.3.2" xref="S2.SS2.SSS1.p1.8.m7.2.3.cmml"><mo id="S2.SS2.SSS1.p1.8.m7.2.3.3.2.1" stretchy="false" xref="S2.SS2.SSS1.p1.8.m7.2.3.cmml">(</mo><mi id="S2.SS2.SSS1.p1.8.m7.2.2" xref="S2.SS2.SSS1.p1.8.m7.2.2.cmml">𝜽</mi><mo id="S2.SS2.SSS1.p1.8.m7.2.3.3.2.2" stretchy="false" xref="S2.SS2.SSS1.p1.8.m7.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.8.m7.2b"><apply id="S2.SS2.SSS1.p1.8.m7.2.3.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3"><times id="S2.SS2.SSS1.p1.8.m7.2.3.1.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.1"></times><apply id="S2.SS2.SSS1.p1.8.m7.2.3.2.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.2"><divide id="S2.SS2.SSS1.p1.8.m7.2.3.2.1.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.1"></divide><apply id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2"><times id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.1.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.1"></times><apply id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2"><log id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.1"></log><ci id="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.2.2.2">𝑝</ci></apply><ci id="S2.SS2.SSS1.p1.8.m7.1.1.cmml" xref="S2.SS2.SSS1.p1.8.m7.1.1">𝜽</ci></apply><apply id="S2.SS2.SSS1.p1.8.m7.2.3.2.3.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.3"><ci id="S2.SS2.SSS1.p1.8.m7.2.3.2.3.1.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.3.1">~</ci><ci id="S2.SS2.SSS1.p1.8.m7.2.3.2.3.2.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.3.2.3.2">𝑝</ci></apply></apply><ci id="S2.SS2.SSS1.p1.8.m7.2.2.cmml" xref="S2.SS2.SSS1.p1.8.m7.2.2">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.8.m7.2c">\log p(\bm{\theta})/\tilde{p}(\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.8.m7.2d">roman_log italic_p ( bold_italic_θ ) / over~ start_ARG italic_p end_ARG ( bold_italic_θ )</annotation></semantics></math> cancels out when optimizing <math alttext="\mathcal{L}_{\rm NPE}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.9.m8.1"><semantics id="S2.SS2.SSS1.p1.9.m8.1a"><msub id="S2.SS2.SSS1.p1.9.m8.1.1" xref="S2.SS2.SSS1.p1.9.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.9.m8.1.1.2" xref="S2.SS2.SSS1.p1.9.m8.1.1.2.cmml">ℒ</mi><mi id="S2.SS2.SSS1.p1.9.m8.1.1.3" xref="S2.SS2.SSS1.p1.9.m8.1.1.3.cmml">NPE</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.9.m8.1b"><apply id="S2.SS2.SSS1.p1.9.m8.1.1.cmml" xref="S2.SS2.SSS1.p1.9.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.9.m8.1.1.1.cmml" xref="S2.SS2.SSS1.p1.9.m8.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.9.m8.1.1.2.cmml" xref="S2.SS2.SSS1.p1.9.m8.1.1.2">ℒ</ci><ci id="S2.SS2.SSS1.p1.9.m8.1.1.3.cmml" xref="S2.SS2.SSS1.p1.9.m8.1.1.3">NPE</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.9.m8.1c">\mathcal{L}_{\rm NPE}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.9.m8.1d">caligraphic_L start_POSTSUBSCRIPT roman_NPE end_POSTSUBSCRIPT</annotation></semantics></math> over <math alttext="\bm{w}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.10.m9.1"><semantics id="S2.SS2.SSS1.p1.10.m9.1a"><mi id="S2.SS2.SSS1.p1.10.m9.1.1" xref="S2.SS2.SSS1.p1.10.m9.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.10.m9.1b"><ci id="S2.SS2.SSS1.p1.10.m9.1.1.cmml" xref="S2.SS2.SSS1.p1.10.m9.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.10.m9.1c">\bm{w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.10.m9.1d">bold_italic_w</annotation></semantics></math>, but is still required for constructing the posterior estimator <math alttext="\hat{\mathcal{P}}(\bm{\theta}|\bm{x})" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.11.m10.1"><semantics id="S2.SS2.SSS1.p1.11.m10.1a"><mrow id="S2.SS2.SSS1.p1.11.m10.1.1" xref="S2.SS2.SSS1.p1.11.m10.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.11.m10.1.1.3" xref="S2.SS2.SSS1.p1.11.m10.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.11.m10.1.1.3.2" xref="S2.SS2.SSS1.p1.11.m10.1.1.3.2.cmml">𝒫</mi><mo id="S2.SS2.SSS1.p1.11.m10.1.1.3.1" xref="S2.SS2.SSS1.p1.11.m10.1.1.3.1.cmml">^</mo></mover><mo id="S2.SS2.SSS1.p1.11.m10.1.1.2" xref="S2.SS2.SSS1.p1.11.m10.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p1.11.m10.1.1.1.1" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS1.p1.11.m10.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.2" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.1" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.3" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.SS2.SSS1.p1.11.m10.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.11.m10.1b"><apply id="S2.SS2.SSS1.p1.11.m10.1.1.cmml" xref="S2.SS2.SSS1.p1.11.m10.1.1"><times id="S2.SS2.SSS1.p1.11.m10.1.1.2.cmml" xref="S2.SS2.SSS1.p1.11.m10.1.1.2"></times><apply id="S2.SS2.SSS1.p1.11.m10.1.1.3.cmml" xref="S2.SS2.SSS1.p1.11.m10.1.1.3"><ci id="S2.SS2.SSS1.p1.11.m10.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.11.m10.1.1.3.1">^</ci><ci id="S2.SS2.SSS1.p1.11.m10.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.11.m10.1.1.3.2">𝒫</ci></apply><apply id="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.2">𝜽</ci><ci id="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.11.m10.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.11.m10.1c">\hat{\mathcal{P}}(\bm{\theta}|\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.11.m10.1d">over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x )</annotation></semantics></math>.
This method has the advantage that it allows for quick evaluation and sampling of the full posterior at inference time. However, the disadvantage is that it requires knowledge of the analytic form of the proposal prior <math alttext="\tilde{p}(\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.12.m11.1"><semantics id="S2.SS2.SSS1.p1.12.m11.1a"><mrow id="S2.SS2.SSS1.p1.12.m11.1.2" xref="S2.SS2.SSS1.p1.12.m11.1.2.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.12.m11.1.2.2" xref="S2.SS2.SSS1.p1.12.m11.1.2.2.cmml"><mi id="S2.SS2.SSS1.p1.12.m11.1.2.2.2" xref="S2.SS2.SSS1.p1.12.m11.1.2.2.2.cmml">p</mi><mo id="S2.SS2.SSS1.p1.12.m11.1.2.2.1" xref="S2.SS2.SSS1.p1.12.m11.1.2.2.1.cmml">~</mo></mover><mo id="S2.SS2.SSS1.p1.12.m11.1.2.1" xref="S2.SS2.SSS1.p1.12.m11.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p1.12.m11.1.2.3.2" xref="S2.SS2.SSS1.p1.12.m11.1.2.cmml"><mo id="S2.SS2.SSS1.p1.12.m11.1.2.3.2.1" stretchy="false" xref="S2.SS2.SSS1.p1.12.m11.1.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.12.m11.1.1" xref="S2.SS2.SSS1.p1.12.m11.1.1.cmml">𝜽</mi><mo id="S2.SS2.SSS1.p1.12.m11.1.2.3.2.2" stretchy="false" xref="S2.SS2.SSS1.p1.12.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.12.m11.1b"><apply id="S2.SS2.SSS1.p1.12.m11.1.2.cmml" xref="S2.SS2.SSS1.p1.12.m11.1.2"><times id="S2.SS2.SSS1.p1.12.m11.1.2.1.cmml" xref="S2.SS2.SSS1.p1.12.m11.1.2.1"></times><apply id="S2.SS2.SSS1.p1.12.m11.1.2.2.cmml" xref="S2.SS2.SSS1.p1.12.m11.1.2.2"><ci id="S2.SS2.SSS1.p1.12.m11.1.2.2.1.cmml" xref="S2.SS2.SSS1.p1.12.m11.1.2.2.1">~</ci><ci id="S2.SS2.SSS1.p1.12.m11.1.2.2.2.cmml" xref="S2.SS2.SSS1.p1.12.m11.1.2.2.2">𝑝</ci></apply><ci id="S2.SS2.SSS1.p1.12.m11.1.1.cmml" xref="S2.SS2.SSS1.p1.12.m11.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.12.m11.1c">\tilde{p}(\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.12.m11.1d">over~ start_ARG italic_p end_ARG ( bold_italic_θ )</annotation></semantics></math> from which training data was sampled, which may not be accessible for astrophysical training data (<em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p1.12.1">e.g.,</em> cluster properties in cosmological simulations).
Recently, <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx59" title="">Vasist <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Vasist, Rozet, Absil, Mollière, Nasedkin, and Louppe</a></cite> used an NPE strategy to constrain exoplanetary atmospheric models. NPE has also become a known tool in Gravitational-Wave astronomy where analytical Compact Binary Coalescent (CBC) waveforms play the role of the forward model (<em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p1.12.2">e.g.,</em> with <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS1.p1.12.3">DINGO</span> from <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx16" title="">Dax <em class="ltx_emph ltx_font_italic">et al.</em>(2021a)Dax, Green, Gair, Macke, Buonanno, and Schölkopf</a></cite>, and the constraints on GW150914 by <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx60" title="">Crisostomi <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Crisostomi, Dey, Barausse, and Trotta</a></cite>, among many others).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2 </span>Neural Likelihood Estimation (NLE)</h4>
<div class="ltx_para" id="S2.SS2.SSS2.p1">
<p class="ltx_p" id="S2.SS2.SSS2.p1.1">An alternative method which circumvents the issue of fixed priors is to only fit for the likelihood, <math alttext="\mathcal{P}\left(\bm{x}|\bm{\theta}\right)" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.1.m1.1"><semantics id="S2.SS2.SSS2.p1.1.m1.1a"><mrow id="S2.SS2.SSS2.p1.1.m1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.1.m1.1.1.3" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml">𝒫</mi><mo id="S2.SS2.SSS2.p1.1.m1.1.1.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.SSS2.p1.1.m1.1.1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS2.p1.1.m1.1.1.1.1.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.SS2.SSS2.p1.1.m1.1.1.1.1.3" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.1.m1.1b"><apply id="S2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1"><times id="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.2"></times><ci id="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3">𝒫</ci><apply id="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.1.1.3">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.1.m1.1c">\mathcal{P}\left(\bm{x}|\bm{\theta}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.1.m1.1d">caligraphic_P ( bold_italic_x | bold_italic_θ )</annotation></semantics></math>, via Neural Likelihood Estimation <cite class="ltx_cite ltx_citemacro_citep">(NLE; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx53" title="">Alsing <em class="ltx_emph ltx_font_italic">et al.</em>(2018)Alsing, Wandelt, and Feeney</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx61" title="">Alsing <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Alsing, Charnock, Feeney, and Wandelt</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx62" title="">Papamakarios <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Papamakarios, Sterratt, and Murray</a>)</cite>. The loss function for NLE notably does not include the assumed or proposal prior, and simply maximizes the global log-likelihood,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\rm NLE}:=-\mathbb{E}_{\mathcal{D}_{\rm train}}\log q_{\bm{w}}(%
\bm{x}|\bm{\theta})," class="ltx_Math" display="block" id="S2.E5.m1.1"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.3.2.cmml">ℒ</mi><mi id="S2.E5.m1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.3.3.cmml">NLE</mi></msub><mo id="S2.E5.m1.1.1.1.1.2" lspace="0.278em" rspace="0.278em" xref="S2.E5.m1.1.1.1.1.2.cmml">:=</mo><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.1.1.1.1.1a" xref="S2.E5.m1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E5.m1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><msub id="S2.E5.m1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.1.1.1.1.1.3.3.2" xref="S2.E5.m1.1.1.1.1.1.1.3.3.2.cmml">𝒟</mi><mi id="S2.E5.m1.1.1.1.1.1.1.3.3.3" xref="S2.E5.m1.1.1.1.1.1.1.3.3.3.cmml">train</mi></msub></msub><mo id="S2.E5.m1.1.1.1.1.1.1.2" lspace="0.167em" xref="S2.E5.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.4" xref="S2.E5.m1.1.1.1.1.1.1.4.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.4.1" xref="S2.E5.m1.1.1.1.1.1.1.4.1.cmml">log</mi><mo id="S2.E5.m1.1.1.1.1.1.1.4a" lspace="0.167em" xref="S2.E5.m1.1.1.1.1.1.1.4.cmml">⁡</mo><msub id="S2.E5.m1.1.1.1.1.1.1.4.2" xref="S2.E5.m1.1.1.1.1.1.1.4.2.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.4.2.2" xref="S2.E5.m1.1.1.1.1.1.1.4.2.2.cmml">q</mi><mi id="S2.E5.m1.1.1.1.1.1.1.4.2.3" xref="S2.E5.m1.1.1.1.1.1.1.4.2.3.cmml">𝒘</mi></msub></mrow><mo id="S2.E5.m1.1.1.1.1.1.1.2a" xref="S2.E5.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.2">assign</csymbol><apply id="S2.E5.m1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.3.2">ℒ</ci><ci id="S2.E5.m1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.3.3">NLE</ci></apply><apply id="S2.E5.m1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><minus id="S2.E5.m1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1"></minus><apply id="S2.E5.m1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1"><times id="S2.E5.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.2"></times><apply id="S2.E5.m1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.2">𝔼</ci><apply id="S2.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.3.2">𝒟</ci><ci id="S2.E5.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.3.3">train</ci></apply></apply><apply id="S2.E5.m1.1.1.1.1.1.1.4.cmml" xref="S2.E5.m1.1.1.1.1.1.1.4"><log id="S2.E5.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.4.1"></log><apply id="S2.E5.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.4.2.2">𝑞</ci><ci id="S2.E5.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.4.2.3">𝒘</ci></apply></apply><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3">𝜽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\mathcal{L}_{\rm NLE}:=-\mathbb{E}_{\mathcal{D}_{\rm train}}\log q_{\bm{w}}(%
\bm{x}|\bm{\theta}),</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_NLE end_POSTSUBSCRIPT := - blackboard_E start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_q start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_x | bold_italic_θ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS2.p1.4">wherein we emphasize the swapped arguments of <math alttext="q" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.2.m1.1"><semantics id="S2.SS2.SSS2.p1.2.m1.1a"><mi id="S2.SS2.SSS2.p1.2.m1.1.1" xref="S2.SS2.SSS2.p1.2.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.2.m1.1b"><ci id="S2.SS2.SSS2.p1.2.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.2.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.2.m1.1d">italic_q</annotation></semantics></math> as compared to Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E4" title="4 ‣ 2.2.1 Neural Posterior Estimation (NPE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">4</span></a>.
Multiplying a learned likelihood with an assumed prior results in a proxy which is proportional to the posterior, <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS2.p1.4.1">i.e.,</em> <math alttext="\hat{\mathcal{P}}(\bm{\theta}|\bm{x})\propto q_{\bm{w}}(\bm{x}|\bm{\theta})p(%
\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.3.m2.3"><semantics id="S2.SS2.SSS2.p1.3.m2.3a"><mrow id="S2.SS2.SSS2.p1.3.m2.3.3" xref="S2.SS2.SSS2.p1.3.m2.3.3.cmml"><mrow id="S2.SS2.SSS2.p1.3.m2.2.2.1" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.cmml"><mover accent="true" id="S2.SS2.SSS2.p1.3.m2.2.2.1.3" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.3.m2.2.2.1.3.2" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.3.2.cmml">𝒫</mi><mo id="S2.SS2.SSS2.p1.3.m2.2.2.1.3.1" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.3.1.cmml">^</mo></mover><mo id="S2.SS2.SSS2.p1.3.m2.2.2.1.2" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.cmml"><mo id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.2" stretchy="false" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.cmml"><mi id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.2" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.1" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.3" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.3" stretchy="false" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.SSS2.p1.3.m2.3.3.3" xref="S2.SS2.SSS2.p1.3.m2.3.3.3.cmml">∝</mo><mrow id="S2.SS2.SSS2.p1.3.m2.3.3.2" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.cmml"><msub id="S2.SS2.SSS2.p1.3.m2.3.3.2.3" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.3.cmml"><mi id="S2.SS2.SSS2.p1.3.m2.3.3.2.3.2" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.3.2.cmml">q</mi><mi id="S2.SS2.SSS2.p1.3.m2.3.3.2.3.3" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.3.3.cmml">𝒘</mi></msub><mo id="S2.SS2.SSS2.p1.3.m2.3.3.2.2" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.2.cmml">⁢</mo><mrow id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.cmml"><mo id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.2" stretchy="false" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.cmml"><mi id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.2" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.1" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.1.cmml">|</mo><mi id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.3" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.3" stretchy="false" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.cmml">)</mo></mrow><mo id="S2.SS2.SSS2.p1.3.m2.3.3.2.2a" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.2.cmml">⁢</mo><mi id="S2.SS2.SSS2.p1.3.m2.3.3.2.4" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.4.cmml">p</mi><mo id="S2.SS2.SSS2.p1.3.m2.3.3.2.2b" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.2.cmml">⁢</mo><mrow id="S2.SS2.SSS2.p1.3.m2.3.3.2.5.2" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.cmml"><mo id="S2.SS2.SSS2.p1.3.m2.3.3.2.5.2.1" stretchy="false" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.cmml">(</mo><mi id="S2.SS2.SSS2.p1.3.m2.1.1" xref="S2.SS2.SSS2.p1.3.m2.1.1.cmml">𝜽</mi><mo id="S2.SS2.SSS2.p1.3.m2.3.3.2.5.2.2" stretchy="false" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.3.m2.3b"><apply id="S2.SS2.SSS2.p1.3.m2.3.3.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3"><csymbol cd="latexml" id="S2.SS2.SSS2.p1.3.m2.3.3.3.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.3">proportional-to</csymbol><apply id="S2.SS2.SSS2.p1.3.m2.2.2.1.cmml" xref="S2.SS2.SSS2.p1.3.m2.2.2.1"><times id="S2.SS2.SSS2.p1.3.m2.2.2.1.2.cmml" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.2"></times><apply id="S2.SS2.SSS2.p1.3.m2.2.2.1.3.cmml" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.3"><ci id="S2.SS2.SSS2.p1.3.m2.2.2.1.3.1.cmml" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.3.1">^</ci><ci id="S2.SS2.SSS2.p1.3.m2.2.2.1.3.2.cmml" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.3.2">𝒫</ci></apply><apply id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.2">𝜽</ci><ci id="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.3.m2.2.2.1.1.1.1.3">𝒙</ci></apply></apply><apply id="S2.SS2.SSS2.p1.3.m2.3.3.2.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2"><times id="S2.SS2.SSS2.p1.3.m2.3.3.2.2.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.2"></times><apply id="S2.SS2.SSS2.p1.3.m2.3.3.2.3.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.3.m2.3.3.2.3.1.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.3">subscript</csymbol><ci id="S2.SS2.SSS2.p1.3.m2.3.3.2.3.2.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.3.2">𝑞</ci><ci id="S2.SS2.SSS2.p1.3.m2.3.3.2.3.3.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.3.3">𝒘</ci></apply><apply id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1"><csymbol cd="latexml" id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.1">conditional</csymbol><ci id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.2">𝒙</ci><ci id="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.1.1.1.3">𝜽</ci></apply><ci id="S2.SS2.SSS2.p1.3.m2.3.3.2.4.cmml" xref="S2.SS2.SSS2.p1.3.m2.3.3.2.4">𝑝</ci><ci id="S2.SS2.SSS2.p1.3.m2.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m2.1.1">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.3.m2.3c">\hat{\mathcal{P}}(\bm{\theta}|\bm{x})\propto q_{\bm{w}}(\bm{x}|\bm{\theta})p(%
\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.3.m2.3d">over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x ) ∝ italic_q start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_x | bold_italic_θ ) italic_p ( bold_italic_θ )</annotation></semantics></math>. Generating samples from the posterior is then simply a matter of using this proxy in running Markov chain Monte Carlo <cite class="ltx_cite ltx_citemacro_citep">(MCMC; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx63" title="">Robert <em class="ltx_emph ltx_font_italic">et al.</em>(1999)Robert, Casella, and Casella</a>)</cite> or Variational Inference <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx64" title="">Blei <em class="ltx_emph ltx_font_italic">et al.</em>(2017)Blei, Kucukelbir, and McAuliffe</a>)</cite>. For example, in Metropolis-Hastings MCMC <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx65" title="">Robert <em class="ltx_emph ltx_font_italic">et al.</em>(2004)Robert, Casella, Robert, and Casella</a>)</cite>, the learned likelihood and assumed prior can be used to calculate the acceptance probability of a transition <math alttext="\bm{\theta}_{t}\rightarrow\bm{\theta}^{\prime}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.4.m3.1"><semantics id="S2.SS2.SSS2.p1.4.m3.1a"><mrow id="S2.SS2.SSS2.p1.4.m3.1.1" xref="S2.SS2.SSS2.p1.4.m3.1.1.cmml"><msub id="S2.SS2.SSS2.p1.4.m3.1.1.2" xref="S2.SS2.SSS2.p1.4.m3.1.1.2.cmml"><mi id="S2.SS2.SSS2.p1.4.m3.1.1.2.2" xref="S2.SS2.SSS2.p1.4.m3.1.1.2.2.cmml">𝜽</mi><mi id="S2.SS2.SSS2.p1.4.m3.1.1.2.3" xref="S2.SS2.SSS2.p1.4.m3.1.1.2.3.cmml">t</mi></msub><mo id="S2.SS2.SSS2.p1.4.m3.1.1.1" stretchy="false" xref="S2.SS2.SSS2.p1.4.m3.1.1.1.cmml">→</mo><msup id="S2.SS2.SSS2.p1.4.m3.1.1.3" xref="S2.SS2.SSS2.p1.4.m3.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.4.m3.1.1.3.2" xref="S2.SS2.SSS2.p1.4.m3.1.1.3.2.cmml">𝜽</mi><mo id="S2.SS2.SSS2.p1.4.m3.1.1.3.3" xref="S2.SS2.SSS2.p1.4.m3.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.4.m3.1b"><apply id="S2.SS2.SSS2.p1.4.m3.1.1.cmml" xref="S2.SS2.SSS2.p1.4.m3.1.1"><ci id="S2.SS2.SSS2.p1.4.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p1.4.m3.1.1.1">→</ci><apply id="S2.SS2.SSS2.p1.4.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p1.4.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.4.m3.1.1.2.1.cmml" xref="S2.SS2.SSS2.p1.4.m3.1.1.2">subscript</csymbol><ci id="S2.SS2.SSS2.p1.4.m3.1.1.2.2.cmml" xref="S2.SS2.SSS2.p1.4.m3.1.1.2.2">𝜽</ci><ci id="S2.SS2.SSS2.p1.4.m3.1.1.2.3.cmml" xref="S2.SS2.SSS2.p1.4.m3.1.1.2.3">𝑡</ci></apply><apply id="S2.SS2.SSS2.p1.4.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p1.4.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.4.m3.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.4.m3.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS2.p1.4.m3.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.4.m3.1.1.3.2">𝜽</ci><ci id="S2.SS2.SSS2.p1.4.m3.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.4.m3.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.4.m3.1c">\bm{\theta}_{t}\rightarrow\bm{\theta}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.4.m3.1d">bold_italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT → bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> without knowledge of the full normalized posterior, <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS2.p1.4.2">i.e.,</em></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha:=\min\left(1,\frac{\mathcal{P}(\bm{\theta}^{\prime})\mathcal{P}(\bm{x}|%
\bm{\theta}^{\prime})q(\bm{\theta}^{\prime}|\bm{\theta}_{t})}{\mathcal{P}(\bm{%
\theta}_{t})\mathcal{P}(\bm{x}|\bm{\theta}_{t})q(\bm{\theta}_{t}|\bm{\theta}^{%
\prime})}\right)," class="ltx_Math" display="block" id="S2.E6.m1.9"><semantics id="S2.E6.m1.9a"><mrow id="S2.E6.m1.9.9.1" xref="S2.E6.m1.9.9.1.1.cmml"><mrow id="S2.E6.m1.9.9.1.1" xref="S2.E6.m1.9.9.1.1.cmml"><mi id="S2.E6.m1.9.9.1.1.2" xref="S2.E6.m1.9.9.1.1.2.cmml">α</mi><mo id="S2.E6.m1.9.9.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.E6.m1.9.9.1.1.1.cmml">:=</mo><mrow id="S2.E6.m1.9.9.1.1.3.2" xref="S2.E6.m1.9.9.1.1.3.1.cmml"><mi id="S2.E6.m1.7.7" xref="S2.E6.m1.7.7.cmml">min</mi><mo id="S2.E6.m1.9.9.1.1.3.2a" xref="S2.E6.m1.9.9.1.1.3.1.cmml">⁡</mo><mrow id="S2.E6.m1.9.9.1.1.3.2.1" xref="S2.E6.m1.9.9.1.1.3.1.cmml"><mo id="S2.E6.m1.9.9.1.1.3.2.1.1" xref="S2.E6.m1.9.9.1.1.3.1.cmml">(</mo><mn id="S2.E6.m1.8.8" xref="S2.E6.m1.8.8.cmml">1</mn><mo id="S2.E6.m1.9.9.1.1.3.2.1.2" xref="S2.E6.m1.9.9.1.1.3.1.cmml">,</mo><mfrac id="S2.E6.m1.6.6" xref="S2.E6.m1.6.6.cmml"><mrow id="S2.E6.m1.3.3.3" xref="S2.E6.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.3.3.3.5" xref="S2.E6.m1.3.3.3.5.cmml">𝒫</mi><mo id="S2.E6.m1.3.3.3.4" xref="S2.E6.m1.3.3.3.4.cmml">⁢</mo><mrow id="S2.E6.m1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E6.m1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.2.cmml">𝜽</mi><mo id="S2.E6.m1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S2.E6.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E6.m1.3.3.3.4a" xref="S2.E6.m1.3.3.3.4.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.3.3.3.6" xref="S2.E6.m1.3.3.3.6.cmml">𝒫</mi><mo id="S2.E6.m1.3.3.3.4b" xref="S2.E6.m1.3.3.3.4.cmml">⁢</mo><mrow id="S2.E6.m1.2.2.2.2.1" xref="S2.E6.m1.2.2.2.2.1.1.cmml"><mo id="S2.E6.m1.2.2.2.2.1.2" stretchy="false" xref="S2.E6.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E6.m1.2.2.2.2.1.1" xref="S2.E6.m1.2.2.2.2.1.1.cmml"><mi id="S2.E6.m1.2.2.2.2.1.1.2" xref="S2.E6.m1.2.2.2.2.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.E6.m1.2.2.2.2.1.1.1" xref="S2.E6.m1.2.2.2.2.1.1.1.cmml">|</mo><msup id="S2.E6.m1.2.2.2.2.1.1.3" xref="S2.E6.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.E6.m1.2.2.2.2.1.1.3.2" xref="S2.E6.m1.2.2.2.2.1.1.3.2.cmml">𝜽</mi><mo id="S2.E6.m1.2.2.2.2.1.1.3.3" xref="S2.E6.m1.2.2.2.2.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S2.E6.m1.2.2.2.2.1.3" stretchy="false" xref="S2.E6.m1.2.2.2.2.1.1.cmml">)</mo></mrow><mo id="S2.E6.m1.3.3.3.4c" xref="S2.E6.m1.3.3.3.4.cmml">⁢</mo><mi id="S2.E6.m1.3.3.3.7" xref="S2.E6.m1.3.3.3.7.cmml">q</mi><mo id="S2.E6.m1.3.3.3.4d" xref="S2.E6.m1.3.3.3.4.cmml">⁢</mo><mrow id="S2.E6.m1.3.3.3.3.1" xref="S2.E6.m1.3.3.3.3.1.1.cmml"><mo id="S2.E6.m1.3.3.3.3.1.2" stretchy="false" xref="S2.E6.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S2.E6.m1.3.3.3.3.1.1" xref="S2.E6.m1.3.3.3.3.1.1.cmml"><msup id="S2.E6.m1.3.3.3.3.1.1.2" xref="S2.E6.m1.3.3.3.3.1.1.2.cmml"><mi id="S2.E6.m1.3.3.3.3.1.1.2.2" xref="S2.E6.m1.3.3.3.3.1.1.2.2.cmml">𝜽</mi><mo id="S2.E6.m1.3.3.3.3.1.1.2.3" xref="S2.E6.m1.3.3.3.3.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S2.E6.m1.3.3.3.3.1.1.1" xref="S2.E6.m1.3.3.3.3.1.1.1.cmml">|</mo><msub id="S2.E6.m1.3.3.3.3.1.1.3" xref="S2.E6.m1.3.3.3.3.1.1.3.cmml"><mi id="S2.E6.m1.3.3.3.3.1.1.3.2" xref="S2.E6.m1.3.3.3.3.1.1.3.2.cmml">𝜽</mi><mi id="S2.E6.m1.3.3.3.3.1.1.3.3" xref="S2.E6.m1.3.3.3.3.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E6.m1.3.3.3.3.1.3" stretchy="false" xref="S2.E6.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E6.m1.6.6.6" xref="S2.E6.m1.6.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.6.6.6.5" xref="S2.E6.m1.6.6.6.5.cmml">𝒫</mi><mo id="S2.E6.m1.6.6.6.4" xref="S2.E6.m1.6.6.6.4.cmml">⁢</mo><mrow id="S2.E6.m1.4.4.4.1.1" xref="S2.E6.m1.4.4.4.1.1.1.cmml"><mo id="S2.E6.m1.4.4.4.1.1.2" stretchy="false" xref="S2.E6.m1.4.4.4.1.1.1.cmml">(</mo><msub id="S2.E6.m1.4.4.4.1.1.1" xref="S2.E6.m1.4.4.4.1.1.1.cmml"><mi id="S2.E6.m1.4.4.4.1.1.1.2" xref="S2.E6.m1.4.4.4.1.1.1.2.cmml">𝜽</mi><mi id="S2.E6.m1.4.4.4.1.1.1.3" xref="S2.E6.m1.4.4.4.1.1.1.3.cmml">t</mi></msub><mo id="S2.E6.m1.4.4.4.1.1.3" stretchy="false" xref="S2.E6.m1.4.4.4.1.1.1.cmml">)</mo></mrow><mo id="S2.E6.m1.6.6.6.4a" xref="S2.E6.m1.6.6.6.4.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.6.6.6.6" xref="S2.E6.m1.6.6.6.6.cmml">𝒫</mi><mo id="S2.E6.m1.6.6.6.4b" xref="S2.E6.m1.6.6.6.4.cmml">⁢</mo><mrow id="S2.E6.m1.5.5.5.2.1" xref="S2.E6.m1.5.5.5.2.1.1.cmml"><mo id="S2.E6.m1.5.5.5.2.1.2" stretchy="false" xref="S2.E6.m1.5.5.5.2.1.1.cmml">(</mo><mrow id="S2.E6.m1.5.5.5.2.1.1" xref="S2.E6.m1.5.5.5.2.1.1.cmml"><mi id="S2.E6.m1.5.5.5.2.1.1.2" xref="S2.E6.m1.5.5.5.2.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.E6.m1.5.5.5.2.1.1.1" xref="S2.E6.m1.5.5.5.2.1.1.1.cmml">|</mo><msub id="S2.E6.m1.5.5.5.2.1.1.3" xref="S2.E6.m1.5.5.5.2.1.1.3.cmml"><mi id="S2.E6.m1.5.5.5.2.1.1.3.2" xref="S2.E6.m1.5.5.5.2.1.1.3.2.cmml">𝜽</mi><mi id="S2.E6.m1.5.5.5.2.1.1.3.3" xref="S2.E6.m1.5.5.5.2.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E6.m1.5.5.5.2.1.3" stretchy="false" xref="S2.E6.m1.5.5.5.2.1.1.cmml">)</mo></mrow><mo id="S2.E6.m1.6.6.6.4c" xref="S2.E6.m1.6.6.6.4.cmml">⁢</mo><mi id="S2.E6.m1.6.6.6.7" xref="S2.E6.m1.6.6.6.7.cmml">q</mi><mo id="S2.E6.m1.6.6.6.4d" xref="S2.E6.m1.6.6.6.4.cmml">⁢</mo><mrow id="S2.E6.m1.6.6.6.3.1" xref="S2.E6.m1.6.6.6.3.1.1.cmml"><mo id="S2.E6.m1.6.6.6.3.1.2" stretchy="false" xref="S2.E6.m1.6.6.6.3.1.1.cmml">(</mo><mrow id="S2.E6.m1.6.6.6.3.1.1" xref="S2.E6.m1.6.6.6.3.1.1.cmml"><msub id="S2.E6.m1.6.6.6.3.1.1.2" xref="S2.E6.m1.6.6.6.3.1.1.2.cmml"><mi id="S2.E6.m1.6.6.6.3.1.1.2.2" xref="S2.E6.m1.6.6.6.3.1.1.2.2.cmml">𝜽</mi><mi id="S2.E6.m1.6.6.6.3.1.1.2.3" xref="S2.E6.m1.6.6.6.3.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.E6.m1.6.6.6.3.1.1.1" xref="S2.E6.m1.6.6.6.3.1.1.1.cmml">|</mo><msup id="S2.E6.m1.6.6.6.3.1.1.3" xref="S2.E6.m1.6.6.6.3.1.1.3.cmml"><mi id="S2.E6.m1.6.6.6.3.1.1.3.2" xref="S2.E6.m1.6.6.6.3.1.1.3.2.cmml">𝜽</mi><mo id="S2.E6.m1.6.6.6.3.1.1.3.3" xref="S2.E6.m1.6.6.6.3.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S2.E6.m1.6.6.6.3.1.3" stretchy="false" xref="S2.E6.m1.6.6.6.3.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.E6.m1.9.9.1.1.3.2.1.3" xref="S2.E6.m1.9.9.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.9.9.1.2" xref="S2.E6.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.9b"><apply id="S2.E6.m1.9.9.1.1.cmml" xref="S2.E6.m1.9.9.1"><csymbol cd="latexml" id="S2.E6.m1.9.9.1.1.1.cmml" xref="S2.E6.m1.9.9.1.1.1">assign</csymbol><ci id="S2.E6.m1.9.9.1.1.2.cmml" xref="S2.E6.m1.9.9.1.1.2">𝛼</ci><apply id="S2.E6.m1.9.9.1.1.3.1.cmml" xref="S2.E6.m1.9.9.1.1.3.2"><min id="S2.E6.m1.7.7.cmml" xref="S2.E6.m1.7.7"></min><cn id="S2.E6.m1.8.8.cmml" type="integer" xref="S2.E6.m1.8.8">1</cn><apply id="S2.E6.m1.6.6.cmml" xref="S2.E6.m1.6.6"><divide id="S2.E6.m1.6.6.7.cmml" xref="S2.E6.m1.6.6"></divide><apply id="S2.E6.m1.3.3.3.cmml" xref="S2.E6.m1.3.3.3"><times id="S2.E6.m1.3.3.3.4.cmml" xref="S2.E6.m1.3.3.3.4"></times><ci id="S2.E6.m1.3.3.3.5.cmml" xref="S2.E6.m1.3.3.3.5">𝒫</ci><apply id="S2.E6.m1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1">superscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.2">𝜽</ci><ci id="S2.E6.m1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.3">′</ci></apply><ci id="S2.E6.m1.3.3.3.6.cmml" xref="S2.E6.m1.3.3.3.6">𝒫</ci><apply id="S2.E6.m1.2.2.2.2.1.1.cmml" xref="S2.E6.m1.2.2.2.2.1"><csymbol cd="latexml" id="S2.E6.m1.2.2.2.2.1.1.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1">conditional</csymbol><ci id="S2.E6.m1.2.2.2.2.1.1.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1.2">𝒙</ci><apply id="S2.E6.m1.2.2.2.2.1.1.3.cmml" xref="S2.E6.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.3">superscript</csymbol><ci id="S2.E6.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1.3.2">𝜽</ci><ci id="S2.E6.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E6.m1.2.2.2.2.1.1.3.3">′</ci></apply></apply><ci id="S2.E6.m1.3.3.3.7.cmml" xref="S2.E6.m1.3.3.3.7">𝑞</ci><apply id="S2.E6.m1.3.3.3.3.1.1.cmml" xref="S2.E6.m1.3.3.3.3.1"><csymbol cd="latexml" id="S2.E6.m1.3.3.3.3.1.1.1.cmml" xref="S2.E6.m1.3.3.3.3.1.1.1">conditional</csymbol><apply id="S2.E6.m1.3.3.3.3.1.1.2.cmml" xref="S2.E6.m1.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.3.3.1.1.2.1.cmml" xref="S2.E6.m1.3.3.3.3.1.1.2">superscript</csymbol><ci id="S2.E6.m1.3.3.3.3.1.1.2.2.cmml" xref="S2.E6.m1.3.3.3.3.1.1.2.2">𝜽</ci><ci id="S2.E6.m1.3.3.3.3.1.1.2.3.cmml" xref="S2.E6.m1.3.3.3.3.1.1.2.3">′</ci></apply><apply id="S2.E6.m1.3.3.3.3.1.1.3.cmml" xref="S2.E6.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.3.3.1.1.3.1.cmml" xref="S2.E6.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S2.E6.m1.3.3.3.3.1.1.3.2.cmml" xref="S2.E6.m1.3.3.3.3.1.1.3.2">𝜽</ci><ci id="S2.E6.m1.3.3.3.3.1.1.3.3.cmml" xref="S2.E6.m1.3.3.3.3.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S2.E6.m1.6.6.6.cmml" xref="S2.E6.m1.6.6.6"><times id="S2.E6.m1.6.6.6.4.cmml" xref="S2.E6.m1.6.6.6.4"></times><ci id="S2.E6.m1.6.6.6.5.cmml" xref="S2.E6.m1.6.6.6.5">𝒫</ci><apply id="S2.E6.m1.4.4.4.1.1.1.cmml" xref="S2.E6.m1.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.4.1.1.1.1.cmml" xref="S2.E6.m1.4.4.4.1.1">subscript</csymbol><ci id="S2.E6.m1.4.4.4.1.1.1.2.cmml" xref="S2.E6.m1.4.4.4.1.1.1.2">𝜽</ci><ci id="S2.E6.m1.4.4.4.1.1.1.3.cmml" xref="S2.E6.m1.4.4.4.1.1.1.3">𝑡</ci></apply><ci id="S2.E6.m1.6.6.6.6.cmml" xref="S2.E6.m1.6.6.6.6">𝒫</ci><apply id="S2.E6.m1.5.5.5.2.1.1.cmml" xref="S2.E6.m1.5.5.5.2.1"><csymbol cd="latexml" id="S2.E6.m1.5.5.5.2.1.1.1.cmml" xref="S2.E6.m1.5.5.5.2.1.1.1">conditional</csymbol><ci id="S2.E6.m1.5.5.5.2.1.1.2.cmml" xref="S2.E6.m1.5.5.5.2.1.1.2">𝒙</ci><apply id="S2.E6.m1.5.5.5.2.1.1.3.cmml" xref="S2.E6.m1.5.5.5.2.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.5.5.5.2.1.1.3.1.cmml" xref="S2.E6.m1.5.5.5.2.1.1.3">subscript</csymbol><ci id="S2.E6.m1.5.5.5.2.1.1.3.2.cmml" xref="S2.E6.m1.5.5.5.2.1.1.3.2">𝜽</ci><ci id="S2.E6.m1.5.5.5.2.1.1.3.3.cmml" xref="S2.E6.m1.5.5.5.2.1.1.3.3">𝑡</ci></apply></apply><ci id="S2.E6.m1.6.6.6.7.cmml" xref="S2.E6.m1.6.6.6.7">𝑞</ci><apply id="S2.E6.m1.6.6.6.3.1.1.cmml" xref="S2.E6.m1.6.6.6.3.1"><csymbol cd="latexml" id="S2.E6.m1.6.6.6.3.1.1.1.cmml" xref="S2.E6.m1.6.6.6.3.1.1.1">conditional</csymbol><apply id="S2.E6.m1.6.6.6.3.1.1.2.cmml" xref="S2.E6.m1.6.6.6.3.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.6.6.6.3.1.1.2.1.cmml" xref="S2.E6.m1.6.6.6.3.1.1.2">subscript</csymbol><ci id="S2.E6.m1.6.6.6.3.1.1.2.2.cmml" xref="S2.E6.m1.6.6.6.3.1.1.2.2">𝜽</ci><ci id="S2.E6.m1.6.6.6.3.1.1.2.3.cmml" xref="S2.E6.m1.6.6.6.3.1.1.2.3">𝑡</ci></apply><apply id="S2.E6.m1.6.6.6.3.1.1.3.cmml" xref="S2.E6.m1.6.6.6.3.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.6.6.6.3.1.1.3.1.cmml" xref="S2.E6.m1.6.6.6.3.1.1.3">superscript</csymbol><ci id="S2.E6.m1.6.6.6.3.1.1.3.2.cmml" xref="S2.E6.m1.6.6.6.3.1.1.3.2">𝜽</ci><ci id="S2.E6.m1.6.6.6.3.1.1.3.3.cmml" xref="S2.E6.m1.6.6.6.3.1.1.3.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.9c">\alpha:=\min\left(1,\frac{\mathcal{P}(\bm{\theta}^{\prime})\mathcal{P}(\bm{x}|%
\bm{\theta}^{\prime})q(\bm{\theta}^{\prime}|\bm{\theta}_{t})}{\mathcal{P}(\bm{%
\theta}_{t})\mathcal{P}(\bm{x}|\bm{\theta}_{t})q(\bm{\theta}_{t}|\bm{\theta}^{%
\prime})}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.9d">italic_α := roman_min ( 1 , divide start_ARG caligraphic_P ( bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) caligraphic_P ( bold_italic_x | bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) italic_q ( bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | bold_italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG caligraphic_P ( bold_italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) caligraphic_P ( bold_italic_x | bold_italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) italic_q ( bold_italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS2.p1.5">where <math alttext="q(\bm{\theta}^{\prime}|\bm{\theta}_{t})" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.5.m1.1"><semantics id="S2.SS2.SSS2.p1.5.m1.1a"><mrow id="S2.SS2.SSS2.p1.5.m1.1.1" xref="S2.SS2.SSS2.p1.5.m1.1.1.cmml"><mi id="S2.SS2.SSS2.p1.5.m1.1.1.3" xref="S2.SS2.SSS2.p1.5.m1.1.1.3.cmml">q</mi><mo id="S2.SS2.SSS2.p1.5.m1.1.1.2" xref="S2.SS2.SSS2.p1.5.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.SSS2.p1.5.m1.1.1.1.1" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.cmml"><msup id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.cmml"><mi id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.2" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.2.cmml">𝜽</mi><mo id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.3" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.2" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.2.cmml">𝜽</mi><mi id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.3" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.5.m1.1b"><apply id="S2.SS2.SSS2.p1.5.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1"><times id="S2.SS2.SSS2.p1.5.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.2"></times><ci id="S2.SS2.SSS2.p1.5.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.3">𝑞</ci><apply id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.2">𝜽</ci><ci id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.2.3">′</ci></apply><apply id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.2">𝜽</ci><ci id="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.5.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.5.m1.1c">q(\bm{\theta}^{\prime}|\bm{\theta}_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.5.m1.1d">italic_q ( bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | bold_italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is the proposal mechanism. Note, the process of obtaining a posterior is identical to the explicit likelihood-based approach, but instead of an analytic likelihood function, NLE has essentially a “black box” function instead. The advantage of this method is that one only needs to perform training once for a given model, at the cost of additional sampling once data becomes available.
For instance, <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx66" title="">Jeffrey <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Jeffrey, Alsing, and Lanusse</a></cite> fit a density model for the likelihood of compressed summaries from <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS2.p1.5.1">DES SV</span> weak lensing maps. The <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS2.p1.5.2">Madminer</span> tool <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx67" title="">Brehmer <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Brehmer, Kling, Espejo, and Cranmer</a>)</cite> for particle physics notably allows for NLE using ILI tools.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.3 </span>Neural Ratio Estimation (NRE)</h4>
<div class="ltx_para" id="S2.SS2.SSS3.p1">
<p class="ltx_p" id="S2.SS2.SSS3.p1.8">As in NLE, Neural Ratio Estimation <cite class="ltx_cite ltx_citemacro_citep">(NRE; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx68" title="">Hermans <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Hermans, Begy, and Louppe</a>)</cite> targets a proxy that is proportional to the posterior. Instead of outputting a conditional density estimate for the likelihood, NRE models instead target the likelihood ratio,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r(\bm{x},\bm{\theta}):=\frac{\mathcal{P}(\bm{x}|\bm{\theta})}{\mathcal{P}(\bm{%
x}|\bm{\theta}_{0})}," class="ltx_Math" display="block" id="S2.E7.m1.5"><semantics id="S2.E7.m1.5a"><mrow id="S2.E7.m1.5.5.1" xref="S2.E7.m1.5.5.1.1.cmml"><mrow id="S2.E7.m1.5.5.1.1" xref="S2.E7.m1.5.5.1.1.cmml"><mrow id="S2.E7.m1.5.5.1.1.2" xref="S2.E7.m1.5.5.1.1.2.cmml"><mi id="S2.E7.m1.5.5.1.1.2.2" xref="S2.E7.m1.5.5.1.1.2.2.cmml">r</mi><mo id="S2.E7.m1.5.5.1.1.2.1" xref="S2.E7.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S2.E7.m1.5.5.1.1.2.3.2" xref="S2.E7.m1.5.5.1.1.2.3.1.cmml"><mo id="S2.E7.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S2.E7.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="S2.E7.m1.3.3" xref="S2.E7.m1.3.3.cmml">𝒙</mi><mo id="S2.E7.m1.5.5.1.1.2.3.2.2" xref="S2.E7.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S2.E7.m1.4.4" xref="S2.E7.m1.4.4.cmml">𝜽</mi><mo id="S2.E7.m1.5.5.1.1.2.3.2.3" rspace="0.278em" stretchy="false" xref="S2.E7.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E7.m1.5.5.1.1.1" rspace="0.278em" xref="S2.E7.m1.5.5.1.1.1.cmml">:=</mo><mfrac id="S2.E7.m1.2.2" xref="S2.E7.m1.2.2.cmml"><mrow id="S2.E7.m1.1.1.1" xref="S2.E7.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.1.1.1.3" xref="S2.E7.m1.1.1.1.3.cmml">𝒫</mi><mo id="S2.E7.m1.1.1.1.2" xref="S2.E7.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E7.m1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mo id="S2.E7.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.E7.m1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E7.m1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.E7.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E7.m1.2.2.2" xref="S2.E7.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.2.2.2.3" xref="S2.E7.m1.2.2.2.3.cmml">𝒫</mi><mo id="S2.E7.m1.2.2.2.2" xref="S2.E7.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.E7.m1.2.2.2.1.1" xref="S2.E7.m1.2.2.2.1.1.1.cmml"><mo id="S2.E7.m1.2.2.2.1.1.2" stretchy="false" xref="S2.E7.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.2.2.2.1.1.1" xref="S2.E7.m1.2.2.2.1.1.1.cmml"><mi id="S2.E7.m1.2.2.2.1.1.1.2" xref="S2.E7.m1.2.2.2.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.E7.m1.2.2.2.1.1.1.1" xref="S2.E7.m1.2.2.2.1.1.1.1.cmml">|</mo><msub id="S2.E7.m1.2.2.2.1.1.1.3" xref="S2.E7.m1.2.2.2.1.1.1.3.cmml"><mi id="S2.E7.m1.2.2.2.1.1.1.3.2" xref="S2.E7.m1.2.2.2.1.1.1.3.2.cmml">𝜽</mi><mn id="S2.E7.m1.2.2.2.1.1.1.3.3" xref="S2.E7.m1.2.2.2.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S2.E7.m1.2.2.2.1.1.3" stretchy="false" xref="S2.E7.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S2.E7.m1.5.5.1.2" xref="S2.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.5b"><apply id="S2.E7.m1.5.5.1.1.cmml" xref="S2.E7.m1.5.5.1"><csymbol cd="latexml" id="S2.E7.m1.5.5.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1">assign</csymbol><apply id="S2.E7.m1.5.5.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.2"><times id="S2.E7.m1.5.5.1.1.2.1.cmml" xref="S2.E7.m1.5.5.1.1.2.1"></times><ci id="S2.E7.m1.5.5.1.1.2.2.cmml" xref="S2.E7.m1.5.5.1.1.2.2">𝑟</ci><interval closure="open" id="S2.E7.m1.5.5.1.1.2.3.1.cmml" xref="S2.E7.m1.5.5.1.1.2.3.2"><ci id="S2.E7.m1.3.3.cmml" xref="S2.E7.m1.3.3">𝒙</ci><ci id="S2.E7.m1.4.4.cmml" xref="S2.E7.m1.4.4">𝜽</ci></interval></apply><apply id="S2.E7.m1.2.2.cmml" xref="S2.E7.m1.2.2"><divide id="S2.E7.m1.2.2.3.cmml" xref="S2.E7.m1.2.2"></divide><apply id="S2.E7.m1.1.1.1.cmml" xref="S2.E7.m1.1.1.1"><times id="S2.E7.m1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.2"></times><ci id="S2.E7.m1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.3">𝒫</ci><apply id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E7.m1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3">𝜽</ci></apply></apply><apply id="S2.E7.m1.2.2.2.cmml" xref="S2.E7.m1.2.2.2"><times id="S2.E7.m1.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2"></times><ci id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.3">𝒫</ci><apply id="S2.E7.m1.2.2.2.1.1.1.cmml" xref="S2.E7.m1.2.2.2.1.1"><csymbol cd="latexml" id="S2.E7.m1.2.2.2.1.1.1.1.cmml" xref="S2.E7.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S2.E7.m1.2.2.2.1.1.1.2.cmml" xref="S2.E7.m1.2.2.2.1.1.1.2">𝒙</ci><apply id="S2.E7.m1.2.2.2.1.1.1.3.cmml" xref="S2.E7.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.1.1.1.3.1.cmml" xref="S2.E7.m1.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E7.m1.2.2.2.1.1.1.3.2.cmml" xref="S2.E7.m1.2.2.2.1.1.1.3.2">𝜽</ci><cn id="S2.E7.m1.2.2.2.1.1.1.3.3.cmml" type="integer" xref="S2.E7.m1.2.2.2.1.1.1.3.3">0</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.5c">r(\bm{x},\bm{\theta}):=\frac{\mathcal{P}(\bm{x}|\bm{\theta})}{\mathcal{P}(\bm{%
x}|\bm{\theta}_{0})},</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.5d">italic_r ( bold_italic_x , bold_italic_θ ) := divide start_ARG caligraphic_P ( bold_italic_x | bold_italic_θ ) end_ARG start_ARG caligraphic_P ( bold_italic_x | bold_italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS3.p1.2">equal to the ratio of the likelihood at a given point in parameter space to the likelihood at a reference point, <math alttext="\bm{\theta}_{0}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.1.m1.1"><semantics id="S2.SS2.SSS3.p1.1.m1.1a"><msub id="S2.SS2.SSS3.p1.1.m1.1.1" xref="S2.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS3.p1.1.m1.1.1.2" xref="S2.SS2.SSS3.p1.1.m1.1.1.2.cmml">𝜽</mi><mn id="S2.SS2.SSS3.p1.1.m1.1.1.3" xref="S2.SS2.SSS3.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.1.m1.1b"><apply id="S2.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1.2">𝜽</ci><cn id="S2.SS2.SSS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS3.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.1.m1.1c">\bm{\theta}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.1.m1.1d">bold_italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>. This formulation is convenient because it can be folded into an acceptance ratio like Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E6" title="6 ‣ 2.2.2 Neural Likelihood Estimation (NLE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">6</span></a> and also be cast as a classification problem <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx69" title="">Cranmer <em class="ltx_emph ltx_font_italic">et al.</em>(2015)Cranmer, Pavez, and Louppe</a>)</cite>. The output of a classification network, <math alttext="d_{\bm{w}}(\bm{x},\bm{\theta})\in[0,1]" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.2.m2.4"><semantics id="S2.SS2.SSS3.p1.2.m2.4a"><mrow id="S2.SS2.SSS3.p1.2.m2.4.5" xref="S2.SS2.SSS3.p1.2.m2.4.5.cmml"><mrow id="S2.SS2.SSS3.p1.2.m2.4.5.2" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.cmml"><msub id="S2.SS2.SSS3.p1.2.m2.4.5.2.2" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.2.cmml"><mi id="S2.SS2.SSS3.p1.2.m2.4.5.2.2.2" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.2.2.cmml">d</mi><mi id="S2.SS2.SSS3.p1.2.m2.4.5.2.2.3" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.2.3.cmml">𝒘</mi></msub><mo id="S2.SS2.SSS3.p1.2.m2.4.5.2.1" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.1.cmml">⁢</mo><mrow id="S2.SS2.SSS3.p1.2.m2.4.5.2.3.2" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.3.1.cmml"><mo id="S2.SS2.SSS3.p1.2.m2.4.5.2.3.2.1" stretchy="false" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.3.1.cmml">(</mo><mi id="S2.SS2.SSS3.p1.2.m2.1.1" xref="S2.SS2.SSS3.p1.2.m2.1.1.cmml">𝒙</mi><mo id="S2.SS2.SSS3.p1.2.m2.4.5.2.3.2.2" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.3.1.cmml">,</mo><mi id="S2.SS2.SSS3.p1.2.m2.2.2" xref="S2.SS2.SSS3.p1.2.m2.2.2.cmml">𝜽</mi><mo id="S2.SS2.SSS3.p1.2.m2.4.5.2.3.2.3" stretchy="false" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.SSS3.p1.2.m2.4.5.1" xref="S2.SS2.SSS3.p1.2.m2.4.5.1.cmml">∈</mo><mrow id="S2.SS2.SSS3.p1.2.m2.4.5.3.2" xref="S2.SS2.SSS3.p1.2.m2.4.5.3.1.cmml"><mo id="S2.SS2.SSS3.p1.2.m2.4.5.3.2.1" stretchy="false" xref="S2.SS2.SSS3.p1.2.m2.4.5.3.1.cmml">[</mo><mn id="S2.SS2.SSS3.p1.2.m2.3.3" xref="S2.SS2.SSS3.p1.2.m2.3.3.cmml">0</mn><mo id="S2.SS2.SSS3.p1.2.m2.4.5.3.2.2" xref="S2.SS2.SSS3.p1.2.m2.4.5.3.1.cmml">,</mo><mn id="S2.SS2.SSS3.p1.2.m2.4.4" xref="S2.SS2.SSS3.p1.2.m2.4.4.cmml">1</mn><mo id="S2.SS2.SSS3.p1.2.m2.4.5.3.2.3" stretchy="false" xref="S2.SS2.SSS3.p1.2.m2.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.2.m2.4b"><apply id="S2.SS2.SSS3.p1.2.m2.4.5.cmml" xref="S2.SS2.SSS3.p1.2.m2.4.5"><in id="S2.SS2.SSS3.p1.2.m2.4.5.1.cmml" xref="S2.SS2.SSS3.p1.2.m2.4.5.1"></in><apply id="S2.SS2.SSS3.p1.2.m2.4.5.2.cmml" xref="S2.SS2.SSS3.p1.2.m2.4.5.2"><times id="S2.SS2.SSS3.p1.2.m2.4.5.2.1.cmml" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.1"></times><apply id="S2.SS2.SSS3.p1.2.m2.4.5.2.2.cmml" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.2.m2.4.5.2.2.1.cmml" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.2">subscript</csymbol><ci id="S2.SS2.SSS3.p1.2.m2.4.5.2.2.2.cmml" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.2.2">𝑑</ci><ci id="S2.SS2.SSS3.p1.2.m2.4.5.2.2.3.cmml" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.2.3">𝒘</ci></apply><interval closure="open" id="S2.SS2.SSS3.p1.2.m2.4.5.2.3.1.cmml" xref="S2.SS2.SSS3.p1.2.m2.4.5.2.3.2"><ci id="S2.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS3.p1.2.m2.1.1">𝒙</ci><ci id="S2.SS2.SSS3.p1.2.m2.2.2.cmml" xref="S2.SS2.SSS3.p1.2.m2.2.2">𝜽</ci></interval></apply><interval closure="closed" id="S2.SS2.SSS3.p1.2.m2.4.5.3.1.cmml" xref="S2.SS2.SSS3.p1.2.m2.4.5.3.2"><cn id="S2.SS2.SSS3.p1.2.m2.3.3.cmml" type="integer" xref="S2.SS2.SSS3.p1.2.m2.3.3">0</cn><cn id="S2.SS2.SSS3.p1.2.m2.4.4.cmml" type="integer" xref="S2.SS2.SSS3.p1.2.m2.4.4">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.2.m2.4c">d_{\bm{w}}(\bm{x},\bm{\theta})\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.2.m2.4d">italic_d start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_θ ) ∈ [ 0 , 1 ]</annotation></semantics></math>, can be considered equivalent to a likelihood ratio as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{r}(\bm{x},\bm{\theta})=\frac{d_{\bm{w}}(\bm{x},\bm{\theta})}{1-d_{\bm{w}}%
(\bm{x},\bm{\theta})}." class="ltx_Math" display="block" id="S2.E8.m1.7"><semantics id="S2.E8.m1.7a"><mrow id="S2.E8.m1.7.7.1" xref="S2.E8.m1.7.7.1.1.cmml"><mrow id="S2.E8.m1.7.7.1.1" xref="S2.E8.m1.7.7.1.1.cmml"><mrow id="S2.E8.m1.7.7.1.1.2" xref="S2.E8.m1.7.7.1.1.2.cmml"><mover accent="true" id="S2.E8.m1.7.7.1.1.2.2" xref="S2.E8.m1.7.7.1.1.2.2.cmml"><mi id="S2.E8.m1.7.7.1.1.2.2.2" xref="S2.E8.m1.7.7.1.1.2.2.2.cmml">r</mi><mo id="S2.E8.m1.7.7.1.1.2.2.1" xref="S2.E8.m1.7.7.1.1.2.2.1.cmml">^</mo></mover><mo id="S2.E8.m1.7.7.1.1.2.1" xref="S2.E8.m1.7.7.1.1.2.1.cmml">⁢</mo><mrow id="S2.E8.m1.7.7.1.1.2.3.2" xref="S2.E8.m1.7.7.1.1.2.3.1.cmml"><mo id="S2.E8.m1.7.7.1.1.2.3.2.1" stretchy="false" xref="S2.E8.m1.7.7.1.1.2.3.1.cmml">(</mo><mi id="S2.E8.m1.5.5" xref="S2.E8.m1.5.5.cmml">𝒙</mi><mo id="S2.E8.m1.7.7.1.1.2.3.2.2" xref="S2.E8.m1.7.7.1.1.2.3.1.cmml">,</mo><mi id="S2.E8.m1.6.6" xref="S2.E8.m1.6.6.cmml">𝜽</mi><mo id="S2.E8.m1.7.7.1.1.2.3.2.3" stretchy="false" xref="S2.E8.m1.7.7.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E8.m1.7.7.1.1.1" xref="S2.E8.m1.7.7.1.1.1.cmml">=</mo><mfrac id="S2.E8.m1.4.4" xref="S2.E8.m1.4.4.cmml"><mrow id="S2.E8.m1.2.2.2" xref="S2.E8.m1.2.2.2.cmml"><msub id="S2.E8.m1.2.2.2.4" xref="S2.E8.m1.2.2.2.4.cmml"><mi id="S2.E8.m1.2.2.2.4.2" xref="S2.E8.m1.2.2.2.4.2.cmml">d</mi><mi id="S2.E8.m1.2.2.2.4.3" xref="S2.E8.m1.2.2.2.4.3.cmml">𝒘</mi></msub><mo id="S2.E8.m1.2.2.2.3" xref="S2.E8.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E8.m1.2.2.2.5.2" xref="S2.E8.m1.2.2.2.5.1.cmml"><mo id="S2.E8.m1.2.2.2.5.2.1" stretchy="false" xref="S2.E8.m1.2.2.2.5.1.cmml">(</mo><mi id="S2.E8.m1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml">𝒙</mi><mo id="S2.E8.m1.2.2.2.5.2.2" xref="S2.E8.m1.2.2.2.5.1.cmml">,</mo><mi id="S2.E8.m1.2.2.2.2" xref="S2.E8.m1.2.2.2.2.cmml">𝜽</mi><mo id="S2.E8.m1.2.2.2.5.2.3" stretchy="false" xref="S2.E8.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow><mrow id="S2.E8.m1.4.4.4" xref="S2.E8.m1.4.4.4.cmml"><mn id="S2.E8.m1.4.4.4.4" xref="S2.E8.m1.4.4.4.4.cmml">1</mn><mo id="S2.E8.m1.4.4.4.3" xref="S2.E8.m1.4.4.4.3.cmml">−</mo><mrow id="S2.E8.m1.4.4.4.5" xref="S2.E8.m1.4.4.4.5.cmml"><msub id="S2.E8.m1.4.4.4.5.2" xref="S2.E8.m1.4.4.4.5.2.cmml"><mi id="S2.E8.m1.4.4.4.5.2.2" xref="S2.E8.m1.4.4.4.5.2.2.cmml">d</mi><mi id="S2.E8.m1.4.4.4.5.2.3" xref="S2.E8.m1.4.4.4.5.2.3.cmml">𝒘</mi></msub><mo id="S2.E8.m1.4.4.4.5.1" xref="S2.E8.m1.4.4.4.5.1.cmml">⁢</mo><mrow id="S2.E8.m1.4.4.4.5.3.2" xref="S2.E8.m1.4.4.4.5.3.1.cmml"><mo id="S2.E8.m1.4.4.4.5.3.2.1" stretchy="false" xref="S2.E8.m1.4.4.4.5.3.1.cmml">(</mo><mi id="S2.E8.m1.3.3.3.1" xref="S2.E8.m1.3.3.3.1.cmml">𝒙</mi><mo id="S2.E8.m1.4.4.4.5.3.2.2" xref="S2.E8.m1.4.4.4.5.3.1.cmml">,</mo><mi id="S2.E8.m1.4.4.4.2" xref="S2.E8.m1.4.4.4.2.cmml">𝜽</mi><mo id="S2.E8.m1.4.4.4.5.3.2.3" stretchy="false" xref="S2.E8.m1.4.4.4.5.3.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S2.E8.m1.7.7.1.2" lspace="0em" xref="S2.E8.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.7b"><apply id="S2.E8.m1.7.7.1.1.cmml" xref="S2.E8.m1.7.7.1"><eq id="S2.E8.m1.7.7.1.1.1.cmml" xref="S2.E8.m1.7.7.1.1.1"></eq><apply id="S2.E8.m1.7.7.1.1.2.cmml" xref="S2.E8.m1.7.7.1.1.2"><times id="S2.E8.m1.7.7.1.1.2.1.cmml" xref="S2.E8.m1.7.7.1.1.2.1"></times><apply id="S2.E8.m1.7.7.1.1.2.2.cmml" xref="S2.E8.m1.7.7.1.1.2.2"><ci id="S2.E8.m1.7.7.1.1.2.2.1.cmml" xref="S2.E8.m1.7.7.1.1.2.2.1">^</ci><ci id="S2.E8.m1.7.7.1.1.2.2.2.cmml" xref="S2.E8.m1.7.7.1.1.2.2.2">𝑟</ci></apply><interval closure="open" id="S2.E8.m1.7.7.1.1.2.3.1.cmml" xref="S2.E8.m1.7.7.1.1.2.3.2"><ci id="S2.E8.m1.5.5.cmml" xref="S2.E8.m1.5.5">𝒙</ci><ci id="S2.E8.m1.6.6.cmml" xref="S2.E8.m1.6.6">𝜽</ci></interval></apply><apply id="S2.E8.m1.4.4.cmml" xref="S2.E8.m1.4.4"><divide id="S2.E8.m1.4.4.5.cmml" xref="S2.E8.m1.4.4"></divide><apply id="S2.E8.m1.2.2.2.cmml" xref="S2.E8.m1.2.2.2"><times id="S2.E8.m1.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.3"></times><apply id="S2.E8.m1.2.2.2.4.cmml" xref="S2.E8.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.4.1.cmml" xref="S2.E8.m1.2.2.2.4">subscript</csymbol><ci id="S2.E8.m1.2.2.2.4.2.cmml" xref="S2.E8.m1.2.2.2.4.2">𝑑</ci><ci id="S2.E8.m1.2.2.2.4.3.cmml" xref="S2.E8.m1.2.2.2.4.3">𝒘</ci></apply><interval closure="open" id="S2.E8.m1.2.2.2.5.1.cmml" xref="S2.E8.m1.2.2.2.5.2"><ci id="S2.E8.m1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1">𝒙</ci><ci id="S2.E8.m1.2.2.2.2.cmml" xref="S2.E8.m1.2.2.2.2">𝜽</ci></interval></apply><apply id="S2.E8.m1.4.4.4.cmml" xref="S2.E8.m1.4.4.4"><minus id="S2.E8.m1.4.4.4.3.cmml" xref="S2.E8.m1.4.4.4.3"></minus><cn id="S2.E8.m1.4.4.4.4.cmml" type="integer" xref="S2.E8.m1.4.4.4.4">1</cn><apply id="S2.E8.m1.4.4.4.5.cmml" xref="S2.E8.m1.4.4.4.5"><times id="S2.E8.m1.4.4.4.5.1.cmml" xref="S2.E8.m1.4.4.4.5.1"></times><apply id="S2.E8.m1.4.4.4.5.2.cmml" xref="S2.E8.m1.4.4.4.5.2"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.4.5.2.1.cmml" xref="S2.E8.m1.4.4.4.5.2">subscript</csymbol><ci id="S2.E8.m1.4.4.4.5.2.2.cmml" xref="S2.E8.m1.4.4.4.5.2.2">𝑑</ci><ci id="S2.E8.m1.4.4.4.5.2.3.cmml" xref="S2.E8.m1.4.4.4.5.2.3">𝒘</ci></apply><interval closure="open" id="S2.E8.m1.4.4.4.5.3.1.cmml" xref="S2.E8.m1.4.4.4.5.3.2"><ci id="S2.E8.m1.3.3.3.1.cmml" xref="S2.E8.m1.3.3.3.1">𝒙</ci><ci id="S2.E8.m1.4.4.4.2.cmml" xref="S2.E8.m1.4.4.4.2">𝜽</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.7c">\hat{r}(\bm{x},\bm{\theta})=\frac{d_{\bm{w}}(\bm{x},\bm{\theta})}{1-d_{\bm{w}}%
(\bm{x},\bm{\theta})}.</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.7d">over^ start_ARG italic_r end_ARG ( bold_italic_x , bold_italic_θ ) = divide start_ARG italic_d start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_θ ) end_ARG start_ARG 1 - italic_d start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_θ ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS3.p1.4">The classification problem can be interpreted as quantifying whether observed data <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.3.m1.1"><semantics id="S2.SS2.SSS3.p1.3.m1.1a"><mi id="S2.SS2.SSS3.p1.3.m1.1.1" xref="S2.SS2.SSS3.p1.3.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.3.m1.1b"><ci id="S2.SS2.SSS3.p1.3.m1.1.1.cmml" xref="S2.SS2.SSS3.p1.3.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.3.m1.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.3.m1.1d">bold_italic_x</annotation></semantics></math> is consistent with <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.4.m2.1"><semantics id="S2.SS2.SSS3.p1.4.m2.1a"><mi id="S2.SS2.SSS3.p1.4.m2.1.1" xref="S2.SS2.SSS3.p1.4.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.4.m2.1b"><ci id="S2.SS2.SSS3.p1.4.m2.1.1.cmml" xref="S2.SS2.SSS3.p1.4.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.4.m2.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.4.m2.1d">bold_italic_θ</annotation></semantics></math>. We can then train this neural network model using the loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\rm NRE}:=\mathbb{E}_{\mathcal{D}_{\rm train}}\left[d_{\bm{w}}(%
\bm{x},\bm{\theta})+\mathbb{E}_{\bm{\theta}^{\prime}\sim p(\bm{\theta})}\left[%
1-d_{\bm{w}}(\bm{x},\bm{\theta}^{\prime})\right]\right]," class="ltx_Math" display="block" id="S2.E9.m1.5"><semantics id="S2.E9.m1.5a"><mrow id="S2.E9.m1.5.5.1" xref="S2.E9.m1.5.5.1.1.cmml"><mrow id="S2.E9.m1.5.5.1.1" xref="S2.E9.m1.5.5.1.1.cmml"><msub id="S2.E9.m1.5.5.1.1.3" xref="S2.E9.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E9.m1.5.5.1.1.3.2" xref="S2.E9.m1.5.5.1.1.3.2.cmml">ℒ</mi><mi id="S2.E9.m1.5.5.1.1.3.3" xref="S2.E9.m1.5.5.1.1.3.3.cmml">NRE</mi></msub><mo id="S2.E9.m1.5.5.1.1.2" lspace="0.278em" rspace="0.278em" xref="S2.E9.m1.5.5.1.1.2.cmml">:=</mo><mrow id="S2.E9.m1.5.5.1.1.1" xref="S2.E9.m1.5.5.1.1.1.cmml"><msub id="S2.E9.m1.5.5.1.1.1.3" xref="S2.E9.m1.5.5.1.1.1.3.cmml"><mi id="S2.E9.m1.5.5.1.1.1.3.2" xref="S2.E9.m1.5.5.1.1.1.3.2.cmml">𝔼</mi><msub id="S2.E9.m1.5.5.1.1.1.3.3" xref="S2.E9.m1.5.5.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E9.m1.5.5.1.1.1.3.3.2" xref="S2.E9.m1.5.5.1.1.1.3.3.2.cmml">𝒟</mi><mi id="S2.E9.m1.5.5.1.1.1.3.3.3" xref="S2.E9.m1.5.5.1.1.1.3.3.3.cmml">train</mi></msub></msub><mo id="S2.E9.m1.5.5.1.1.1.2" xref="S2.E9.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.E9.m1.5.5.1.1.1.1.1" xref="S2.E9.m1.5.5.1.1.1.1.2.cmml"><mo id="S2.E9.m1.5.5.1.1.1.1.1.2" xref="S2.E9.m1.5.5.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E9.m1.5.5.1.1.1.1.1.1" xref="S2.E9.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S2.E9.m1.5.5.1.1.1.1.1.1.3" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.cmml"><msub id="S2.E9.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">d</mi><mi id="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.3" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.3.cmml">𝒘</mi></msub><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.3.1" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E9.m1.5.5.1.1.1.1.1.1.3.3.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.3.1.cmml"><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S2.E9.m1.2.2" xref="S2.E9.m1.2.2.cmml">𝒙</mi><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.3.3.2.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S2.E9.m1.3.3" xref="S2.E9.m1.3.3.cmml">𝜽</mi><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.E9.m1.5.5.1.1.1.1.1.1.1" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.cmml"><msub id="S2.E9.m1.5.5.1.1.1.1.1.1.1.3" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E9.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E9.m1.1.1.1" xref="S2.E9.m1.1.1.1.cmml"><msup id="S2.E9.m1.1.1.1.3" xref="S2.E9.m1.1.1.1.3.cmml"><mi id="S2.E9.m1.1.1.1.3.2" xref="S2.E9.m1.1.1.1.3.2.cmml">𝜽</mi><mo id="S2.E9.m1.1.1.1.3.3" xref="S2.E9.m1.1.1.1.3.3.cmml">′</mo></msup><mo id="S2.E9.m1.1.1.1.2" xref="S2.E9.m1.1.1.1.2.cmml">∼</mo><mrow id="S2.E9.m1.1.1.1.4" xref="S2.E9.m1.1.1.1.4.cmml"><mi id="S2.E9.m1.1.1.1.4.2" xref="S2.E9.m1.1.1.1.4.2.cmml">p</mi><mo id="S2.E9.m1.1.1.1.4.1" xref="S2.E9.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S2.E9.m1.1.1.1.4.3.2" xref="S2.E9.m1.1.1.1.4.cmml"><mo id="S2.E9.m1.1.1.1.4.3.2.1" stretchy="false" xref="S2.E9.m1.1.1.1.4.cmml">(</mo><mi id="S2.E9.m1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml">𝜽</mi><mo id="S2.E9.m1.1.1.1.4.3.2.2" stretchy="false" xref="S2.E9.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">d</mi><mi id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝒘</mi></msub><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E9.m1.4.4" xref="S2.E9.m1.4.4.cmml">𝒙</mi><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msup id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E9.m1.5.5.1.1.1.1.1.3" xref="S2.E9.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E9.m1.5.5.1.2" xref="S2.E9.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.5b"><apply id="S2.E9.m1.5.5.1.1.cmml" xref="S2.E9.m1.5.5.1"><csymbol cd="latexml" id="S2.E9.m1.5.5.1.1.2.cmml" xref="S2.E9.m1.5.5.1.1.2">assign</csymbol><apply id="S2.E9.m1.5.5.1.1.3.cmml" xref="S2.E9.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.5.5.1.1.3.1.cmml" xref="S2.E9.m1.5.5.1.1.3">subscript</csymbol><ci id="S2.E9.m1.5.5.1.1.3.2.cmml" xref="S2.E9.m1.5.5.1.1.3.2">ℒ</ci><ci id="S2.E9.m1.5.5.1.1.3.3.cmml" xref="S2.E9.m1.5.5.1.1.3.3">NRE</ci></apply><apply id="S2.E9.m1.5.5.1.1.1.cmml" xref="S2.E9.m1.5.5.1.1.1"><times id="S2.E9.m1.5.5.1.1.1.2.cmml" xref="S2.E9.m1.5.5.1.1.1.2"></times><apply id="S2.E9.m1.5.5.1.1.1.3.cmml" xref="S2.E9.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.5.5.1.1.1.3.1.cmml" xref="S2.E9.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S2.E9.m1.5.5.1.1.1.3.2.cmml" xref="S2.E9.m1.5.5.1.1.1.3.2">𝔼</ci><apply id="S2.E9.m1.5.5.1.1.1.3.3.cmml" xref="S2.E9.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.5.5.1.1.1.3.3.1.cmml" xref="S2.E9.m1.5.5.1.1.1.3.3">subscript</csymbol><ci id="S2.E9.m1.5.5.1.1.1.3.3.2.cmml" xref="S2.E9.m1.5.5.1.1.1.3.3.2">𝒟</ci><ci id="S2.E9.m1.5.5.1.1.1.3.3.3.cmml" xref="S2.E9.m1.5.5.1.1.1.3.3.3">train</ci></apply></apply><apply id="S2.E9.m1.5.5.1.1.1.1.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S2.E9.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E9.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1"><plus id="S2.E9.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.2"></plus><apply id="S2.E9.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3"><times id="S2.E9.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.1"></times><apply id="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.2">𝑑</ci><ci id="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.2.3">𝒘</ci></apply><interval closure="open" id="S2.E9.m1.5.5.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.3.3.2"><ci id="S2.E9.m1.2.2.cmml" xref="S2.E9.m1.2.2">𝒙</ci><ci id="S2.E9.m1.3.3.cmml" xref="S2.E9.m1.3.3">𝜽</ci></interval></apply><apply id="S2.E9.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1"><times id="S2.E9.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.2"></times><apply id="S2.E9.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E9.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.3.2">𝔼</ci><apply id="S2.E9.m1.1.1.1.cmml" xref="S2.E9.m1.1.1.1"><csymbol cd="latexml" id="S2.E9.m1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.2">similar-to</csymbol><apply id="S2.E9.m1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.1.3">superscript</csymbol><ci id="S2.E9.m1.1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.1.3.2">𝜽</ci><ci id="S2.E9.m1.1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.1.3.3">′</ci></apply><apply id="S2.E9.m1.1.1.1.4.cmml" xref="S2.E9.m1.1.1.1.4"><times id="S2.E9.m1.1.1.1.4.1.cmml" xref="S2.E9.m1.1.1.1.4.1"></times><ci id="S2.E9.m1.1.1.1.4.2.cmml" xref="S2.E9.m1.1.1.1.4.2">𝑝</ci><ci id="S2.E9.m1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1">𝜽</ci></apply></apply></apply><apply id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1"><minus id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"></minus><cn id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">1</cn><apply id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3">𝒘</ci></apply><interval closure="open" id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E9.m1.4.4.cmml" xref="S2.E9.m1.4.4">𝒙</ci><apply id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝜽</ci><ci id="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.5c">\mathcal{L}_{\rm NRE}:=\mathbb{E}_{\mathcal{D}_{\rm train}}\left[d_{\bm{w}}(%
\bm{x},\bm{\theta})+\mathbb{E}_{\bm{\theta}^{\prime}\sim p(\bm{\theta})}\left[%
1-d_{\bm{w}}(\bm{x},\bm{\theta}^{\prime})\right]\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.5d">caligraphic_L start_POSTSUBSCRIPT roman_NRE end_POSTSUBSCRIPT := blackboard_E start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_d start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_θ ) + blackboard_E start_POSTSUBSCRIPT bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_p ( bold_italic_θ ) end_POSTSUBSCRIPT [ 1 - italic_d start_POSTSUBSCRIPT bold_italic_w end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS3.p1.7">wherein we associate a positive classification with assigning a data <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.5.m1.1"><semantics id="S2.SS2.SSS3.p1.5.m1.1a"><mi id="S2.SS2.SSS3.p1.5.m1.1.1" xref="S2.SS2.SSS3.p1.5.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.5.m1.1b"><ci id="S2.SS2.SSS3.p1.5.m1.1.1.cmml" xref="S2.SS2.SSS3.p1.5.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.5.m1.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.5.m1.1d">bold_italic_x</annotation></semantics></math> to the correct <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.6.m2.1"><semantics id="S2.SS2.SSS3.p1.6.m2.1a"><mi id="S2.SS2.SSS3.p1.6.m2.1.1" xref="S2.SS2.SSS3.p1.6.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.6.m2.1b"><ci id="S2.SS2.SSS3.p1.6.m2.1.1.cmml" xref="S2.SS2.SSS3.p1.6.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.6.m2.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.6.m2.1d">bold_italic_θ</annotation></semantics></math>, and a negative classification with those assigning data to a <math alttext="\bm{\theta}^{\prime}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.7.m3.1"><semantics id="S2.SS2.SSS3.p1.7.m3.1a"><msup id="S2.SS2.SSS3.p1.7.m3.1.1" xref="S2.SS2.SSS3.p1.7.m3.1.1.cmml"><mi id="S2.SS2.SSS3.p1.7.m3.1.1.2" xref="S2.SS2.SSS3.p1.7.m3.1.1.2.cmml">𝜽</mi><mo id="S2.SS2.SSS3.p1.7.m3.1.1.3" xref="S2.SS2.SSS3.p1.7.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.7.m3.1b"><apply id="S2.SS2.SSS3.p1.7.m3.1.1.cmml" xref="S2.SS2.SSS3.p1.7.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.7.m3.1.1.1.cmml" xref="S2.SS2.SSS3.p1.7.m3.1.1">superscript</csymbol><ci id="S2.SS2.SSS3.p1.7.m3.1.1.2.cmml" xref="S2.SS2.SSS3.p1.7.m3.1.1.2">𝜽</ci><ci id="S2.SS2.SSS3.p1.7.m3.1.1.3.cmml" xref="S2.SS2.SSS3.p1.7.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.7.m3.1c">\bm{\theta}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.7.m3.1d">bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> sampled from the prior.
The main benefit of NRE over NPE and NLE is that one need not specify an approximating distribution such as MDNs or normalizing flows to emulate a posterior. The complexity is purely limited in terms of the depth and design of the neural architecture. Among others, <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx70" title="">Cole <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Cole, Miller, Witte, Cai, Grootes, Nattino, and Weniger</a></cite> and <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx71" title="">Karchev <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Karchev, Trotta, and Weniger</a></cite> applied a variation of NRE (namely Truncated Marginal NRE, <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx72" title="">Miller <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Miller, Cole, Forré, Louppe, and Weniger</a></cite>) to CMB data and Supernova data, respectively. Additionally, <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx73" title="">Delaunoy <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Delaunoy, Wehenkel, Hinderer, Nissanke, Weniger, Williamson, and Louppe</a></cite> and <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx74" title="">Bhardwaj <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Bhardwaj, Alvey, Miller, Nissanke, and Weniger</a></cite> use NRE for Gravitational Wave parameter inference.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.4 </span>Choosing an Estimator</h4>
<div class="ltx_para" id="S2.SS2.SSS4.p1">
<p class="ltx_p" id="S2.SS2.SSS4.p1.6">The optimal choice of NPE, NLE, or NRE is highly dependent on the properties on the underlying problem, the dimensionalities of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.1.m1.1"><semantics id="S2.SS2.SSS4.p1.1.m1.1a"><mi id="S2.SS2.SSS4.p1.1.m1.1.1" xref="S2.SS2.SSS4.p1.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.1.m1.1b"><ci id="S2.SS2.SSS4.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS4.p1.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.1.m1.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.1.m1.1d">bold_italic_x</annotation></semantics></math> and <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.2.m2.1"><semantics id="S2.SS2.SSS4.p1.2.m2.1a"><mi id="S2.SS2.SSS4.p1.2.m2.1.1" xref="S2.SS2.SSS4.p1.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.2.m2.1b"><ci id="S2.SS2.SSS4.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS4.p1.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.2.m2.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.2.m2.1d">bold_italic_θ</annotation></semantics></math>, and the intended application. First, the ease of learning the shape of a likelihood or posterior distribution can vary dramatically between different physical problems. For example, the shape of the unimodal posterior in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.F1" title="Figure 1 ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">1</span></a> is considerably simpler than that of the bimodal likelihood, and thus NPE will be easier to converge than NLE. However, this is the opposite for some applications presented in Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S4" title="4 Synthetic Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">4</span></a>, where the likelihood is simpler and thus NLE converges much faster than NPE or NRE. In cases where both the posterior and likelihood exhibit complicated shapes, NRE models are a strong option, as they do not require an explicit choice of NDE. Secondly, a good rule of thumb is that neural networks are easier to train when using high-dimensional input to produce low-dimensional output than vice versa. Thus, if <math alttext="\operatorname{dim}(\bm{x})" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.3.m3.2"><semantics id="S2.SS2.SSS4.p1.3.m3.2a"><mrow id="S2.SS2.SSS4.p1.3.m3.2.3.2" xref="S2.SS2.SSS4.p1.3.m3.2.3.1.cmml"><mi id="S2.SS2.SSS4.p1.3.m3.1.1" xref="S2.SS2.SSS4.p1.3.m3.1.1.cmml">dim</mi><mo id="S2.SS2.SSS4.p1.3.m3.2.3.2a" xref="S2.SS2.SSS4.p1.3.m3.2.3.1.cmml">⁡</mo><mrow id="S2.SS2.SSS4.p1.3.m3.2.3.2.1" xref="S2.SS2.SSS4.p1.3.m3.2.3.1.cmml"><mo id="S2.SS2.SSS4.p1.3.m3.2.3.2.1.1" stretchy="false" xref="S2.SS2.SSS4.p1.3.m3.2.3.1.cmml">(</mo><mi id="S2.SS2.SSS4.p1.3.m3.2.2" xref="S2.SS2.SSS4.p1.3.m3.2.2.cmml">𝒙</mi><mo id="S2.SS2.SSS4.p1.3.m3.2.3.2.1.2" stretchy="false" xref="S2.SS2.SSS4.p1.3.m3.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.3.m3.2b"><apply id="S2.SS2.SSS4.p1.3.m3.2.3.1.cmml" xref="S2.SS2.SSS4.p1.3.m3.2.3.2"><ci id="S2.SS2.SSS4.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS4.p1.3.m3.1.1">dim</ci><ci id="S2.SS2.SSS4.p1.3.m3.2.2.cmml" xref="S2.SS2.SSS4.p1.3.m3.2.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.3.m3.2c">\operatorname{dim}(\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.3.m3.2d">roman_dim ( bold_italic_x )</annotation></semantics></math> is large (<em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS4.p1.6.1">e.g.,</em> for image- or graph-like data) then NPE may work better than NLE models. Once again, NRE models are a nice middle-ground as they take in both <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.4.m4.1"><semantics id="S2.SS2.SSS4.p1.4.m4.1a"><mi id="S2.SS2.SSS4.p1.4.m4.1.1" xref="S2.SS2.SSS4.p1.4.m4.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.4.m4.1b"><ci id="S2.SS2.SSS4.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS4.p1.4.m4.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.4.m4.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.4.m4.1d">bold_italic_x</annotation></semantics></math> and <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.5.m5.1"><semantics id="S2.SS2.SSS4.p1.5.m5.1a"><mi id="S2.SS2.SSS4.p1.5.m5.1.1" xref="S2.SS2.SSS4.p1.5.m5.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.5.m5.1b"><ci id="S2.SS2.SSS4.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS4.p1.5.m5.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.5.m5.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.5.m5.1d">bold_italic_θ</annotation></semantics></math>. Note, this heuristic may be changing with the advent of diffusion generative models <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx75" title="">Song <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Song, Sohl-Dickstein, Kingma, Kumar, Ermon, and Poole</a>)</cite>, but those are not yet integrated into <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS4.p1.6.2">LtU-ILI</span>. Lastly, it is imperative to consider the downstream applications of the inference. NPE models are much better for cases in which the inference must be repeated for many test <math alttext="\bm{x}_{\rm o}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.6.m6.1"><semantics id="S2.SS2.SSS4.p1.6.m6.1a"><msub id="S2.SS2.SSS4.p1.6.m6.1.1" xref="S2.SS2.SSS4.p1.6.m6.1.1.cmml"><mi id="S2.SS2.SSS4.p1.6.m6.1.1.2" xref="S2.SS2.SSS4.p1.6.m6.1.1.2.cmml">𝒙</mi><mi id="S2.SS2.SSS4.p1.6.m6.1.1.3" mathvariant="normal" xref="S2.SS2.SSS4.p1.6.m6.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.6.m6.1b"><apply id="S2.SS2.SSS4.p1.6.m6.1.1.cmml" xref="S2.SS2.SSS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p1.6.m6.1.1.1.cmml" xref="S2.SS2.SSS4.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.SSS4.p1.6.m6.1.1.2.cmml" xref="S2.SS2.SSS4.p1.6.m6.1.1.2">𝒙</ci><ci id="S2.SS2.SSS4.p1.6.m6.1.1.3.cmml" xref="S2.SS2.SSS4.p1.6.m6.1.1.3">o</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.6.m6.1c">\bm{x}_{\rm o}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.6.m6.1d">bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT</annotation></semantics></math> (<em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS4.p1.6.3">e.g.,</em> estimating morphology for many JWST galaxies), as it can be prohibitively expensive to run MCMC chains for NLE and NRE for many test points. However, if the learned posteriors will simply be injected into a broader hierarchical likelihood sampling (<em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS4.p1.6.4">e.g.,</em> using cluster masses to constrain cosmology), NLE or NRE would be a more natural choice.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS4.p2">
<p class="ltx_p" id="S2.SS2.SSS4.p2.1">For a quantitative comparison of NPE, NLE, and NRE on machine learning benchmarks, see <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx76" title="">Lueckmann <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Lueckmann, Boelts, Greenberg, Goncalves, and Macke</a></cite>. In any case, the best way to choose a method for a new problem is to try each and perform quantitative comparisons, tests which are made considerably easier with the configuration interface in <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS4.p2.1.1">LtU-ILI</span>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Sequential Learning</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Thus far, we have phrased our problem in such a way that we first have a set of pre-run simulations, and only later do we obtain the posterior distribution given our observations. This can be the case when the simulations are particularly expensive (<em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.1">e.g.,</em> <math alttext="N" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><mi id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_N</annotation></semantics></math>-body simulations in cosmology, or Earth systems models for climate science <em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.2">e.g.,</em> from which <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx77" title="">Watson-Parris <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Watson-Parris, Williams, Deaconu, and Stier</a></cite> built emulators). In these cases, we must be careful about any difference between the proposal prior for the parameters from which the simulations were run (<em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.3">e.g.,</em> a Latin hypercube) and the chosen prior for the parameters used in the inference (<em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.4">e.g.,</em> a multivariate Gaussian). It may be the case that this proposal prior is significantly wider than the posterior distribution inferred once the real data have been observed, meaning that many of the simulations used in training for NPE/NLE/NRE have been “wasted” as the posterior has almost no support in the region of parameter space occupied by a (potentially significant) fraction of the simulations.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">One can instead adopt a multi-round inference approach to improve simulation efficiency, referred to as Sequential NPE/NLE/NRE or SNLE/SNLE/SNRE. In this method, we begin by running a fraction of the total desired simulations with parameters sampled from the broad prior, conducting the first round of training for the NPE/NLE/NRE model. This weak inference is then applied to <math alttext="\bm{x_{\rm o}}" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><msub id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">𝒙</mi><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">𝐨</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">𝒙</ci><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝐨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\bm{x_{\rm o}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT bold_o end_POSTSUBSCRIPT</annotation></semantics></math> to derive a first estimate for the posterior. The algorithm then identifies regions of high posterior density and conducts additional simulations within these areas to produce a refined posterior estimate. This can be repeated until a convergence criterion is met or the total simulation budget is exhausted. This iterative refinement of the posterior around the region of interest can lead to improved posterior estimates for a given experiment.
However, it is important to note that these results are deliberately optimized for a singular observed data point. The sampled simulations may not be appropriate for a different experiment, potentially resulting in a less accurate estimate of the posterior distribution if no further simulations are run.</p>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.1">Note that an alternative method for generating parameters of interest using acquisition functions that minimize the expected uncertainty in the posterior density approximation exists. This is based on the
Bayesian Optimization for Likelihood-Free Inference (BOLFI) framework <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx78" title="">Gutmann <em class="ltx_emph ltx_font_italic">et al.</em>(2016)Gutmann, Cor <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite> has also been suggested and applied to cosmological data <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx79" title="">Leclercq(2018)</a>)</cite>, although this is not yet part of <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.p3.1.1">LtU-ILI</span>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Validation</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.3">The goal of model validation is to assess whether the posteriors <math alttext="\hat{\mathcal{P}}(\bm{\theta}|\bm{x}_{\rm o})" class="ltx_Math" display="inline" id="S2.SS4.p1.1.m1.1"><semantics id="S2.SS4.p1.1.m1.1a"><mrow id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml"><mover accent="true" id="S2.SS4.p1.1.m1.1.1.3" xref="S2.SS4.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.1.m1.1.1.3.2" xref="S2.SS4.p1.1.m1.1.1.3.2.cmml">𝒫</mi><mo id="S2.SS4.p1.1.m1.1.1.3.1" xref="S2.SS4.p1.1.m1.1.1.3.1.cmml">^</mo></mover><mo id="S2.SS4.p1.1.m1.1.1.2" xref="S2.SS4.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS4.p1.1.m1.1.1.1.1" xref="S2.SS4.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS4.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS4.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS4.p1.1.m1.1.1.1.1.1" xref="S2.SS4.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS4.p1.1.m1.1.1.1.1.1.2" xref="S2.SS4.p1.1.m1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.SS4.p1.1.m1.1.1.1.1.1.1" xref="S2.SS4.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS4.p1.1.m1.1.1.1.1.1.3" xref="S2.SS4.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS4.p1.1.m1.1.1.1.1.1.3.2" xref="S2.SS4.p1.1.m1.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.SS4.p1.1.m1.1.1.1.1.1.3.3" mathvariant="normal" xref="S2.SS4.p1.1.m1.1.1.1.1.1.3.3.cmml">o</mi></msub></mrow><mo id="S2.SS4.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS4.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><apply id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1"><times id="S2.SS4.p1.1.m1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.1.2"></times><apply id="S2.SS4.p1.1.m1.1.1.3.cmml" xref="S2.SS4.p1.1.m1.1.1.3"><ci id="S2.SS4.p1.1.m1.1.1.3.1.cmml" xref="S2.SS4.p1.1.m1.1.1.3.1">^</ci><ci id="S2.SS4.p1.1.m1.1.1.3.2.cmml" xref="S2.SS4.p1.1.m1.1.1.3.2">𝒫</ci></apply><apply id="S2.SS4.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS4.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS4.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1.1.2">𝜽</ci><apply id="S2.SS4.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS4.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.SS4.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1.1.3.3">o</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">\hat{\mathcal{P}}(\bm{\theta}|\bm{x}_{\rm o})</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.1d">over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT )</annotation></semantics></math> learned in Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2" title="2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.2</span></a> will be accurate and reliable when applied to new data. Explicitly, we want to evaluate: (1) whether the learned posteriors are maximally constraining of <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS4.p1.2.m2.1"><semantics id="S2.SS4.p1.2.m2.1a"><mi id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><ci id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">bold_italic_θ</annotation></semantics></math> given the observed data <math alttext="\bm{x}_{\rm o}" class="ltx_Math" display="inline" id="S2.SS4.p1.3.m3.1"><semantics id="S2.SS4.p1.3.m3.1a"><msub id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml"><mi id="S2.SS4.p1.3.m3.1.1.2" xref="S2.SS4.p1.3.m3.1.1.2.cmml">𝒙</mi><mi id="S2.SS4.p1.3.m3.1.1.3" mathvariant="normal" xref="S2.SS4.p1.3.m3.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><apply id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.3.m3.1.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS4.p1.3.m3.1.1.2.cmml" xref="S2.SS4.p1.3.m3.1.1.2">𝒙</ci><ci id="S2.SS4.p1.3.m3.1.1.3.cmml" xref="S2.SS4.p1.3.m3.1.1.3">o</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">\bm{x}_{\rm o}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.3.m3.1d">bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT</annotation></semantics></math>, and (2) whether the predictive uncertainties quoted by our learned model are accurately calibrated to our training data. These two criteria are naturally adversarial, and is often referred to as the bias-variance tradeoff. For example, a model can satisfy condition (1) by reporting tight error bars, but it will then fail condition (2) when its error bars are smaller than the true distribution of training data. Similarly, a model that produces a posterior equal to the prior will easily satisfy condition (2) but will ultimately be uninformative for solving condition (1).
Despite the ‘black box’ nature of neural networks, these criteria
control the quality of the learned implicit inference posteriors, mitigating the chance that the learned model is not representative of the data used to train it.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.2">We evaluate the constraints and coverage of our learned posteriors on a labeled test set of data-parameter pairs <math alttext="\mathcal{D}_{\rm test}:=\{(\bm{x}_{i},\bm{\theta}_{i})\}_{i=1}^{N_{\rm test}}" class="ltx_Math" display="inline" id="S2.SS4.p2.1.m1.1"><semantics id="S2.SS4.p2.1.m1.1a"><mrow id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml"><msub id="S2.SS4.p2.1.m1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p2.1.m1.1.1.3.2" xref="S2.SS4.p2.1.m1.1.1.3.2.cmml">𝒟</mi><mi id="S2.SS4.p2.1.m1.1.1.3.3" xref="S2.SS4.p2.1.m1.1.1.3.3.cmml">test</mi></msub><mo id="S2.SS4.p2.1.m1.1.1.2" lspace="0.278em" rspace="0.278em" xref="S2.SS4.p2.1.m1.1.1.2.cmml">:=</mo><msubsup id="S2.SS4.p2.1.m1.1.1.1" xref="S2.SS4.p2.1.m1.1.1.1.cmml"><mrow id="S2.SS4.p2.1.m1.1.1.1.1.1.1" xref="S2.SS4.p2.1.m1.1.1.1.1.1.2.cmml"><mo id="S2.SS4.p2.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS4.p2.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.3.cmml"><mo id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.4" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">𝜽</mi><mi id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.SS4.p2.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS4.p2.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS4.p2.1.m1.1.1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.1.1.3.cmml"><mi id="S2.SS4.p2.1.m1.1.1.1.1.3.2" xref="S2.SS4.p2.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS4.p2.1.m1.1.1.1.1.3.1" xref="S2.SS4.p2.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS4.p2.1.m1.1.1.1.1.3.3" xref="S2.SS4.p2.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S2.SS4.p2.1.m1.1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.1.3.cmml"><mi id="S2.SS4.p2.1.m1.1.1.1.3.2" xref="S2.SS4.p2.1.m1.1.1.1.3.2.cmml">N</mi><mi id="S2.SS4.p2.1.m1.1.1.1.3.3" xref="S2.SS4.p2.1.m1.1.1.1.3.3.cmml">test</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><apply id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1"><csymbol cd="latexml" id="S2.SS4.p2.1.m1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.2">assign</csymbol><apply id="S2.SS4.p2.1.m1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.3.1.cmml" xref="S2.SS4.p2.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.3.2.cmml" xref="S2.SS4.p2.1.m1.1.1.3.2">𝒟</ci><ci id="S2.SS4.p2.1.m1.1.1.3.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3.3">test</ci></apply><apply id="S2.SS4.p2.1.m1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1">superscript</csymbol><apply id="S2.SS4.p2.1.m1.1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1">subscript</csymbol><set id="S2.SS4.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1"><interval closure="open" id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2"><apply id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.2">𝜽</ci><ci id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S2.SS4.p2.1.m1.1.1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.3"><eq id="S2.SS4.p2.1.m1.1.1.1.1.3.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.3.1"></eq><ci id="S2.SS4.p2.1.m1.1.1.1.1.3.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.3.2">𝑖</ci><cn id="S2.SS4.p2.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS4.p2.1.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.SS4.p2.1.m1.1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.3.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1.3">subscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.1.3.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1.3.2">𝑁</ci><ci id="S2.SS4.p2.1.m1.1.1.1.3.3.cmml" xref="S2.SS4.p2.1.m1.1.1.1.3.3">test</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">\mathcal{D}_{\rm test}:=\{(\bm{x}_{i},\bm{\theta}_{i})\}_{i=1}^{N_{\rm test}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT roman_test end_POSTSUBSCRIPT := { ( bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT roman_test end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. This test set is meant to represent a fully independent sampling of the real data distribution, unseen by the model prior to validation. This test set may originate from the same source as our labeled training set <math alttext="\mathcal{D}_{\rm train}" class="ltx_Math" display="inline" id="S2.SS4.p2.2.m2.1"><semantics id="S2.SS4.p2.2.m2.1a"><msub id="S2.SS4.p2.2.m2.1.1" xref="S2.SS4.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p2.2.m2.1.1.2" xref="S2.SS4.p2.2.m2.1.1.2.cmml">𝒟</mi><mi id="S2.SS4.p2.2.m2.1.1.3" xref="S2.SS4.p2.2.m2.1.1.3.cmml">train</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.2.m2.1b"><apply id="S2.SS4.p2.2.m2.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.2.m2.1.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p2.2.m2.1.1.2.cmml" xref="S2.SS4.p2.2.m2.1.1.2">𝒟</ci><ci id="S2.SS4.p2.2.m2.1.1.3.cmml" xref="S2.SS4.p2.2.m2.1.1.3">train</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.2.m2.1c">\mathcal{D}_{\rm train}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_train end_POSTSUBSCRIPT</annotation></semantics></math> but must be held independent to avoid overfitting and underestimation of the uncertainty (see <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx6" title="">Huppenkothen <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Huppenkothen, Ntampaka, Ho, Fouesneau, Nord, Peek, Walmsley, Wu, Avestruz, Buck <em class="ltx_emph ltx_font_italic">et al.</em></a></cite> for a review of best practices). If the distribution of data-parameter pairs in the test set matches that of the predictions of our learned posterior, then our model is calibrated and can be reliably extended to new, unlabeled data.</p>
</div>
<div class="ltx_para" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.3">We build tests by comparing the true parameters from the test set to posterior samples derived from our models. Sampling-based comparisons provide a unified framework for all NPE/NLE/NRE learning strategies since they do not require normalization of the posterior PDF. The technical details for sampling from neural networks depend on the implemented learning strategy and are discussed in more detail in Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S3.SS3" title="3.3 Validation ‣ 3 Code Structure ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">3.3</span></a>.
Here, we will assume that, for a given input <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS4.p3.1.m1.1"><semantics id="S2.SS4.p3.1.m1.1a"><mi id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b"><ci id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.1.m1.1d">bold_italic_x</annotation></semantics></math>, we can draw independent and identically distributed (i.i.d.) samples from the learned posterior distributions <math alttext="\hat{\bm{\theta}}\sim\hat{\mathcal{P}}(\bm{\theta}|\bm{x})" class="ltx_Math" display="inline" id="S2.SS4.p3.2.m2.1"><semantics id="S2.SS4.p3.2.m2.1a"><mrow id="S2.SS4.p3.2.m2.1.1" xref="S2.SS4.p3.2.m2.1.1.cmml"><mover accent="true" id="S2.SS4.p3.2.m2.1.1.3" xref="S2.SS4.p3.2.m2.1.1.3.cmml"><mi id="S2.SS4.p3.2.m2.1.1.3.2" xref="S2.SS4.p3.2.m2.1.1.3.2.cmml">𝜽</mi><mo id="S2.SS4.p3.2.m2.1.1.3.1" xref="S2.SS4.p3.2.m2.1.1.3.1.cmml">^</mo></mover><mo id="S2.SS4.p3.2.m2.1.1.2" xref="S2.SS4.p3.2.m2.1.1.2.cmml">∼</mo><mrow id="S2.SS4.p3.2.m2.1.1.1" xref="S2.SS4.p3.2.m2.1.1.1.cmml"><mover accent="true" id="S2.SS4.p3.2.m2.1.1.1.3" xref="S2.SS4.p3.2.m2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p3.2.m2.1.1.1.3.2" xref="S2.SS4.p3.2.m2.1.1.1.3.2.cmml">𝒫</mi><mo id="S2.SS4.p3.2.m2.1.1.1.3.1" xref="S2.SS4.p3.2.m2.1.1.1.3.1.cmml">^</mo></mover><mo id="S2.SS4.p3.2.m2.1.1.1.2" xref="S2.SS4.p3.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS4.p3.2.m2.1.1.1.1.1" xref="S2.SS4.p3.2.m2.1.1.1.1.1.1.cmml"><mo id="S2.SS4.p3.2.m2.1.1.1.1.1.2" stretchy="false" xref="S2.SS4.p3.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS4.p3.2.m2.1.1.1.1.1.1" xref="S2.SS4.p3.2.m2.1.1.1.1.1.1.cmml"><mi id="S2.SS4.p3.2.m2.1.1.1.1.1.1.2" xref="S2.SS4.p3.2.m2.1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.SS4.p3.2.m2.1.1.1.1.1.1.1" xref="S2.SS4.p3.2.m2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS4.p3.2.m2.1.1.1.1.1.1.3" xref="S2.SS4.p3.2.m2.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.SS4.p3.2.m2.1.1.1.1.1.3" stretchy="false" xref="S2.SS4.p3.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.2.m2.1b"><apply id="S2.SS4.p3.2.m2.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1"><csymbol cd="latexml" id="S2.SS4.p3.2.m2.1.1.2.cmml" xref="S2.SS4.p3.2.m2.1.1.2">similar-to</csymbol><apply id="S2.SS4.p3.2.m2.1.1.3.cmml" xref="S2.SS4.p3.2.m2.1.1.3"><ci id="S2.SS4.p3.2.m2.1.1.3.1.cmml" xref="S2.SS4.p3.2.m2.1.1.3.1">^</ci><ci id="S2.SS4.p3.2.m2.1.1.3.2.cmml" xref="S2.SS4.p3.2.m2.1.1.3.2">𝜽</ci></apply><apply id="S2.SS4.p3.2.m2.1.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1.1"><times id="S2.SS4.p3.2.m2.1.1.1.2.cmml" xref="S2.SS4.p3.2.m2.1.1.1.2"></times><apply id="S2.SS4.p3.2.m2.1.1.1.3.cmml" xref="S2.SS4.p3.2.m2.1.1.1.3"><ci id="S2.SS4.p3.2.m2.1.1.1.3.1.cmml" xref="S2.SS4.p3.2.m2.1.1.1.3.1">^</ci><ci id="S2.SS4.p3.2.m2.1.1.1.3.2.cmml" xref="S2.SS4.p3.2.m2.1.1.1.3.2">𝒫</ci></apply><apply id="S2.SS4.p3.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS4.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS4.p3.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.SS4.p3.2.m2.1.1.1.1.1.1.2">𝜽</ci><ci id="S2.SS4.p3.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.SS4.p3.2.m2.1.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.2.m2.1c">\hat{\bm{\theta}}\sim\hat{\mathcal{P}}(\bm{\theta}|\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.2.m2.1d">over^ start_ARG bold_italic_θ end_ARG ∼ over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x )</annotation></semantics></math>. These samples can then be used to compare the level of constraint on <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS4.p3.3.m3.1"><semantics id="S2.SS4.p3.3.m3.1a"><mi id="S2.SS4.p3.3.m3.1.1" xref="S2.SS4.p3.3.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.3.m3.1b"><ci id="S2.SS4.p3.3.m3.1.1.cmml" xref="S2.SS4.p3.3.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.3.m3.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.3.m3.1d">bold_italic_θ</annotation></semantics></math> and the consistency with the true values.</p>
</div>
<div class="ltx_para" id="S2.SS4.p4">
<p class="ltx_p" id="S2.SS4.p4.2">To test precision, which reflects the ability of a learned posterior to constrain parameter values, we examine the distribution and shape of posterior samples <math alttext="\hat{\bm{\theta}}" class="ltx_Math" display="inline" id="S2.SS4.p4.1.m1.1"><semantics id="S2.SS4.p4.1.m1.1a"><mover accent="true" id="S2.SS4.p4.1.m1.1.1" xref="S2.SS4.p4.1.m1.1.1.cmml"><mi id="S2.SS4.p4.1.m1.1.1.2" xref="S2.SS4.p4.1.m1.1.1.2.cmml">𝜽</mi><mo id="S2.SS4.p4.1.m1.1.1.1" xref="S2.SS4.p4.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.1.m1.1b"><apply id="S2.SS4.p4.1.m1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1"><ci id="S2.SS4.p4.1.m1.1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1.1">^</ci><ci id="S2.SS4.p4.1.m1.1.1.2.cmml" xref="S2.SS4.p4.1.m1.1.1.2">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.1.m1.1c">\hat{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.1.m1.1d">over^ start_ARG bold_italic_θ end_ARG</annotation></semantics></math> around the true value <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS4.p4.2.m2.1"><semantics id="S2.SS4.p4.2.m2.1a"><mi id="S2.SS4.p4.2.m2.1.1" xref="S2.SS4.p4.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.2.m2.1b"><ci id="S2.SS4.p4.2.m2.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.2.m2.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.2.m2.1d">bold_italic_θ</annotation></semantics></math>. These distributions are commonly visualized using multivariate corner plots
or marginal true vs. predicted plots.
The contours in these plots help qualitatively assess constraining power, identify posterior degeneracies, and detect systematic biases.</p>
</div>
<div class="ltx_para" id="S2.SS4.p5">
<p class="ltx_p" id="S2.SS4.p5.4">A quantitative measure of precision is the cumulative likelihood of the test dataset, denoted as <math alttext="\hat{\mathcal{P}}(\mathcal{D}_{\rm test})=\prod_{i=1}^{N_{\rm test}}\hat{%
\mathcal{P}}(\bm{\theta}_{i}|\bm{x}_{i})" class="ltx_Math" display="inline" id="S2.SS4.p5.1.m1.2"><semantics id="S2.SS4.p5.1.m1.2a"><mrow id="S2.SS4.p5.1.m1.2.2" xref="S2.SS4.p5.1.m1.2.2.cmml"><mrow id="S2.SS4.p5.1.m1.1.1.1" xref="S2.SS4.p5.1.m1.1.1.1.cmml"><mover accent="true" id="S2.SS4.p5.1.m1.1.1.1.3" xref="S2.SS4.p5.1.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p5.1.m1.1.1.1.3.2" xref="S2.SS4.p5.1.m1.1.1.1.3.2.cmml">𝒫</mi><mo id="S2.SS4.p5.1.m1.1.1.1.3.1" xref="S2.SS4.p5.1.m1.1.1.1.3.1.cmml">^</mo></mover><mo id="S2.SS4.p5.1.m1.1.1.1.2" xref="S2.SS4.p5.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS4.p5.1.m1.1.1.1.1.1" xref="S2.SS4.p5.1.m1.1.1.1.1.1.1.cmml"><mo id="S2.SS4.p5.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS4.p5.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS4.p5.1.m1.1.1.1.1.1.1" xref="S2.SS4.p5.1.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p5.1.m1.1.1.1.1.1.1.2" xref="S2.SS4.p5.1.m1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.SS4.p5.1.m1.1.1.1.1.1.1.3" xref="S2.SS4.p5.1.m1.1.1.1.1.1.1.3.cmml">test</mi></msub><mo id="S2.SS4.p5.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS4.p5.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS4.p5.1.m1.2.2.3" rspace="0.111em" xref="S2.SS4.p5.1.m1.2.2.3.cmml">=</mo><mrow id="S2.SS4.p5.1.m1.2.2.2" xref="S2.SS4.p5.1.m1.2.2.2.cmml"><msubsup id="S2.SS4.p5.1.m1.2.2.2.2" xref="S2.SS4.p5.1.m1.2.2.2.2.cmml"><mo id="S2.SS4.p5.1.m1.2.2.2.2.2.2" xref="S2.SS4.p5.1.m1.2.2.2.2.2.2.cmml">∏</mo><mrow id="S2.SS4.p5.1.m1.2.2.2.2.2.3" xref="S2.SS4.p5.1.m1.2.2.2.2.2.3.cmml"><mi id="S2.SS4.p5.1.m1.2.2.2.2.2.3.2" xref="S2.SS4.p5.1.m1.2.2.2.2.2.3.2.cmml">i</mi><mo id="S2.SS4.p5.1.m1.2.2.2.2.2.3.1" xref="S2.SS4.p5.1.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S2.SS4.p5.1.m1.2.2.2.2.2.3.3" xref="S2.SS4.p5.1.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><msub id="S2.SS4.p5.1.m1.2.2.2.2.3" xref="S2.SS4.p5.1.m1.2.2.2.2.3.cmml"><mi id="S2.SS4.p5.1.m1.2.2.2.2.3.2" xref="S2.SS4.p5.1.m1.2.2.2.2.3.2.cmml">N</mi><mi id="S2.SS4.p5.1.m1.2.2.2.2.3.3" xref="S2.SS4.p5.1.m1.2.2.2.2.3.3.cmml">test</mi></msub></msubsup><mrow id="S2.SS4.p5.1.m1.2.2.2.1" xref="S2.SS4.p5.1.m1.2.2.2.1.cmml"><mover accent="true" id="S2.SS4.p5.1.m1.2.2.2.1.3" xref="S2.SS4.p5.1.m1.2.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p5.1.m1.2.2.2.1.3.2" xref="S2.SS4.p5.1.m1.2.2.2.1.3.2.cmml">𝒫</mi><mo id="S2.SS4.p5.1.m1.2.2.2.1.3.1" xref="S2.SS4.p5.1.m1.2.2.2.1.3.1.cmml">^</mo></mover><mo id="S2.SS4.p5.1.m1.2.2.2.1.2" xref="S2.SS4.p5.1.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS4.p5.1.m1.2.2.2.1.1.1" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.cmml"><mo id="S2.SS4.p5.1.m1.2.2.2.1.1.1.2" stretchy="false" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.cmml"><msub id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.cmml"><mi id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.2" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.2.cmml">𝜽</mi><mi id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.3" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.1" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.1.cmml">|</mo><msub id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.cmml"><mi id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.2" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.3" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.SS4.p5.1.m1.2.2.2.1.1.1.3" stretchy="false" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.1.m1.2b"><apply id="S2.SS4.p5.1.m1.2.2.cmml" xref="S2.SS4.p5.1.m1.2.2"><eq id="S2.SS4.p5.1.m1.2.2.3.cmml" xref="S2.SS4.p5.1.m1.2.2.3"></eq><apply id="S2.SS4.p5.1.m1.1.1.1.cmml" xref="S2.SS4.p5.1.m1.1.1.1"><times id="S2.SS4.p5.1.m1.1.1.1.2.cmml" xref="S2.SS4.p5.1.m1.1.1.1.2"></times><apply id="S2.SS4.p5.1.m1.1.1.1.3.cmml" xref="S2.SS4.p5.1.m1.1.1.1.3"><ci id="S2.SS4.p5.1.m1.1.1.1.3.1.cmml" xref="S2.SS4.p5.1.m1.1.1.1.3.1">^</ci><ci id="S2.SS4.p5.1.m1.1.1.1.3.2.cmml" xref="S2.SS4.p5.1.m1.1.1.1.3.2">𝒫</ci></apply><apply id="S2.SS4.p5.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS4.p5.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p5.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p5.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p5.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS4.p5.1.m1.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.SS4.p5.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS4.p5.1.m1.1.1.1.1.1.1.3">test</ci></apply></apply><apply id="S2.SS4.p5.1.m1.2.2.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2"><apply id="S2.SS4.p5.1.m1.2.2.2.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p5.1.m1.2.2.2.2.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2">superscript</csymbol><apply id="S2.SS4.p5.1.m1.2.2.2.2.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p5.1.m1.2.2.2.2.2.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.SS4.p5.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.2.2">product</csymbol><apply id="S2.SS4.p5.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.2.3"><eq id="S2.SS4.p5.1.m1.2.2.2.2.2.3.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.2.3.1"></eq><ci id="S2.SS4.p5.1.m1.2.2.2.2.2.3.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.2.3.2">𝑖</ci><cn id="S2.SS4.p5.1.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S2.SS4.p5.1.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S2.SS4.p5.1.m1.2.2.2.2.3.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS4.p5.1.m1.2.2.2.2.3.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.3">subscript</csymbol><ci id="S2.SS4.p5.1.m1.2.2.2.2.3.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.3.2">𝑁</ci><ci id="S2.SS4.p5.1.m1.2.2.2.2.3.3.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.3.3">test</ci></apply></apply><apply id="S2.SS4.p5.1.m1.2.2.2.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1"><times id="S2.SS4.p5.1.m1.2.2.2.1.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.2"></times><apply id="S2.SS4.p5.1.m1.2.2.2.1.3.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.3"><ci id="S2.SS4.p5.1.m1.2.2.2.1.3.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.3.1">^</ci><ci id="S2.SS4.p5.1.m1.2.2.2.1.3.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.3.2">𝒫</ci></apply><apply id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.1">conditional</csymbol><apply id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.2">𝜽</ci><ci id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.2">𝒙</ci><ci id="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S2.SS4.p5.1.m1.2.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.1.m1.2c">\hat{\mathcal{P}}(\mathcal{D}_{\rm test})=\prod_{i=1}^{N_{\rm test}}\hat{%
\mathcal{P}}(\bm{\theta}_{i}|\bm{x}_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.1.m1.2d">over^ start_ARG caligraphic_P end_ARG ( caligraphic_D start_POSTSUBSCRIPT roman_test end_POSTSUBSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT roman_test end_POSTSUBSCRIPT end_POSTSUPERSCRIPT over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>. Larger test likelihoods indicate a model posterior that concentrates more probability mass around the true value, implying greater constraining power. The test likelihood is simple to calculate for NPE methods, which directly estimate <math alttext="\mathcal{P}(\bm{\theta}|\bm{x})" class="ltx_Math" display="inline" id="S2.SS4.p5.2.m2.1"><semantics id="S2.SS4.p5.2.m2.1a"><mrow id="S2.SS4.p5.2.m2.1.1" xref="S2.SS4.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p5.2.m2.1.1.3" xref="S2.SS4.p5.2.m2.1.1.3.cmml">𝒫</mi><mo id="S2.SS4.p5.2.m2.1.1.2" xref="S2.SS4.p5.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.SS4.p5.2.m2.1.1.1.1" xref="S2.SS4.p5.2.m2.1.1.1.1.1.cmml"><mo id="S2.SS4.p5.2.m2.1.1.1.1.2" stretchy="false" xref="S2.SS4.p5.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS4.p5.2.m2.1.1.1.1.1" xref="S2.SS4.p5.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS4.p5.2.m2.1.1.1.1.1.2" xref="S2.SS4.p5.2.m2.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.SS4.p5.2.m2.1.1.1.1.1.1" xref="S2.SS4.p5.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS4.p5.2.m2.1.1.1.1.1.3" xref="S2.SS4.p5.2.m2.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.SS4.p5.2.m2.1.1.1.1.3" stretchy="false" xref="S2.SS4.p5.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.2.m2.1b"><apply id="S2.SS4.p5.2.m2.1.1.cmml" xref="S2.SS4.p5.2.m2.1.1"><times id="S2.SS4.p5.2.m2.1.1.2.cmml" xref="S2.SS4.p5.2.m2.1.1.2"></times><ci id="S2.SS4.p5.2.m2.1.1.3.cmml" xref="S2.SS4.p5.2.m2.1.1.3">𝒫</ci><apply id="S2.SS4.p5.2.m2.1.1.1.1.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS4.p5.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS4.p5.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.1.2">𝜽</ci><ci id="S2.SS4.p5.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.2.m2.1c">\mathcal{P}(\bm{\theta}|\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.2.m2.1d">caligraphic_P ( bold_italic_θ | bold_italic_x )</annotation></semantics></math>. However, for NLE and NRE methods, evaluating the log-likelihood involves an additional step of training a generative model <math alttext="\mathcal{G}(\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS4.p5.3.m3.1"><semantics id="S2.SS4.p5.3.m3.1a"><mrow id="S2.SS4.p5.3.m3.1.2" xref="S2.SS4.p5.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p5.3.m3.1.2.2" xref="S2.SS4.p5.3.m3.1.2.2.cmml">𝒢</mi><mo id="S2.SS4.p5.3.m3.1.2.1" xref="S2.SS4.p5.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.SS4.p5.3.m3.1.2.3.2" xref="S2.SS4.p5.3.m3.1.2.cmml"><mo id="S2.SS4.p5.3.m3.1.2.3.2.1" stretchy="false" xref="S2.SS4.p5.3.m3.1.2.cmml">(</mo><mi id="S2.SS4.p5.3.m3.1.1" xref="S2.SS4.p5.3.m3.1.1.cmml">𝜽</mi><mo id="S2.SS4.p5.3.m3.1.2.3.2.2" stretchy="false" xref="S2.SS4.p5.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.3.m3.1b"><apply id="S2.SS4.p5.3.m3.1.2.cmml" xref="S2.SS4.p5.3.m3.1.2"><times id="S2.SS4.p5.3.m3.1.2.1.cmml" xref="S2.SS4.p5.3.m3.1.2.1"></times><ci id="S2.SS4.p5.3.m3.1.2.2.cmml" xref="S2.SS4.p5.3.m3.1.2.2">𝒢</ci><ci id="S2.SS4.p5.3.m3.1.1.cmml" xref="S2.SS4.p5.3.m3.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.3.m3.1c">\mathcal{G}(\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.3.m3.1d">caligraphic_G ( bold_italic_θ )</annotation></semantics></math> from the inferred posterior samples <math alttext="\hat{\bm{\theta}}" class="ltx_Math" display="inline" id="S2.SS4.p5.4.m4.1"><semantics id="S2.SS4.p5.4.m4.1a"><mover accent="true" id="S2.SS4.p5.4.m4.1.1" xref="S2.SS4.p5.4.m4.1.1.cmml"><mi id="S2.SS4.p5.4.m4.1.1.2" xref="S2.SS4.p5.4.m4.1.1.2.cmml">𝜽</mi><mo id="S2.SS4.p5.4.m4.1.1.1" xref="S2.SS4.p5.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.4.m4.1b"><apply id="S2.SS4.p5.4.m4.1.1.cmml" xref="S2.SS4.p5.4.m4.1.1"><ci id="S2.SS4.p5.4.m4.1.1.1.cmml" xref="S2.SS4.p5.4.m4.1.1.1">^</ci><ci id="S2.SS4.p5.4.m4.1.1.2.cmml" xref="S2.SS4.p5.4.m4.1.1.2">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.4.m4.1c">\hat{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.4.m4.1d">over^ start_ARG bold_italic_θ end_ARG</annotation></semantics></math>. This process is computationally expensive, especially for large datasets, and not sensitive to overconfidence.
</p>
</div>
<div class="ltx_para" id="S2.SS4.p6">
<p class="ltx_p" id="S2.SS4.p6.1">Lastly, given samples from a reference posterior, we can evaluate the discrepancy between a model’s prediction and its optimum. Reference posteriors can often be attained via long-run MCMC chains for explicit likelihood approaches, and then used to compare with ILI methods. <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx76" title="">Lueckmann <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Lueckmann, Boelts, Greenberg, Goncalves, and Macke</a></cite> performed an extensive quantitative analysis on various sample-wise distances for benchmarking ILI methods and found that Classifier 2 Sample Tests <cite class="ltx_cite ltx_citemacro_citep">(C2ST; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx80" title="">Lopez-Paz and Oquab(2016)</a>)</cite> were the most constraining measure of accuracy. C2ST is defined as the accuracy of a trained classifier (often a neural network itself) to distinguish between the true and inferred posterior samples. High C2ST suggests that the true and inferred posterior are very different, whereas a C2ST of <math alttext="\sim 0.5" class="ltx_Math" display="inline" id="S2.SS4.p6.1.m1.1"><semantics id="S2.SS4.p6.1.m1.1a"><mrow id="S2.SS4.p6.1.m1.1.1" xref="S2.SS4.p6.1.m1.1.1.cmml"><mi id="S2.SS4.p6.1.m1.1.1.2" xref="S2.SS4.p6.1.m1.1.1.2.cmml"></mi><mo id="S2.SS4.p6.1.m1.1.1.1" xref="S2.SS4.p6.1.m1.1.1.1.cmml">∼</mo><mn id="S2.SS4.p6.1.m1.1.1.3" xref="S2.SS4.p6.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p6.1.m1.1b"><apply id="S2.SS4.p6.1.m1.1.1.cmml" xref="S2.SS4.p6.1.m1.1.1"><csymbol cd="latexml" id="S2.SS4.p6.1.m1.1.1.1.cmml" xref="S2.SS4.p6.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.SS4.p6.1.m1.1.1.2.cmml" xref="S2.SS4.p6.1.m1.1.1.2">absent</csymbol><cn id="S2.SS4.p6.1.m1.1.1.3.cmml" type="float" xref="S2.SS4.p6.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p6.1.m1.1c">\sim 0.5</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p6.1.m1.1d">∼ 0.5</annotation></semantics></math> suggests they are nearly indistinguishable. C2ST is later used to benchmark <span class="ltx_text ltx_font_smallcaps" id="S2.SS4.p6.1.1">LtU-ILI</span> in Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S4.SS1" title="4.1 Toy Problem ‣ 4 Synthetic Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS4.p7">
<p class="ltx_p" id="S2.SS4.p7.1">Posterior samples are also useful for quantifying the calibration of our model uncertainty in parameter space. We can construct a direct comparison of the predicted percentiles by our inference engine to the true error observed in our validation dataset. We first define the Probability Integral Transform <cite class="ltx_cite ltx_citemacro_citep">(PIT; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx81" title="">Cook <em class="ltx_emph ltx_font_italic">et al.</em>(2006)Cook, Gelman, and Rubin</a>)</cite> as the <span class="ltx_text ltx_font_italic" id="S2.SS4.p7.1.1">cumulative density function</span> (CDF) of our model posterior given an input <math alttext="\bm{x}_{\rm o}" class="ltx_Math" display="inline" id="S2.SS4.p7.1.m1.1"><semantics id="S2.SS4.p7.1.m1.1a"><msub id="S2.SS4.p7.1.m1.1.1" xref="S2.SS4.p7.1.m1.1.1.cmml"><mi id="S2.SS4.p7.1.m1.1.1.2" xref="S2.SS4.p7.1.m1.1.1.2.cmml">𝒙</mi><mi id="S2.SS4.p7.1.m1.1.1.3" mathvariant="normal" xref="S2.SS4.p7.1.m1.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p7.1.m1.1b"><apply id="S2.SS4.p7.1.m1.1.1.cmml" xref="S2.SS4.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p7.1.m1.1.1.1.cmml" xref="S2.SS4.p7.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p7.1.m1.1.1.2.cmml" xref="S2.SS4.p7.1.m1.1.1.2">𝒙</ci><ci id="S2.SS4.p7.1.m1.1.1.3.cmml" xref="S2.SS4.p7.1.m1.1.1.3">o</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p7.1.m1.1c">\bm{x}_{\rm o}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p7.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT</annotation></semantics></math>,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\rm PIT}(\bm{\theta};\bm{x}_{\rm o})=\int_{-\infty}^{\bm{\theta}}\ d\bm{%
\theta}\ \hat{\mathcal{P}}(\bm{\theta}|\bm{x}_{\rm o})." class="ltx_Math" display="block" id="S2.E10.m1.2"><semantics id="S2.E10.m1.2a"><mrow id="S2.E10.m1.2.2.1" xref="S2.E10.m1.2.2.1.1.cmml"><mrow id="S2.E10.m1.2.2.1.1" xref="S2.E10.m1.2.2.1.1.cmml"><mrow id="S2.E10.m1.2.2.1.1.1" xref="S2.E10.m1.2.2.1.1.1.cmml"><mi id="S2.E10.m1.2.2.1.1.1.3" xref="S2.E10.m1.2.2.1.1.1.3.cmml">PIT</mi><mo id="S2.E10.m1.2.2.1.1.1.2" xref="S2.E10.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E10.m1.2.2.1.1.1.1.1" xref="S2.E10.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E10.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E10.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="S2.E10.m1.1.1" xref="S2.E10.m1.1.1.cmml">𝜽</mi><mo id="S2.E10.m1.2.2.1.1.1.1.1.3" xref="S2.E10.m1.2.2.1.1.1.1.2.cmml">;</mo><msub id="S2.E10.m1.2.2.1.1.1.1.1.1" xref="S2.E10.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E10.m1.2.2.1.1.1.1.1.1.2" xref="S2.E10.m1.2.2.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.E10.m1.2.2.1.1.1.1.1.1.3" mathvariant="normal" xref="S2.E10.m1.2.2.1.1.1.1.1.1.3.cmml">o</mi></msub><mo id="S2.E10.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S2.E10.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E10.m1.2.2.1.1.3" rspace="0.111em" xref="S2.E10.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.E10.m1.2.2.1.1.2" xref="S2.E10.m1.2.2.1.1.2.cmml"><msubsup id="S2.E10.m1.2.2.1.1.2.2" xref="S2.E10.m1.2.2.1.1.2.2.cmml"><mo id="S2.E10.m1.2.2.1.1.2.2.2.2" xref="S2.E10.m1.2.2.1.1.2.2.2.2.cmml">∫</mo><mrow id="S2.E10.m1.2.2.1.1.2.2.2.3" xref="S2.E10.m1.2.2.1.1.2.2.2.3.cmml"><mo id="S2.E10.m1.2.2.1.1.2.2.2.3a" xref="S2.E10.m1.2.2.1.1.2.2.2.3.cmml">−</mo><mi id="S2.E10.m1.2.2.1.1.2.2.2.3.2" mathvariant="normal" xref="S2.E10.m1.2.2.1.1.2.2.2.3.2.cmml">∞</mi></mrow><mi id="S2.E10.m1.2.2.1.1.2.2.3" xref="S2.E10.m1.2.2.1.1.2.2.3.cmml">𝜽</mi></msubsup><mrow id="S2.E10.m1.2.2.1.1.2.1" xref="S2.E10.m1.2.2.1.1.2.1.cmml"><mrow id="S2.E10.m1.2.2.1.1.2.1.3" xref="S2.E10.m1.2.2.1.1.2.1.3.cmml"><mo id="S2.E10.m1.2.2.1.1.2.1.3.1" lspace="0em" rspace="0em" xref="S2.E10.m1.2.2.1.1.2.1.3.1.cmml">𝑑</mo><mi id="S2.E10.m1.2.2.1.1.2.1.3.2" xref="S2.E10.m1.2.2.1.1.2.1.3.2.cmml">𝜽</mi></mrow><mo id="S2.E10.m1.2.2.1.1.2.1.2" lspace="0.500em" xref="S2.E10.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mover accent="true" id="S2.E10.m1.2.2.1.1.2.1.4" xref="S2.E10.m1.2.2.1.1.2.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.2.2.1.1.2.1.4.2" xref="S2.E10.m1.2.2.1.1.2.1.4.2.cmml">𝒫</mi><mo id="S2.E10.m1.2.2.1.1.2.1.4.1" xref="S2.E10.m1.2.2.1.1.2.1.4.1.cmml">^</mo></mover><mo id="S2.E10.m1.2.2.1.1.2.1.2a" xref="S2.E10.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.E10.m1.2.2.1.1.2.1.1.1" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.cmml"><mo id="S2.E10.m1.2.2.1.1.2.1.1.1.2" stretchy="false" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.E10.m1.2.2.1.1.2.1.1.1.1" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="S2.E10.m1.2.2.1.1.2.1.1.1.1.2" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.E10.m1.2.2.1.1.2.1.1.1.1.1" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.1.cmml">|</mo><msub id="S2.E10.m1.2.2.1.1.2.1.1.1.1.3" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.3" mathvariant="normal" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">o</mi></msub></mrow><mo id="S2.E10.m1.2.2.1.1.2.1.1.1.3" stretchy="false" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E10.m1.2.2.1.2" lspace="0em" xref="S2.E10.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.2b"><apply id="S2.E10.m1.2.2.1.1.cmml" xref="S2.E10.m1.2.2.1"><eq id="S2.E10.m1.2.2.1.1.3.cmml" xref="S2.E10.m1.2.2.1.1.3"></eq><apply id="S2.E10.m1.2.2.1.1.1.cmml" xref="S2.E10.m1.2.2.1.1.1"><times id="S2.E10.m1.2.2.1.1.1.2.cmml" xref="S2.E10.m1.2.2.1.1.1.2"></times><ci id="S2.E10.m1.2.2.1.1.1.3.cmml" xref="S2.E10.m1.2.2.1.1.1.3">PIT</ci><list id="S2.E10.m1.2.2.1.1.1.1.2.cmml" xref="S2.E10.m1.2.2.1.1.1.1.1"><ci id="S2.E10.m1.1.1.cmml" xref="S2.E10.m1.1.1">𝜽</ci><apply id="S2.E10.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E10.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E10.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.2.2.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E10.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.2.2.1.1.1.1.1.1.3">o</ci></apply></list></apply><apply id="S2.E10.m1.2.2.1.1.2.cmml" xref="S2.E10.m1.2.2.1.1.2"><apply id="S2.E10.m1.2.2.1.1.2.2.cmml" xref="S2.E10.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.E10.m1.2.2.1.1.2.2.1.cmml" xref="S2.E10.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S2.E10.m1.2.2.1.1.2.2.2.cmml" xref="S2.E10.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.E10.m1.2.2.1.1.2.2.2.1.cmml" xref="S2.E10.m1.2.2.1.1.2.2">subscript</csymbol><int id="S2.E10.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E10.m1.2.2.1.1.2.2.2.2"></int><apply id="S2.E10.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.E10.m1.2.2.1.1.2.2.2.3"><minus id="S2.E10.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S2.E10.m1.2.2.1.1.2.2.2.3"></minus><infinity id="S2.E10.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S2.E10.m1.2.2.1.1.2.2.2.3.2"></infinity></apply></apply><ci id="S2.E10.m1.2.2.1.1.2.2.3.cmml" xref="S2.E10.m1.2.2.1.1.2.2.3">𝜽</ci></apply><apply id="S2.E10.m1.2.2.1.1.2.1.cmml" xref="S2.E10.m1.2.2.1.1.2.1"><times id="S2.E10.m1.2.2.1.1.2.1.2.cmml" xref="S2.E10.m1.2.2.1.1.2.1.2"></times><apply id="S2.E10.m1.2.2.1.1.2.1.3.cmml" xref="S2.E10.m1.2.2.1.1.2.1.3"><csymbol cd="latexml" id="S2.E10.m1.2.2.1.1.2.1.3.1.cmml" xref="S2.E10.m1.2.2.1.1.2.1.3.1">differential-d</csymbol><ci id="S2.E10.m1.2.2.1.1.2.1.3.2.cmml" xref="S2.E10.m1.2.2.1.1.2.1.3.2">𝜽</ci></apply><apply id="S2.E10.m1.2.2.1.1.2.1.4.cmml" xref="S2.E10.m1.2.2.1.1.2.1.4"><ci id="S2.E10.m1.2.2.1.1.2.1.4.1.cmml" xref="S2.E10.m1.2.2.1.1.2.1.4.1">^</ci><ci id="S2.E10.m1.2.2.1.1.2.1.4.2.cmml" xref="S2.E10.m1.2.2.1.1.2.1.4.2">𝒫</ci></apply><apply id="S2.E10.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E10.m1.2.2.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.E10.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.1">conditional</csymbol><ci id="S2.E10.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.2">𝜽</ci><apply id="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.2">𝒙</ci><ci id="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S2.E10.m1.2.2.1.1.2.1.1.1.1.3.3">o</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.2c">{\rm PIT}(\bm{\theta};\bm{x}_{\rm o})=\int_{-\infty}^{\bm{\theta}}\ d\bm{%
\theta}\ \hat{\mathcal{P}}(\bm{\theta}|\bm{x}_{\rm o}).</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m1.2d">roman_PIT ( bold_italic_θ ; bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT ) = ∫ start_POSTSUBSCRIPT - ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT bold_italic_θ end_POSTSUPERSCRIPT italic_d bold_italic_θ over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p7.5">Given i.i.d. samples from the posterior, we can construct an estimator for the PIT value as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\rm PIT}(\bm{\theta};\bm{x}_{\rm o})=\mathbb{E}_{\hat{\bm{\theta}}\sim%
\hat{\mathcal{P}}(\bm{\theta}|\bm{x}_{\rm o})}\left[\Theta\left(\hat{\bm{%
\theta}}-\bm{\theta}\right)\right]," class="ltx_Math" display="block" id="S2.E11.m1.3"><semantics id="S2.E11.m1.3a"><mrow id="S2.E11.m1.3.3.1" xref="S2.E11.m1.3.3.1.1.cmml"><mrow id="S2.E11.m1.3.3.1.1" xref="S2.E11.m1.3.3.1.1.cmml"><mrow id="S2.E11.m1.3.3.1.1.1" xref="S2.E11.m1.3.3.1.1.1.cmml"><mover accent="true" id="S2.E11.m1.3.3.1.1.1.3" xref="S2.E11.m1.3.3.1.1.1.3.cmml"><mi id="S2.E11.m1.3.3.1.1.1.3.2" xref="S2.E11.m1.3.3.1.1.1.3.2.cmml">PIT</mi><mo id="S2.E11.m1.3.3.1.1.1.3.1" xref="S2.E11.m1.3.3.1.1.1.3.1.cmml">^</mo></mover><mo id="S2.E11.m1.3.3.1.1.1.2" xref="S2.E11.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E11.m1.3.3.1.1.1.1.1" xref="S2.E11.m1.3.3.1.1.1.1.2.cmml"><mo id="S2.E11.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E11.m1.3.3.1.1.1.1.2.cmml">(</mo><mi id="S2.E11.m1.2.2" xref="S2.E11.m1.2.2.cmml">𝜽</mi><mo id="S2.E11.m1.3.3.1.1.1.1.1.3" xref="S2.E11.m1.3.3.1.1.1.1.2.cmml">;</mo><msub id="S2.E11.m1.3.3.1.1.1.1.1.1" xref="S2.E11.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E11.m1.3.3.1.1.1.1.1.1.2" xref="S2.E11.m1.3.3.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.E11.m1.3.3.1.1.1.1.1.1.3" mathvariant="normal" xref="S2.E11.m1.3.3.1.1.1.1.1.1.3.cmml">o</mi></msub><mo id="S2.E11.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S2.E11.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E11.m1.3.3.1.1.3" xref="S2.E11.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E11.m1.3.3.1.1.2" xref="S2.E11.m1.3.3.1.1.2.cmml"><msub id="S2.E11.m1.3.3.1.1.2.3" xref="S2.E11.m1.3.3.1.1.2.3.cmml"><mi id="S2.E11.m1.3.3.1.1.2.3.2" xref="S2.E11.m1.3.3.1.1.2.3.2.cmml">𝔼</mi><mrow id="S2.E11.m1.1.1.1" xref="S2.E11.m1.1.1.1.cmml"><mover accent="true" id="S2.E11.m1.1.1.1.3" xref="S2.E11.m1.1.1.1.3.cmml"><mi id="S2.E11.m1.1.1.1.3.2" xref="S2.E11.m1.1.1.1.3.2.cmml">𝜽</mi><mo id="S2.E11.m1.1.1.1.3.1" xref="S2.E11.m1.1.1.1.3.1.cmml">^</mo></mover><mo id="S2.E11.m1.1.1.1.2" xref="S2.E11.m1.1.1.1.2.cmml">∼</mo><mrow id="S2.E11.m1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.cmml"><mover accent="true" id="S2.E11.m1.1.1.1.1.3" xref="S2.E11.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E11.m1.1.1.1.1.3.2" xref="S2.E11.m1.1.1.1.1.3.2.cmml">𝒫</mi><mo id="S2.E11.m1.1.1.1.1.3.1" xref="S2.E11.m1.1.1.1.1.3.1.cmml">^</mo></mover><mo id="S2.E11.m1.1.1.1.1.2" xref="S2.E11.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E11.m1.1.1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E11.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E11.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E11.m1.1.1.1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.E11.m1.1.1.1.1.1.1.1.2" xref="S2.E11.m1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.E11.m1.1.1.1.1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E11.m1.1.1.1.1.1.1.1.3" xref="S2.E11.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E11.m1.1.1.1.1.1.1.1.3.2" xref="S2.E11.m1.1.1.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.E11.m1.1.1.1.1.1.1.1.3.3" mathvariant="normal" xref="S2.E11.m1.1.1.1.1.1.1.1.3.3.cmml">o</mi></msub></mrow><mo id="S2.E11.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E11.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S2.E11.m1.3.3.1.1.2.2" xref="S2.E11.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="S2.E11.m1.3.3.1.1.2.1.1" xref="S2.E11.m1.3.3.1.1.2.1.2.cmml"><mo id="S2.E11.m1.3.3.1.1.2.1.1.2" xref="S2.E11.m1.3.3.1.1.2.1.2.1.cmml">[</mo><mrow id="S2.E11.m1.3.3.1.1.2.1.1.1" xref="S2.E11.m1.3.3.1.1.2.1.1.1.cmml"><mi id="S2.E11.m1.3.3.1.1.2.1.1.1.3" mathvariant="normal" xref="S2.E11.m1.3.3.1.1.2.1.1.1.3.cmml">Θ</mi><mo id="S2.E11.m1.3.3.1.1.2.1.1.1.2" xref="S2.E11.m1.3.3.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><mo id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2.2" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.cmml">𝜽</mi><mo id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2.1" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.3" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E11.m1.3.3.1.1.2.1.1.3" xref="S2.E11.m1.3.3.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E11.m1.3.3.1.2" xref="S2.E11.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m1.3b"><apply id="S2.E11.m1.3.3.1.1.cmml" xref="S2.E11.m1.3.3.1"><eq id="S2.E11.m1.3.3.1.1.3.cmml" xref="S2.E11.m1.3.3.1.1.3"></eq><apply id="S2.E11.m1.3.3.1.1.1.cmml" xref="S2.E11.m1.3.3.1.1.1"><times id="S2.E11.m1.3.3.1.1.1.2.cmml" xref="S2.E11.m1.3.3.1.1.1.2"></times><apply id="S2.E11.m1.3.3.1.1.1.3.cmml" xref="S2.E11.m1.3.3.1.1.1.3"><ci id="S2.E11.m1.3.3.1.1.1.3.1.cmml" xref="S2.E11.m1.3.3.1.1.1.3.1">^</ci><ci id="S2.E11.m1.3.3.1.1.1.3.2.cmml" xref="S2.E11.m1.3.3.1.1.1.3.2">PIT</ci></apply><list id="S2.E11.m1.3.3.1.1.1.1.2.cmml" xref="S2.E11.m1.3.3.1.1.1.1.1"><ci id="S2.E11.m1.2.2.cmml" xref="S2.E11.m1.2.2">𝜽</ci><apply id="S2.E11.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E11.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E11.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E11.m1.3.3.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E11.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E11.m1.3.3.1.1.1.1.1.1.3">o</ci></apply></list></apply><apply id="S2.E11.m1.3.3.1.1.2.cmml" xref="S2.E11.m1.3.3.1.1.2"><times id="S2.E11.m1.3.3.1.1.2.2.cmml" xref="S2.E11.m1.3.3.1.1.2.2"></times><apply id="S2.E11.m1.3.3.1.1.2.3.cmml" xref="S2.E11.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S2.E11.m1.3.3.1.1.2.3.1.cmml" xref="S2.E11.m1.3.3.1.1.2.3">subscript</csymbol><ci id="S2.E11.m1.3.3.1.1.2.3.2.cmml" xref="S2.E11.m1.3.3.1.1.2.3.2">𝔼</ci><apply id="S2.E11.m1.1.1.1.cmml" xref="S2.E11.m1.1.1.1"><csymbol cd="latexml" id="S2.E11.m1.1.1.1.2.cmml" xref="S2.E11.m1.1.1.1.2">similar-to</csymbol><apply id="S2.E11.m1.1.1.1.3.cmml" xref="S2.E11.m1.1.1.1.3"><ci id="S2.E11.m1.1.1.1.3.1.cmml" xref="S2.E11.m1.1.1.1.3.1">^</ci><ci id="S2.E11.m1.1.1.1.3.2.cmml" xref="S2.E11.m1.1.1.1.3.2">𝜽</ci></apply><apply id="S2.E11.m1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1"><times id="S2.E11.m1.1.1.1.1.2.cmml" xref="S2.E11.m1.1.1.1.1.2"></times><apply id="S2.E11.m1.1.1.1.1.3.cmml" xref="S2.E11.m1.1.1.1.1.3"><ci id="S2.E11.m1.1.1.1.1.3.1.cmml" xref="S2.E11.m1.1.1.1.1.3.1">^</ci><ci id="S2.E11.m1.1.1.1.1.3.2.cmml" xref="S2.E11.m1.1.1.1.1.3.2">𝒫</ci></apply><apply id="S2.E11.m1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.2">𝜽</ci><apply id="S2.E11.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E11.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.E11.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.3.3">o</ci></apply></apply></apply></apply></apply><apply id="S2.E11.m1.3.3.1.1.2.1.2.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1"><csymbol cd="latexml" id="S2.E11.m1.3.3.1.1.2.1.2.1.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S2.E11.m1.3.3.1.1.2.1.1.1.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1.1"><times id="S2.E11.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1.1.2"></times><ci id="S2.E11.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1.1.3">Θ</ci><apply id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1"><minus id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1"></minus><apply id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2"><ci id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.2.2">𝜽</ci></apply><ci id="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml" xref="S2.E11.m1.3.3.1.1.2.1.1.1.1.1.1.3">𝜽</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.3c">\hat{\rm PIT}(\bm{\theta};\bm{x}_{\rm o})=\mathbb{E}_{\hat{\bm{\theta}}\sim%
\hat{\mathcal{P}}(\bm{\theta}|\bm{x}_{\rm o})}\left[\Theta\left(\hat{\bm{%
\theta}}-\bm{\theta}\right)\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m1.3d">over^ start_ARG roman_PIT end_ARG ( bold_italic_θ ; bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT ) = blackboard_E start_POSTSUBSCRIPT over^ start_ARG bold_italic_θ end_ARG ∼ over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x start_POSTSUBSCRIPT roman_o end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ roman_Θ ( over^ start_ARG bold_italic_θ end_ARG - bold_italic_θ ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p7.4">where <math alttext="\Theta" class="ltx_Math" display="inline" id="S2.SS4.p7.2.m1.1"><semantics id="S2.SS4.p7.2.m1.1a"><mi id="S2.SS4.p7.2.m1.1.1" mathvariant="normal" xref="S2.SS4.p7.2.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p7.2.m1.1b"><ci id="S2.SS4.p7.2.m1.1.1.cmml" xref="S2.SS4.p7.2.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p7.2.m1.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p7.2.m1.1d">roman_Θ</annotation></semantics></math> is the Heaviside step function. Stated plainly, the PIT value counts the number of times that our posterior samples <math alttext="\hat{\bm{\theta}}" class="ltx_Math" display="inline" id="S2.SS4.p7.3.m2.1"><semantics id="S2.SS4.p7.3.m2.1a"><mover accent="true" id="S2.SS4.p7.3.m2.1.1" xref="S2.SS4.p7.3.m2.1.1.cmml"><mi id="S2.SS4.p7.3.m2.1.1.2" xref="S2.SS4.p7.3.m2.1.1.2.cmml">𝜽</mi><mo id="S2.SS4.p7.3.m2.1.1.1" xref="S2.SS4.p7.3.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS4.p7.3.m2.1b"><apply id="S2.SS4.p7.3.m2.1.1.cmml" xref="S2.SS4.p7.3.m2.1.1"><ci id="S2.SS4.p7.3.m2.1.1.1.cmml" xref="S2.SS4.p7.3.m2.1.1.1">^</ci><ci id="S2.SS4.p7.3.m2.1.1.2.cmml" xref="S2.SS4.p7.3.m2.1.1.2">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p7.3.m2.1c">\hat{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p7.3.m2.1d">over^ start_ARG bold_italic_θ end_ARG</annotation></semantics></math> fall below the true parameter value <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS4.p7.4.m3.1"><semantics id="S2.SS4.p7.4.m3.1a"><mi id="S2.SS4.p7.4.m3.1.1" xref="S2.SS4.p7.4.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p7.4.m3.1b"><ci id="S2.SS4.p7.4.m3.1.1.cmml" xref="S2.SS4.p7.4.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p7.4.m3.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p7.4.m3.1d">bold_italic_θ</annotation></semantics></math>. If our model posteriors are globally consistent with the truth, i.e. we match the true posterior everywhere in data-parameter space, then the distribution of PIT values evaluated on data-parameter pairs from our test set must be uniformly distributed <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx82" title="">Zhao <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Zhao, Dalmasso, Izbicki, and Lee</a>)</cite>: </p>
<table class="ltx_equation ltx_eqn_table" id="S2.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\rm PIT}(\bm{\theta}_{i};\bm{x}_{i})\sim U(0,1),\ \forall\ (\bm{x}_{i},\bm{%
\theta}_{i})\in\mathcal{D}_{\rm test}\,." class="ltx_Math" display="block" id="S2.E12.m1.3"><semantics id="S2.E12.m1.3a"><mrow id="S2.E12.m1.3.3.1"><mrow id="S2.E12.m1.3.3.1.1.2" xref="S2.E12.m1.3.3.1.1.3.cmml"><mrow id="S2.E12.m1.3.3.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.cmml"><mrow id="S2.E12.m1.3.3.1.1.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.2.cmml"><mi id="S2.E12.m1.3.3.1.1.1.1.2.4" xref="S2.E12.m1.3.3.1.1.1.1.2.4.cmml">PIT</mi><mo id="S2.E12.m1.3.3.1.1.1.1.2.3" xref="S2.E12.m1.3.3.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.2.2.2" xref="S2.E12.m1.3.3.1.1.1.1.2.2.3.cmml"><mo id="S2.E12.m1.3.3.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E12.m1.3.3.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mi id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E12.m1.3.3.1.1.1.1.2.2.2.4" xref="S2.E12.m1.3.3.1.1.1.1.2.2.3.cmml">;</mo><msub id="S2.E12.m1.3.3.1.1.1.1.2.2.2.2" xref="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.2" xref="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.2.cmml">𝒙</mi><mi id="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.3" xref="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo id="S2.E12.m1.3.3.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E12.m1.3.3.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E12.m1.3.3.1.1.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.3.cmml">∼</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.4" xref="S2.E12.m1.3.3.1.1.1.1.4.cmml"><mi id="S2.E12.m1.3.3.1.1.1.1.4.2" xref="S2.E12.m1.3.3.1.1.1.1.4.2.cmml">U</mi><mo id="S2.E12.m1.3.3.1.1.1.1.4.1" xref="S2.E12.m1.3.3.1.1.1.1.4.1.cmml">⁢</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.4.3.2" xref="S2.E12.m1.3.3.1.1.1.1.4.3.1.cmml"><mo id="S2.E12.m1.3.3.1.1.1.1.4.3.2.1" stretchy="false" xref="S2.E12.m1.3.3.1.1.1.1.4.3.1.cmml">(</mo><mn id="S2.E12.m1.1.1" xref="S2.E12.m1.1.1.cmml">0</mn><mo id="S2.E12.m1.3.3.1.1.1.1.4.3.2.2" xref="S2.E12.m1.3.3.1.1.1.1.4.3.1.cmml">,</mo><mn id="S2.E12.m1.2.2" xref="S2.E12.m1.2.2.cmml">1</mn><mo id="S2.E12.m1.3.3.1.1.1.1.4.3.2.3" stretchy="false" xref="S2.E12.m1.3.3.1.1.1.1.4.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E12.m1.3.3.1.1.2.3" rspace="0.667em" xref="S2.E12.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S2.E12.m1.3.3.1.1.2.2" xref="S2.E12.m1.3.3.1.1.2.2.cmml"><mrow id="S2.E12.m1.3.3.1.1.2.2.2" xref="S2.E12.m1.3.3.1.1.2.2.2.cmml"><mo id="S2.E12.m1.3.3.1.1.2.2.2.3" rspace="0.500em" xref="S2.E12.m1.3.3.1.1.2.2.2.3.cmml">∀</mo><mrow id="S2.E12.m1.3.3.1.1.2.2.2.2.2" xref="S2.E12.m1.3.3.1.1.2.2.2.2.3.cmml"><mo id="S2.E12.m1.3.3.1.1.2.2.2.2.2.3" stretchy="false" xref="S2.E12.m1.3.3.1.1.2.2.2.2.3.cmml">(</mo><msub id="S2.E12.m1.3.3.1.1.2.2.1.1.1.1" xref="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.cmml"><mi id="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.2" xref="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.3" xref="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E12.m1.3.3.1.1.2.2.2.2.2.4" xref="S2.E12.m1.3.3.1.1.2.2.2.2.3.cmml">,</mo><msub id="S2.E12.m1.3.3.1.1.2.2.2.2.2.2" xref="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.2.cmml">𝜽</mi><mi id="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.3" xref="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S2.E12.m1.3.3.1.1.2.2.2.2.2.5" stretchy="false" xref="S2.E12.m1.3.3.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E12.m1.3.3.1.1.2.2.3" xref="S2.E12.m1.3.3.1.1.2.2.3.cmml">∈</mo><msub id="S2.E12.m1.3.3.1.1.2.2.4" xref="S2.E12.m1.3.3.1.1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E12.m1.3.3.1.1.2.2.4.2" xref="S2.E12.m1.3.3.1.1.2.2.4.2.cmml">𝒟</mi><mi id="S2.E12.m1.3.3.1.1.2.2.4.3" xref="S2.E12.m1.3.3.1.1.2.2.4.3.cmml">test</mi></msub></mrow></mrow><mo id="S2.E12.m1.3.3.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m1.3b"><apply id="S2.E12.m1.3.3.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.3a.cmml" xref="S2.E12.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E12.m1.3.3.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S2.E12.m1.3.3.1.1.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.3">similar-to</csymbol><apply id="S2.E12.m1.3.3.1.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.2"><times id="S2.E12.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.2.3"></times><ci id="S2.E12.m1.3.3.1.1.1.1.2.4.cmml" xref="S2.E12.m1.3.3.1.1.1.1.2.4">PIT</ci><list id="S2.E12.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.2.2.2"><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2">𝜽</ci><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.2">𝒙</ci><ci id="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></list></apply><apply id="S2.E12.m1.3.3.1.1.1.1.4.cmml" xref="S2.E12.m1.3.3.1.1.1.1.4"><times id="S2.E12.m1.3.3.1.1.1.1.4.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.4.1"></times><ci id="S2.E12.m1.3.3.1.1.1.1.4.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.4.2">𝑈</ci><interval closure="open" id="S2.E12.m1.3.3.1.1.1.1.4.3.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.4.3.2"><cn id="S2.E12.m1.1.1.cmml" type="integer" xref="S2.E12.m1.1.1">0</cn><cn id="S2.E12.m1.2.2.cmml" type="integer" xref="S2.E12.m1.2.2">1</cn></interval></apply></apply><apply id="S2.E12.m1.3.3.1.1.2.2.cmml" xref="S2.E12.m1.3.3.1.1.2.2"><in id="S2.E12.m1.3.3.1.1.2.2.3.cmml" xref="S2.E12.m1.3.3.1.1.2.2.3"></in><apply id="S2.E12.m1.3.3.1.1.2.2.2.cmml" xref="S2.E12.m1.3.3.1.1.2.2.2"><csymbol cd="latexml" id="S2.E12.m1.3.3.1.1.2.2.2.3.cmml" xref="S2.E12.m1.3.3.1.1.2.2.2.3">for-all</csymbol><interval closure="open" id="S2.E12.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S2.E12.m1.3.3.1.1.2.2.2.2.2"><apply id="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.2">𝒙</ci><ci id="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S2.E12.m1.3.3.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E12.m1.3.3.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.2">𝜽</ci><ci id="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E12.m1.3.3.1.1.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S2.E12.m1.3.3.1.1.2.2.4.cmml" xref="S2.E12.m1.3.3.1.1.2.2.4"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.2.2.4.1.cmml" xref="S2.E12.m1.3.3.1.1.2.2.4">subscript</csymbol><ci id="S2.E12.m1.3.3.1.1.2.2.4.2.cmml" xref="S2.E12.m1.3.3.1.1.2.2.4.2">𝒟</ci><ci id="S2.E12.m1.3.3.1.1.2.2.4.3.cmml" xref="S2.E12.m1.3.3.1.1.2.2.4.3">test</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.3c">{\rm PIT}(\bm{\theta}_{i};\bm{x}_{i})\sim U(0,1),\ \forall\ (\bm{x}_{i},\bm{%
\theta}_{i})\in\mathcal{D}_{\rm test}\,.</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.3d">roman_PIT ( bold_italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∼ italic_U ( 0 , 1 ) , ∀ ( bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ caligraphic_D start_POSTSUBSCRIPT roman_test end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p7.6">As a result of this property, the distribution of PIT values is a common goodness-of-fit metric for conditional density models <cite class="ltx_cite ltx_citemacro_citep">(e.g. <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx81" title="">Cook <em class="ltx_emph ltx_font_italic">et al.</em>(2006)Cook, Gelman, and Rubin</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx83" title="">Bordoloi <em class="ltx_emph ltx_font_italic">et al.</em>(2010)Bordoloi, Lilly, and Amara</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx84" title="">Tanaka <em class="ltx_emph ltx_font_italic">et al.</em>(2018)Tanaka, Coupon, Hsieh, Mineo, Nishizawa, Speagle, Furusawa, Miyazaki, and Murayama</a>)</cite>. This is also known as Simulation-Based Calibration <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx85" title="">Talts <em class="ltx_emph ltx_font_italic">et al.</em>(2018)Talts, Betancourt, Simpson, Vehtari, and Gelman</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS4.p8">
<p class="ltx_p" id="S2.SS4.p8.1">To better interpret errors in the PIT distribution, we can use a percentile-percentile (P-P) plot, explicitly comparing the CDF of PIT values to the CDF of a uniform random variable. Intuitively, the P-P plot measures: ‘What percentile level is my posterior model assigning to the true value, and with what frequency does this occur in the test set?’ If the predictive posterior is well-calibrated, these should be the same, <em class="ltx_emph ltx_font_italic" id="S2.SS4.p8.1.1">e.g.,</em> we should predict the true value below the 50-th percentile 50% of the time. If it is not, the shape of the P-P plot acts as a sensitive probe of global bias or over-/under-dispersion of predictive uncertainty (see Figure 1 of <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx82" title="">Zhao <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Zhao, Dalmasso, Izbicki, and Lee</a></cite> for interpretations of error with P-P plots). This is an extremely practical tool for understanding and correcting biases and over/under-dispersion in complex ILI posteriors.</p>
</div>
<div class="ltx_para" id="S2.SS4.p9">
<p class="ltx_p" id="S2.SS4.p9.3">As the dimensionality of <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS4.p9.1.m1.1"><semantics id="S2.SS4.p9.1.m1.1a"><mi id="S2.SS4.p9.1.m1.1.1" xref="S2.SS4.p9.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p9.1.m1.1b"><ci id="S2.SS4.p9.1.m1.1.1.cmml" xref="S2.SS4.p9.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p9.1.m1.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p9.1.m1.1d">bold_italic_θ</annotation></semantics></math> increases, proper coverage of the posterior distribution requires exponentially more samples. As a result, the PIT estimator (Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E11" title="11 ‣ 2.4 Validation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">11</span></a>) becomes intractably difficult to measure with low variance in the high-dimensionality regime. In this regime, we use approximate methods to bound the constraints of posterior coverage tests. Firstly, we can construct a PIT value from the marginal posterior over each <math alttext="i" class="ltx_Math" display="inline" id="S2.SS4.p9.2.m2.1"><semantics id="S2.SS4.p9.2.m2.1a"><mi id="S2.SS4.p9.2.m2.1.1" xref="S2.SS4.p9.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p9.2.m2.1b"><ci id="S2.SS4.p9.2.m2.1.1.cmml" xref="S2.SS4.p9.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p9.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p9.2.m2.1d">italic_i</annotation></semantics></math>-th component of <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS4.p9.3.m3.1"><semantics id="S2.SS4.p9.3.m3.1a"><mi id="S2.SS4.p9.3.m3.1.1" xref="S2.SS4.p9.3.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p9.3.m3.1b"><ci id="S2.SS4.p9.3.m3.1.1.cmml" xref="S2.SS4.p9.3.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p9.3.m3.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p9.3.m3.1d">bold_italic_θ</annotation></semantics></math>, <em class="ltx_emph ltx_font_italic" id="S2.SS4.p9.3.1">i.e.,</em></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\rm PIT}(\theta_{i};\bm{x})=\mathbb{E}_{\hat{\bm{\theta}}\sim\hat{%
\mathcal{P}}(\bm{\theta}|\bm{x})}\left[\Theta\left(\hat{\theta}_{i}-\theta_{i}%
\right)\right]," class="ltx_Math" display="block" id="S2.E13.m1.3"><semantics id="S2.E13.m1.3a"><mrow id="S2.E13.m1.3.3.1" xref="S2.E13.m1.3.3.1.1.cmml"><mrow id="S2.E13.m1.3.3.1.1" xref="S2.E13.m1.3.3.1.1.cmml"><mrow id="S2.E13.m1.3.3.1.1.1" xref="S2.E13.m1.3.3.1.1.1.cmml"><mover accent="true" id="S2.E13.m1.3.3.1.1.1.3" xref="S2.E13.m1.3.3.1.1.1.3.cmml"><mi id="S2.E13.m1.3.3.1.1.1.3.2" xref="S2.E13.m1.3.3.1.1.1.3.2.cmml">PIT</mi><mo id="S2.E13.m1.3.3.1.1.1.3.1" xref="S2.E13.m1.3.3.1.1.1.3.1.cmml">^</mo></mover><mo id="S2.E13.m1.3.3.1.1.1.2" xref="S2.E13.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E13.m1.3.3.1.1.1.1.1" xref="S2.E13.m1.3.3.1.1.1.1.2.cmml"><mo id="S2.E13.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E13.m1.3.3.1.1.1.1.2.cmml">(</mo><msub id="S2.E13.m1.3.3.1.1.1.1.1.1" xref="S2.E13.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E13.m1.3.3.1.1.1.1.1.1.2" xref="S2.E13.m1.3.3.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E13.m1.3.3.1.1.1.1.1.1.3" xref="S2.E13.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E13.m1.3.3.1.1.1.1.1.3" xref="S2.E13.m1.3.3.1.1.1.1.2.cmml">;</mo><mi id="S2.E13.m1.2.2" xref="S2.E13.m1.2.2.cmml">𝒙</mi><mo id="S2.E13.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S2.E13.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E13.m1.3.3.1.1.3" xref="S2.E13.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E13.m1.3.3.1.1.2" xref="S2.E13.m1.3.3.1.1.2.cmml"><msub id="S2.E13.m1.3.3.1.1.2.3" xref="S2.E13.m1.3.3.1.1.2.3.cmml"><mi id="S2.E13.m1.3.3.1.1.2.3.2" xref="S2.E13.m1.3.3.1.1.2.3.2.cmml">𝔼</mi><mrow id="S2.E13.m1.1.1.1" xref="S2.E13.m1.1.1.1.cmml"><mover accent="true" id="S2.E13.m1.1.1.1.3" xref="S2.E13.m1.1.1.1.3.cmml"><mi id="S2.E13.m1.1.1.1.3.2" xref="S2.E13.m1.1.1.1.3.2.cmml">𝜽</mi><mo id="S2.E13.m1.1.1.1.3.1" xref="S2.E13.m1.1.1.1.3.1.cmml">^</mo></mover><mo id="S2.E13.m1.1.1.1.2" xref="S2.E13.m1.1.1.1.2.cmml">∼</mo><mrow id="S2.E13.m1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.cmml"><mover accent="true" id="S2.E13.m1.1.1.1.1.3" xref="S2.E13.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E13.m1.1.1.1.1.3.2" xref="S2.E13.m1.1.1.1.1.3.2.cmml">𝒫</mi><mo id="S2.E13.m1.1.1.1.1.3.1" xref="S2.E13.m1.1.1.1.1.3.1.cmml">^</mo></mover><mo id="S2.E13.m1.1.1.1.1.2" xref="S2.E13.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E13.m1.1.1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E13.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E13.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E13.m1.1.1.1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.E13.m1.1.1.1.1.1.1.1.2" xref="S2.E13.m1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S2.E13.m1.1.1.1.1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E13.m1.1.1.1.1.1.1.1.3" xref="S2.E13.m1.1.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.E13.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E13.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S2.E13.m1.3.3.1.1.2.2" xref="S2.E13.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="S2.E13.m1.3.3.1.1.2.1.1" xref="S2.E13.m1.3.3.1.1.2.1.2.cmml"><mo id="S2.E13.m1.3.3.1.1.2.1.1.2" xref="S2.E13.m1.3.3.1.1.2.1.2.1.cmml">[</mo><mrow id="S2.E13.m1.3.3.1.1.2.1.1.1" xref="S2.E13.m1.3.3.1.1.2.1.1.1.cmml"><mi id="S2.E13.m1.3.3.1.1.2.1.1.1.3" mathvariant="normal" xref="S2.E13.m1.3.3.1.1.2.1.1.1.3.cmml">Θ</mi><mo id="S2.E13.m1.3.3.1.1.2.1.1.1.2" xref="S2.E13.m1.3.3.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><mo id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><msub id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.cmml">θ</mi><mo id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.1" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.3" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.2" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.3" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E13.m1.3.3.1.1.2.1.1.3" xref="S2.E13.m1.3.3.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E13.m1.3.3.1.2" xref="S2.E13.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E13.m1.3b"><apply id="S2.E13.m1.3.3.1.1.cmml" xref="S2.E13.m1.3.3.1"><eq id="S2.E13.m1.3.3.1.1.3.cmml" xref="S2.E13.m1.3.3.1.1.3"></eq><apply id="S2.E13.m1.3.3.1.1.1.cmml" xref="S2.E13.m1.3.3.1.1.1"><times id="S2.E13.m1.3.3.1.1.1.2.cmml" xref="S2.E13.m1.3.3.1.1.1.2"></times><apply id="S2.E13.m1.3.3.1.1.1.3.cmml" xref="S2.E13.m1.3.3.1.1.1.3"><ci id="S2.E13.m1.3.3.1.1.1.3.1.cmml" xref="S2.E13.m1.3.3.1.1.1.3.1">^</ci><ci id="S2.E13.m1.3.3.1.1.1.3.2.cmml" xref="S2.E13.m1.3.3.1.1.1.3.2">PIT</ci></apply><list id="S2.E13.m1.3.3.1.1.1.1.2.cmml" xref="S2.E13.m1.3.3.1.1.1.1.1"><apply id="S2.E13.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E13.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E13.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.3.3.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E13.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S2.E13.m1.2.2.cmml" xref="S2.E13.m1.2.2">𝒙</ci></list></apply><apply id="S2.E13.m1.3.3.1.1.2.cmml" xref="S2.E13.m1.3.3.1.1.2"><times id="S2.E13.m1.3.3.1.1.2.2.cmml" xref="S2.E13.m1.3.3.1.1.2.2"></times><apply id="S2.E13.m1.3.3.1.1.2.3.cmml" xref="S2.E13.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S2.E13.m1.3.3.1.1.2.3.1.cmml" xref="S2.E13.m1.3.3.1.1.2.3">subscript</csymbol><ci id="S2.E13.m1.3.3.1.1.2.3.2.cmml" xref="S2.E13.m1.3.3.1.1.2.3.2">𝔼</ci><apply id="S2.E13.m1.1.1.1.cmml" xref="S2.E13.m1.1.1.1"><csymbol cd="latexml" id="S2.E13.m1.1.1.1.2.cmml" xref="S2.E13.m1.1.1.1.2">similar-to</csymbol><apply id="S2.E13.m1.1.1.1.3.cmml" xref="S2.E13.m1.1.1.1.3"><ci id="S2.E13.m1.1.1.1.3.1.cmml" xref="S2.E13.m1.1.1.1.3.1">^</ci><ci id="S2.E13.m1.1.1.1.3.2.cmml" xref="S2.E13.m1.1.1.1.3.2">𝜽</ci></apply><apply id="S2.E13.m1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1"><times id="S2.E13.m1.1.1.1.1.2.cmml" xref="S2.E13.m1.1.1.1.1.2"></times><apply id="S2.E13.m1.1.1.1.1.3.cmml" xref="S2.E13.m1.1.1.1.1.3"><ci id="S2.E13.m1.1.1.1.1.3.1.cmml" xref="S2.E13.m1.1.1.1.1.3.1">^</ci><ci id="S2.E13.m1.1.1.1.1.3.2.cmml" xref="S2.E13.m1.1.1.1.1.3.2">𝒫</ci></apply><apply id="S2.E13.m1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E13.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.2">𝜽</ci><ci id="S2.E13.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></apply><apply id="S2.E13.m1.3.3.1.1.2.1.2.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1"><csymbol cd="latexml" id="S2.E13.m1.3.3.1.1.2.1.2.1.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S2.E13.m1.3.3.1.1.2.1.1.1.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1"><times id="S2.E13.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.2"></times><ci id="S2.E13.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.3">Θ</ci><apply id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1"><minus id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.1"></minus><apply id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2"><ci id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.1">^</ci><ci id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2">𝜃</ci></apply><ci id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.2">𝜃</ci><ci id="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E13.m1.3.3.1.1.2.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E13.m1.3c">\hat{\rm PIT}(\theta_{i};\bm{x})=\mathbb{E}_{\hat{\bm{\theta}}\sim\hat{%
\mathcal{P}}(\bm{\theta}|\bm{x})}\left[\Theta\left(\hat{\theta}_{i}-\theta_{i}%
\right)\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E13.m1.3d">over^ start_ARG roman_PIT end_ARG ( italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; bold_italic_x ) = blackboard_E start_POSTSUBSCRIPT over^ start_ARG bold_italic_θ end_ARG ∼ over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x ) end_POSTSUBSCRIPT [ roman_Θ ( over^ start_ARG italic_θ end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p9.8">where <math alttext="\hat{\theta}_{i}" class="ltx_Math" display="inline" id="S2.SS4.p9.4.m1.1"><semantics id="S2.SS4.p9.4.m1.1a"><msub id="S2.SS4.p9.4.m1.1.1" xref="S2.SS4.p9.4.m1.1.1.cmml"><mover accent="true" id="S2.SS4.p9.4.m1.1.1.2" xref="S2.SS4.p9.4.m1.1.1.2.cmml"><mi id="S2.SS4.p9.4.m1.1.1.2.2" xref="S2.SS4.p9.4.m1.1.1.2.2.cmml">θ</mi><mo id="S2.SS4.p9.4.m1.1.1.2.1" xref="S2.SS4.p9.4.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS4.p9.4.m1.1.1.3" xref="S2.SS4.p9.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p9.4.m1.1b"><apply id="S2.SS4.p9.4.m1.1.1.cmml" xref="S2.SS4.p9.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p9.4.m1.1.1.1.cmml" xref="S2.SS4.p9.4.m1.1.1">subscript</csymbol><apply id="S2.SS4.p9.4.m1.1.1.2.cmml" xref="S2.SS4.p9.4.m1.1.1.2"><ci id="S2.SS4.p9.4.m1.1.1.2.1.cmml" xref="S2.SS4.p9.4.m1.1.1.2.1">^</ci><ci id="S2.SS4.p9.4.m1.1.1.2.2.cmml" xref="S2.SS4.p9.4.m1.1.1.2.2">𝜃</ci></apply><ci id="S2.SS4.p9.4.m1.1.1.3.cmml" xref="S2.SS4.p9.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p9.4.m1.1c">\hat{\theta}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p9.4.m1.1d">over^ start_ARG italic_θ end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{i}" class="ltx_Math" display="inline" id="S2.SS4.p9.5.m2.1"><semantics id="S2.SS4.p9.5.m2.1a"><msub id="S2.SS4.p9.5.m2.1.1" xref="S2.SS4.p9.5.m2.1.1.cmml"><mi id="S2.SS4.p9.5.m2.1.1.2" xref="S2.SS4.p9.5.m2.1.1.2.cmml">θ</mi><mi id="S2.SS4.p9.5.m2.1.1.3" xref="S2.SS4.p9.5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p9.5.m2.1b"><apply id="S2.SS4.p9.5.m2.1.1.cmml" xref="S2.SS4.p9.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p9.5.m2.1.1.1.cmml" xref="S2.SS4.p9.5.m2.1.1">subscript</csymbol><ci id="S2.SS4.p9.5.m2.1.1.2.cmml" xref="S2.SS4.p9.5.m2.1.1.2">𝜃</ci><ci id="S2.SS4.p9.5.m2.1.1.3.cmml" xref="S2.SS4.p9.5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p9.5.m2.1c">\theta_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p9.5.m2.1d">italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS4.p9.6.m3.1"><semantics id="S2.SS4.p9.6.m3.1a"><mi id="S2.SS4.p9.6.m3.1.1" xref="S2.SS4.p9.6.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p9.6.m3.1b"><ci id="S2.SS4.p9.6.m3.1.1.cmml" xref="S2.SS4.p9.6.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p9.6.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p9.6.m3.1d">italic_i</annotation></semantics></math>-th components of <math alttext="\hat{\bm{\theta}}" class="ltx_Math" display="inline" id="S2.SS4.p9.7.m4.1"><semantics id="S2.SS4.p9.7.m4.1a"><mover accent="true" id="S2.SS4.p9.7.m4.1.1" xref="S2.SS4.p9.7.m4.1.1.cmml"><mi id="S2.SS4.p9.7.m4.1.1.2" xref="S2.SS4.p9.7.m4.1.1.2.cmml">𝜽</mi><mo id="S2.SS4.p9.7.m4.1.1.1" xref="S2.SS4.p9.7.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS4.p9.7.m4.1b"><apply id="S2.SS4.p9.7.m4.1.1.cmml" xref="S2.SS4.p9.7.m4.1.1"><ci id="S2.SS4.p9.7.m4.1.1.1.cmml" xref="S2.SS4.p9.7.m4.1.1.1">^</ci><ci id="S2.SS4.p9.7.m4.1.1.2.cmml" xref="S2.SS4.p9.7.m4.1.1.2">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p9.7.m4.1c">\hat{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p9.7.m4.1d">over^ start_ARG bold_italic_θ end_ARG</annotation></semantics></math> and <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS4.p9.8.m5.1"><semantics id="S2.SS4.p9.8.m5.1a"><mi id="S2.SS4.p9.8.m5.1.1" xref="S2.SS4.p9.8.m5.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p9.8.m5.1b"><ci id="S2.SS4.p9.8.m5.1.1.cmml" xref="S2.SS4.p9.8.m5.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p9.8.m5.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p9.8.m5.1d">bold_italic_θ</annotation></semantics></math> respectively. If our model posterior is globally consistent with the true posterior, then this marginal PIT value has the same properties as Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E11" title="11 ‣ 2.4 Validation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">11</span></a>, <em class="ltx_emph ltx_font_italic" id="S2.SS4.p9.8.1">i.e.,</em> when evaluated on the test set they should be uniformly distributed.</p>
</div>
<div class="ltx_para" id="S2.SS4.p10">
<p class="ltx_p" id="S2.SS4.p10.1">It is also sufficient to use approximations to check multivariate posterior coverage. The Tests of Accuracy with Random Points <cite class="ltx_cite ltx_citemacro_citep">(TARP; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx37" title="">Lemos <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Lemos, Coogan, Hezaveh, and Levasseur</a>)</cite> method uses samples in high-dimensional parameter space to estimate expected coverage probabilities. By examining the density of posterior samples within regions of parameter space near true values, TARP constructs estimates of posterior coverage which are guaranteed to converge to the true posterior coverage with sufficient samples. With enough samples, this test is necessary and sufficient to guarantee an optimal posterior estimate.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Code Structure</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="265" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of the <span class="ltx_text ltx_font_smallcaps" id="S3.F2.2.1">LtU-ILI</span> pipeline, displaying the procedural processes when running each stage. Each of the three stages (Data, Inference, Validation) is independently configurable, meaning any setup of one stage will automatically link to the others.</figcaption>
</figure>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The <span class="ltx_text ltx_font_smallcaps" id="S3.p1.1.1">LtU-ILI</span> software is a pipeline for training implicit inference models to infer scalar parameters from observational data. A typical inference pipeline consists of three main stages: Data, Inference, and Validation. The Data stage involves loading datasets from file or setting up on-the-fly simulators (e.g. for the methodologies in Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS3" title="2.3 Sequential Learning ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.3</span></a>) in order to provide data-parameter pairs for implicit inference. The Inference stage then takes these data-parameter pairs, trains neural networks to connect them with amortized posterior or likelihood representations (as in Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2" title="2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.2</span></a>), and saves the fitted models to file. Finally, the Validation stage loads a test dataset as well as the fitted models from Inference in order to evaluate goodness-of-fit metrics (e.g. constraint level, posterior coverage, etc.) and produces inference on unlabeled data. A schematic of this pipeline is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S3.F2" title="Figure 2 ‣ 3 Code Structure ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">Each stage is independent and adaptive, such that the configuration of one stage can be changed while keeping the others the same and the pipeline will still run. For example, if you had a fixed dataset but wanted to try out many different neural architectures, you would only need to change the Inference configuration. Similarly, if you wanted to see the gain in constraining power of using a short, conservative data vector versus a longer, more informative data vector, you could simply change the Data configuration to load the different datasets and the Inference and Validation would proceed exactly the same way.
This design principle is extremely practical for doing apples-to-apples comparisons of the many design choices and hyperparameters associated with ILI, a key tenet of robust and responsible machine learning <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx6" title="">Huppenkothen <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Huppenkothen, Ntampaka, Ho, Fouesneau, Nord, Peek, Walmsley, Wu, Avestruz, Buck <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">The pipeline is designed to promote exploratory research while also supporting efficient production-level testing. We provide a fully functional Jupyter interface and detailed examples to access each stage of <span class="ltx_text ltx_font_smallcaps" id="S3.p3.1.1">LtU-ILI</span>. The Jupyter interface is a widely-used tool for examining new problems, building educational material, and facilitating collaborative efforts <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx86" title="">Wang <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Wang, Mittal, Brooks, and Oney</a>)</cite>. The Jupyter interface of <span class="ltx_text ltx_font_smallcaps" id="S3.p3.1.2">LtU-ILI</span> provides step-by-step guidance for establishing and testing a new inference pipeline that is familiar to novices and experts alike. This allows <span class="ltx_text ltx_font_smallcaps" id="S3.p3.1.3">LtU-ILI</span> to act both as a user-friendly toolkit to explore inference on a new problem as well as carry out thorough testing and hyperparameter tuning through its <span class="ltx_text ltx_font_typewriter" id="S3.p3.1.4">yaml</span>-based configuration API. Users can generate many configurations of the pipeline and run multiple fittings in parallel on large-scale GPU compute clusters.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1">In this section, we discuss the design of the Data, Inference, and Validation stages of the <span class="ltx_text ltx_font_smallcaps" id="S3.p4.1.1">LtU-ILI</span> pipeline, including each of their capabilities and relevant reference works. For specifics on using the API, we refer the reader to our full code documentation<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://ltu-ili.readthedocs.io" title="">https://ltu-ili.readthedocs.io</a></span></span></span>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Data</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The objective of the Data stage is to gather data-parameter pairs and present them in an amenable format to the Inference stage. For standard inference, with fixed training and test catalogs, the Data stage simply loads data-parameter pairs from in-memory or on-disk storage and provides <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.1">get_all_data()</span> and <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.2">get_all_parameters()</span> helper functions to pass along data and parameters in the correct format. These functions are called during the Inference stage for later pre-processing within the <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.3">sbi</span>, <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.4">pydelfi</span>, and <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.5">lampe</span> backends. Within <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.1.6">LtU-ILI</span>, we provide several convenience classes to prepare data from either <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.7">numpy</span>-, <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.8">xarray</span>-, or <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.9">torch</span>-like data formats. Users are also can create their own data-loading objects, so long as they adhere to the aforementioned conventions.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2">For multi-round inference (Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS3" title="2.3 Sequential Learning ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.3</span></a>), the Data stage also provides a <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.2.1">simulate()</span> function, wherein the loader will execute an on-the-fly simulation for given parameters to generate data for efficient sequential learning. In the example class provided in <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.2.2">LtU-ILI</span>, users can initialize this stage with an arbitrary simulation function that intakes parameters <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">bold_italic_θ</annotation></semantics></math> and outputs data <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">bold_italic_x</annotation></semantics></math>, and the sequential Inference stage will handle any calls to the function. Also, users can load a pre-run initial catalog from file and write any newly-generated simulations to disk during the training procedure.
</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Inference</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.1.1">LtU-ILI</span> code encompasses a broad diversity of methodologies and architectures for performing implicit inference. However, the core configurations for all types of inference are universal.
Every Inference stage requires specifying: a posterior-, likelihood-, or ratio-estimation; one or multiple neural architectures; a prior distribution; and training hyperparameters (e.g. learning rate, batch size, etc.).</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Once these are provided, the Inference stage knows how to pull data-parameter pairs from the Data stage, perform data preprocessing, construct each training algorithm, minimize losses (see Equations <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E4" title="4 ‣ 2.2.1 Neural Posterior Estimation (NPE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">4</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E5" title="5 ‣ 2.2.2 Neural Likelihood Estimation (NLE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">5</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E9" title="9 ‣ 2.2.3 Neural Ratio Estimation (NRE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">9</span></a>), and produce a learned posterior model, <math alttext="\hat{\mathcal{P}}(\bm{\theta}|\bm{x})" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">𝒫</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">^</mo></mover><mo id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S3.SS2.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S3.SS2.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><times id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"></times><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><ci id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1">^</ci><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝒫</ci></apply><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2">𝜽</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\hat{\mathcal{P}}(\bm{\theta}|\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x )</annotation></semantics></math>. Each inference algorithm automatically implements best practices for training, including data normalization <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx87" title="">Singh and Singh(2020)</a>)</cite>, adaptive stochastic gradient descent <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx88" title="">Kingma and Ba(2014)</a>)</cite>, and validation-guided early stopping <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx89" title="">Bai <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Bai, Yang, Han, Yang, Li, Mao, Niu, and Liu</a>)</cite>. The remainder of this section is dedicated to the core considerations of configuring the Inference stage.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">The Inference stage is built on three distinct computational backends: <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.1">pydelfi</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx35" title="">Alsing <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Alsing, Charnock, Feeney, and Wandelt</a>)</cite>, <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.2">sbi</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx34" title="">Tejero-Cantero <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Tejero-Cantero, Boelts, Deistler, Lueckmann, Durkan, Gonçalves, Greenberg, and Macke</a>)</cite>, and <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.3">lampe</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx36" title="">Rozet <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Rozet, Delaunoy, Miller <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>. <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.4">pydelfi</span> is a Tensorflow package <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx90" title="">Abadi <em class="ltx_emph ltx_font_italic">et al.</em>(2016)Abadi, Barham, Chen, Chen, Davis, Dean, Devin, Ghemawat, Irving, Isard <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite> for performing NLE using active learning and data compression techniques. <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.5">sbi</span> is a PyTorch package <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx91" title="">Paszke <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Paszke, Gross, Massa, Lerer, Bradbury, Chanan, Killeen, Lin, Gimelshein, Antiga <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite> for performing NPE, NLE, and NRE, as well as their sequential analogs. <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.6">lampe</span> is also a PyTorch package focused on NPE methods, with substantial support for diverse embedding networks and normalizing flow models. The implementations of NLE in <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.7">pydelfi</span> and <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.8">sbi</span> are similar in theory <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx62" title="">Papamakarios <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Papamakarios, Sterratt, and Murray</a>)</cite> but differ in applications of embedding networks. <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.9">pydelfi</span> has the option to train in a two-step process, wherein first it trains an embedding network to optimally compress data via Fisher information maximization <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx92" title="">Charnock <em class="ltx_emph ltx_font_italic">et al.</em>(2018)Charnock, Lavaux, and Wandelt</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx93" title="">Alsing and Wandelt(2018)</a>)</cite> and then attaches it to the head of an NLE model, whereas <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.10">sbi</span> exclusively uses NLE embedding networks to compress parameters. <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.11">pydelfi</span>’s two-step compression-estimation process has been shown to significantly improve simulation-efficiency during sequential training for applications in cosmology <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx94" title="">Alsing <em class="ltx_emph ltx_font_italic">et al.</em>(2018)Alsing, Wandelt, and Feeney</a>)</cite>. The <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.12">lampe</span> NPE in <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p3.1.13">LtU-ILI</span> is a custom implementation of <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx95" title="">Lueckmann <em class="ltx_emph ltx_font_italic">et al.</em>(2017)Lueckmann, Goncalves, Bassetto, Öcal, Nonnenmacher, and Macke</a></cite>, similar to SNPE-B of <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.1.14">sbi</span> but allowing for greater variety of configuration, embedding networks, and NDEs.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p3.1.15">LtU-ILI</span> is a unifying framework for all of these mutually-exclusive backends, allowing, for the first time, convenient apples-to-apples comparison of each implementation of ILI.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">The Tensorflow and PyTorch backends have a variety of pre-implemented NDEs and ratio classifiers. The NDEs are either Mixture Density Networks (MDNs; See Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS2" title="2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.2</span></a>) or normalizing flows <cite class="ltx_cite ltx_citemacro_citep">(See <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx57" title="">Papamakarios <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Papamakarios, Nalisnick, Rezende, Mohamed, and Lakshminarayanan</a>, for a review)</cite>. The <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p4.1.1">pydelfi</span> architectures are implemented from scratch, whereas the <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p4.1.2">sbi</span> flow models utilize <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p4.1.3">nflows</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx96" title="">Durkan <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Durkan, Bekasov, Murray, and Papamakarios</a>)</cite> and <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p4.1.4">lampe</span> models utilize <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p4.1.5">zuko</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx97" title="">Rozet <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Rozet <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>. Both backends also accept various standard and customizable prior distributions. The primary requirement of a custom prior is the ability to evaluate <math alttext="\log p(\bm{\theta})" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.2" xref="S3.SS2.p4.1.m1.1.2.cmml"><mrow id="S3.SS2.p4.1.m1.1.2.2" xref="S3.SS2.p4.1.m1.1.2.2.cmml"><mi id="S3.SS2.p4.1.m1.1.2.2.1" xref="S3.SS2.p4.1.m1.1.2.2.1.cmml">log</mi><mo id="S3.SS2.p4.1.m1.1.2.2a" lspace="0.167em" xref="S3.SS2.p4.1.m1.1.2.2.cmml">⁡</mo><mi id="S3.SS2.p4.1.m1.1.2.2.2" xref="S3.SS2.p4.1.m1.1.2.2.2.cmml">p</mi></mrow><mo id="S3.SS2.p4.1.m1.1.2.1" xref="S3.SS2.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p4.1.m1.1.2.3.2" xref="S3.SS2.p4.1.m1.1.2.cmml"><mo id="S3.SS2.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p4.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">𝜽</mi><mo id="S3.SS2.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.2"><times id="S3.SS2.p4.1.m1.1.2.1.cmml" xref="S3.SS2.p4.1.m1.1.2.1"></times><apply id="S3.SS2.p4.1.m1.1.2.2.cmml" xref="S3.SS2.p4.1.m1.1.2.2"><log id="S3.SS2.p4.1.m1.1.2.2.1.cmml" xref="S3.SS2.p4.1.m1.1.2.2.1"></log><ci id="S3.SS2.p4.1.m1.1.2.2.2.cmml" xref="S3.SS2.p4.1.m1.1.2.2.2">𝑝</ci></apply><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\log p(\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">roman_log italic_p ( bold_italic_θ )</annotation></semantics></math> (for NDE models) or a proportional proxy (for NLE/NRE models). If the assumed prior’s support is bounded (<em class="ltx_emph ltx_font_italic" id="S3.SS2.p4.1.6">e.g.,</em> a top-hat prior), the code internally implements an affine parameter transformation to avoid assigning a nonzero probability to regions of parameter space beyond prior bounds.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1">A key component of <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p5.1.1">LtU-ILI</span> is model ensembling, wherein we independently train multiple neural networks on the same dataset and combine their predictions to improve robustness to overfitting and model uncertainty. Singular NDEs are prone to overconfidence <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx98" title="">Hermans <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Hermans, Delaunoy, Rozet, Wehenkel, Begy, and Louppe</a>)</cite>, <em class="ltx_emph ltx_font_italic" id="S3.SS2.p5.1.2">i.e.,</em> they have a tendency to underestimate the predictive uncertainty. Deep ensembling <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx27" title="">Lakshminarayanan <em class="ltx_emph ltx_font_italic">et al.</em>(2017)Lakshminarayanan, Pritzel, and Blundell</a>)</cite> is a well-tested schema for correcting overconfidence by averaging NDE predictions from multiple models to inflate error bars and correctly capture model uncertainty. It is an alternative to the computationally-expensive Bayesian neural networks <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx99" title="">Blundell <em class="ltx_emph ltx_font_italic">et al.</em>(2015)Blundell, Cornebise, Kavukcuoglu, and Wierstra</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx26" title="">Gal and Ghahramani(2016)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx100" title="">Cobb and Jalaian(2021)</a>)</cite>, in which the full weight posterior is learned during training and sampled during inference. We recommend that users utilize deep ensembles to ensure robust inference within <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p5.1.3">LtU-ILI</span>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.1">The adaptability of neural networks to various data inputs has greatly contributed to their growth in astronomy and cosmology. The convenient implementations of the various NDEs and classifiers in <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p6.1.1">LtU-ILI</span> can be further augmented with customizable embedding networks. These embedding networks can use classic <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p6.1.2">Keras</span>-like neural layers <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx101" title="">Chollet <em class="ltx_emph ltx_font_italic">et al.</em>(2015)Chollet <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite> in both Tensorflow and PyTorch, greatly simplifying implementation. The integration with embedding networks in the <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p6.1.3">lampe</span> backend allow for exotic inputs, like graphs and sequences. In the code, we provide several examples of embedding networks, including connections to convolutional and graph neural networks <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx102" title="">LeCun <em class="ltx_emph ltx_font_italic">et al.</em>(1998)LeCun, Bottou, Bengio, and Haffner</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx103" title="">Kipf and Welling(2016)</a>)</cite>. We also note that all backends can be run on GPUs, to take advantage of computational speed-ups when using complex embedding networks.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Validation</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The Validation stage provides modular functions to implement the validation metrics described in Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS4" title="2.4 Validation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.4</span></a> on the learned posteriors <math alttext="\hat{\mathcal{P}}(\bm{\theta}|\bm{x})" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml">𝒫</mi><mo id="S3.SS3.p1.1.m1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">^</mo></mover><mo id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.1.m1.1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S3.SS3.p1.1.m1.1.1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S3.SS3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><times id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2"></times><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><ci id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.1">^</ci><ci id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">𝒫</ci></apply><apply id="S3.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2">𝜽</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\hat{\mathcal{P}}(\bm{\theta}|\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x )</annotation></semantics></math>. The execution of the Validation stage follows:</p>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1">Load the learned neural posteriors from the Inference Stage.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.3">Sample the posterior <math alttext="\hat{\bm{\theta}}\sim\hat{\mathcal{P}}(\bm{\theta}|\bm{x})" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><mrow id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.3.2" xref="S3.I1.i2.p1.1.m1.1.1.3.2.cmml">𝜽</mi><mo id="S3.I1.i2.p1.1.m1.1.1.3.1" xref="S3.I1.i2.p1.1.m1.1.1.3.1.cmml">^</mo></mover><mo id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml">∼</mo><mrow id="S3.I1.i2.p1.1.m1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.cmml"><mover accent="true" id="S3.I1.i2.p1.1.m1.1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p1.1.m1.1.1.1.3.2" xref="S3.I1.i2.p1.1.m1.1.1.1.3.2.cmml">𝒫</mi><mo id="S3.I1.i2.p1.1.m1.1.1.1.3.1" xref="S3.I1.i2.p1.1.m1.1.1.1.3.1.cmml">^</mo></mover><mo id="S3.I1.i2.p1.1.m1.1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.I1.i2.p1.1.m1.1.1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.I1.i2.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.1.m1.1.1.1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml">𝜽</mi><mo fence="false" id="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S3.I1.i2.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><csymbol cd="latexml" id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">similar-to</csymbol><apply id="S3.I1.i2.p1.1.m1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3"><ci id="S3.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.1">^</ci><ci id="S3.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.2">𝜽</ci></apply><apply id="S3.I1.i2.p1.1.m1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1"><times id="S3.I1.i2.p1.1.m1.1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.2"></times><apply id="S3.I1.i2.p1.1.m1.1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.3"><ci id="S3.I1.i2.p1.1.m1.1.1.1.3.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.3.1">^</ci><ci id="S3.I1.i2.p1.1.m1.1.1.1.3.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.3.2">𝒫</ci></apply><apply id="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.2">𝜽</ci><ci id="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">\hat{\bm{\theta}}\sim\hat{\mathcal{P}}(\bm{\theta}|\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">over^ start_ARG bold_italic_θ end_ARG ∼ over^ start_ARG caligraphic_P end_ARG ( bold_italic_θ | bold_italic_x )</annotation></semantics></math> at test data points, <math alttext="\mathcal{D}_{\rm test}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.1"><semantics id="S3.I1.i2.p1.2.m2.1a"><msub id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p1.2.m2.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.2.cmml">𝒟</mi><mi id="S3.I1.i2.p1.2.m2.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml">test</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><apply id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.2.m2.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2">𝒟</ci><ci id="S3.I1.i2.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3">test</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">\mathcal{D}_{\rm test}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_test end_POSTSUBSCRIPT</annotation></semantics></math>, or at an unlabeled observational point, <math alttext="\bm{x}_{\rm obs}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.3.m3.1"><semantics id="S3.I1.i2.p1.3.m3.1a"><msub id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml"><mi id="S3.I1.i2.p1.3.m3.1.1.2" xref="S3.I1.i2.p1.3.m3.1.1.2.cmml">𝒙</mi><mi id="S3.I1.i2.p1.3.m3.1.1.3" xref="S3.I1.i2.p1.3.m3.1.1.3.cmml">obs</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.1b"><apply id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.3.m3.1.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.3.m3.1.1.2.cmml" xref="S3.I1.i2.p1.3.m3.1.1.2">𝒙</ci><ci id="S3.I1.i2.p1.3.m3.1.1.3.cmml" xref="S3.I1.i2.p1.3.m3.1.1.3">obs</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.1c">\bm{x}_{\rm obs}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.3.m3.1d">bold_italic_x start_POSTSUBSCRIPT roman_obs end_POSTSUBSCRIPT</annotation></semantics></math>.
</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1">Construct the validation metric and return or save it to file.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">The most impactful configuration of the Validation stage is the choice of sampling methods. <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.1.1">LtU-ILI</span> provides three classes of samplers: MCMC, variational inference (VI), and direct sampling.
All models (NPE/NLE/NRE) in both backends are natively integrated with the <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.1.2">emcee</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx104" title="">Foreman-Mackey <em class="ltx_emph ltx_font_italic">et al.</em>(2013)Foreman-Mackey, Hogg, Lang, and Goodman</a>)</cite> sampling package. <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.1.3">emcee</span> implements the <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx105" title="">Goodman and Weare(2010)</a></cite> MCMC sampler and improves efficiency through parallelization and affine transformations but does not take advantage of probability gradients. The <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.1.4">sbi</span> models also have access to <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.1.5">PyTorch</span>’s <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.1.6">pyro</span> samplers <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx106" title="">Bingham <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Bingham, Chen, Jankowiak, Obermeyer, Pradhan, Karaletsos, Singh, Szerlip, Horsfall, and Goodman</a>)</cite>, including slice samplers <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx107" title="">Neal(2003)</a>)</cite>, Hamiltonian Monte Carlo <cite class="ltx_cite ltx_citemacro_citep">(HMC; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx108" title="">Neal <em class="ltx_emph ltx_font_italic">et al.</em>(2011)Neal <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>, and the No-U-Turn sampler <cite class="ltx_cite ltx_citemacro_citep">(NUTS; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx109" title="">Hoffman <em class="ltx_emph ltx_font_italic">et al.</em>(2014)Hoffman, Gelman <em class="ltx_emph ltx_font_italic">et al.</em></a>)</cite>. All <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.1.7">emcee</span> and <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.1.8">pyro</span> samplers have a unified interface within <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.1.9">LtU-ILI</span>, wherein users can simply specify their choice of sampler as well as the number, length, and thinning of MCMC chains. Also, we provide the functionality for <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.1.10">sbi</span> models to fit and sample from NDEs through neural VI <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx110" title="">Graves(2011)</a>)</cite>. VI is a fast, approximate alternative to MCMC sampling, particularly useful in the high-dimensional parameter regime. Lastly, solely for the NPE models in <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.1.11">sbi</span>, users can utilize direct sampling, which is faster than both MCMC and VI. We remark that the choice of sampling configuration might change according to the validation metric in question, so <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.1.12">LtU-ILI</span> allows for the flexibility to specify this on a case-by-case basis.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Synthetic Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we demonstrate the capabilities of <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.1">LtU-ILI</span> on a number of synthetic experiments for which an analytic form for the posterior or likelihood is known. We use these traditional experiments to measure benchmark performance the variety of inference engines available in the code against each other and classical methods (<em class="ltx_emph ltx_font_italic" id="S4.p1.1.2">e.g.,</em> ABC, HMC).</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Toy Problem</h3>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="817" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Example SNPE posterior inference in comparison to classical implicit (Rejection ABC) and explicit (HMC) likelihood inference for the known toy simulator in Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S4.E14" title="14 ‣ 4.1 Toy Problem ‣ 4 Synthetic Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">14</span></a>. The true value for each parameter is shown in red and contours are shown at the central <math alttext="68\%" class="ltx_Math" display="inline" id="S4.F3.5.m1.1"><semantics id="S4.F3.5.m1.1b"><mrow id="S4.F3.5.m1.1.1" xref="S4.F3.5.m1.1.1.cmml"><mn id="S4.F3.5.m1.1.1.2" xref="S4.F3.5.m1.1.1.2.cmml">68</mn><mo id="S4.F3.5.m1.1.1.1" xref="S4.F3.5.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.5.m1.1c"><apply id="S4.F3.5.m1.1.1.cmml" xref="S4.F3.5.m1.1.1"><csymbol cd="latexml" id="S4.F3.5.m1.1.1.1.cmml" xref="S4.F3.5.m1.1.1.1">percent</csymbol><cn id="S4.F3.5.m1.1.1.2.cmml" type="integer" xref="S4.F3.5.m1.1.1.2">68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.m1.1d">68\%</annotation><annotation encoding="application/x-llamapun" id="S4.F3.5.m1.1e">68 %</annotation></semantics></math> and <math alttext="95\%" class="ltx_Math" display="inline" id="S4.F3.6.m2.1"><semantics id="S4.F3.6.m2.1b"><mrow id="S4.F3.6.m2.1.1" xref="S4.F3.6.m2.1.1.cmml"><mn id="S4.F3.6.m2.1.1.2" xref="S4.F3.6.m2.1.1.2.cmml">95</mn><mo id="S4.F3.6.m2.1.1.1" xref="S4.F3.6.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.6.m2.1c"><apply id="S4.F3.6.m2.1.1.cmml" xref="S4.F3.6.m2.1.1"><csymbol cd="latexml" id="S4.F3.6.m2.1.1.1.cmml" xref="S4.F3.6.m2.1.1.1">percent</csymbol><cn id="S4.F3.6.m2.1.1.2.cmml" type="integer" xref="S4.F3.6.m2.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.6.m2.1d">95\%</annotation><annotation encoding="application/x-llamapun" id="S4.F3.6.m2.1e">95 %</annotation></semantics></math> confidence intervals. Note that the prior for each <math alttext="\theta_{i}" class="ltx_Math" display="inline" id="S4.F3.7.m3.1"><semantics id="S4.F3.7.m3.1b"><msub id="S4.F3.7.m3.1.1" xref="S4.F3.7.m3.1.1.cmml"><mi id="S4.F3.7.m3.1.1.2" xref="S4.F3.7.m3.1.1.2.cmml">θ</mi><mi id="S4.F3.7.m3.1.1.3" xref="S4.F3.7.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F3.7.m3.1c"><apply id="S4.F3.7.m3.1.1.cmml" xref="S4.F3.7.m3.1.1"><csymbol cd="ambiguous" id="S4.F3.7.m3.1.1.1.cmml" xref="S4.F3.7.m3.1.1">subscript</csymbol><ci id="S4.F3.7.m3.1.1.2.cmml" xref="S4.F3.7.m3.1.1.2">𝜃</ci><ci id="S4.F3.7.m3.1.1.3.cmml" xref="S4.F3.7.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.7.m3.1d">\theta_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.7.m3.1e">italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a standard normal, as <math alttext="p(\theta_{i})=\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S4.F3.8.m4.3"><semantics id="S4.F3.8.m4.3b"><mrow id="S4.F3.8.m4.3.3" xref="S4.F3.8.m4.3.3.cmml"><mrow id="S4.F3.8.m4.3.3.1" xref="S4.F3.8.m4.3.3.1.cmml"><mi id="S4.F3.8.m4.3.3.1.3" xref="S4.F3.8.m4.3.3.1.3.cmml">p</mi><mo id="S4.F3.8.m4.3.3.1.2" xref="S4.F3.8.m4.3.3.1.2.cmml">⁢</mo><mrow id="S4.F3.8.m4.3.3.1.1.1" xref="S4.F3.8.m4.3.3.1.1.1.1.cmml"><mo id="S4.F3.8.m4.3.3.1.1.1.2" stretchy="false" xref="S4.F3.8.m4.3.3.1.1.1.1.cmml">(</mo><msub id="S4.F3.8.m4.3.3.1.1.1.1" xref="S4.F3.8.m4.3.3.1.1.1.1.cmml"><mi id="S4.F3.8.m4.3.3.1.1.1.1.2" xref="S4.F3.8.m4.3.3.1.1.1.1.2.cmml">θ</mi><mi id="S4.F3.8.m4.3.3.1.1.1.1.3" xref="S4.F3.8.m4.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.F3.8.m4.3.3.1.1.1.3" stretchy="false" xref="S4.F3.8.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.F3.8.m4.3.3.2" xref="S4.F3.8.m4.3.3.2.cmml">=</mo><mrow id="S4.F3.8.m4.3.3.3" xref="S4.F3.8.m4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F3.8.m4.3.3.3.2" xref="S4.F3.8.m4.3.3.3.2.cmml">𝒩</mi><mo id="S4.F3.8.m4.3.3.3.1" xref="S4.F3.8.m4.3.3.3.1.cmml">⁢</mo><mrow id="S4.F3.8.m4.3.3.3.3.2" xref="S4.F3.8.m4.3.3.3.3.1.cmml"><mo id="S4.F3.8.m4.3.3.3.3.2.1" stretchy="false" xref="S4.F3.8.m4.3.3.3.3.1.cmml">(</mo><mn id="S4.F3.8.m4.1.1" xref="S4.F3.8.m4.1.1.cmml">0</mn><mo id="S4.F3.8.m4.3.3.3.3.2.2" xref="S4.F3.8.m4.3.3.3.3.1.cmml">,</mo><mn id="S4.F3.8.m4.2.2" xref="S4.F3.8.m4.2.2.cmml">1</mn><mo id="S4.F3.8.m4.3.3.3.3.2.3" stretchy="false" xref="S4.F3.8.m4.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.8.m4.3c"><apply id="S4.F3.8.m4.3.3.cmml" xref="S4.F3.8.m4.3.3"><eq id="S4.F3.8.m4.3.3.2.cmml" xref="S4.F3.8.m4.3.3.2"></eq><apply id="S4.F3.8.m4.3.3.1.cmml" xref="S4.F3.8.m4.3.3.1"><times id="S4.F3.8.m4.3.3.1.2.cmml" xref="S4.F3.8.m4.3.3.1.2"></times><ci id="S4.F3.8.m4.3.3.1.3.cmml" xref="S4.F3.8.m4.3.3.1.3">𝑝</ci><apply id="S4.F3.8.m4.3.3.1.1.1.1.cmml" xref="S4.F3.8.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.F3.8.m4.3.3.1.1.1.1.1.cmml" xref="S4.F3.8.m4.3.3.1.1.1">subscript</csymbol><ci id="S4.F3.8.m4.3.3.1.1.1.1.2.cmml" xref="S4.F3.8.m4.3.3.1.1.1.1.2">𝜃</ci><ci id="S4.F3.8.m4.3.3.1.1.1.1.3.cmml" xref="S4.F3.8.m4.3.3.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.F3.8.m4.3.3.3.cmml" xref="S4.F3.8.m4.3.3.3"><times id="S4.F3.8.m4.3.3.3.1.cmml" xref="S4.F3.8.m4.3.3.3.1"></times><ci id="S4.F3.8.m4.3.3.3.2.cmml" xref="S4.F3.8.m4.3.3.3.2">𝒩</ci><interval closure="open" id="S4.F3.8.m4.3.3.3.3.1.cmml" xref="S4.F3.8.m4.3.3.3.3.2"><cn id="S4.F3.8.m4.1.1.cmml" type="integer" xref="S4.F3.8.m4.1.1">0</cn><cn id="S4.F3.8.m4.2.2.cmml" type="integer" xref="S4.F3.8.m4.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.8.m4.3d">p(\theta_{i})=\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.F3.8.m4.3e">italic_p ( italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = caligraphic_N ( 0 , 1 )</annotation></semantics></math>.
</figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We first build a toy model to demonstrate <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.1">LtU-ILI</span>’s ability to learn non-linear posteriors. We consider a 10-dimensional data vector <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">bold_italic_x</annotation></semantics></math> constructed element-wise from the following stochastic simulator:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="x_{i}=3\sin(k_{i}+\phi_{0})+\phi_{1}k_{i}^{2}+\epsilon_{i}," class="ltx_Math" display="block" id="S4.E14.m1.2"><semantics id="S4.E14.m1.2a"><mrow id="S4.E14.m1.2.2.1" xref="S4.E14.m1.2.2.1.1.cmml"><mrow id="S4.E14.m1.2.2.1.1" xref="S4.E14.m1.2.2.1.1.cmml"><msub id="S4.E14.m1.2.2.1.1.3" xref="S4.E14.m1.2.2.1.1.3.cmml"><mi id="S4.E14.m1.2.2.1.1.3.2" xref="S4.E14.m1.2.2.1.1.3.2.cmml">x</mi><mi id="S4.E14.m1.2.2.1.1.3.3" xref="S4.E14.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S4.E14.m1.2.2.1.1.2" xref="S4.E14.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E14.m1.2.2.1.1.1" xref="S4.E14.m1.2.2.1.1.1.cmml"><mrow id="S4.E14.m1.2.2.1.1.1.1" xref="S4.E14.m1.2.2.1.1.1.1.cmml"><mn id="S4.E14.m1.2.2.1.1.1.1.3" xref="S4.E14.m1.2.2.1.1.1.1.3.cmml">3</mn><mo id="S4.E14.m1.2.2.1.1.1.1.2" lspace="0.167em" xref="S4.E14.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.2.2.1.1.1.1.1.1" xref="S4.E14.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.1.1" xref="S4.E14.m1.1.1.cmml">sin</mi><mo id="S4.E14.m1.2.2.1.1.1.1.1.1a" xref="S4.E14.m1.2.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E14.m1.2.2.1.1.1.1.1.1.1" xref="S4.E14.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S4.E14.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mrow id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">k</mi><mi id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mn id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S4.E14.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E14.m1.2.2.1.1.1.2" xref="S4.E14.m1.2.2.1.1.1.2.cmml">+</mo><mrow id="S4.E14.m1.2.2.1.1.1.3" xref="S4.E14.m1.2.2.1.1.1.3.cmml"><msub id="S4.E14.m1.2.2.1.1.1.3.2" xref="S4.E14.m1.2.2.1.1.1.3.2.cmml"><mi id="S4.E14.m1.2.2.1.1.1.3.2.2" xref="S4.E14.m1.2.2.1.1.1.3.2.2.cmml">ϕ</mi><mn id="S4.E14.m1.2.2.1.1.1.3.2.3" xref="S4.E14.m1.2.2.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S4.E14.m1.2.2.1.1.1.3.1" xref="S4.E14.m1.2.2.1.1.1.3.1.cmml">⁢</mo><msubsup id="S4.E14.m1.2.2.1.1.1.3.3" xref="S4.E14.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.E14.m1.2.2.1.1.1.3.3.2.2" xref="S4.E14.m1.2.2.1.1.1.3.3.2.2.cmml">k</mi><mi id="S4.E14.m1.2.2.1.1.1.3.3.2.3" xref="S4.E14.m1.2.2.1.1.1.3.3.2.3.cmml">i</mi><mn id="S4.E14.m1.2.2.1.1.1.3.3.3" xref="S4.E14.m1.2.2.1.1.1.3.3.3.cmml">2</mn></msubsup></mrow><mo id="S4.E14.m1.2.2.1.1.1.2a" xref="S4.E14.m1.2.2.1.1.1.2.cmml">+</mo><msub id="S4.E14.m1.2.2.1.1.1.4" xref="S4.E14.m1.2.2.1.1.1.4.cmml"><mi id="S4.E14.m1.2.2.1.1.1.4.2" xref="S4.E14.m1.2.2.1.1.1.4.2.cmml">ϵ</mi><mi id="S4.E14.m1.2.2.1.1.1.4.3" xref="S4.E14.m1.2.2.1.1.1.4.3.cmml">i</mi></msub></mrow></mrow><mo id="S4.E14.m1.2.2.1.2" xref="S4.E14.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.2b"><apply id="S4.E14.m1.2.2.1.1.cmml" xref="S4.E14.m1.2.2.1"><eq id="S4.E14.m1.2.2.1.1.2.cmml" xref="S4.E14.m1.2.2.1.1.2"></eq><apply id="S4.E14.m1.2.2.1.1.3.cmml" xref="S4.E14.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.1.1.3.1.cmml" xref="S4.E14.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.E14.m1.2.2.1.1.3.2.cmml" xref="S4.E14.m1.2.2.1.1.3.2">𝑥</ci><ci id="S4.E14.m1.2.2.1.1.3.3.cmml" xref="S4.E14.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S4.E14.m1.2.2.1.1.1.cmml" xref="S4.E14.m1.2.2.1.1.1"><plus id="S4.E14.m1.2.2.1.1.1.2.cmml" xref="S4.E14.m1.2.2.1.1.1.2"></plus><apply id="S4.E14.m1.2.2.1.1.1.1.cmml" xref="S4.E14.m1.2.2.1.1.1.1"><times id="S4.E14.m1.2.2.1.1.1.1.2.cmml" xref="S4.E14.m1.2.2.1.1.1.1.2"></times><cn id="S4.E14.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.E14.m1.2.2.1.1.1.1.3">3</cn><apply id="S4.E14.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E14.m1.2.2.1.1.1.1.1.1"><sin id="S4.E14.m1.1.1.cmml" xref="S4.E14.m1.1.1"></sin><apply id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1"><plus id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑘</ci><ci id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><cn id="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E14.m1.2.2.1.1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply></apply><apply id="S4.E14.m1.2.2.1.1.1.3.cmml" xref="S4.E14.m1.2.2.1.1.1.3"><times id="S4.E14.m1.2.2.1.1.1.3.1.cmml" xref="S4.E14.m1.2.2.1.1.1.3.1"></times><apply id="S4.E14.m1.2.2.1.1.1.3.2.cmml" xref="S4.E14.m1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.1.1.1.3.2.1.cmml" xref="S4.E14.m1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S4.E14.m1.2.2.1.1.1.3.2.2.cmml" xref="S4.E14.m1.2.2.1.1.1.3.2.2">italic-ϕ</ci><cn id="S4.E14.m1.2.2.1.1.1.3.2.3.cmml" type="integer" xref="S4.E14.m1.2.2.1.1.1.3.2.3">1</cn></apply><apply id="S4.E14.m1.2.2.1.1.1.3.3.cmml" xref="S4.E14.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.E14.m1.2.2.1.1.1.3.3">superscript</csymbol><apply id="S4.E14.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.E14.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.1.1.1.3.3.2.1.cmml" xref="S4.E14.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.E14.m1.2.2.1.1.1.3.3.2.2.cmml" xref="S4.E14.m1.2.2.1.1.1.3.3.2.2">𝑘</ci><ci id="S4.E14.m1.2.2.1.1.1.3.3.2.3.cmml" xref="S4.E14.m1.2.2.1.1.1.3.3.2.3">𝑖</ci></apply><cn id="S4.E14.m1.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S4.E14.m1.2.2.1.1.1.3.3.3">2</cn></apply></apply><apply id="S4.E14.m1.2.2.1.1.1.4.cmml" xref="S4.E14.m1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.1.1.1.4.1.cmml" xref="S4.E14.m1.2.2.1.1.1.4">subscript</csymbol><ci id="S4.E14.m1.2.2.1.1.1.4.2.cmml" xref="S4.E14.m1.2.2.1.1.1.4.2">italic-ϵ</ci><ci id="S4.E14.m1.2.2.1.1.1.4.3.cmml" xref="S4.E14.m1.2.2.1.1.1.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.2c">x_{i}=3\sin(k_{i}+\phi_{0})+\phi_{1}k_{i}^{2}+\epsilon_{i},</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.2d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 3 roman_sin ( italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_ϕ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) + italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.14">where <math alttext="k_{i}=(2i/3)-3" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m1.1"><semantics id="S4.SS1.p1.2.m1.1a"><mrow id="S4.SS1.p1.2.m1.1.1" xref="S4.SS1.p1.2.m1.1.1.cmml"><msub id="S4.SS1.p1.2.m1.1.1.3" xref="S4.SS1.p1.2.m1.1.1.3.cmml"><mi id="S4.SS1.p1.2.m1.1.1.3.2" xref="S4.SS1.p1.2.m1.1.1.3.2.cmml">k</mi><mi id="S4.SS1.p1.2.m1.1.1.3.3" xref="S4.SS1.p1.2.m1.1.1.3.3.cmml">i</mi></msub><mo id="S4.SS1.p1.2.m1.1.1.2" xref="S4.SS1.p1.2.m1.1.1.2.cmml">=</mo><mrow id="S4.SS1.p1.2.m1.1.1.1" xref="S4.SS1.p1.2.m1.1.1.1.cmml"><mrow id="S4.SS1.p1.2.m1.1.1.1.1.1" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS1.p1.2.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.2.m1.1.1.1.1.1.1" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.cmml"><mrow id="S4.SS1.p1.2.m1.1.1.1.1.1.1.2" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.cmml"><mn id="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.2" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.2.cmml">2</mn><mo id="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.1" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.3" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.3.cmml">i</mi></mrow><mo id="S4.SS1.p1.2.m1.1.1.1.1.1.1.1" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.1.cmml">/</mo><mn id="S4.SS1.p1.2.m1.1.1.1.1.1.1.3" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.3.cmml">3</mn></mrow><mo id="S4.SS1.p1.2.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS1.p1.2.m1.1.1.1.2" xref="S4.SS1.p1.2.m1.1.1.1.2.cmml">−</mo><mn id="S4.SS1.p1.2.m1.1.1.1.3" xref="S4.SS1.p1.2.m1.1.1.1.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m1.1b"><apply id="S4.SS1.p1.2.m1.1.1.cmml" xref="S4.SS1.p1.2.m1.1.1"><eq id="S4.SS1.p1.2.m1.1.1.2.cmml" xref="S4.SS1.p1.2.m1.1.1.2"></eq><apply id="S4.SS1.p1.2.m1.1.1.3.cmml" xref="S4.SS1.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m1.1.1.3.1.cmml" xref="S4.SS1.p1.2.m1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.2.m1.1.1.3.2.cmml" xref="S4.SS1.p1.2.m1.1.1.3.2">𝑘</ci><ci id="S4.SS1.p1.2.m1.1.1.3.3.cmml" xref="S4.SS1.p1.2.m1.1.1.3.3">𝑖</ci></apply><apply id="S4.SS1.p1.2.m1.1.1.1.cmml" xref="S4.SS1.p1.2.m1.1.1.1"><minus id="S4.SS1.p1.2.m1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m1.1.1.1.2"></minus><apply id="S4.SS1.p1.2.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m1.1.1.1.1.1"><divide id="S4.SS1.p1.2.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.1"></divide><apply id="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.2"><times id="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.1"></times><cn id="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.2">2</cn><ci id="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="S4.SS1.p1.2.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m1.1.1.1.1.1.1.3">3</cn></apply><cn id="S4.SS1.p1.2.m1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m1.1.1.1.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m1.1c">k_{i}=(2i/3)-3</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m1.1d">italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( 2 italic_i / 3 ) - 3</annotation></semantics></math> and <math alttext="i\in[0,9]" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m2.2"><semantics id="S4.SS1.p1.3.m2.2a"><mrow id="S4.SS1.p1.3.m2.2.3" xref="S4.SS1.p1.3.m2.2.3.cmml"><mi id="S4.SS1.p1.3.m2.2.3.2" xref="S4.SS1.p1.3.m2.2.3.2.cmml">i</mi><mo id="S4.SS1.p1.3.m2.2.3.1" xref="S4.SS1.p1.3.m2.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p1.3.m2.2.3.3.2" xref="S4.SS1.p1.3.m2.2.3.3.1.cmml"><mo id="S4.SS1.p1.3.m2.2.3.3.2.1" stretchy="false" xref="S4.SS1.p1.3.m2.2.3.3.1.cmml">[</mo><mn id="S4.SS1.p1.3.m2.1.1" xref="S4.SS1.p1.3.m2.1.1.cmml">0</mn><mo id="S4.SS1.p1.3.m2.2.3.3.2.2" xref="S4.SS1.p1.3.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p1.3.m2.2.2" xref="S4.SS1.p1.3.m2.2.2.cmml">9</mn><mo id="S4.SS1.p1.3.m2.2.3.3.2.3" stretchy="false" xref="S4.SS1.p1.3.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m2.2b"><apply id="S4.SS1.p1.3.m2.2.3.cmml" xref="S4.SS1.p1.3.m2.2.3"><in id="S4.SS1.p1.3.m2.2.3.1.cmml" xref="S4.SS1.p1.3.m2.2.3.1"></in><ci id="S4.SS1.p1.3.m2.2.3.2.cmml" xref="S4.SS1.p1.3.m2.2.3.2">𝑖</ci><interval closure="closed" id="S4.SS1.p1.3.m2.2.3.3.1.cmml" xref="S4.SS1.p1.3.m2.2.3.3.2"><cn id="S4.SS1.p1.3.m2.1.1.cmml" type="integer" xref="S4.SS1.p1.3.m2.1.1">0</cn><cn id="S4.SS1.p1.3.m2.2.2.cmml" type="integer" xref="S4.SS1.p1.3.m2.2.2">9</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m2.2c">i\in[0,9]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m2.2d">italic_i ∈ [ 0 , 9 ]</annotation></semantics></math>.
Here, the data vector <math alttext="\bm{x}:=\{x_{i}\}_{i=0}^{9}\in\mathbb{R}^{10}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m3.1"><semantics id="S4.SS1.p1.4.m3.1a"><mrow id="S4.SS1.p1.4.m3.1.1" xref="S4.SS1.p1.4.m3.1.1.cmml"><mi id="S4.SS1.p1.4.m3.1.1.3" xref="S4.SS1.p1.4.m3.1.1.3.cmml">𝒙</mi><mo id="S4.SS1.p1.4.m3.1.1.4" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p1.4.m3.1.1.4.cmml">:=</mo><msubsup id="S4.SS1.p1.4.m3.1.1.1" xref="S4.SS1.p1.4.m3.1.1.1.cmml"><mrow id="S4.SS1.p1.4.m3.1.1.1.1.1.1" xref="S4.SS1.p1.4.m3.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p1.4.m3.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.4.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p1.4.m3.1.1.1.1.1.1.1" xref="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p1.4.m3.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p1.4.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p1.4.m3.1.1.1.1.3" xref="S4.SS1.p1.4.m3.1.1.1.1.3.cmml"><mi id="S4.SS1.p1.4.m3.1.1.1.1.3.2" xref="S4.SS1.p1.4.m3.1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p1.4.m3.1.1.1.1.3.1" xref="S4.SS1.p1.4.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p1.4.m3.1.1.1.1.3.3" xref="S4.SS1.p1.4.m3.1.1.1.1.3.3.cmml">0</mn></mrow><mn id="S4.SS1.p1.4.m3.1.1.1.3" xref="S4.SS1.p1.4.m3.1.1.1.3.cmml">9</mn></msubsup><mo id="S4.SS1.p1.4.m3.1.1.5" xref="S4.SS1.p1.4.m3.1.1.5.cmml">∈</mo><msup id="S4.SS1.p1.4.m3.1.1.6" xref="S4.SS1.p1.4.m3.1.1.6.cmml"><mi id="S4.SS1.p1.4.m3.1.1.6.2" xref="S4.SS1.p1.4.m3.1.1.6.2.cmml">ℝ</mi><mn id="S4.SS1.p1.4.m3.1.1.6.3" xref="S4.SS1.p1.4.m3.1.1.6.3.cmml">10</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m3.1b"><apply id="S4.SS1.p1.4.m3.1.1.cmml" xref="S4.SS1.p1.4.m3.1.1"><and id="S4.SS1.p1.4.m3.1.1a.cmml" xref="S4.SS1.p1.4.m3.1.1"></and><apply id="S4.SS1.p1.4.m3.1.1b.cmml" xref="S4.SS1.p1.4.m3.1.1"><csymbol cd="latexml" id="S4.SS1.p1.4.m3.1.1.4.cmml" xref="S4.SS1.p1.4.m3.1.1.4">assign</csymbol><ci id="S4.SS1.p1.4.m3.1.1.3.cmml" xref="S4.SS1.p1.4.m3.1.1.3">𝒙</ci><apply id="S4.SS1.p1.4.m3.1.1.1.cmml" xref="S4.SS1.p1.4.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m3.1.1.1.2.cmml" xref="S4.SS1.p1.4.m3.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.4.m3.1.1.1.1.cmml" xref="S4.SS1.p1.4.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m3.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m3.1.1.1">subscript</csymbol><set id="S4.SS1.p1.4.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.1.1"><apply id="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS1.p1.4.m3.1.1.1.1.3.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.3"><eq id="S4.SS1.p1.4.m3.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.3.1"></eq><ci id="S4.SS1.p1.4.m3.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.3.2">𝑖</ci><cn id="S4.SS1.p1.4.m3.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p1.4.m3.1.1.1.1.3.3">0</cn></apply></apply><cn id="S4.SS1.p1.4.m3.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.4.m3.1.1.1.3">9</cn></apply></apply><apply id="S4.SS1.p1.4.m3.1.1c.cmml" xref="S4.SS1.p1.4.m3.1.1"><in id="S4.SS1.p1.4.m3.1.1.5.cmml" xref="S4.SS1.p1.4.m3.1.1.5"></in><share href="#S4.SS1.p1.4.m3.1.1.1.cmml" id="S4.SS1.p1.4.m3.1.1d.cmml" xref="S4.SS1.p1.4.m3.1.1"></share><apply id="S4.SS1.p1.4.m3.1.1.6.cmml" xref="S4.SS1.p1.4.m3.1.1.6"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m3.1.1.6.1.cmml" xref="S4.SS1.p1.4.m3.1.1.6">superscript</csymbol><ci id="S4.SS1.p1.4.m3.1.1.6.2.cmml" xref="S4.SS1.p1.4.m3.1.1.6.2">ℝ</ci><cn id="S4.SS1.p1.4.m3.1.1.6.3.cmml" type="integer" xref="S4.SS1.p1.4.m3.1.1.6.3">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m3.1c">\bm{x}:=\{x_{i}\}_{i=0}^{9}\in\mathbb{R}^{10}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m3.1d">bold_italic_x := { italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 9 end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 10 end_POSTSUPERSCRIPT</annotation></semantics></math> is composed of a sinusoidal signal with phase <math alttext="\phi_{0}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m4.1"><semantics id="S4.SS1.p1.5.m4.1a"><msub id="S4.SS1.p1.5.m4.1.1" xref="S4.SS1.p1.5.m4.1.1.cmml"><mi id="S4.SS1.p1.5.m4.1.1.2" xref="S4.SS1.p1.5.m4.1.1.2.cmml">ϕ</mi><mn id="S4.SS1.p1.5.m4.1.1.3" xref="S4.SS1.p1.5.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m4.1b"><apply id="S4.SS1.p1.5.m4.1.1.cmml" xref="S4.SS1.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m4.1.1.1.cmml" xref="S4.SS1.p1.5.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m4.1.1.2.cmml" xref="S4.SS1.p1.5.m4.1.1.2">italic-ϕ</ci><cn id="S4.SS1.p1.5.m4.1.1.3.cmml" type="integer" xref="S4.SS1.p1.5.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m4.1c">\phi_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m4.1d">italic_ϕ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, a quadratic signal of amplitude <math alttext="\phi_{1}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m5.1"><semantics id="S4.SS1.p1.6.m5.1a"><msub id="S4.SS1.p1.6.m5.1.1" xref="S4.SS1.p1.6.m5.1.1.cmml"><mi id="S4.SS1.p1.6.m5.1.1.2" xref="S4.SS1.p1.6.m5.1.1.2.cmml">ϕ</mi><mn id="S4.SS1.p1.6.m5.1.1.3" xref="S4.SS1.p1.6.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m5.1b"><apply id="S4.SS1.p1.6.m5.1.1.cmml" xref="S4.SS1.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m5.1.1.1.cmml" xref="S4.SS1.p1.6.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m5.1.1.2.cmml" xref="S4.SS1.p1.6.m5.1.1.2">italic-ϕ</ci><cn id="S4.SS1.p1.6.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p1.6.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m5.1c">\phi_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m5.1d">italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, and an i.i.d. noise component <math alttext="\epsilon_{i}\sim\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m6.2"><semantics id="S4.SS1.p1.7.m6.2a"><mrow id="S4.SS1.p1.7.m6.2.3" xref="S4.SS1.p1.7.m6.2.3.cmml"><msub id="S4.SS1.p1.7.m6.2.3.2" xref="S4.SS1.p1.7.m6.2.3.2.cmml"><mi id="S4.SS1.p1.7.m6.2.3.2.2" xref="S4.SS1.p1.7.m6.2.3.2.2.cmml">ϵ</mi><mi id="S4.SS1.p1.7.m6.2.3.2.3" xref="S4.SS1.p1.7.m6.2.3.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.7.m6.2.3.1" xref="S4.SS1.p1.7.m6.2.3.1.cmml">∼</mo><mrow id="S4.SS1.p1.7.m6.2.3.3" xref="S4.SS1.p1.7.m6.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.7.m6.2.3.3.2" xref="S4.SS1.p1.7.m6.2.3.3.2.cmml">𝒩</mi><mo id="S4.SS1.p1.7.m6.2.3.3.1" xref="S4.SS1.p1.7.m6.2.3.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.7.m6.2.3.3.3.2" xref="S4.SS1.p1.7.m6.2.3.3.3.1.cmml"><mo id="S4.SS1.p1.7.m6.2.3.3.3.2.1" stretchy="false" xref="S4.SS1.p1.7.m6.2.3.3.3.1.cmml">(</mo><mn id="S4.SS1.p1.7.m6.1.1" xref="S4.SS1.p1.7.m6.1.1.cmml">0</mn><mo id="S4.SS1.p1.7.m6.2.3.3.3.2.2" xref="S4.SS1.p1.7.m6.2.3.3.3.1.cmml">,</mo><mn id="S4.SS1.p1.7.m6.2.2" xref="S4.SS1.p1.7.m6.2.2.cmml">1</mn><mo id="S4.SS1.p1.7.m6.2.3.3.3.2.3" stretchy="false" xref="S4.SS1.p1.7.m6.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m6.2b"><apply id="S4.SS1.p1.7.m6.2.3.cmml" xref="S4.SS1.p1.7.m6.2.3"><csymbol cd="latexml" id="S4.SS1.p1.7.m6.2.3.1.cmml" xref="S4.SS1.p1.7.m6.2.3.1">similar-to</csymbol><apply id="S4.SS1.p1.7.m6.2.3.2.cmml" xref="S4.SS1.p1.7.m6.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m6.2.3.2.1.cmml" xref="S4.SS1.p1.7.m6.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.7.m6.2.3.2.2.cmml" xref="S4.SS1.p1.7.m6.2.3.2.2">italic-ϵ</ci><ci id="S4.SS1.p1.7.m6.2.3.2.3.cmml" xref="S4.SS1.p1.7.m6.2.3.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.7.m6.2.3.3.cmml" xref="S4.SS1.p1.7.m6.2.3.3"><times id="S4.SS1.p1.7.m6.2.3.3.1.cmml" xref="S4.SS1.p1.7.m6.2.3.3.1"></times><ci id="S4.SS1.p1.7.m6.2.3.3.2.cmml" xref="S4.SS1.p1.7.m6.2.3.3.2">𝒩</ci><interval closure="open" id="S4.SS1.p1.7.m6.2.3.3.3.1.cmml" xref="S4.SS1.p1.7.m6.2.3.3.3.2"><cn id="S4.SS1.p1.7.m6.1.1.cmml" type="integer" xref="S4.SS1.p1.7.m6.1.1">0</cn><cn id="S4.SS1.p1.7.m6.2.2.cmml" type="integer" xref="S4.SS1.p1.7.m6.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m6.2c">\epsilon_{i}\sim\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m6.2d">italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , 1 )</annotation></semantics></math>. We further decompose <math alttext="{\bm{\phi}}" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m7.1"><semantics id="S4.SS1.p1.8.m7.1a"><mi id="S4.SS1.p1.8.m7.1.1" mathvariant="bold-italic" xref="S4.SS1.p1.8.m7.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m7.1b"><ci id="S4.SS1.p1.8.m7.1.1.cmml" xref="S4.SS1.p1.8.m7.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m7.1c">{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m7.1d">bold_italic_ϕ</annotation></semantics></math> into our target parameters <math alttext="\bm{\theta}\in\mathbb{R}^{3}" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m8.1"><semantics id="S4.SS1.p1.9.m8.1a"><mrow id="S4.SS1.p1.9.m8.1.1" xref="S4.SS1.p1.9.m8.1.1.cmml"><mi id="S4.SS1.p1.9.m8.1.1.2" xref="S4.SS1.p1.9.m8.1.1.2.cmml">𝜽</mi><mo id="S4.SS1.p1.9.m8.1.1.1" xref="S4.SS1.p1.9.m8.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.9.m8.1.1.3" xref="S4.SS1.p1.9.m8.1.1.3.cmml"><mi id="S4.SS1.p1.9.m8.1.1.3.2" xref="S4.SS1.p1.9.m8.1.1.3.2.cmml">ℝ</mi><mn id="S4.SS1.p1.9.m8.1.1.3.3" xref="S4.SS1.p1.9.m8.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m8.1b"><apply id="S4.SS1.p1.9.m8.1.1.cmml" xref="S4.SS1.p1.9.m8.1.1"><in id="S4.SS1.p1.9.m8.1.1.1.cmml" xref="S4.SS1.p1.9.m8.1.1.1"></in><ci id="S4.SS1.p1.9.m8.1.1.2.cmml" xref="S4.SS1.p1.9.m8.1.1.2">𝜽</ci><apply id="S4.SS1.p1.9.m8.1.1.3.cmml" xref="S4.SS1.p1.9.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m8.1.1.3.1.cmml" xref="S4.SS1.p1.9.m8.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.9.m8.1.1.3.2.cmml" xref="S4.SS1.p1.9.m8.1.1.3.2">ℝ</ci><cn id="S4.SS1.p1.9.m8.1.1.3.3.cmml" type="integer" xref="S4.SS1.p1.9.m8.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m8.1c">\bm{\theta}\in\mathbb{R}^{3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m8.1d">bold_italic_θ ∈ blackboard_R start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> via <math alttext="\phi_{0}=\theta_{0}+\theta_{1}" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m9.1"><semantics id="S4.SS1.p1.10.m9.1a"><mrow id="S4.SS1.p1.10.m9.1.1" xref="S4.SS1.p1.10.m9.1.1.cmml"><msub id="S4.SS1.p1.10.m9.1.1.2" xref="S4.SS1.p1.10.m9.1.1.2.cmml"><mi id="S4.SS1.p1.10.m9.1.1.2.2" xref="S4.SS1.p1.10.m9.1.1.2.2.cmml">ϕ</mi><mn id="S4.SS1.p1.10.m9.1.1.2.3" xref="S4.SS1.p1.10.m9.1.1.2.3.cmml">0</mn></msub><mo id="S4.SS1.p1.10.m9.1.1.1" xref="S4.SS1.p1.10.m9.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.10.m9.1.1.3" xref="S4.SS1.p1.10.m9.1.1.3.cmml"><msub id="S4.SS1.p1.10.m9.1.1.3.2" xref="S4.SS1.p1.10.m9.1.1.3.2.cmml"><mi id="S4.SS1.p1.10.m9.1.1.3.2.2" xref="S4.SS1.p1.10.m9.1.1.3.2.2.cmml">θ</mi><mn id="S4.SS1.p1.10.m9.1.1.3.2.3" xref="S4.SS1.p1.10.m9.1.1.3.2.3.cmml">0</mn></msub><mo id="S4.SS1.p1.10.m9.1.1.3.1" xref="S4.SS1.p1.10.m9.1.1.3.1.cmml">+</mo><msub id="S4.SS1.p1.10.m9.1.1.3.3" xref="S4.SS1.p1.10.m9.1.1.3.3.cmml"><mi id="S4.SS1.p1.10.m9.1.1.3.3.2" xref="S4.SS1.p1.10.m9.1.1.3.3.2.cmml">θ</mi><mn id="S4.SS1.p1.10.m9.1.1.3.3.3" xref="S4.SS1.p1.10.m9.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m9.1b"><apply id="S4.SS1.p1.10.m9.1.1.cmml" xref="S4.SS1.p1.10.m9.1.1"><eq id="S4.SS1.p1.10.m9.1.1.1.cmml" xref="S4.SS1.p1.10.m9.1.1.1"></eq><apply id="S4.SS1.p1.10.m9.1.1.2.cmml" xref="S4.SS1.p1.10.m9.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m9.1.1.2.1.cmml" xref="S4.SS1.p1.10.m9.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.10.m9.1.1.2.2.cmml" xref="S4.SS1.p1.10.m9.1.1.2.2">italic-ϕ</ci><cn id="S4.SS1.p1.10.m9.1.1.2.3.cmml" type="integer" xref="S4.SS1.p1.10.m9.1.1.2.3">0</cn></apply><apply id="S4.SS1.p1.10.m9.1.1.3.cmml" xref="S4.SS1.p1.10.m9.1.1.3"><plus id="S4.SS1.p1.10.m9.1.1.3.1.cmml" xref="S4.SS1.p1.10.m9.1.1.3.1"></plus><apply id="S4.SS1.p1.10.m9.1.1.3.2.cmml" xref="S4.SS1.p1.10.m9.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m9.1.1.3.2.1.cmml" xref="S4.SS1.p1.10.m9.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p1.10.m9.1.1.3.2.2.cmml" xref="S4.SS1.p1.10.m9.1.1.3.2.2">𝜃</ci><cn id="S4.SS1.p1.10.m9.1.1.3.2.3.cmml" type="integer" xref="S4.SS1.p1.10.m9.1.1.3.2.3">0</cn></apply><apply id="S4.SS1.p1.10.m9.1.1.3.3.cmml" xref="S4.SS1.p1.10.m9.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m9.1.1.3.3.1.cmml" xref="S4.SS1.p1.10.m9.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.10.m9.1.1.3.3.2.cmml" xref="S4.SS1.p1.10.m9.1.1.3.3.2">𝜃</ci><cn id="S4.SS1.p1.10.m9.1.1.3.3.3.cmml" type="integer" xref="S4.SS1.p1.10.m9.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m9.1c">\phi_{0}=\theta_{0}+\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.10.m9.1d">italic_ϕ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\phi_{1}=\theta_{1}-3\theta_{2}^{2}" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m10.1"><semantics id="S4.SS1.p1.11.m10.1a"><mrow id="S4.SS1.p1.11.m10.1.1" xref="S4.SS1.p1.11.m10.1.1.cmml"><msub id="S4.SS1.p1.11.m10.1.1.2" xref="S4.SS1.p1.11.m10.1.1.2.cmml"><mi id="S4.SS1.p1.11.m10.1.1.2.2" xref="S4.SS1.p1.11.m10.1.1.2.2.cmml">ϕ</mi><mn id="S4.SS1.p1.11.m10.1.1.2.3" xref="S4.SS1.p1.11.m10.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.p1.11.m10.1.1.1" xref="S4.SS1.p1.11.m10.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.11.m10.1.1.3" xref="S4.SS1.p1.11.m10.1.1.3.cmml"><msub id="S4.SS1.p1.11.m10.1.1.3.2" xref="S4.SS1.p1.11.m10.1.1.3.2.cmml"><mi id="S4.SS1.p1.11.m10.1.1.3.2.2" xref="S4.SS1.p1.11.m10.1.1.3.2.2.cmml">θ</mi><mn id="S4.SS1.p1.11.m10.1.1.3.2.3" xref="S4.SS1.p1.11.m10.1.1.3.2.3.cmml">1</mn></msub><mo id="S4.SS1.p1.11.m10.1.1.3.1" xref="S4.SS1.p1.11.m10.1.1.3.1.cmml">−</mo><mrow id="S4.SS1.p1.11.m10.1.1.3.3" xref="S4.SS1.p1.11.m10.1.1.3.3.cmml"><mn id="S4.SS1.p1.11.m10.1.1.3.3.2" xref="S4.SS1.p1.11.m10.1.1.3.3.2.cmml">3</mn><mo id="S4.SS1.p1.11.m10.1.1.3.3.1" xref="S4.SS1.p1.11.m10.1.1.3.3.1.cmml">⁢</mo><msubsup id="S4.SS1.p1.11.m10.1.1.3.3.3" xref="S4.SS1.p1.11.m10.1.1.3.3.3.cmml"><mi id="S4.SS1.p1.11.m10.1.1.3.3.3.2.2" xref="S4.SS1.p1.11.m10.1.1.3.3.3.2.2.cmml">θ</mi><mn id="S4.SS1.p1.11.m10.1.1.3.3.3.2.3" xref="S4.SS1.p1.11.m10.1.1.3.3.3.2.3.cmml">2</mn><mn id="S4.SS1.p1.11.m10.1.1.3.3.3.3" xref="S4.SS1.p1.11.m10.1.1.3.3.3.3.cmml">2</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m10.1b"><apply id="S4.SS1.p1.11.m10.1.1.cmml" xref="S4.SS1.p1.11.m10.1.1"><eq id="S4.SS1.p1.11.m10.1.1.1.cmml" xref="S4.SS1.p1.11.m10.1.1.1"></eq><apply id="S4.SS1.p1.11.m10.1.1.2.cmml" xref="S4.SS1.p1.11.m10.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m10.1.1.2.1.cmml" xref="S4.SS1.p1.11.m10.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.11.m10.1.1.2.2.cmml" xref="S4.SS1.p1.11.m10.1.1.2.2">italic-ϕ</ci><cn id="S4.SS1.p1.11.m10.1.1.2.3.cmml" type="integer" xref="S4.SS1.p1.11.m10.1.1.2.3">1</cn></apply><apply id="S4.SS1.p1.11.m10.1.1.3.cmml" xref="S4.SS1.p1.11.m10.1.1.3"><minus id="S4.SS1.p1.11.m10.1.1.3.1.cmml" xref="S4.SS1.p1.11.m10.1.1.3.1"></minus><apply id="S4.SS1.p1.11.m10.1.1.3.2.cmml" xref="S4.SS1.p1.11.m10.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m10.1.1.3.2.1.cmml" xref="S4.SS1.p1.11.m10.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p1.11.m10.1.1.3.2.2.cmml" xref="S4.SS1.p1.11.m10.1.1.3.2.2">𝜃</ci><cn id="S4.SS1.p1.11.m10.1.1.3.2.3.cmml" type="integer" xref="S4.SS1.p1.11.m10.1.1.3.2.3">1</cn></apply><apply id="S4.SS1.p1.11.m10.1.1.3.3.cmml" xref="S4.SS1.p1.11.m10.1.1.3.3"><times id="S4.SS1.p1.11.m10.1.1.3.3.1.cmml" xref="S4.SS1.p1.11.m10.1.1.3.3.1"></times><cn id="S4.SS1.p1.11.m10.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p1.11.m10.1.1.3.3.2">3</cn><apply id="S4.SS1.p1.11.m10.1.1.3.3.3.cmml" xref="S4.SS1.p1.11.m10.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m10.1.1.3.3.3.1.cmml" xref="S4.SS1.p1.11.m10.1.1.3.3.3">superscript</csymbol><apply id="S4.SS1.p1.11.m10.1.1.3.3.3.2.cmml" xref="S4.SS1.p1.11.m10.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m10.1.1.3.3.3.2.1.cmml" xref="S4.SS1.p1.11.m10.1.1.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.11.m10.1.1.3.3.3.2.2.cmml" xref="S4.SS1.p1.11.m10.1.1.3.3.3.2.2">𝜃</ci><cn id="S4.SS1.p1.11.m10.1.1.3.3.3.2.3.cmml" type="integer" xref="S4.SS1.p1.11.m10.1.1.3.3.3.2.3">2</cn></apply><cn id="S4.SS1.p1.11.m10.1.1.3.3.3.3.cmml" type="integer" xref="S4.SS1.p1.11.m10.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m10.1c">\phi_{1}=\theta_{1}-3\theta_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.11.m10.1d">italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - 3 italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>. We expect our inference engine to forward constraints on latent variables <math alttext="\bm{\phi}" class="ltx_Math" display="inline" id="S4.SS1.p1.12.m11.1"><semantics id="S4.SS1.p1.12.m11.1a"><mi id="S4.SS1.p1.12.m11.1.1" mathvariant="bold-italic" xref="S4.SS1.p1.12.m11.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m11.1b"><ci id="S4.SS1.p1.12.m11.1.1.cmml" xref="S4.SS1.p1.12.m11.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m11.1c">\bm{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.12.m11.1d">bold_italic_ϕ</annotation></semantics></math> onto target variables <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S4.SS1.p1.13.m12.1"><semantics id="S4.SS1.p1.13.m12.1a"><mi id="S4.SS1.p1.13.m12.1.1" xref="S4.SS1.p1.13.m12.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m12.1b"><ci id="S4.SS1.p1.13.m12.1.1.cmml" xref="S4.SS1.p1.13.m12.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m12.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.13.m12.1d">bold_italic_θ</annotation></semantics></math>. We assume a standard normal prior on each of our parameters of interest, <math alttext="p(\theta_{i})=\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S4.SS1.p1.14.m13.3"><semantics id="S4.SS1.p1.14.m13.3a"><mrow id="S4.SS1.p1.14.m13.3.3" xref="S4.SS1.p1.14.m13.3.3.cmml"><mrow id="S4.SS1.p1.14.m13.3.3.1" xref="S4.SS1.p1.14.m13.3.3.1.cmml"><mi id="S4.SS1.p1.14.m13.3.3.1.3" xref="S4.SS1.p1.14.m13.3.3.1.3.cmml">p</mi><mo id="S4.SS1.p1.14.m13.3.3.1.2" xref="S4.SS1.p1.14.m13.3.3.1.2.cmml">⁢</mo><mrow id="S4.SS1.p1.14.m13.3.3.1.1.1" xref="S4.SS1.p1.14.m13.3.3.1.1.1.1.cmml"><mo id="S4.SS1.p1.14.m13.3.3.1.1.1.2" stretchy="false" xref="S4.SS1.p1.14.m13.3.3.1.1.1.1.cmml">(</mo><msub id="S4.SS1.p1.14.m13.3.3.1.1.1.1" xref="S4.SS1.p1.14.m13.3.3.1.1.1.1.cmml"><mi id="S4.SS1.p1.14.m13.3.3.1.1.1.1.2" xref="S4.SS1.p1.14.m13.3.3.1.1.1.1.2.cmml">θ</mi><mi id="S4.SS1.p1.14.m13.3.3.1.1.1.1.3" xref="S4.SS1.p1.14.m13.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p1.14.m13.3.3.1.1.1.3" stretchy="false" xref="S4.SS1.p1.14.m13.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.14.m13.3.3.2" xref="S4.SS1.p1.14.m13.3.3.2.cmml">=</mo><mrow id="S4.SS1.p1.14.m13.3.3.3" xref="S4.SS1.p1.14.m13.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.14.m13.3.3.3.2" xref="S4.SS1.p1.14.m13.3.3.3.2.cmml">𝒩</mi><mo id="S4.SS1.p1.14.m13.3.3.3.1" xref="S4.SS1.p1.14.m13.3.3.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.14.m13.3.3.3.3.2" xref="S4.SS1.p1.14.m13.3.3.3.3.1.cmml"><mo id="S4.SS1.p1.14.m13.3.3.3.3.2.1" stretchy="false" xref="S4.SS1.p1.14.m13.3.3.3.3.1.cmml">(</mo><mn id="S4.SS1.p1.14.m13.1.1" xref="S4.SS1.p1.14.m13.1.1.cmml">0</mn><mo id="S4.SS1.p1.14.m13.3.3.3.3.2.2" xref="S4.SS1.p1.14.m13.3.3.3.3.1.cmml">,</mo><mn id="S4.SS1.p1.14.m13.2.2" xref="S4.SS1.p1.14.m13.2.2.cmml">1</mn><mo id="S4.SS1.p1.14.m13.3.3.3.3.2.3" stretchy="false" xref="S4.SS1.p1.14.m13.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m13.3b"><apply id="S4.SS1.p1.14.m13.3.3.cmml" xref="S4.SS1.p1.14.m13.3.3"><eq id="S4.SS1.p1.14.m13.3.3.2.cmml" xref="S4.SS1.p1.14.m13.3.3.2"></eq><apply id="S4.SS1.p1.14.m13.3.3.1.cmml" xref="S4.SS1.p1.14.m13.3.3.1"><times id="S4.SS1.p1.14.m13.3.3.1.2.cmml" xref="S4.SS1.p1.14.m13.3.3.1.2"></times><ci id="S4.SS1.p1.14.m13.3.3.1.3.cmml" xref="S4.SS1.p1.14.m13.3.3.1.3">𝑝</ci><apply id="S4.SS1.p1.14.m13.3.3.1.1.1.1.cmml" xref="S4.SS1.p1.14.m13.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m13.3.3.1.1.1.1.1.cmml" xref="S4.SS1.p1.14.m13.3.3.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.14.m13.3.3.1.1.1.1.2.cmml" xref="S4.SS1.p1.14.m13.3.3.1.1.1.1.2">𝜃</ci><ci id="S4.SS1.p1.14.m13.3.3.1.1.1.1.3.cmml" xref="S4.SS1.p1.14.m13.3.3.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.SS1.p1.14.m13.3.3.3.cmml" xref="S4.SS1.p1.14.m13.3.3.3"><times id="S4.SS1.p1.14.m13.3.3.3.1.cmml" xref="S4.SS1.p1.14.m13.3.3.3.1"></times><ci id="S4.SS1.p1.14.m13.3.3.3.2.cmml" xref="S4.SS1.p1.14.m13.3.3.3.2">𝒩</ci><interval closure="open" id="S4.SS1.p1.14.m13.3.3.3.3.1.cmml" xref="S4.SS1.p1.14.m13.3.3.3.3.2"><cn id="S4.SS1.p1.14.m13.1.1.cmml" type="integer" xref="S4.SS1.p1.14.m13.1.1">0</cn><cn id="S4.SS1.p1.14.m13.2.2.cmml" type="integer" xref="S4.SS1.p1.14.m13.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m13.3c">p(\theta_{i})=\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.14.m13.3d">italic_p ( italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = caligraphic_N ( 0 , 1 )</annotation></semantics></math>. This is a challenging inference task because the likelihood is highly non-linear and the posteriors exhibit strong degeneracies. However, learning parameters from such complex, correlated data vectors is a common problem in astronomy and cosmology <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.14.1.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx16" title="">Dax <em class="ltx_emph ltx_font_italic">et al.</em>(2021a)Dax, Green, Gair, Macke, Buonanno, and Schölkopf</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx33" title="">Modi <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Modi, Pandey, Ho, Hahn, Blancard, and Wandelt</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx111" title="">Bartlett <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Bartlett, Kammerer, Kronberger, Desmond, Ferreira, Wandelt, Burlacu, Alonso, and Zennaro</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.5">Given this simulator, we train <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p2.5.1">sbi</span>-SNPE using an ensemble of two normalizing flows (MAFs) to produce the example <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">bold_italic_θ</annotation></semantics></math> posterior in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S4.F3" title="Figure 3 ‣ 4.1 Toy Problem ‣ 4 Synthetic Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">3</span></a>, shown relative to equivalent constraints with Rejection ABC and long-run HMC. We train the SNPE sequentially using 10 rounds of 2000 simulations each, following the procedure described in Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS3" title="2.3 Sequential Learning ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.3</span></a> and using Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S4.E14" title="14 ‣ 4.1 Toy Problem ‣ 4 Synthetic Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">14</span></a>. For ABC, we run the same number of simulations (20,000) and take the closest <math alttext="0.5\%" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mn id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">0.5</mn><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1">percent</csymbol><cn id="S4.SS1.p2.2.m2.1.1.2.cmml" type="float" xref="S4.SS1.p2.2.m2.1.1.2">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">0.5\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">0.5 %</annotation></semantics></math> to our data vector, using an L2 distance. For HMC, we run eight chains each with 10,000 tuning steps and 10,000 sampling steps, for a total of 160,000 simulations. This run has an effective sample size of <math alttext="~{}3,900-8,000" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.3"><semantics id="S4.SS1.p2.3.m3.3a"><mrow id="S4.SS1.p2.3.m3.3.3.1" xref="S4.SS1.p2.3.m3.3.3.2.cmml"><mn id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">3</mn><mo id="S4.SS1.p2.3.m3.3.3.1.2" xref="S4.SS1.p2.3.m3.3.3.2.cmml">,</mo><mrow id="S4.SS1.p2.3.m3.3.3.1.1" xref="S4.SS1.p2.3.m3.3.3.1.1.cmml"><mn id="S4.SS1.p2.3.m3.3.3.1.1.2" xref="S4.SS1.p2.3.m3.3.3.1.1.2.cmml">900</mn><mo id="S4.SS1.p2.3.m3.3.3.1.1.1" xref="S4.SS1.p2.3.m3.3.3.1.1.1.cmml">−</mo><mn id="S4.SS1.p2.3.m3.3.3.1.1.3" xref="S4.SS1.p2.3.m3.3.3.1.1.3.cmml">8</mn></mrow><mo id="S4.SS1.p2.3.m3.3.3.1.3" xref="S4.SS1.p2.3.m3.3.3.2.cmml">,</mo><mn id="S4.SS1.p2.3.m3.2.2" xref="S4.SS1.p2.3.m3.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.3b"><list id="S4.SS1.p2.3.m3.3.3.2.cmml" xref="S4.SS1.p2.3.m3.3.3.1"><cn id="S4.SS1.p2.3.m3.1.1.cmml" type="integer" xref="S4.SS1.p2.3.m3.1.1">3</cn><apply id="S4.SS1.p2.3.m3.3.3.1.1.cmml" xref="S4.SS1.p2.3.m3.3.3.1.1"><minus id="S4.SS1.p2.3.m3.3.3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.3.3.1.1.1"></minus><cn id="S4.SS1.p2.3.m3.3.3.1.1.2.cmml" type="integer" xref="S4.SS1.p2.3.m3.3.3.1.1.2">900</cn><cn id="S4.SS1.p2.3.m3.3.3.1.1.3.cmml" type="integer" xref="S4.SS1.p2.3.m3.3.3.1.1.3">8</cn></apply><cn id="S4.SS1.p2.3.m3.2.2.cmml" type="integer" xref="S4.SS1.p2.3.m3.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.3c">~{}3,900-8,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.3d">3 , 900 - 8 , 000</annotation></semantics></math> and a Gelman-Rubin <math alttext="\hat{R}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mover accent="true" id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">R</mi><mo id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><ci id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1">^</ci><ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\hat{R}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">over^ start_ARG italic_R end_ARG</annotation></semantics></math> statistic of <math alttext="1.001" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mn id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">1.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><cn id="S4.SS1.p2.5.m5.1.1.cmml" type="float" xref="S4.SS1.p2.5.m5.1.1">1.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">1.001</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">1.001</annotation></semantics></math> for all parameters. We consider these long-run HMC samples to be equivalent to a reference ‘ground truth’ posterior.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.8">Despite the same simulation budget as ABC, the SNPE posterior constraints have converged to the reference posterior and are strongly more constraining than the ABC constraints. In both the SNPE and HMC posteriors, we clearly observe the expected linear degeneracy between <math alttext="\theta_{0}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><msub id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">θ</mi><mn id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝜃</ci><cn id="S4.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><msub id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">θ</mi><mn id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝜃</ci><cn id="S4.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> as well as the quadratic degeneracy between <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><msub id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">θ</mi><mn id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2">𝜃</ci><cn id="S4.SS1.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{2}" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><msub id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">θ</mi><mn id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">𝜃</ci><cn id="S4.SS1.p3.4.m4.1.1.3.cmml" type="integer" xref="S4.SS1.p3.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, direct results from the aforementioned definitions of <math alttext="\phi_{0}" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><msub id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">ϕ</mi><mn id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">italic-ϕ</ci><cn id="S4.SS1.p3.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p3.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">\phi_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">italic_ϕ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\phi_{1}" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><msub id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">ϕ</mi><mn id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">italic-ϕ</ci><cn id="S4.SS1.p3.6.m6.1.1.3.cmml" type="integer" xref="S4.SS1.p3.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">\phi_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>. These two degeneracies imply another quadratic degeneracy between <math alttext="\theta_{0}" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m7.1"><semantics id="S4.SS1.p3.7.m7.1a"><msub id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml"><mi id="S4.SS1.p3.7.m7.1.1.2" xref="S4.SS1.p3.7.m7.1.1.2.cmml">θ</mi><mn id="S4.SS1.p3.7.m7.1.1.3" xref="S4.SS1.p3.7.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><apply id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p3.7.m7.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.2">𝜃</ci><cn id="S4.SS1.p3.7.m7.1.1.3.cmml" type="integer" xref="S4.SS1.p3.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m7.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{2}" class="ltx_Math" display="inline" id="S4.SS1.p3.8.m8.1"><semantics id="S4.SS1.p3.8.m8.1a"><msub id="S4.SS1.p3.8.m8.1.1" xref="S4.SS1.p3.8.m8.1.1.cmml"><mi id="S4.SS1.p3.8.m8.1.1.2" xref="S4.SS1.p3.8.m8.1.1.2.cmml">θ</mi><mn id="S4.SS1.p3.8.m8.1.1.3" xref="S4.SS1.p3.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m8.1b"><apply id="S4.SS1.p3.8.m8.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.1.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.p3.8.m8.1.1.2.cmml" xref="S4.SS1.p3.8.m8.1.1.2">𝜃</ci><cn id="S4.SS1.p3.8.m8.1.1.3.cmml" type="integer" xref="S4.SS1.p3.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m8.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.8.m8.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. Despite this non-linearity, we see the multi-dimensional 68% and 95% confidence intervals are entirely consistent between SNPE and HMC. However, ABC methods struggle in this regime. Because the data dimensionality is ten, ABC requires orders-of-magnitude more samples to fully capture the tails of the posterior distribution. This regime demonstrates the utility of having a low-cost amortized posterior model like SNPE, especially in further cases where the simulators are not as simple.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Benchmarking</h3>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="265" id="S4.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Prediction error as a function of simulation budget for various <span class="ltx_text ltx_font_smallcaps" id="S4.F4.2.1">LtU-ILI</span> training methodologies on the benchmark SLCP inference problem <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx62" title="">Papamakarios <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Papamakarios, Sterratt, and Murray</a>)</cite>. For clarity, plotted points for different models at the same simulation budget are slightly offset horizontally. The Rejection-ABC method is shown on all subplots as a baseline. Error is defined in terms of the Classifier 2-sample Test <cite class="ltx_cite ltx_citemacro_citep">(C2ST; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx80" title="">Lopez-Paz and Oquab(2016)</a>)</cite> metric. A lower C2ST indicates a more accurate inferred posterior, with 0.5 being the optimal score. C2ST values are shown at their median and central 95% confidence interval, calculated over ten independent runs.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We benchmark all models in <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p1.1.1">LtU-ILI</span> on the standard “Simple Likelihood Complex Posterior” problem <cite class="ltx_cite ltx_citemacro_citep">(SLCP; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx62" title="">Papamakarios <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Papamakarios, Sterratt, and Murray</a>)</cite> common in simulation-based inference experiments <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S4.SS2.p1.1.2.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx112" title="">Greenberg <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Greenberg, Nonnenmacher, and Macke</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx76" title="">Lueckmann <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Lueckmann, Boelts, Greenberg, Goncalves, and Macke</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx113" title="">Ramesh <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Ramesh, Lueckmann, Boelts, Tejero-Cantero, Greenberg, Gonçalves, and Macke</a>)</cite>. SLCP has a fairly straightforward, unimodal likelihood but a very complex, multimodal posterior distribution, making it a difficult, but attainable benchmark for implicit inference. We follow the implementation of SLCP in <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx76" title="">Lueckmann <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Lueckmann, Boelts, Greenberg, Goncalves, and Macke</a></cite>, wherein we train various NPE/NLE/NRE methods and compare their resultant posteriors to reference posteriors determined with long-run HMC chains. We implement this for all available NPE/NLE/NRE methods and their sequential analogs in each of the <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p1.1.3">pydelfi</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p1.1.4">sbi</span>, and <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p1.1.5">lampe</span> backends. We also include benchmarking of Rejection ABC as a baseline. Throughout all backends and engines, we use the same architectures as in <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx76" title="">Lueckmann <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Lueckmann, Boelts, Greenberg, Goncalves, and Macke</a></cite>, which were determined through exhaustive hyperparameter searches.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">For each trial, we measure the error of an inference engine with respect to a reference posterior using C2ST (see Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS4" title="2.4 Validation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.4</span></a>).
For each backend, engine, and simulation budget, we perform independent training and inference on ten separate reference posteriors to aggregate test statistics.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.3">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S4.F4" title="Figure 4 ‣ 4.2 Benchmarking ‣ 4 Synthetic Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">4</span></a>, we show the performance of each <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p3.3.1">LtU-ILI</span> engine on the SLCP benchmark as a function of the simulation budget used for generating the training set. As we would expect, the accuracy of inferred posteriors increases with the number of given simulations across all models. We observe that all models strongly outperform the Rejection ABC baseline due to their efficient use of simulation data. For the SLCP benchmark, we observe that NLE methods perform the best, NPE methods are a close second, and NRE methods have the worst performance. However, we note that the SLCP by definition has a simple, easy-to-learn likelihood, encouraging strong NLE performance. This hierarchy of performance could be entirely different for other problems. Sequential methods (SNPE/SNLE/SNRE) show very little improvement for small simulation budgets (<math alttext="10^{3}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><msup id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mn id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">10</mn><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">superscript</csymbol><cn id="S4.SS2.p3.1.m1.1.1.2.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1.2">10</cn><cn id="S4.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">10^{3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>), but show massive gains for large budgets (<math alttext="10^{5}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><msup id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mn id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">10</mn><mn id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">superscript</csymbol><cn id="S4.SS2.p3.2.m2.1.1.2.cmml" type="integer" xref="S4.SS2.p3.2.m2.1.1.2">10</cn><cn id="S4.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p3.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">10^{5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">10 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math>), especially for the NLE methods. This is likely because, for small training datasets, the posteriors are poorly constrained and barely deviate from the prior. However, for the tight posterior constraints in large budget runs, sequential methods are able to more easily focus simulation resources on small regions of parameter space. Next, we note that the <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p3.3.2">lampe</span>-NPE implementation largely mirrors that of <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p3.3.3">sbi</span>-NPE, and <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p3.3.4">pydelfi</span>-NLE slightly outperforms <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p3.3.5">sbi</span>-NLE for a medium simulation budget (<math alttext="10^{4}" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><msup id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mn id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">10</mn><mn id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">superscript</csymbol><cn id="S4.SS2.p3.3.m3.1.1.2.cmml" type="integer" xref="S4.SS2.p3.3.m3.1.1.2">10</cn><cn id="S4.SS2.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p3.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">10^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math>). Although hyperparameters (<em class="ltx_emph ltx_font_italic" id="S4.SS2.p3.3.6">i.e.,</em> architectures, learning rate, validation schema) are fixed for these experiments, slight differences in backend implementations might lead to better or worse performance. Lastly, as a check, the performances of all <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p3.3.7">sbi</span> engines closely match those found in <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx76" title="">Lueckmann <em class="ltx_emph ltx_font_italic">et al.</em>(2021)Lueckmann, Boelts, Greenberg, Goncalves, and Macke</a></cite>, suggesting our implementation of SLCP is correct.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Science Experiments</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we demonstrate various applications of <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.1">LtU-ILI</span> for common astrophysics and cosmology problems. These experiments are designed to display the diverse functionality of the code, including using CNN embedding networks (Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS1" title="5.1 X-ray Mass Estimation of Galaxy Clusters ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">5.1</span></a>), applying posterior coverage validation (Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS2" title="5.2 Quijote Dark Matter Power Spectrum ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">5.2</span></a>), incorporating graph neural network layers (Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS3" title="5.3 Field-level Inference with Graph Neural Networks ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">5.3</span></a>), using multiround inference (Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS4" title="5.4 Multi-round Inference for Gravitational Waves ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">5.4</span></a>), quantifying information in different data sources (Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS5" title="5.5 Inferring Dust Parameters ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">5.5</span></a>), and integrating information-optimal pretrained embeddings (Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.SS6" title="5.6 The Mass and Energy Loading of Galactic Winds ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">5.6</span></a>). We note that these experiments are intended to illuminate interesting pathways for the scientific application of <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.2">LtU-ILI</span> and not necessarily make significant scientific conclusions on their subject material. For readability, experiment descriptions are kept short, but the code and data are made publicly available through the codebase.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>X-ray Mass Estimation of Galaxy Clusters</h3>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="433" id="S5.F5.g1" src="x5.png" width="788"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Inference of galaxy cluster <math alttext="M_{500c}" class="ltx_Math" display="inline" id="S5.F5.3.m1.1"><semantics id="S5.F5.3.m1.1b"><msub id="S5.F5.3.m1.1.1" xref="S5.F5.3.m1.1.1.cmml"><mi id="S5.F5.3.m1.1.1.2" xref="S5.F5.3.m1.1.1.2.cmml">M</mi><mrow id="S5.F5.3.m1.1.1.3" xref="S5.F5.3.m1.1.1.3.cmml"><mn id="S5.F5.3.m1.1.1.3.2" xref="S5.F5.3.m1.1.1.3.2.cmml">500</mn><mo id="S5.F5.3.m1.1.1.3.1" xref="S5.F5.3.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.F5.3.m1.1.1.3.3" xref="S5.F5.3.m1.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.F5.3.m1.1c"><apply id="S5.F5.3.m1.1.1.cmml" xref="S5.F5.3.m1.1.1"><csymbol cd="ambiguous" id="S5.F5.3.m1.1.1.1.cmml" xref="S5.F5.3.m1.1.1">subscript</csymbol><ci id="S5.F5.3.m1.1.1.2.cmml" xref="S5.F5.3.m1.1.1.2">𝑀</ci><apply id="S5.F5.3.m1.1.1.3.cmml" xref="S5.F5.3.m1.1.1.3"><times id="S5.F5.3.m1.1.1.3.1.cmml" xref="S5.F5.3.m1.1.1.3.1"></times><cn id="S5.F5.3.m1.1.1.3.2.cmml" type="integer" xref="S5.F5.3.m1.1.1.3.2">500</cn><ci id="S5.F5.3.m1.1.1.3.3.cmml" xref="S5.F5.3.m1.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.3.m1.1d">M_{500c}</annotation><annotation encoding="application/x-llamapun" id="S5.F5.3.m1.1e">italic_M start_POSTSUBSCRIPT 500 italic_c end_POSTSUBSCRIPT</annotation></semantics></math> mass from eROSITA-like mock X-ray observations, as in <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx114" title="">Ho <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Ho, Soltis, Farahi, Nagai, Evrard, and Ntampaka</a></cite>. The left four subplots show random examples of single-band X-ray observables in terms of their sky-projected surface brightness and target mass (in <math alttext="h^{-1}M_{\odot}" class="ltx_Math" display="inline" id="S5.F5.4.m2.1"><semantics id="S5.F5.4.m2.1b"><mrow id="S5.F5.4.m2.1.1" xref="S5.F5.4.m2.1.1.cmml"><msup id="S5.F5.4.m2.1.1.2" xref="S5.F5.4.m2.1.1.2.cmml"><mi id="S5.F5.4.m2.1.1.2.2" xref="S5.F5.4.m2.1.1.2.2.cmml">h</mi><mrow id="S5.F5.4.m2.1.1.2.3" xref="S5.F5.4.m2.1.1.2.3.cmml"><mo id="S5.F5.4.m2.1.1.2.3b" xref="S5.F5.4.m2.1.1.2.3.cmml">−</mo><mn id="S5.F5.4.m2.1.1.2.3.2" xref="S5.F5.4.m2.1.1.2.3.2.cmml">1</mn></mrow></msup><mo id="S5.F5.4.m2.1.1.1" xref="S5.F5.4.m2.1.1.1.cmml">⁢</mo><msub id="S5.F5.4.m2.1.1.3" xref="S5.F5.4.m2.1.1.3.cmml"><mi id="S5.F5.4.m2.1.1.3.2" xref="S5.F5.4.m2.1.1.3.2.cmml">M</mi><mo id="S5.F5.4.m2.1.1.3.3" xref="S5.F5.4.m2.1.1.3.3.cmml">⊙</mo></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.F5.4.m2.1c"><apply id="S5.F5.4.m2.1.1.cmml" xref="S5.F5.4.m2.1.1"><times id="S5.F5.4.m2.1.1.1.cmml" xref="S5.F5.4.m2.1.1.1"></times><apply id="S5.F5.4.m2.1.1.2.cmml" xref="S5.F5.4.m2.1.1.2"><csymbol cd="ambiguous" id="S5.F5.4.m2.1.1.2.1.cmml" xref="S5.F5.4.m2.1.1.2">superscript</csymbol><ci id="S5.F5.4.m2.1.1.2.2.cmml" xref="S5.F5.4.m2.1.1.2.2">ℎ</ci><apply id="S5.F5.4.m2.1.1.2.3.cmml" xref="S5.F5.4.m2.1.1.2.3"><minus id="S5.F5.4.m2.1.1.2.3.1.cmml" xref="S5.F5.4.m2.1.1.2.3"></minus><cn id="S5.F5.4.m2.1.1.2.3.2.cmml" type="integer" xref="S5.F5.4.m2.1.1.2.3.2">1</cn></apply></apply><apply id="S5.F5.4.m2.1.1.3.cmml" xref="S5.F5.4.m2.1.1.3"><csymbol cd="ambiguous" id="S5.F5.4.m2.1.1.3.1.cmml" xref="S5.F5.4.m2.1.1.3">subscript</csymbol><ci id="S5.F5.4.m2.1.1.3.2.cmml" xref="S5.F5.4.m2.1.1.3.2">𝑀</ci><csymbol cd="latexml" id="S5.F5.4.m2.1.1.3.3.cmml" xref="S5.F5.4.m2.1.1.3.3">direct-product</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.4.m2.1d">h^{-1}M_{\odot}</annotation><annotation encoding="application/x-llamapun" id="S5.F5.4.m2.1e">italic_h start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT italic_M start_POSTSUBSCRIPT ⊙ end_POSTSUBSCRIPT</annotation></semantics></math>). The right plot is the true vs. predicted log-mass estimates on the test set, where we show the median and central 68% confidence interval of our neural posteriors. For readability, test points in the right plot have been randomly subsampled.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.3">A prime functionality of <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p1.3.1">LtU-ILI</span> is its flexibility to adapt to many modalities of data. Through the use of a customizable embedding network, we process image data to estimate the mass of galaxy clusters from X-ray observations. Our inference problem mirrors that of <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx114" title="">Ho <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Ho, Soltis, Farahi, Nagai, Evrard, and Ntampaka</a></cite>, wherein we try to estimate the <math alttext="M_{\rm 500c}" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><msub id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">M</mi><mrow id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml"><mn id="S5.SS1.p1.1.m1.1.1.3.2" xref="S5.SS1.p1.1.m1.1.1.3.2.cmml">500</mn><mo id="S5.SS1.p1.1.m1.1.1.3.1" xref="S5.SS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.p1.1.m1.1.1.3.3" mathvariant="normal" xref="S5.SS1.p1.1.m1.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">𝑀</ci><apply id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3"><times id="S5.SS1.p1.1.m1.1.1.3.1.cmml" xref="S5.SS1.p1.1.m1.1.1.3.1"></times><cn id="S5.SS1.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.3.2">500</cn><ci id="S5.SS1.p1.1.m1.1.1.3.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3.3">c</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">M_{\rm 500c}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">italic_M start_POSTSUBSCRIPT 500 roman_c end_POSTSUBSCRIPT</annotation></semantics></math> mass of a galaxy cluster from <math alttext="128\times 128" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mn id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">128</mn><mo id="S5.SS1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><times id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></times><cn id="S5.SS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.2">128</cn><cn id="S5.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">128\times 128</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">128 × 128</annotation></semantics></math> images of sky-projected X-ray photon counts. To train and test our model, we use a dataset of <math alttext="3,285" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.2"><semantics id="S5.SS1.p1.3.m3.2a"><mrow id="S5.SS1.p1.3.m3.2.3.2" xref="S5.SS1.p1.3.m3.2.3.1.cmml"><mn id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">3</mn><mo id="S5.SS1.p1.3.m3.2.3.2.1" xref="S5.SS1.p1.3.m3.2.3.1.cmml">,</mo><mn id="S5.SS1.p1.3.m3.2.2" xref="S5.SS1.p1.3.m3.2.2.cmml">285</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.2b"><list id="S5.SS1.p1.3.m3.2.3.1.cmml" xref="S5.SS1.p1.3.m3.2.3.2"><cn id="S5.SS1.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1">3</cn><cn id="S5.SS1.p1.3.m3.2.2.cmml" type="integer" xref="S5.SS1.p1.3.m3.2.2">285</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.2c">3,285</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.2d">3 , 285</annotation></semantics></math> mock X-ray observations of clusters derived from the Magneticum hydrodynamical simulation <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx115" title="">Dolag <em class="ltx_emph ltx_font_italic">et al.</em>(2016)Dolag, Komatsu, and Sunyaev</a>)</cite> designed to mimic those of the eROSITA telescope <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx116" title="">Soltis <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Soltis, Ntampaka, Wu, ZuHone, Evrard, Farahi, Ho, and Nagai</a>)</cite>. These mock observations are single-band images of the X-ray photon emission from the hot intra-cluster medium (ICM) and include realistic simulation of the contaminating systematics which afflict real X-ray measurements, including cluster morphology, background emission, telescope response, and AGN sources. Examples of these observables are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F5" title="Figure 5 ‣ 5.1 X-ray Mass Estimation of Galaxy Clusters ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">5</span></a>. A good estimator of cluster mass needs to be able to disentangle the source X-ray signal from the noise and peripheral emission, while also understanding the physical connection between X-ray emission, ICM gas content, and system mass.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">To recreate this example, we perform NPE using an embedding network of the same convolutional architecture as <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx114" title="">Ho <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Ho, Soltis, Farahi, Nagai, Evrard, and Ntampaka</a></cite>. That is, instead of the last dense layer mapping to a single point estimate, we forward the final embedding into an NDE. We construct an ensemble of four models, each with the same embedding architecture, but two with Masked Autoregressive Flow <cite class="ltx_cite ltx_citemacro_citep">(MAF  <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx117" title="">Papamakarios <em class="ltx_emph ltx_font_italic">et al.</em>(2017)Papamakarios, Pavlakou, and Murray</a>)</cite> NDEs and two with MDNs. We then train the models from scratch using the NDE losses, instead of the mean-squared-error (MSE) loss of <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx114" title="">Ho <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Ho, Soltis, Farahi, Nagai, Evrard, and Ntampaka</a></cite>. As in the reference, we assume a uniform prior on cluster mass. We split our mock catalog into 90% training data and 10% test data, and present our performance results on the latter. The entire training and testing procedure takes about fifteen minutes on an Nvidia V100 GPU.</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.3">The true vs. predicted mass estimates for this model are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F5" title="Figure 5 ‣ 5.1 X-ray Mass Estimation of Galaxy Clusters ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">5</span></a>. Using the original architecture, we achieve a test scatter on the mean prediction of <math alttext="0.0782\ {\rm dex}" class="ltx_Math" display="inline" id="S5.SS1.p3.1.m1.1"><semantics id="S5.SS1.p3.1.m1.1a"><mrow id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml"><mn id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2.cmml">0.0782</mn><mo id="S5.SS1.p3.1.m1.1.1.1" lspace="0.500em" xref="S5.SS1.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS1.p3.1.m1.1.1.3" xref="S5.SS1.p3.1.m1.1.1.3.cmml">dex</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1"><times id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1.1"></times><cn id="S5.SS1.p3.1.m1.1.1.2.cmml" type="float" xref="S5.SS1.p3.1.m1.1.1.2">0.0782</cn><ci id="S5.SS1.p3.1.m1.1.1.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3">dex</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">0.0782\ {\rm dex}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.1.m1.1d">0.0782 roman_dex</annotation></semantics></math>. When compared to the <math alttext="0.0773\ {\rm dex}" class="ltx_Math" display="inline" id="S5.SS1.p3.2.m2.1"><semantics id="S5.SS1.p3.2.m2.1a"><mrow id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml"><mn id="S5.SS1.p3.2.m2.1.1.2" xref="S5.SS1.p3.2.m2.1.1.2.cmml">0.0773</mn><mo id="S5.SS1.p3.2.m2.1.1.1" lspace="0.500em" xref="S5.SS1.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.SS1.p3.2.m2.1.1.3" xref="S5.SS1.p3.2.m2.1.1.3.cmml">dex</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><apply id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1"><times id="S5.SS1.p3.2.m2.1.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1.1"></times><cn id="S5.SS1.p3.2.m2.1.1.2.cmml" type="float" xref="S5.SS1.p3.2.m2.1.1.2">0.0773</cn><ci id="S5.SS1.p3.2.m2.1.1.3.cmml" xref="S5.SS1.p3.2.m2.1.1.3">dex</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">0.0773\ {\rm dex}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.2.m2.1d">0.0773 roman_dex</annotation></semantics></math> scatter of the single-band X-ray images in <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx114" title="">Ho <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Ho, Soltis, Farahi, Nagai, Evrard, and Ntampaka</a></cite>, we achieve a very similar level of information extraction, though our uncertainty is slightly higher than the original. We attribute this to the fact that model ensembling slightly inflates predictive uncertainty <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx98" title="">Hermans <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Hermans, Delaunoy, Rozet, Wehenkel, Begy, and Louppe</a>)</cite>. However, we remark that by slightly increasing the number of convolutional filters in the first two layers, we observed mean scatters as low as <math alttext="0.071\ {\rm dex}" class="ltx_Math" display="inline" id="S5.SS1.p3.3.m3.1"><semantics id="S5.SS1.p3.3.m3.1a"><mrow id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml"><mn id="S5.SS1.p3.3.m3.1.1.2" xref="S5.SS1.p3.3.m3.1.1.2.cmml">0.071</mn><mo id="S5.SS1.p3.3.m3.1.1.1" lspace="0.500em" xref="S5.SS1.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.SS1.p3.3.m3.1.1.3" xref="S5.SS1.p3.3.m3.1.1.3.cmml">dex</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.1b"><apply id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1"><times id="S5.SS1.p3.3.m3.1.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1.1"></times><cn id="S5.SS1.p3.3.m3.1.1.2.cmml" type="float" xref="S5.SS1.p3.3.m3.1.1.2">0.071</cn><ci id="S5.SS1.p3.3.m3.1.1.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3">dex</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.1c">0.071\ {\rm dex}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.3.m3.1d">0.071 roman_dex</annotation></semantics></math>, suggesting that the NPEs are capable of state-of-the-art constraints on physical problems when given the right architecture. We also note that hyperparameter search through neural architectures is made efficient and accessible through <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p3.3.1">LtU-ILI</span>’s configuration-based interface.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Quijote Dark Matter Power Spectrum</h3>
<figure class="ltx_figure" id="S5.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_inline-para ltx_minipage ltx_flex_size_1 ltx_align_center ltx_align_middle" id="S5.F6.13" style="width:273.2pt;">
<span class="ltx_figure" id="S5.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="304" id="S5.F6.sf1.g1" src="x6.png" width="830"/>
<span class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>True vs. Predicted</span>
</span>
<span class="ltx_figure" id="S5.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="298" id="S5.F6.sf2.g1" src="x7.png" width="830"/>
<span class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Marginal Percentile Coverage Test</span>
</span></span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_minipage ltx_flex_size_1 ltx_align_center ltx_align_middle" id="S5.F6.sf3" style="width:151.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="807" id="S5.F6.sf3.g1" src="x8.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>TARP Multivariate Coverage Test
</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span> Inference of three cosmological parameters <math alttext="\Omega_{m}" class="ltx_Math" display="inline" id="S5.F6.7.m1.1"><semantics id="S5.F6.7.m1.1b"><msub id="S5.F6.7.m1.1.1" xref="S5.F6.7.m1.1.1.cmml"><mi id="S5.F6.7.m1.1.1.2" mathvariant="normal" xref="S5.F6.7.m1.1.1.2.cmml">Ω</mi><mi id="S5.F6.7.m1.1.1.3" xref="S5.F6.7.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F6.7.m1.1c"><apply id="S5.F6.7.m1.1.1.cmml" xref="S5.F6.7.m1.1.1"><csymbol cd="ambiguous" id="S5.F6.7.m1.1.1.1.cmml" xref="S5.F6.7.m1.1.1">subscript</csymbol><ci id="S5.F6.7.m1.1.1.2.cmml" xref="S5.F6.7.m1.1.1.2">Ω</ci><ci id="S5.F6.7.m1.1.1.3.cmml" xref="S5.F6.7.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.7.m1.1d">\Omega_{m}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.7.m1.1e">roman_Ω start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="h" class="ltx_Math" display="inline" id="S5.F6.8.m2.1"><semantics id="S5.F6.8.m2.1b"><mi id="S5.F6.8.m2.1.1" xref="S5.F6.8.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.F6.8.m2.1c"><ci id="S5.F6.8.m2.1.1.cmml" xref="S5.F6.8.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.8.m2.1d">h</annotation><annotation encoding="application/x-llamapun" id="S5.F6.8.m2.1e">italic_h</annotation></semantics></math>, and <math alttext="\sigma_{8}" class="ltx_Math" display="inline" id="S5.F6.9.m3.1"><semantics id="S5.F6.9.m3.1b"><msub id="S5.F6.9.m3.1.1" xref="S5.F6.9.m3.1.1.cmml"><mi id="S5.F6.9.m3.1.1.2" xref="S5.F6.9.m3.1.1.2.cmml">σ</mi><mn id="S5.F6.9.m3.1.1.3" xref="S5.F6.9.m3.1.1.3.cmml">8</mn></msub><annotation-xml encoding="MathML-Content" id="S5.F6.9.m3.1c"><apply id="S5.F6.9.m3.1.1.cmml" xref="S5.F6.9.m3.1.1"><csymbol cd="ambiguous" id="S5.F6.9.m3.1.1.1.cmml" xref="S5.F6.9.m3.1.1">subscript</csymbol><ci id="S5.F6.9.m3.1.1.2.cmml" xref="S5.F6.9.m3.1.1.2">𝜎</ci><cn id="S5.F6.9.m3.1.1.3.cmml" type="integer" xref="S5.F6.9.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.9.m3.1d">\sigma_{8}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.9.m3.1e">italic_σ start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT</annotation></semantics></math> from halo power spectrum multipoles in Quijote simulations using SBI. In (a) we show the comparison between true and predicted value of the parameters in the test simulations. Marginal error bars are shown at the central <math alttext="68\%" class="ltx_Math" display="inline" id="S5.F6.10.m4.1"><semantics id="S5.F6.10.m4.1b"><mrow id="S5.F6.10.m4.1.1" xref="S5.F6.10.m4.1.1.cmml"><mn id="S5.F6.10.m4.1.1.2" xref="S5.F6.10.m4.1.1.2.cmml">68</mn><mo id="S5.F6.10.m4.1.1.1" xref="S5.F6.10.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.10.m4.1c"><apply id="S5.F6.10.m4.1.1.cmml" xref="S5.F6.10.m4.1.1"><csymbol cd="latexml" id="S5.F6.10.m4.1.1.1.cmml" xref="S5.F6.10.m4.1.1.1">percent</csymbol><cn id="S5.F6.10.m4.1.1.2.cmml" type="integer" xref="S5.F6.10.m4.1.1.2">68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.10.m4.1d">68\%</annotation><annotation encoding="application/x-llamapun" id="S5.F6.10.m4.1e">68 %</annotation></semantics></math> confidence intervals. In (b) and (c) we show the coverage tests using the P-P plots as well as using TARP method. These show bootstrapping error bars at <math alttext="68\%" class="ltx_Math" display="inline" id="S5.F6.11.m5.1"><semantics id="S5.F6.11.m5.1b"><mrow id="S5.F6.11.m5.1.1" xref="S5.F6.11.m5.1.1.cmml"><mn id="S5.F6.11.m5.1.1.2" xref="S5.F6.11.m5.1.1.2.cmml">68</mn><mo id="S5.F6.11.m5.1.1.1" xref="S5.F6.11.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.11.m5.1c"><apply id="S5.F6.11.m5.1.1.cmml" xref="S5.F6.11.m5.1.1"><csymbol cd="latexml" id="S5.F6.11.m5.1.1.1.cmml" xref="S5.F6.11.m5.1.1.1">percent</csymbol><cn id="S5.F6.11.m5.1.1.2.cmml" type="integer" xref="S5.F6.11.m5.1.1.2">68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.11.m5.1d">68\%</annotation><annotation encoding="application/x-llamapun" id="S5.F6.11.m5.1e">68 %</annotation></semantics></math> and <math alttext="95\%" class="ltx_Math" display="inline" id="S5.F6.12.m6.1"><semantics id="S5.F6.12.m6.1b"><mrow id="S5.F6.12.m6.1.1" xref="S5.F6.12.m6.1.1.cmml"><mn id="S5.F6.12.m6.1.1.2" xref="S5.F6.12.m6.1.1.2.cmml">95</mn><mo id="S5.F6.12.m6.1.1.1" xref="S5.F6.12.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.12.m6.1c"><apply id="S5.F6.12.m6.1.1.cmml" xref="S5.F6.12.m6.1.1"><csymbol cd="latexml" id="S5.F6.12.m6.1.1.1.cmml" xref="S5.F6.12.m6.1.1.1">percent</csymbol><cn id="S5.F6.12.m6.1.1.2.cmml" type="integer" xref="S5.F6.12.m6.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.12.m6.1d">95\%</annotation><annotation encoding="application/x-llamapun" id="S5.F6.12.m6.1e">95 %</annotation></semantics></math>, indicative of typical variations in an ideal estimator for a finite test set.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.10">One of the major applications of SBI in the field of cosmology is to infer the cosmological parameters from observations.
This takes the form of using simulations as a forward model, measuring summary statistics that capture the relevant cosmological information, and then comparing them to observations.
Here we demonstrate this application by predicting three cosmological parameters using the power spectrum multipoles measured from the halo catalog of Quijote simulation <cite class="ltx_cite ltx_citemacro_cite">(see <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx118" title="">Villaescusa-Navarro <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Villaescusa-Navarro, Hahn, Massara, Banerjee, Delgado, Ramanah, Charnock, Giusarma, Li, Allys, Brochard, Uhlemann, Chiang, He, Pisani, Obuljen, Feng, Castorina, Contardo, Kreisch, Nicola, Alsing, Scoccimarro, Verde, Viel, Ho, Mallat, Wandelt, and Spergel</a>, for a description of the simulations)</cite>. We use the power spectrum multipoles corresponding to <math alttext="\ell=0,1,2" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.3"><semantics id="S5.SS2.p1.1.m1.3a"><mrow id="S5.SS2.p1.1.m1.3.4" xref="S5.SS2.p1.1.m1.3.4.cmml"><mi id="S5.SS2.p1.1.m1.3.4.2" mathvariant="normal" xref="S5.SS2.p1.1.m1.3.4.2.cmml">ℓ</mi><mo id="S5.SS2.p1.1.m1.3.4.1" xref="S5.SS2.p1.1.m1.3.4.1.cmml">=</mo><mrow id="S5.SS2.p1.1.m1.3.4.3.2" xref="S5.SS2.p1.1.m1.3.4.3.1.cmml"><mn id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">0</mn><mo id="S5.SS2.p1.1.m1.3.4.3.2.1" xref="S5.SS2.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S5.SS2.p1.1.m1.2.2" xref="S5.SS2.p1.1.m1.2.2.cmml">1</mn><mo id="S5.SS2.p1.1.m1.3.4.3.2.2" xref="S5.SS2.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S5.SS2.p1.1.m1.3.3" xref="S5.SS2.p1.1.m1.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.3b"><apply id="S5.SS2.p1.1.m1.3.4.cmml" xref="S5.SS2.p1.1.m1.3.4"><eq id="S5.SS2.p1.1.m1.3.4.1.cmml" xref="S5.SS2.p1.1.m1.3.4.1"></eq><ci id="S5.SS2.p1.1.m1.3.4.2.cmml" xref="S5.SS2.p1.1.m1.3.4.2">ℓ</ci><list id="S5.SS2.p1.1.m1.3.4.3.1.cmml" xref="S5.SS2.p1.1.m1.3.4.3.2"><cn id="S5.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS2.p1.1.m1.1.1">0</cn><cn id="S5.SS2.p1.1.m1.2.2.cmml" type="integer" xref="S5.SS2.p1.1.m1.2.2">1</cn><cn id="S5.SS2.p1.1.m1.3.3.cmml" type="integer" xref="S5.SS2.p1.1.m1.3.3">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.3c">\ell=0,1,2</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.3d">roman_ℓ = 0 , 1 , 2</annotation></semantics></math> in 23 linearly spaced wavenumber (<math alttext="k" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">italic_k</annotation></semantics></math>) bins ranging from 0.08<math alttext="h/{\rm Mpc}" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><mrow id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml"><mi id="S5.SS2.p1.3.m3.1.1.2" xref="S5.SS2.p1.3.m3.1.1.2.cmml">h</mi><mo id="S5.SS2.p1.3.m3.1.1.1" xref="S5.SS2.p1.3.m3.1.1.1.cmml">/</mo><mi id="S5.SS2.p1.3.m3.1.1.3" xref="S5.SS2.p1.3.m3.1.1.3.cmml">Mpc</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1"><divide id="S5.SS2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1.1"></divide><ci id="S5.SS2.p1.3.m3.1.1.2.cmml" xref="S5.SS2.p1.3.m3.1.1.2">ℎ</ci><ci id="S5.SS2.p1.3.m3.1.1.3.cmml" xref="S5.SS2.p1.3.m3.1.1.3">Mpc</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">h/{\rm Mpc}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">italic_h / roman_Mpc</annotation></semantics></math> to 2.8<math alttext="h/{\rm Mpc}" class="ltx_Math" display="inline" id="S5.SS2.p1.4.m4.1"><semantics id="S5.SS2.p1.4.m4.1a"><mrow id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml"><mi id="S5.SS2.p1.4.m4.1.1.2" xref="S5.SS2.p1.4.m4.1.1.2.cmml">h</mi><mo id="S5.SS2.p1.4.m4.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.cmml">/</mo><mi id="S5.SS2.p1.4.m4.1.1.3" xref="S5.SS2.p1.4.m4.1.1.3.cmml">Mpc</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><apply id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1"><divide id="S5.SS2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1"></divide><ci id="S5.SS2.p1.4.m4.1.1.2.cmml" xref="S5.SS2.p1.4.m4.1.1.2">ℎ</ci><ci id="S5.SS2.p1.4.m4.1.1.3.cmml" xref="S5.SS2.p1.4.m4.1.1.3">Mpc</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">h/{\rm Mpc}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.4.m4.1d">italic_h / roman_Mpc</annotation></semantics></math> as our observations, <math alttext="x" class="ltx_Math" display="inline" id="S5.SS2.p1.5.m5.1"><semantics id="S5.SS2.p1.5.m5.1a"><mi id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><ci id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.5.m5.1d">italic_x</annotation></semantics></math>. We use the SNLE method to learn the likelihood <math alttext="p(x|\theta)" class="ltx_Math" display="inline" id="S5.SS2.p1.6.m6.1"><semantics id="S5.SS2.p1.6.m6.1a"><mrow id="S5.SS2.p1.6.m6.1.1" xref="S5.SS2.p1.6.m6.1.1.cmml"><mi id="S5.SS2.p1.6.m6.1.1.3" xref="S5.SS2.p1.6.m6.1.1.3.cmml">p</mi><mo id="S5.SS2.p1.6.m6.1.1.2" xref="S5.SS2.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S5.SS2.p1.6.m6.1.1.1.1" xref="S5.SS2.p1.6.m6.1.1.1.1.1.cmml"><mo id="S5.SS2.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S5.SS2.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS2.p1.6.m6.1.1.1.1.1" xref="S5.SS2.p1.6.m6.1.1.1.1.1.cmml"><mi id="S5.SS2.p1.6.m6.1.1.1.1.1.2" xref="S5.SS2.p1.6.m6.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S5.SS2.p1.6.m6.1.1.1.1.1.1" xref="S5.SS2.p1.6.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S5.SS2.p1.6.m6.1.1.1.1.1.3" xref="S5.SS2.p1.6.m6.1.1.1.1.1.3.cmml">θ</mi></mrow><mo id="S5.SS2.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S5.SS2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m6.1b"><apply id="S5.SS2.p1.6.m6.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1"><times id="S5.SS2.p1.6.m6.1.1.2.cmml" xref="S5.SS2.p1.6.m6.1.1.2"></times><ci id="S5.SS2.p1.6.m6.1.1.3.cmml" xref="S5.SS2.p1.6.m6.1.1.3">𝑝</ci><apply id="S5.SS2.p1.6.m6.1.1.1.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="S5.SS2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS2.p1.6.m6.1.1.1.1.1.2.cmml" xref="S5.SS2.p1.6.m6.1.1.1.1.1.2">𝑥</ci><ci id="S5.SS2.p1.6.m6.1.1.1.1.1.3.cmml" xref="S5.SS2.p1.6.m6.1.1.1.1.1.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m6.1c">p(x|\theta)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.6.m6.1d">italic_p ( italic_x | italic_θ )</annotation></semantics></math>, where the parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S5.SS2.p1.7.m7.1"><semantics id="S5.SS2.p1.7.m7.1a"><mi id="S5.SS2.p1.7.m7.1.1" xref="S5.SS2.p1.7.m7.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.7.m7.1b"><ci id="S5.SS2.p1.7.m7.1.1.cmml" xref="S5.SS2.p1.7.m7.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.7.m7.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.7.m7.1d">italic_θ</annotation></semantics></math> correspond to three cosmological parameters: the total matter density <math alttext="\Omega_{m}" class="ltx_Math" display="inline" id="S5.SS2.p1.8.m8.1"><semantics id="S5.SS2.p1.8.m8.1a"><msub id="S5.SS2.p1.8.m8.1.1" xref="S5.SS2.p1.8.m8.1.1.cmml"><mi id="S5.SS2.p1.8.m8.1.1.2" mathvariant="normal" xref="S5.SS2.p1.8.m8.1.1.2.cmml">Ω</mi><mi id="S5.SS2.p1.8.m8.1.1.3" xref="S5.SS2.p1.8.m8.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.8.m8.1b"><apply id="S5.SS2.p1.8.m8.1.1.cmml" xref="S5.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.8.m8.1.1.1.cmml" xref="S5.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S5.SS2.p1.8.m8.1.1.2.cmml" xref="S5.SS2.p1.8.m8.1.1.2">Ω</ci><ci id="S5.SS2.p1.8.m8.1.1.3.cmml" xref="S5.SS2.p1.8.m8.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.8.m8.1c">\Omega_{m}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.8.m8.1d">roman_Ω start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, amplitude of the matter fluctuations <math alttext="\sigma_{8}" class="ltx_Math" display="inline" id="S5.SS2.p1.9.m9.1"><semantics id="S5.SS2.p1.9.m9.1a"><msub id="S5.SS2.p1.9.m9.1.1" xref="S5.SS2.p1.9.m9.1.1.cmml"><mi id="S5.SS2.p1.9.m9.1.1.2" xref="S5.SS2.p1.9.m9.1.1.2.cmml">σ</mi><mn id="S5.SS2.p1.9.m9.1.1.3" xref="S5.SS2.p1.9.m9.1.1.3.cmml">8</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.9.m9.1b"><apply id="S5.SS2.p1.9.m9.1.1.cmml" xref="S5.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.9.m9.1.1.1.cmml" xref="S5.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S5.SS2.p1.9.m9.1.1.2.cmml" xref="S5.SS2.p1.9.m9.1.1.2">𝜎</ci><cn id="S5.SS2.p1.9.m9.1.1.3.cmml" type="integer" xref="S5.SS2.p1.9.m9.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.9.m9.1c">\sigma_{8}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.9.m9.1d">italic_σ start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT</annotation></semantics></math>, and the Hubble constant <math alttext="h" class="ltx_Math" display="inline" id="S5.SS2.p1.10.m10.1"><semantics id="S5.SS2.p1.10.m10.1a"><mi id="S5.SS2.p1.10.m10.1.1" xref="S5.SS2.p1.10.m10.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.10.m10.1b"><ci id="S5.SS2.p1.10.m10.1.1.cmml" xref="S5.SS2.p1.10.m10.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.10.m10.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.10.m10.1d">italic_h</annotation></semantics></math> measuring the rate of the expansion of the Universe.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">We train an ensemble of six networks, each using the MAF architecture with three transformations and 10 hidden features. We use 1800 simulations to train the network, retaining the remaining 200 to test its performance as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F6" title="Figure 6 ‣ 5.2 Quijote Dark Matter Power Spectrum ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">6</span></a>. We then use VI sampling to obtain the posterior of the parameters from this trained likelihood ensemble, weighted by their validation losses.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.3">We show the true vs predicted value of the three parameters on the top-left panels (Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F6.sf1" title="6a ‣ Figure 6 ‣ 5.2 Quijote Dark Matter Power Spectrum ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">6a</span></a>), finding good predictive performance for <math alttext="\Omega_{m}" class="ltx_Math" display="inline" id="S5.SS2.p3.1.m1.1"><semantics id="S5.SS2.p3.1.m1.1a"><msub id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml"><mi id="S5.SS2.p3.1.m1.1.1.2" mathvariant="normal" xref="S5.SS2.p3.1.m1.1.1.2.cmml">Ω</mi><mi id="S5.SS2.p3.1.m1.1.1.3" xref="S5.SS2.p3.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><apply id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2">Ω</ci><ci id="S5.SS2.p3.1.m1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">\Omega_{m}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.1.m1.1d">roman_Ω start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\sigma_{8}" class="ltx_Math" display="inline" id="S5.SS2.p3.2.m2.1"><semantics id="S5.SS2.p3.2.m2.1a"><msub id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml"><mi id="S5.SS2.p3.2.m2.1.1.2" xref="S5.SS2.p3.2.m2.1.1.2.cmml">σ</mi><mn id="S5.SS2.p3.2.m2.1.1.3" xref="S5.SS2.p3.2.m2.1.1.3.cmml">8</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><apply id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.2.m2.1.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p3.2.m2.1.1.2.cmml" xref="S5.SS2.p3.2.m2.1.1.2">𝜎</ci><cn id="S5.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="S5.SS2.p3.2.m2.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">\sigma_{8}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.2.m2.1d">italic_σ start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT</annotation></semantics></math>. The lack of predictability for <math alttext="h" class="ltx_Math" display="inline" id="S5.SS2.p3.3.m3.1"><semantics id="S5.SS2.p3.3.m3.1a"><mi id="S5.SS2.p3.3.m3.1.1" xref="S5.SS2.p3.3.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.3.m3.1b"><ci id="S5.SS2.p3.3.m3.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.3.m3.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.3.m3.1d">italic_h</annotation></semantics></math> is expected physically, as the power spectrum multipoles alone are significantly less sensitive to expansion rate without some external prior information. We also perform coverage tests on the posteriors, finding uniformly distributed rank histograms as given by the coverage test in the bottom-left panels (Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F6.sf2" title="6b ‣ Figure 6 ‣ 5.2 Quijote Dark Matter Power Spectrum ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">6b</span></a>). Finally, we show the coverage test using the TARP method in the center-right panel (Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F6.sf3" title="6c ‣ Figure 6 ‣ 5.2 Quijote Dark Matter Power Spectrum ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">6c</span></a>), finding that the posterior is correctly calibrated.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Field-level Inference with Graph Neural Networks</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.3">We next demonstrate <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p1.3.1">LtU-ILI</span>’s ability to handle different data structures by also including a point cloud dataset example. In particular, we train a neural posterior estimator to recover the cosmological parameters <math alttext="\Omega_{m}" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" mathvariant="normal" xref="S5.SS3.p1.1.m1.1.1.2.cmml">Ω</mi><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">Ω</ci><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\Omega_{m}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">roman_Ω start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\sigma_{8}" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><msub id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">σ</mi><mn id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">8</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝜎</ci><cn id="S5.SS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S5.SS3.p1.2.m2.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">\sigma_{8}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">italic_σ start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT</annotation></semantics></math> from the positions of the <math alttext="10,000" class="ltx_Math" display="inline" id="S5.SS3.p1.3.m3.2"><semantics id="S5.SS3.p1.3.m3.2a"><mrow id="S5.SS3.p1.3.m3.2.3.2" xref="S5.SS3.p1.3.m3.2.3.1.cmml"><mn id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">10</mn><mo id="S5.SS3.p1.3.m3.2.3.2.1" xref="S5.SS3.p1.3.m3.2.3.1.cmml">,</mo><mn id="S5.SS3.p1.3.m3.2.2" xref="S5.SS3.p1.3.m3.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.2b"><list id="S5.SS3.p1.3.m3.2.3.1.cmml" xref="S5.SS3.p1.3.m3.2.3.2"><cn id="S5.SS3.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS3.p1.3.m3.1.1">10</cn><cn id="S5.SS3.p1.3.m3.2.2.cmml" type="integer" xref="S5.SS3.p1.3.m3.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.2c">10,000</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.3.m3.2d">10 , 000</annotation></semantics></math> heaviest dark matter haloes in the Quijote simulations <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx118" title="">Villaescusa-Navarro <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Villaescusa-Navarro, Hahn, Massara, Banerjee, Delgado, Ramanah, Charnock, Giusarma, Li, Allys, Brochard, Uhlemann, Chiang, He, Pisani, Obuljen, Feng, Castorina, Contardo, Kreisch, Nicola, Alsing, Scoccimarro, Verde, Viel, Ho, Mallat, Wandelt, and Spergel</a>)</cite>. The high resolution information present in the discrete halo positions has been shown to constrain cosmological parameters to extremely high precision <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S5.SS3.p1.3.2.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx119" title="">Makinen <em class="ltx_emph ltx_font_italic">et al.</em>(2022b)Makinen, Charnock, Lemos, Porqueres, Heavens, and Wandelt</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx120" title="">Cuesta-Lazaro and Mishra-Sharma(2023)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx121" title="">de Santi <em class="ltx_emph ltx_font_italic">et al.</em>(2023b)de Santi, Shao, Villaescusa-Navarro, Abramo, Teyssier, Villanueva-Domingo, Ni, Anglés-Alcázar, Genel, Hernández-Martínez, Steinwandel, Lovell, Dolag, Castro, and Vogelsberger</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">As an embedding network, we use a graph neural network. We construct a graph where dark matter haloes act as nodes connected to any other dark matter halo separated by a distance smaller than <math alttext="20\,{\rm Mpc}/h" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mrow id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml"><mn id="S5.SS3.p2.1.m1.1.1.2.2" xref="S5.SS3.p2.1.m1.1.1.2.2.cmml">20</mn><mo id="S5.SS3.p2.1.m1.1.1.2.1" lspace="0.170em" xref="S5.SS3.p2.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p2.1.m1.1.1.2.3" xref="S5.SS3.p2.1.m1.1.1.2.3.cmml">Mpc</mi></mrow><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">/</mo><mi id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><divide id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1"></divide><apply id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2"><times id="S5.SS3.p2.1.m1.1.1.2.1.cmml" xref="S5.SS3.p2.1.m1.1.1.2.1"></times><cn id="S5.SS3.p2.1.m1.1.1.2.2.cmml" type="integer" xref="S5.SS3.p2.1.m1.1.1.2.2">20</cn><ci id="S5.SS3.p2.1.m1.1.1.2.3.cmml" xref="S5.SS3.p2.1.m1.1.1.2.3">Mpc</ci></apply><ci id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">20\,{\rm Mpc}/h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">20 roman_Mpc / italic_h</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.3">We train an ensemble of four networks, each one using a MAF architecture with five transformations and <math alttext="50" class="ltx_Math" display="inline" id="S5.SS3.p3.1.m1.1"><semantics id="S5.SS3.p3.1.m1.1a"><mn id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><cn id="S5.SS3.p3.1.m1.1.1.cmml" type="integer" xref="S5.SS3.p3.1.m1.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">50</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.1.m1.1d">50</annotation></semantics></math> hidden features. The graph neural network is a message-passing neural network with node and edge neural networks being two multi-layer perceptrons with <math alttext="3" class="ltx_Math" display="inline" id="S5.SS3.p3.2.m2.1"><semantics id="S5.SS3.p3.2.m2.1a"><mn id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><cn id="S5.SS3.p3.2.m2.1.1.cmml" type="integer" xref="S5.SS3.p3.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">3</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.2.m2.1d">3</annotation></semantics></math> layers of <math alttext="128" class="ltx_Math" display="inline" id="S5.SS3.p3.3.m3.1"><semantics id="S5.SS3.p3.3.m3.1a"><mn id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><cn id="S5.SS3.p3.3.m3.1.1.cmml" type="integer" xref="S5.SS3.p3.3.m3.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">128</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.3.m3.1d">128</annotation></semantics></math> hidden units each. The network takes as inputs 3D distances between nodes, and their corresponding modulus.</p>
</div>
<div class="ltx_para" id="S5.SS3.p4">
<p class="ltx_p" id="S5.SS3.p4.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F7" title="Figure 7 ‣ 5.3 Field-level Inference with Graph Neural Networks ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">7</span></a>, we show an example point cloud together with the resulting graph neural network inference. The graph neural network obtains well-calibrated and informative posteriors, consistent with true values. We note that the constraints are not as tight as those produced for the Quijote dark matter power spectrum in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F6" title="Figure 6 ‣ 5.2 Quijote Dark Matter Power Spectrum ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">6</span></a>. This is likely because the graph only targets the most massive halos, <em class="ltx_emph ltx_font_italic" id="S5.SS3.p4.1.1">i.e.,</em> a more physically realistic probe, while the results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F6" title="Figure 6 ‣ 5.2 Quijote Dark Matter Power Spectrum ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">6</span></a> access the full, high-resolution dark matter distribution.</p>
</div>
<figure class="ltx_figure" id="S5.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_center ltx_align_middle" id="S5.F7.1" style="width:238.5pt;">
<span class="ltx_para ltx_align_center" id="S5.F7.1.p1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="725" id="S5.F7.1.p1.g1" src="x9.png" width="831"/>
</span></span></div>
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_center ltx_align_middle" id="S5.F7.2" style="width:186.5pt;">
<span class="ltx_para ltx_align_center" id="S5.F7.2.p1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="827" id="S5.F7.2.p1.g1" src="x10.png" width="830"/>
</span></span></div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Cosmological inference from dark matter halo point clouds. Left: Example point cloud from the Quijote simulations. The graph neural network takes as an input the distances between halos separated by less than <math alttext="20\,{\rm Mpc}/h" class="ltx_Math" display="inline" id="S5.F7.8.m1.1"><semantics id="S5.F7.8.m1.1b"><mrow id="S5.F7.8.m1.1.1" xref="S5.F7.8.m1.1.1.cmml"><mrow id="S5.F7.8.m1.1.1.2" xref="S5.F7.8.m1.1.1.2.cmml"><mn id="S5.F7.8.m1.1.1.2.2" xref="S5.F7.8.m1.1.1.2.2.cmml">20</mn><mo id="S5.F7.8.m1.1.1.2.1" lspace="0.170em" xref="S5.F7.8.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.F7.8.m1.1.1.2.3" xref="S5.F7.8.m1.1.1.2.3.cmml">Mpc</mi></mrow><mo id="S5.F7.8.m1.1.1.1" xref="S5.F7.8.m1.1.1.1.cmml">/</mo><mi id="S5.F7.8.m1.1.1.3" xref="S5.F7.8.m1.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.8.m1.1c"><apply id="S5.F7.8.m1.1.1.cmml" xref="S5.F7.8.m1.1.1"><divide id="S5.F7.8.m1.1.1.1.cmml" xref="S5.F7.8.m1.1.1.1"></divide><apply id="S5.F7.8.m1.1.1.2.cmml" xref="S5.F7.8.m1.1.1.2"><times id="S5.F7.8.m1.1.1.2.1.cmml" xref="S5.F7.8.m1.1.1.2.1"></times><cn id="S5.F7.8.m1.1.1.2.2.cmml" type="integer" xref="S5.F7.8.m1.1.1.2.2">20</cn><ci id="S5.F7.8.m1.1.1.2.3.cmml" xref="S5.F7.8.m1.1.1.2.3">Mpc</ci></apply><ci id="S5.F7.8.m1.1.1.3.cmml" xref="S5.F7.8.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.8.m1.1d">20\,{\rm Mpc}/h</annotation><annotation encoding="application/x-llamapun" id="S5.F7.8.m1.1e">20 roman_Mpc / italic_h</annotation></semantics></math>. Right: Inferred posterior over <math alttext="\Omega_{m}" class="ltx_Math" display="inline" id="S5.F7.9.m2.1"><semantics id="S5.F7.9.m2.1b"><msub id="S5.F7.9.m2.1.1" xref="S5.F7.9.m2.1.1.cmml"><mi id="S5.F7.9.m2.1.1.2" mathvariant="normal" xref="S5.F7.9.m2.1.1.2.cmml">Ω</mi><mi id="S5.F7.9.m2.1.1.3" xref="S5.F7.9.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F7.9.m2.1c"><apply id="S5.F7.9.m2.1.1.cmml" xref="S5.F7.9.m2.1.1"><csymbol cd="ambiguous" id="S5.F7.9.m2.1.1.1.cmml" xref="S5.F7.9.m2.1.1">subscript</csymbol><ci id="S5.F7.9.m2.1.1.2.cmml" xref="S5.F7.9.m2.1.1.2">Ω</ci><ci id="S5.F7.9.m2.1.1.3.cmml" xref="S5.F7.9.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.9.m2.1d">\Omega_{m}</annotation><annotation encoding="application/x-llamapun" id="S5.F7.9.m2.1e">roman_Ω start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\sigma_{8}" class="ltx_Math" display="inline" id="S5.F7.10.m3.1"><semantics id="S5.F7.10.m3.1b"><msub id="S5.F7.10.m3.1.1" xref="S5.F7.10.m3.1.1.cmml"><mi id="S5.F7.10.m3.1.1.2" xref="S5.F7.10.m3.1.1.2.cmml">σ</mi><mn id="S5.F7.10.m3.1.1.3" xref="S5.F7.10.m3.1.1.3.cmml">8</mn></msub><annotation-xml encoding="MathML-Content" id="S5.F7.10.m3.1c"><apply id="S5.F7.10.m3.1.1.cmml" xref="S5.F7.10.m3.1.1"><csymbol cd="ambiguous" id="S5.F7.10.m3.1.1.1.cmml" xref="S5.F7.10.m3.1.1">subscript</csymbol><ci id="S5.F7.10.m3.1.1.2.cmml" xref="S5.F7.10.m3.1.1.2">𝜎</ci><cn id="S5.F7.10.m3.1.1.3.cmml" type="integer" xref="S5.F7.10.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.10.m3.1d">\sigma_{8}</annotation><annotation encoding="application/x-llamapun" id="S5.F7.10.m3.1e">italic_σ start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT</annotation></semantics></math> on a test set simulation. True values are shown in gray. Contours are shown at the central <math alttext="68\%" class="ltx_Math" display="inline" id="S5.F7.11.m4.1"><semantics id="S5.F7.11.m4.1b"><mrow id="S5.F7.11.m4.1.1" xref="S5.F7.11.m4.1.1.cmml"><mn id="S5.F7.11.m4.1.1.2" xref="S5.F7.11.m4.1.1.2.cmml">68</mn><mo id="S5.F7.11.m4.1.1.1" xref="S5.F7.11.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.11.m4.1c"><apply id="S5.F7.11.m4.1.1.cmml" xref="S5.F7.11.m4.1.1"><csymbol cd="latexml" id="S5.F7.11.m4.1.1.1.cmml" xref="S5.F7.11.m4.1.1.1">percent</csymbol><cn id="S5.F7.11.m4.1.1.2.cmml" type="integer" xref="S5.F7.11.m4.1.1.2">68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.11.m4.1d">68\%</annotation><annotation encoding="application/x-llamapun" id="S5.F7.11.m4.1e">68 %</annotation></semantics></math> and <math alttext="95\%" class="ltx_Math" display="inline" id="S5.F7.12.m5.1"><semantics id="S5.F7.12.m5.1b"><mrow id="S5.F7.12.m5.1.1" xref="S5.F7.12.m5.1.1.cmml"><mn id="S5.F7.12.m5.1.1.2" xref="S5.F7.12.m5.1.1.2.cmml">95</mn><mo id="S5.F7.12.m5.1.1.1" xref="S5.F7.12.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.12.m5.1c"><apply id="S5.F7.12.m5.1.1.cmml" xref="S5.F7.12.m5.1.1"><csymbol cd="latexml" id="S5.F7.12.m5.1.1.1.cmml" xref="S5.F7.12.m5.1.1.1">percent</csymbol><cn id="S5.F7.12.m5.1.1.2.cmml" type="integer" xref="S5.F7.12.m5.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.12.m5.1d">95\%</annotation><annotation encoding="application/x-llamapun" id="S5.F7.12.m5.1e">95 %</annotation></semantics></math> confidence intervals.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Multi-round Inference for Gravitational Waves</h3>
<figure class="ltx_figure" id="S5.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_inline-para ltx_minipage ltx_flex_size_1 ltx_align_center ltx_align_middle" id="S5.F8.13" style="width:186.5pt;">
<span class="ltx_figure" id="S5.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="603" id="S5.F8.sf1.g1" src="x11.png" width="830"/>
<span class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Example of GW signal in source and detector frame.</span>
</span>
<span class="ltx_figure" id="S5.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="461" id="S5.F8.sf2.g1" src="x12.png" width="830"/>
<span class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Multi-round training and validation posterior probability.</span>
</span></span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_minipage ltx_flex_size_1 ltx_align_center ltx_align_middle" id="S5.F8.sf3" style="width:238.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="806" id="S5.F8.sf3.g1" src="x13.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Posterior corner plot for SNPE inference.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Example parameter inference of a GW150914-like event as observed by the gravitational wave Hanford (H1) and Livingstone detectors. (a) Example simulated gravitational signal. Top: Radiation polarizations <math alttext="h_{+}" class="ltx_Math" display="inline" id="S5.F8.7.m1.1"><semantics id="S5.F8.7.m1.1b"><msub id="S5.F8.7.m1.1.1" xref="S5.F8.7.m1.1.1.cmml"><mi id="S5.F8.7.m1.1.1.2" xref="S5.F8.7.m1.1.1.2.cmml">h</mi><mo id="S5.F8.7.m1.1.1.3" xref="S5.F8.7.m1.1.1.3.cmml">+</mo></msub><annotation-xml encoding="MathML-Content" id="S5.F8.7.m1.1c"><apply id="S5.F8.7.m1.1.1.cmml" xref="S5.F8.7.m1.1.1"><csymbol cd="ambiguous" id="S5.F8.7.m1.1.1.1.cmml" xref="S5.F8.7.m1.1.1">subscript</csymbol><ci id="S5.F8.7.m1.1.1.2.cmml" xref="S5.F8.7.m1.1.1.2">ℎ</ci><plus id="S5.F8.7.m1.1.1.3.cmml" xref="S5.F8.7.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.7.m1.1d">h_{+}</annotation><annotation encoding="application/x-llamapun" id="S5.F8.7.m1.1e">italic_h start_POSTSUBSCRIPT + end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="h_{\times}" class="ltx_Math" display="inline" id="S5.F8.8.m2.1"><semantics id="S5.F8.8.m2.1b"><msub id="S5.F8.8.m2.1.1" xref="S5.F8.8.m2.1.1.cmml"><mi id="S5.F8.8.m2.1.1.2" xref="S5.F8.8.m2.1.1.2.cmml">h</mi><mo id="S5.F8.8.m2.1.1.3" xref="S5.F8.8.m2.1.1.3.cmml">×</mo></msub><annotation-xml encoding="MathML-Content" id="S5.F8.8.m2.1c"><apply id="S5.F8.8.m2.1.1.cmml" xref="S5.F8.8.m2.1.1"><csymbol cd="ambiguous" id="S5.F8.8.m2.1.1.1.cmml" xref="S5.F8.8.m2.1.1">subscript</csymbol><ci id="S5.F8.8.m2.1.1.2.cmml" xref="S5.F8.8.m2.1.1.2">ℎ</ci><times id="S5.F8.8.m2.1.1.3.cmml" xref="S5.F8.8.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.8.m2.1d">h_{\times}</annotation><annotation encoding="application/x-llamapun" id="S5.F8.8.m2.1e">italic_h start_POSTSUBSCRIPT × end_POSTSUBSCRIPT</annotation></semantics></math> in source frame. Bottom: Real part of the strain and noise realization on Hanford (H1) detector frame. (b) Evolution of the log-probability for the multi-round GW inference example using SNPE, <em class="ltx_emph ltx_font_italic" id="S5.F8.15.1">i.e.,</em> the negative of the loss function in equation (<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E4" title="4 ‣ 2.2.1 Neural Posterior Estimation (NPE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">4</span></a>) for <math alttext="n_{r}=5" class="ltx_Math" display="inline" id="S5.F8.9.m3.1"><semantics id="S5.F8.9.m3.1b"><mrow id="S5.F8.9.m3.1.1" xref="S5.F8.9.m3.1.1.cmml"><msub id="S5.F8.9.m3.1.1.2" xref="S5.F8.9.m3.1.1.2.cmml"><mi id="S5.F8.9.m3.1.1.2.2" xref="S5.F8.9.m3.1.1.2.2.cmml">n</mi><mi id="S5.F8.9.m3.1.1.2.3" xref="S5.F8.9.m3.1.1.2.3.cmml">r</mi></msub><mo id="S5.F8.9.m3.1.1.1" xref="S5.F8.9.m3.1.1.1.cmml">=</mo><mn id="S5.F8.9.m3.1.1.3" xref="S5.F8.9.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.9.m3.1c"><apply id="S5.F8.9.m3.1.1.cmml" xref="S5.F8.9.m3.1.1"><eq id="S5.F8.9.m3.1.1.1.cmml" xref="S5.F8.9.m3.1.1.1"></eq><apply id="S5.F8.9.m3.1.1.2.cmml" xref="S5.F8.9.m3.1.1.2"><csymbol cd="ambiguous" id="S5.F8.9.m3.1.1.2.1.cmml" xref="S5.F8.9.m3.1.1.2">subscript</csymbol><ci id="S5.F8.9.m3.1.1.2.2.cmml" xref="S5.F8.9.m3.1.1.2.2">𝑛</ci><ci id="S5.F8.9.m3.1.1.2.3.cmml" xref="S5.F8.9.m3.1.1.2.3">𝑟</ci></apply><cn id="S5.F8.9.m3.1.1.3.cmml" type="integer" xref="S5.F8.9.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.9.m3.1d">n_{r}=5</annotation><annotation encoding="application/x-llamapun" id="S5.F8.9.m3.1e">italic_n start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = 5</annotation></semantics></math> rounds.
(c) Resultant posterior for a single run of the multi-round SNPE inference on GW strain data. Contours are shown at <math alttext="68\%" class="ltx_Math" display="inline" id="S5.F8.10.m4.1"><semantics id="S5.F8.10.m4.1b"><mrow id="S5.F8.10.m4.1.1" xref="S5.F8.10.m4.1.1.cmml"><mn id="S5.F8.10.m4.1.1.2" xref="S5.F8.10.m4.1.1.2.cmml">68</mn><mo id="S5.F8.10.m4.1.1.1" xref="S5.F8.10.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.10.m4.1c"><apply id="S5.F8.10.m4.1.1.cmml" xref="S5.F8.10.m4.1.1"><csymbol cd="latexml" id="S5.F8.10.m4.1.1.1.cmml" xref="S5.F8.10.m4.1.1.1">percent</csymbol><cn id="S5.F8.10.m4.1.1.2.cmml" type="integer" xref="S5.F8.10.m4.1.1.2">68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.10.m4.1d">68\%</annotation><annotation encoding="application/x-llamapun" id="S5.F8.10.m4.1e">68 %</annotation></semantics></math> and <math alttext="95\%" class="ltx_Math" display="inline" id="S5.F8.11.m5.1"><semantics id="S5.F8.11.m5.1b"><mrow id="S5.F8.11.m5.1.1" xref="S5.F8.11.m5.1.1.cmml"><mn id="S5.F8.11.m5.1.1.2" xref="S5.F8.11.m5.1.1.2.cmml">95</mn><mo id="S5.F8.11.m5.1.1.1" xref="S5.F8.11.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.11.m5.1c"><apply id="S5.F8.11.m5.1.1.cmml" xref="S5.F8.11.m5.1.1"><csymbol cd="latexml" id="S5.F8.11.m5.1.1.1.cmml" xref="S5.F8.11.m5.1.1.1">percent</csymbol><cn id="S5.F8.11.m5.1.1.2.cmml" type="integer" xref="S5.F8.11.m5.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.11.m5.1d">95\%</annotation><annotation encoding="application/x-llamapun" id="S5.F8.11.m5.1e">95 %</annotation></semantics></math> confidence intervals, and dashed lines indicate the fiducial parameter values. The fake observation <math alttext="\bm{x}_{0}" class="ltx_Math" display="inline" id="S5.F8.12.m6.1"><semantics id="S5.F8.12.m6.1b"><msub id="S5.F8.12.m6.1.1" xref="S5.F8.12.m6.1.1.cmml"><mi id="S5.F8.12.m6.1.1.2" xref="S5.F8.12.m6.1.1.2.cmml">𝒙</mi><mn id="S5.F8.12.m6.1.1.3" xref="S5.F8.12.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.F8.12.m6.1c"><apply id="S5.F8.12.m6.1.1.cmml" xref="S5.F8.12.m6.1.1"><csymbol cd="ambiguous" id="S5.F8.12.m6.1.1.1.cmml" xref="S5.F8.12.m6.1.1">subscript</csymbol><ci id="S5.F8.12.m6.1.1.2.cmml" xref="S5.F8.12.m6.1.1.2">𝒙</ci><cn id="S5.F8.12.m6.1.1.3.cmml" type="integer" xref="S5.F8.12.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.12.m6.1d">\bm{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S5.F8.12.m6.1e">bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> was generated with the same simulator function as the training forward model.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">Over recent years, several studies based on ILI methods have addressed the problem of reconstructing parameters of merger events from gravitational wave (GW) signals <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx122" title="">Cutler and Flanagan(1994)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx123" title="">Thrane and Talbot(2019)</a>)</cite>. Initial advancements were marked by significant contributions to posterior estimation using normalizing flows, as highlighted in <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx124" title="">Green <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Green, Simpson, and Gair</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx125" title="">Green and Gair(2020)</a></cite>. Subsequent research <cite class="ltx_cite ltx_citemacro_citep">(DINGO: <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx16" title="">Dax <em class="ltx_emph ltx_font_italic">et al.</em>(2021a)Dax, Green, Gair, Macke, Buonanno, and Schölkopf</a>)</cite> introduced variations of NPE taking advantage of Group Equivariant Neural Posterior Estimation <cite class="ltx_cite ltx_citemacro_citep">(GNPE: <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx126" title="">Dax <em class="ltx_emph ltx_font_italic">et al.</em>(2021b)Dax, Green, Gair, Deistler, Schölkopf, and Macke</a>)</cite> or Flow Matching Posterior Estimation <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx127" title="">Wildberger <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Wildberger, Dax, Buchholz, Green, Macke, and Schölkopf</a>)</cite>. More recently, <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx60" title="">Crisostomi <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Crisostomi, Dey, Barausse, and Trotta</a></cite> showcased a similar application of multi-round NPE to estimate ringdown parameters of GW150914. <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx73" title="">Delaunoy <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Delaunoy, Wehenkel, Hinderer, Nissanke, Weniger, Williamson, and Louppe</a></cite> and <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx74" title="">Bhardwaj <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Bhardwaj, Alvey, Miller, Nissanke, and Weniger</a></cite> also serve as recent illustrations of applying NRE to GW analyses – the latter incorporating multi-round inference as well.</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.2">In this example, we explore the application of multi-round inference to constrain a reduced set of gravitational wave (GW) parameters. Our forward-modeled data vector is constructed by merging the simulated frequency-domain strain signals from each of the Hanford (H1) and Livingstone (L1) detectors. We employ the <span class="ltx_text ltx_font_typewriter" id="S5.SS4.p2.2.1">IMRPhenomPv2</span> algorithm <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx128" title="">Khan <em class="ltx_emph ltx_font_italic">et al.</em>(2016)Khan, Husa, Hannam, Ohme, Pürrer, Forteza, and Bohé</a>)</cite> with a frequency resolution of <math alttext="\Delta f=0.125\textrm{ Hz}" class="ltx_Math" display="inline" id="S5.SS4.p2.1.m1.1"><semantics id="S5.SS4.p2.1.m1.1a"><mrow id="S5.SS4.p2.1.m1.1.1" xref="S5.SS4.p2.1.m1.1.1.cmml"><mrow id="S5.SS4.p2.1.m1.1.1.2" xref="S5.SS4.p2.1.m1.1.1.2.cmml"><mi id="S5.SS4.p2.1.m1.1.1.2.2" mathvariant="normal" xref="S5.SS4.p2.1.m1.1.1.2.2.cmml">Δ</mi><mo id="S5.SS4.p2.1.m1.1.1.2.1" xref="S5.SS4.p2.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS4.p2.1.m1.1.1.2.3" xref="S5.SS4.p2.1.m1.1.1.2.3.cmml">f</mi></mrow><mo id="S5.SS4.p2.1.m1.1.1.1" xref="S5.SS4.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S5.SS4.p2.1.m1.1.1.3" xref="S5.SS4.p2.1.m1.1.1.3.cmml"><mn id="S5.SS4.p2.1.m1.1.1.3.2" xref="S5.SS4.p2.1.m1.1.1.3.2.cmml">0.125</mn><mo id="S5.SS4.p2.1.m1.1.1.3.1" xref="S5.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mtext id="S5.SS4.p2.1.m1.1.1.3.3" xref="S5.SS4.p2.1.m1.1.1.3.3a.cmml"> Hz</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><apply id="S5.SS4.p2.1.m1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1"><eq id="S5.SS4.p2.1.m1.1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1.1"></eq><apply id="S5.SS4.p2.1.m1.1.1.2.cmml" xref="S5.SS4.p2.1.m1.1.1.2"><times id="S5.SS4.p2.1.m1.1.1.2.1.cmml" xref="S5.SS4.p2.1.m1.1.1.2.1"></times><ci id="S5.SS4.p2.1.m1.1.1.2.2.cmml" xref="S5.SS4.p2.1.m1.1.1.2.2">Δ</ci><ci id="S5.SS4.p2.1.m1.1.1.2.3.cmml" xref="S5.SS4.p2.1.m1.1.1.2.3">𝑓</ci></apply><apply id="S5.SS4.p2.1.m1.1.1.3.cmml" xref="S5.SS4.p2.1.m1.1.1.3"><times id="S5.SS4.p2.1.m1.1.1.3.1.cmml" xref="S5.SS4.p2.1.m1.1.1.3.1"></times><cn id="S5.SS4.p2.1.m1.1.1.3.2.cmml" type="float" xref="S5.SS4.p2.1.m1.1.1.3.2">0.125</cn><ci id="S5.SS4.p2.1.m1.1.1.3.3a.cmml" xref="S5.SS4.p2.1.m1.1.1.3.3"><mtext id="S5.SS4.p2.1.m1.1.1.3.3.cmml" xref="S5.SS4.p2.1.m1.1.1.3.3"> Hz</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.1c">\Delta f=0.125\textrm{ Hz}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.1.m1.1d">roman_Δ italic_f = 0.125 Hz</annotation></semantics></math>, resulting in an input data vector of <math alttext="\textrm{dim}(\bm{x})=2\times 7872" class="ltx_Math" display="inline" id="S5.SS4.p2.2.m2.1"><semantics id="S5.SS4.p2.2.m2.1a"><mrow id="S5.SS4.p2.2.m2.1.2" xref="S5.SS4.p2.2.m2.1.2.cmml"><mrow id="S5.SS4.p2.2.m2.1.2.2" xref="S5.SS4.p2.2.m2.1.2.2.cmml"><mtext id="S5.SS4.p2.2.m2.1.2.2.2" xref="S5.SS4.p2.2.m2.1.2.2.2a.cmml">dim</mtext><mo id="S5.SS4.p2.2.m2.1.2.2.1" xref="S5.SS4.p2.2.m2.1.2.2.1.cmml">⁢</mo><mrow id="S5.SS4.p2.2.m2.1.2.2.3.2" xref="S5.SS4.p2.2.m2.1.2.2.cmml"><mo id="S5.SS4.p2.2.m2.1.2.2.3.2.1" stretchy="false" xref="S5.SS4.p2.2.m2.1.2.2.cmml">(</mo><mi id="S5.SS4.p2.2.m2.1.1" xref="S5.SS4.p2.2.m2.1.1.cmml">𝒙</mi><mo id="S5.SS4.p2.2.m2.1.2.2.3.2.2" stretchy="false" xref="S5.SS4.p2.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S5.SS4.p2.2.m2.1.2.1" xref="S5.SS4.p2.2.m2.1.2.1.cmml">=</mo><mrow id="S5.SS4.p2.2.m2.1.2.3" xref="S5.SS4.p2.2.m2.1.2.3.cmml"><mn id="S5.SS4.p2.2.m2.1.2.3.2" xref="S5.SS4.p2.2.m2.1.2.3.2.cmml">2</mn><mo id="S5.SS4.p2.2.m2.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S5.SS4.p2.2.m2.1.2.3.1.cmml">×</mo><mn id="S5.SS4.p2.2.m2.1.2.3.3" xref="S5.SS4.p2.2.m2.1.2.3.3.cmml">7872</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.2.m2.1b"><apply id="S5.SS4.p2.2.m2.1.2.cmml" xref="S5.SS4.p2.2.m2.1.2"><eq id="S5.SS4.p2.2.m2.1.2.1.cmml" xref="S5.SS4.p2.2.m2.1.2.1"></eq><apply id="S5.SS4.p2.2.m2.1.2.2.cmml" xref="S5.SS4.p2.2.m2.1.2.2"><times id="S5.SS4.p2.2.m2.1.2.2.1.cmml" xref="S5.SS4.p2.2.m2.1.2.2.1"></times><ci id="S5.SS4.p2.2.m2.1.2.2.2a.cmml" xref="S5.SS4.p2.2.m2.1.2.2.2"><mtext id="S5.SS4.p2.2.m2.1.2.2.2.cmml" xref="S5.SS4.p2.2.m2.1.2.2.2">dim</mtext></ci><ci id="S5.SS4.p2.2.m2.1.1.cmml" xref="S5.SS4.p2.2.m2.1.1">𝒙</ci></apply><apply id="S5.SS4.p2.2.m2.1.2.3.cmml" xref="S5.SS4.p2.2.m2.1.2.3"><times id="S5.SS4.p2.2.m2.1.2.3.1.cmml" xref="S5.SS4.p2.2.m2.1.2.3.1"></times><cn id="S5.SS4.p2.2.m2.1.2.3.2.cmml" type="integer" xref="S5.SS4.p2.2.m2.1.2.3.2">2</cn><cn id="S5.SS4.p2.2.m2.1.2.3.3.cmml" type="integer" xref="S5.SS4.p2.2.m2.1.2.3.3">7872</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.2.m2.1c">\textrm{dim}(\bm{x})=2\times 7872</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.2.m2.1d">dim ( bold_italic_x ) = 2 × 7872</annotation></semantics></math>. An illustration of this data vector is presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F8.sf1" title="8a ‣ Figure 8 ‣ 5.4 Multi-round Inference for Gravitational Waves ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">8a</span></a> for clarity. We stress that, in contrast to likelihood-based sampling methods implemented in <span class="ltx_text ltx_font_typewriter" id="S5.SS4.p2.2.2">Bilby</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx129" title="">Ashton <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Ashton, Hübner, Lasky, Talbot, Ackley, Biscoveanu, Chu, Divakarla, Easter, Goncharov, Hernandez Vivanco, Harms, Lower, Meadors, Melchor, Payne, Pitkin, Powell, Sarin, Smith, and Thrane</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx130" title="">Romero-Shaw <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Romero-Shaw, Talbot, Biscoveanu, D’Emilio, Ashton, Berry, Coughlin, Galaudage, Hoy, Hübner, Phukon, Pitkin, Rizzo, Sarin, Smith, Stevenson, Vajpeyi, Arène, Athar, Banagiri, Bose, Carney, Chatziioannou, Clark, Colleoni, Cotesta, Edelman, Estellés, García-Quirós, Ghosh, Green, Haster, Husa, Keitel, Kim,
Hernandez-Vivanco, Magaña Hernandez, Karathanasis, Lasky, De Lillo, Lower, Macleod, Mateu-Lucena, Miller, Millhouse, Morisaki, Oh, Ossokine, Payne, Powell, Pratten, Pürrer, Ramos-Buades, Raymond, Thrane, Veitch, Williams, Williams, and Xiao</a>)</cite>, which only necessitate the signal component of the forward model for the likelihood computation, our ILI approach requires the inclusion of noise realizations in the training data vector.</p>
</div>
<div class="ltx_para" id="S5.SS4.p3">
<p class="ltx_p" id="S5.SS4.p3.6">We illustrate a simplified application of LtU-ILI for NPE on GW signals, fixing parameters related to the time and geometry of the detection and focusing on a set of four parameters: chirp mass (<math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S5.SS4.p3.1.m1.1"><semantics id="S5.SS4.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p3.1.m1.1.1" xref="S5.SS4.p3.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.1.m1.1b"><ci id="S5.SS4.p3.1.m1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.1.m1.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.1.m1.1d">caligraphic_M</annotation></semantics></math>), mass ratio (<math alttext="q" class="ltx_Math" display="inline" id="S5.SS4.p3.2.m2.1"><semantics id="S5.SS4.p3.2.m2.1a"><mi id="S5.SS4.p3.2.m2.1.1" xref="S5.SS4.p3.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.2.m2.1b"><ci id="S5.SS4.p3.2.m2.1.1.cmml" xref="S5.SS4.p3.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.2.m2.1d">italic_q</annotation></semantics></math>), effective aligned spin (<math alttext="\chi_{\textrm{eff}}" class="ltx_Math" display="inline" id="S5.SS4.p3.3.m3.1"><semantics id="S5.SS4.p3.3.m3.1a"><msub id="S5.SS4.p3.3.m3.1.1" xref="S5.SS4.p3.3.m3.1.1.cmml"><mi id="S5.SS4.p3.3.m3.1.1.2" xref="S5.SS4.p3.3.m3.1.1.2.cmml">χ</mi><mtext id="S5.SS4.p3.3.m3.1.1.3" xref="S5.SS4.p3.3.m3.1.1.3a.cmml">eff</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.3.m3.1b"><apply id="S5.SS4.p3.3.m3.1.1.cmml" xref="S5.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.3.m3.1.1.1.cmml" xref="S5.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S5.SS4.p3.3.m3.1.1.2.cmml" xref="S5.SS4.p3.3.m3.1.1.2">𝜒</ci><ci id="S5.SS4.p3.3.m3.1.1.3a.cmml" xref="S5.SS4.p3.3.m3.1.1.3"><mtext id="S5.SS4.p3.3.m3.1.1.3.cmml" mathsize="70%" xref="S5.SS4.p3.3.m3.1.1.3">eff</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.3.m3.1c">\chi_{\textrm{eff}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.3.m3.1d">italic_χ start_POSTSUBSCRIPT eff end_POSTSUBSCRIPT</annotation></semantics></math>) and luminosity distance (<math alttext="d_{L}" class="ltx_Math" display="inline" id="S5.SS4.p3.4.m4.1"><semantics id="S5.SS4.p3.4.m4.1a"><msub id="S5.SS4.p3.4.m4.1.1" xref="S5.SS4.p3.4.m4.1.1.cmml"><mi id="S5.SS4.p3.4.m4.1.1.2" xref="S5.SS4.p3.4.m4.1.1.2.cmml">d</mi><mi id="S5.SS4.p3.4.m4.1.1.3" xref="S5.SS4.p3.4.m4.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.4.m4.1b"><apply id="S5.SS4.p3.4.m4.1.1.cmml" xref="S5.SS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.4.m4.1.1.1.cmml" xref="S5.SS4.p3.4.m4.1.1">subscript</csymbol><ci id="S5.SS4.p3.4.m4.1.1.2.cmml" xref="S5.SS4.p3.4.m4.1.1.2">𝑑</ci><ci id="S5.SS4.p3.4.m4.1.1.3.cmml" xref="S5.SS4.p3.4.m4.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.4.m4.1c">d_{L}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.4.m4.1d">italic_d start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT</annotation></semantics></math>). These parameters, chosen for their reduced correlation and significance in GW parameter estimation <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S5.SS4.p3.6.1.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx131" title="">Veitch <em class="ltx_emph ltx_font_italic">et al.</em>(2015)Veitch, Raymond, Farr, Farr, Graff, Vitale, Aylott, Blackburn, Christensen, Coughlin, Del Pozzo, Feroz, Gair, Haster, Kalogera, Littenberg, Mandel, O’Shaughnessy, Pitkin, Rodriguez, Röver, Sidery, Smith, Van Der Sluys, Vecchio, Vousden, and Wade</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx132" title="">Vitale <em class="ltx_emph ltx_font_italic">et al.</em>(2017)Vitale, Lynch, Raymond, Sturani, Veitch, and Graff</a>)</cite>, are derived from the masses of the coalescing objects – with <math alttext="\mathcal{M}\equiv(m_{1}m_{2})^{\frac{3}{5}}/(m_{1}+m_{2})^{\frac{1}{5}}" class="ltx_Math" display="inline" id="S5.SS4.p3.5.m5.2"><semantics id="S5.SS4.p3.5.m5.2a"><mrow id="S5.SS4.p3.5.m5.2.2" xref="S5.SS4.p3.5.m5.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p3.5.m5.2.2.4" xref="S5.SS4.p3.5.m5.2.2.4.cmml">ℳ</mi><mo id="S5.SS4.p3.5.m5.2.2.3" xref="S5.SS4.p3.5.m5.2.2.3.cmml">≡</mo><mrow id="S5.SS4.p3.5.m5.2.2.2" xref="S5.SS4.p3.5.m5.2.2.2.cmml"><msup id="S5.SS4.p3.5.m5.1.1.1.1" xref="S5.SS4.p3.5.m5.1.1.1.1.cmml"><mrow id="S5.SS4.p3.5.m5.1.1.1.1.1.1" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.cmml"><mo id="S5.SS4.p3.5.m5.1.1.1.1.1.1.2" stretchy="false" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.cmml"><msub id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.cmml"><mi id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.2" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.2.cmml">m</mi><mn id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.3" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.1" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.cmml"><mi id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.2" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.2.cmml">m</mi><mn id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.3" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S5.SS4.p3.5.m5.1.1.1.1.1.1.3" stretchy="false" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mfrac id="S5.SS4.p3.5.m5.1.1.1.1.3" xref="S5.SS4.p3.5.m5.1.1.1.1.3.cmml"><mn id="S5.SS4.p3.5.m5.1.1.1.1.3.2" xref="S5.SS4.p3.5.m5.1.1.1.1.3.2.cmml">3</mn><mn id="S5.SS4.p3.5.m5.1.1.1.1.3.3" xref="S5.SS4.p3.5.m5.1.1.1.1.3.3.cmml">5</mn></mfrac></msup><mo id="S5.SS4.p3.5.m5.2.2.2.3" xref="S5.SS4.p3.5.m5.2.2.2.3.cmml">/</mo><msup id="S5.SS4.p3.5.m5.2.2.2.2" xref="S5.SS4.p3.5.m5.2.2.2.2.cmml"><mrow id="S5.SS4.p3.5.m5.2.2.2.2.1.1" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.cmml"><mo id="S5.SS4.p3.5.m5.2.2.2.2.1.1.2" stretchy="false" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.cmml"><msub id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.cmml"><mi id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.2" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.2.cmml">m</mi><mn id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.3" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.1" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.1.cmml">+</mo><msub id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.cmml"><mi id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.2" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.2.cmml">m</mi><mn id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.3" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S5.SS4.p3.5.m5.2.2.2.2.1.1.3" stretchy="false" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.cmml">)</mo></mrow><mfrac id="S5.SS4.p3.5.m5.2.2.2.2.3" xref="S5.SS4.p3.5.m5.2.2.2.2.3.cmml"><mn id="S5.SS4.p3.5.m5.2.2.2.2.3.2" xref="S5.SS4.p3.5.m5.2.2.2.2.3.2.cmml">1</mn><mn id="S5.SS4.p3.5.m5.2.2.2.2.3.3" xref="S5.SS4.p3.5.m5.2.2.2.2.3.3.cmml">5</mn></mfrac></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.5.m5.2b"><apply id="S5.SS4.p3.5.m5.2.2.cmml" xref="S5.SS4.p3.5.m5.2.2"><equivalent id="S5.SS4.p3.5.m5.2.2.3.cmml" xref="S5.SS4.p3.5.m5.2.2.3"></equivalent><ci id="S5.SS4.p3.5.m5.2.2.4.cmml" xref="S5.SS4.p3.5.m5.2.2.4">ℳ</ci><apply id="S5.SS4.p3.5.m5.2.2.2.cmml" xref="S5.SS4.p3.5.m5.2.2.2"><divide id="S5.SS4.p3.5.m5.2.2.2.3.cmml" xref="S5.SS4.p3.5.m5.2.2.2.3"></divide><apply id="S5.SS4.p3.5.m5.1.1.1.1.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.5.m5.1.1.1.1.2.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1">superscript</csymbol><apply id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1"><times id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.1"></times><apply id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.1.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.2.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.2">𝑚</ci><cn id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.1.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.2.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.2">𝑚</ci><cn id="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S5.SS4.p3.5.m5.1.1.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="S5.SS4.p3.5.m5.1.1.1.1.3.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1.3"><divide id="S5.SS4.p3.5.m5.1.1.1.1.3.1.cmml" xref="S5.SS4.p3.5.m5.1.1.1.1.3"></divide><cn id="S5.SS4.p3.5.m5.1.1.1.1.3.2.cmml" type="integer" xref="S5.SS4.p3.5.m5.1.1.1.1.3.2">3</cn><cn id="S5.SS4.p3.5.m5.1.1.1.1.3.3.cmml" type="integer" xref="S5.SS4.p3.5.m5.1.1.1.1.3.3">5</cn></apply></apply><apply id="S5.SS4.p3.5.m5.2.2.2.2.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS4.p3.5.m5.2.2.2.2.2.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2">superscript</csymbol><apply id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1"><plus id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.1.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.1"></plus><apply id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.1.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.2.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.2">𝑚</ci><cn id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.3.cmml" type="integer" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.2.3">1</cn></apply><apply id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.1.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.2.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.2">𝑚</ci><cn id="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.3.cmml" type="integer" xref="S5.SS4.p3.5.m5.2.2.2.2.1.1.1.3.3">2</cn></apply></apply><apply id="S5.SS4.p3.5.m5.2.2.2.2.3.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2.3"><divide id="S5.SS4.p3.5.m5.2.2.2.2.3.1.cmml" xref="S5.SS4.p3.5.m5.2.2.2.2.3"></divide><cn id="S5.SS4.p3.5.m5.2.2.2.2.3.2.cmml" type="integer" xref="S5.SS4.p3.5.m5.2.2.2.2.3.2">1</cn><cn id="S5.SS4.p3.5.m5.2.2.2.2.3.3.cmml" type="integer" xref="S5.SS4.p3.5.m5.2.2.2.2.3.3">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.5.m5.2c">\mathcal{M}\equiv(m_{1}m_{2})^{\frac{3}{5}}/(m_{1}+m_{2})^{\frac{1}{5}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.5.m5.2d">caligraphic_M ≡ ( italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT divide start_ARG 3 end_ARG start_ARG 5 end_ARG end_POSTSUPERSCRIPT / ( italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG 5 end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="q\equiv m_{2}/m_{1}\leq 1" class="ltx_Math" display="inline" id="S5.SS4.p3.6.m6.1"><semantics id="S5.SS4.p3.6.m6.1a"><mrow id="S5.SS4.p3.6.m6.1.1" xref="S5.SS4.p3.6.m6.1.1.cmml"><mi id="S5.SS4.p3.6.m6.1.1.2" xref="S5.SS4.p3.6.m6.1.1.2.cmml">q</mi><mo id="S5.SS4.p3.6.m6.1.1.3" xref="S5.SS4.p3.6.m6.1.1.3.cmml">≡</mo><mrow id="S5.SS4.p3.6.m6.1.1.4" xref="S5.SS4.p3.6.m6.1.1.4.cmml"><msub id="S5.SS4.p3.6.m6.1.1.4.2" xref="S5.SS4.p3.6.m6.1.1.4.2.cmml"><mi id="S5.SS4.p3.6.m6.1.1.4.2.2" xref="S5.SS4.p3.6.m6.1.1.4.2.2.cmml">m</mi><mn id="S5.SS4.p3.6.m6.1.1.4.2.3" xref="S5.SS4.p3.6.m6.1.1.4.2.3.cmml">2</mn></msub><mo id="S5.SS4.p3.6.m6.1.1.4.1" xref="S5.SS4.p3.6.m6.1.1.4.1.cmml">/</mo><msub id="S5.SS4.p3.6.m6.1.1.4.3" xref="S5.SS4.p3.6.m6.1.1.4.3.cmml"><mi id="S5.SS4.p3.6.m6.1.1.4.3.2" xref="S5.SS4.p3.6.m6.1.1.4.3.2.cmml">m</mi><mn id="S5.SS4.p3.6.m6.1.1.4.3.3" xref="S5.SS4.p3.6.m6.1.1.4.3.3.cmml">1</mn></msub></mrow><mo id="S5.SS4.p3.6.m6.1.1.5" xref="S5.SS4.p3.6.m6.1.1.5.cmml">≤</mo><mn id="S5.SS4.p3.6.m6.1.1.6" xref="S5.SS4.p3.6.m6.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.6.m6.1b"><apply id="S5.SS4.p3.6.m6.1.1.cmml" xref="S5.SS4.p3.6.m6.1.1"><and id="S5.SS4.p3.6.m6.1.1a.cmml" xref="S5.SS4.p3.6.m6.1.1"></and><apply id="S5.SS4.p3.6.m6.1.1b.cmml" xref="S5.SS4.p3.6.m6.1.1"><equivalent id="S5.SS4.p3.6.m6.1.1.3.cmml" xref="S5.SS4.p3.6.m6.1.1.3"></equivalent><ci id="S5.SS4.p3.6.m6.1.1.2.cmml" xref="S5.SS4.p3.6.m6.1.1.2">𝑞</ci><apply id="S5.SS4.p3.6.m6.1.1.4.cmml" xref="S5.SS4.p3.6.m6.1.1.4"><divide id="S5.SS4.p3.6.m6.1.1.4.1.cmml" xref="S5.SS4.p3.6.m6.1.1.4.1"></divide><apply id="S5.SS4.p3.6.m6.1.1.4.2.cmml" xref="S5.SS4.p3.6.m6.1.1.4.2"><csymbol cd="ambiguous" id="S5.SS4.p3.6.m6.1.1.4.2.1.cmml" xref="S5.SS4.p3.6.m6.1.1.4.2">subscript</csymbol><ci id="S5.SS4.p3.6.m6.1.1.4.2.2.cmml" xref="S5.SS4.p3.6.m6.1.1.4.2.2">𝑚</ci><cn id="S5.SS4.p3.6.m6.1.1.4.2.3.cmml" type="integer" xref="S5.SS4.p3.6.m6.1.1.4.2.3">2</cn></apply><apply id="S5.SS4.p3.6.m6.1.1.4.3.cmml" xref="S5.SS4.p3.6.m6.1.1.4.3"><csymbol cd="ambiguous" id="S5.SS4.p3.6.m6.1.1.4.3.1.cmml" xref="S5.SS4.p3.6.m6.1.1.4.3">subscript</csymbol><ci id="S5.SS4.p3.6.m6.1.1.4.3.2.cmml" xref="S5.SS4.p3.6.m6.1.1.4.3.2">𝑚</ci><cn id="S5.SS4.p3.6.m6.1.1.4.3.3.cmml" type="integer" xref="S5.SS4.p3.6.m6.1.1.4.3.3">1</cn></apply></apply></apply><apply id="S5.SS4.p3.6.m6.1.1c.cmml" xref="S5.SS4.p3.6.m6.1.1"><leq id="S5.SS4.p3.6.m6.1.1.5.cmml" xref="S5.SS4.p3.6.m6.1.1.5"></leq><share href="#S5.SS4.p3.6.m6.1.1.4.cmml" id="S5.SS4.p3.6.m6.1.1d.cmml" xref="S5.SS4.p3.6.m6.1.1"></share><cn id="S5.SS4.p3.6.m6.1.1.6.cmml" type="integer" xref="S5.SS4.p3.6.m6.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.6.m6.1c">q\equiv m_{2}/m_{1}\leq 1</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.6.m6.1d">italic_q ≡ italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT / italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ 1</annotation></semantics></math> – and spin characteristics <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx133" title="">Racine(2008)</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S5.SS4.p4">
<p class="ltx_p" id="S5.SS4.p4.4">We established baseline values for our simulated event <math alttext="\bm{x_{0}}" class="ltx_Math" display="inline" id="S5.SS4.p4.1.m1.1"><semantics id="S5.SS4.p4.1.m1.1a"><msub id="S5.SS4.p4.1.m1.1.1" xref="S5.SS4.p4.1.m1.1.1.cmml"><mi id="S5.SS4.p4.1.m1.1.1.2" xref="S5.SS4.p4.1.m1.1.1.2.cmml">𝒙</mi><mn id="S5.SS4.p4.1.m1.1.1.3" xref="S5.SS4.p4.1.m1.1.1.3.cmml">𝟎</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.1.m1.1b"><apply id="S5.SS4.p4.1.m1.1.1.cmml" xref="S5.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.1.m1.1.1.1.cmml" xref="S5.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S5.SS4.p4.1.m1.1.1.2.cmml" xref="S5.SS4.p4.1.m1.1.1.2">𝒙</ci><cn id="S5.SS4.p4.1.m1.1.1.3.cmml" type="integer" xref="S5.SS4.p4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.1.m1.1c">\bm{x_{0}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT bold_0 end_POSTSUBSCRIPT</annotation></semantics></math> at {<math alttext="d_{L}=390\ \textrm{Mpc},q=0.79,\mathcal{M}=30.2\ M_{\odot},\chi_{\textrm{eff}}%
=-0.09" class="ltx_Math" display="inline" id="S5.SS4.p4.2.m2.2"><semantics id="S5.SS4.p4.2.m2.2a"><mrow id="S5.SS4.p4.2.m2.2.2.2" xref="S5.SS4.p4.2.m2.2.2.3.cmml"><mrow id="S5.SS4.p4.2.m2.1.1.1.1" xref="S5.SS4.p4.2.m2.1.1.1.1.cmml"><msub id="S5.SS4.p4.2.m2.1.1.1.1.2" xref="S5.SS4.p4.2.m2.1.1.1.1.2.cmml"><mi id="S5.SS4.p4.2.m2.1.1.1.1.2.2" xref="S5.SS4.p4.2.m2.1.1.1.1.2.2.cmml">d</mi><mi id="S5.SS4.p4.2.m2.1.1.1.1.2.3" xref="S5.SS4.p4.2.m2.1.1.1.1.2.3.cmml">L</mi></msub><mo id="S5.SS4.p4.2.m2.1.1.1.1.1" xref="S5.SS4.p4.2.m2.1.1.1.1.1.cmml">=</mo><mrow id="S5.SS4.p4.2.m2.1.1.1.1.3" xref="S5.SS4.p4.2.m2.1.1.1.1.3.cmml"><mn id="S5.SS4.p4.2.m2.1.1.1.1.3.2" xref="S5.SS4.p4.2.m2.1.1.1.1.3.2.cmml">390</mn><mo id="S5.SS4.p4.2.m2.1.1.1.1.3.1" lspace="0.500em" xref="S5.SS4.p4.2.m2.1.1.1.1.3.1.cmml">⁢</mo><mtext id="S5.SS4.p4.2.m2.1.1.1.1.3.3" xref="S5.SS4.p4.2.m2.1.1.1.1.3.3a.cmml">Mpc</mtext></mrow></mrow><mo id="S5.SS4.p4.2.m2.2.2.2.3" xref="S5.SS4.p4.2.m2.2.2.3a.cmml">,</mo><mrow id="S5.SS4.p4.2.m2.2.2.2.2.2" xref="S5.SS4.p4.2.m2.2.2.2.2.3.cmml"><mrow id="S5.SS4.p4.2.m2.2.2.2.2.1.1" xref="S5.SS4.p4.2.m2.2.2.2.2.1.1.cmml"><mi id="S5.SS4.p4.2.m2.2.2.2.2.1.1.2" xref="S5.SS4.p4.2.m2.2.2.2.2.1.1.2.cmml">q</mi><mo id="S5.SS4.p4.2.m2.2.2.2.2.1.1.1" xref="S5.SS4.p4.2.m2.2.2.2.2.1.1.1.cmml">=</mo><mn id="S5.SS4.p4.2.m2.2.2.2.2.1.1.3" xref="S5.SS4.p4.2.m2.2.2.2.2.1.1.3.cmml">0.79</mn></mrow><mo id="S5.SS4.p4.2.m2.2.2.2.2.2.3" xref="S5.SS4.p4.2.m2.2.2.2.2.3a.cmml">,</mo><mrow id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.3.cmml"><mrow id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.2" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.2.cmml">ℳ</mi><mo id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.1" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.1.cmml">=</mo><mrow id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.cmml"><mn id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.2" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.2.cmml">30.2</mn><mo id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.1" lspace="0.500em" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.1.cmml">⁢</mo><msub id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.cmml"><mi id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.2" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.2.cmml">M</mi><mo id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.3" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.3.cmml">⊙</mo></msub></mrow></mrow><mo id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.3" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.cmml"><msub id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.cmml"><mi id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.2" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.2.cmml">χ</mi><mtext id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.3" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.3a.cmml">eff</mtext></msub><mo id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.1" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.1.cmml">=</mo><mrow id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3.cmml"><mo id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3a" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3.cmml">−</mo><mn id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3.2" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3.2.cmml">0.09</mn></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.2.m2.2b"><apply id="S5.SS4.p4.2.m2.2.2.3.cmml" xref="S5.SS4.p4.2.m2.2.2.2"><csymbol cd="ambiguous" id="S5.SS4.p4.2.m2.2.2.3a.cmml" xref="S5.SS4.p4.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS4.p4.2.m2.1.1.1.1.cmml" xref="S5.SS4.p4.2.m2.1.1.1.1"><eq id="S5.SS4.p4.2.m2.1.1.1.1.1.cmml" xref="S5.SS4.p4.2.m2.1.1.1.1.1"></eq><apply id="S5.SS4.p4.2.m2.1.1.1.1.2.cmml" xref="S5.SS4.p4.2.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p4.2.m2.1.1.1.1.2.1.cmml" xref="S5.SS4.p4.2.m2.1.1.1.1.2">subscript</csymbol><ci id="S5.SS4.p4.2.m2.1.1.1.1.2.2.cmml" xref="S5.SS4.p4.2.m2.1.1.1.1.2.2">𝑑</ci><ci id="S5.SS4.p4.2.m2.1.1.1.1.2.3.cmml" xref="S5.SS4.p4.2.m2.1.1.1.1.2.3">𝐿</ci></apply><apply id="S5.SS4.p4.2.m2.1.1.1.1.3.cmml" xref="S5.SS4.p4.2.m2.1.1.1.1.3"><times id="S5.SS4.p4.2.m2.1.1.1.1.3.1.cmml" xref="S5.SS4.p4.2.m2.1.1.1.1.3.1"></times><cn id="S5.SS4.p4.2.m2.1.1.1.1.3.2.cmml" type="integer" xref="S5.SS4.p4.2.m2.1.1.1.1.3.2">390</cn><ci id="S5.SS4.p4.2.m2.1.1.1.1.3.3a.cmml" xref="S5.SS4.p4.2.m2.1.1.1.1.3.3"><mtext id="S5.SS4.p4.2.m2.1.1.1.1.3.3.cmml" xref="S5.SS4.p4.2.m2.1.1.1.1.3.3">Mpc</mtext></ci></apply></apply><apply id="S5.SS4.p4.2.m2.2.2.2.2.3.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS4.p4.2.m2.2.2.2.2.3a.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS4.p4.2.m2.2.2.2.2.1.1.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.1.1"><eq id="S5.SS4.p4.2.m2.2.2.2.2.1.1.1.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.1.1.1"></eq><ci id="S5.SS4.p4.2.m2.2.2.2.2.1.1.2.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.1.1.2">𝑞</ci><cn id="S5.SS4.p4.2.m2.2.2.2.2.1.1.3.cmml" type="float" xref="S5.SS4.p4.2.m2.2.2.2.2.1.1.3">0.79</cn></apply><apply id="S5.SS4.p4.2.m2.2.2.2.2.2.2.3.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS4.p4.2.m2.2.2.2.2.2.2.3a.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1"><eq id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.1.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.1"></eq><ci id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.2.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.2">ℳ</ci><apply id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3"><times id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.1.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.1"></times><cn id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.2.cmml" type="float" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.2">30.2</cn><apply id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.1.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.2.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.2">𝑀</ci><csymbol cd="latexml" id="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.3.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.1.1.3.3.3">direct-product</csymbol></apply></apply></apply><apply id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2"><eq id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.1.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.1"></eq><apply id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.2">𝜒</ci><ci id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.3a.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.3"><mtext id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.2.3">eff</mtext></ci></apply><apply id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3"><minus id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3.1.cmml" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3"></minus><cn id="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3.2.cmml" type="float" xref="S5.SS4.p4.2.m2.2.2.2.2.2.2.2.2.3.2">0.09</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.2.m2.2c">d_{L}=390\ \textrm{Mpc},q=0.79,\mathcal{M}=30.2\ M_{\odot},\chi_{\textrm{eff}}%
=-0.09</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.2.m2.2d">italic_d start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT = 390 Mpc , italic_q = 0.79 , caligraphic_M = 30.2 italic_M start_POSTSUBSCRIPT ⊙ end_POSTSUBSCRIPT , italic_χ start_POSTSUBSCRIPT eff end_POSTSUBSCRIPT = - 0.09</annotation></semantics></math>)}, akin to the GW150914 event as detailed in the first column of Table 1 by <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx134" title="">Abbott <em class="ltx_emph ltx_font_italic">et al.</em>(2016)Abbott <em class="ltx_emph ltx_font_italic">et al.</em></a></cite>. Following the procedure described in <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx135" title="">Karathanasis <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Karathanasis, Revenu, Mukherjee, and Stachurski</a></cite>, the defined priors are uniform ranging from [<math alttext="100.0\textrm{ Mpc},0.2,12.0\,M_{\odot},-1.0" class="ltx_Math" display="inline" id="S5.SS4.p4.3.m3.4"><semantics id="S5.SS4.p4.3.m3.4a"><mrow id="S5.SS4.p4.3.m3.4.4.3" xref="S5.SS4.p4.3.m3.4.4.4.cmml"><mrow id="S5.SS4.p4.3.m3.2.2.1.1" xref="S5.SS4.p4.3.m3.2.2.1.1.cmml"><mn id="S5.SS4.p4.3.m3.2.2.1.1.2" xref="S5.SS4.p4.3.m3.2.2.1.1.2.cmml">100.0</mn><mo id="S5.SS4.p4.3.m3.2.2.1.1.1" xref="S5.SS4.p4.3.m3.2.2.1.1.1.cmml">⁢</mo><mtext id="S5.SS4.p4.3.m3.2.2.1.1.3" xref="S5.SS4.p4.3.m3.2.2.1.1.3a.cmml"> Mpc</mtext></mrow><mo id="S5.SS4.p4.3.m3.4.4.3.4" xref="S5.SS4.p4.3.m3.4.4.4.cmml">,</mo><mn id="S5.SS4.p4.3.m3.1.1" xref="S5.SS4.p4.3.m3.1.1.cmml">0.2</mn><mo id="S5.SS4.p4.3.m3.4.4.3.5" xref="S5.SS4.p4.3.m3.4.4.4.cmml">,</mo><mrow id="S5.SS4.p4.3.m3.3.3.2.2" xref="S5.SS4.p4.3.m3.3.3.2.2.cmml"><mn id="S5.SS4.p4.3.m3.3.3.2.2.2" xref="S5.SS4.p4.3.m3.3.3.2.2.2.cmml">12.0</mn><mo id="S5.SS4.p4.3.m3.3.3.2.2.1" lspace="0.170em" xref="S5.SS4.p4.3.m3.3.3.2.2.1.cmml">⁢</mo><msub id="S5.SS4.p4.3.m3.3.3.2.2.3" xref="S5.SS4.p4.3.m3.3.3.2.2.3.cmml"><mi id="S5.SS4.p4.3.m3.3.3.2.2.3.2" xref="S5.SS4.p4.3.m3.3.3.2.2.3.2.cmml">M</mi><mo id="S5.SS4.p4.3.m3.3.3.2.2.3.3" xref="S5.SS4.p4.3.m3.3.3.2.2.3.3.cmml">⊙</mo></msub></mrow><mo id="S5.SS4.p4.3.m3.4.4.3.6" xref="S5.SS4.p4.3.m3.4.4.4.cmml">,</mo><mrow id="S5.SS4.p4.3.m3.4.4.3.3" xref="S5.SS4.p4.3.m3.4.4.3.3.cmml"><mo id="S5.SS4.p4.3.m3.4.4.3.3a" xref="S5.SS4.p4.3.m3.4.4.3.3.cmml">−</mo><mn id="S5.SS4.p4.3.m3.4.4.3.3.2" xref="S5.SS4.p4.3.m3.4.4.3.3.2.cmml">1.0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.3.m3.4b"><list id="S5.SS4.p4.3.m3.4.4.4.cmml" xref="S5.SS4.p4.3.m3.4.4.3"><apply id="S5.SS4.p4.3.m3.2.2.1.1.cmml" xref="S5.SS4.p4.3.m3.2.2.1.1"><times id="S5.SS4.p4.3.m3.2.2.1.1.1.cmml" xref="S5.SS4.p4.3.m3.2.2.1.1.1"></times><cn id="S5.SS4.p4.3.m3.2.2.1.1.2.cmml" type="float" xref="S5.SS4.p4.3.m3.2.2.1.1.2">100.0</cn><ci id="S5.SS4.p4.3.m3.2.2.1.1.3a.cmml" xref="S5.SS4.p4.3.m3.2.2.1.1.3"><mtext id="S5.SS4.p4.3.m3.2.2.1.1.3.cmml" xref="S5.SS4.p4.3.m3.2.2.1.1.3"> Mpc</mtext></ci></apply><cn id="S5.SS4.p4.3.m3.1.1.cmml" type="float" xref="S5.SS4.p4.3.m3.1.1">0.2</cn><apply id="S5.SS4.p4.3.m3.3.3.2.2.cmml" xref="S5.SS4.p4.3.m3.3.3.2.2"><times id="S5.SS4.p4.3.m3.3.3.2.2.1.cmml" xref="S5.SS4.p4.3.m3.3.3.2.2.1"></times><cn id="S5.SS4.p4.3.m3.3.3.2.2.2.cmml" type="float" xref="S5.SS4.p4.3.m3.3.3.2.2.2">12.0</cn><apply id="S5.SS4.p4.3.m3.3.3.2.2.3.cmml" xref="S5.SS4.p4.3.m3.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.SS4.p4.3.m3.3.3.2.2.3.1.cmml" xref="S5.SS4.p4.3.m3.3.3.2.2.3">subscript</csymbol><ci id="S5.SS4.p4.3.m3.3.3.2.2.3.2.cmml" xref="S5.SS4.p4.3.m3.3.3.2.2.3.2">𝑀</ci><csymbol cd="latexml" id="S5.SS4.p4.3.m3.3.3.2.2.3.3.cmml" xref="S5.SS4.p4.3.m3.3.3.2.2.3.3">direct-product</csymbol></apply></apply><apply id="S5.SS4.p4.3.m3.4.4.3.3.cmml" xref="S5.SS4.p4.3.m3.4.4.3.3"><minus id="S5.SS4.p4.3.m3.4.4.3.3.1.cmml" xref="S5.SS4.p4.3.m3.4.4.3.3"></minus><cn id="S5.SS4.p4.3.m3.4.4.3.3.2.cmml" type="float" xref="S5.SS4.p4.3.m3.4.4.3.3.2">1.0</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.3.m3.4c">100.0\textrm{ Mpc},0.2,12.0\,M_{\odot},-1.0</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.3.m3.4d">100.0 Mpc , 0.2 , 12.0 italic_M start_POSTSUBSCRIPT ⊙ end_POSTSUBSCRIPT , - 1.0</annotation></semantics></math>] to [<math alttext="1000.0\textrm{ Mpc},1.0,45.0\,M_{\odot},1.0" class="ltx_Math" display="inline" id="S5.SS4.p4.4.m4.4"><semantics id="S5.SS4.p4.4.m4.4a"><mrow id="S5.SS4.p4.4.m4.4.4.2" xref="S5.SS4.p4.4.m4.4.4.3.cmml"><mrow id="S5.SS4.p4.4.m4.3.3.1.1" xref="S5.SS4.p4.4.m4.3.3.1.1.cmml"><mn id="S5.SS4.p4.4.m4.3.3.1.1.2" xref="S5.SS4.p4.4.m4.3.3.1.1.2.cmml">1000.0</mn><mo id="S5.SS4.p4.4.m4.3.3.1.1.1" xref="S5.SS4.p4.4.m4.3.3.1.1.1.cmml">⁢</mo><mtext id="S5.SS4.p4.4.m4.3.3.1.1.3" xref="S5.SS4.p4.4.m4.3.3.1.1.3a.cmml"> Mpc</mtext></mrow><mo id="S5.SS4.p4.4.m4.4.4.2.3" xref="S5.SS4.p4.4.m4.4.4.3.cmml">,</mo><mn id="S5.SS4.p4.4.m4.1.1" xref="S5.SS4.p4.4.m4.1.1.cmml">1.0</mn><mo id="S5.SS4.p4.4.m4.4.4.2.4" xref="S5.SS4.p4.4.m4.4.4.3.cmml">,</mo><mrow id="S5.SS4.p4.4.m4.4.4.2.2" xref="S5.SS4.p4.4.m4.4.4.2.2.cmml"><mn id="S5.SS4.p4.4.m4.4.4.2.2.2" xref="S5.SS4.p4.4.m4.4.4.2.2.2.cmml">45.0</mn><mo id="S5.SS4.p4.4.m4.4.4.2.2.1" lspace="0.170em" xref="S5.SS4.p4.4.m4.4.4.2.2.1.cmml">⁢</mo><msub id="S5.SS4.p4.4.m4.4.4.2.2.3" xref="S5.SS4.p4.4.m4.4.4.2.2.3.cmml"><mi id="S5.SS4.p4.4.m4.4.4.2.2.3.2" xref="S5.SS4.p4.4.m4.4.4.2.2.3.2.cmml">M</mi><mo id="S5.SS4.p4.4.m4.4.4.2.2.3.3" xref="S5.SS4.p4.4.m4.4.4.2.2.3.3.cmml">⊙</mo></msub></mrow><mo id="S5.SS4.p4.4.m4.4.4.2.5" xref="S5.SS4.p4.4.m4.4.4.3.cmml">,</mo><mn id="S5.SS4.p4.4.m4.2.2" xref="S5.SS4.p4.4.m4.2.2.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.4.m4.4b"><list id="S5.SS4.p4.4.m4.4.4.3.cmml" xref="S5.SS4.p4.4.m4.4.4.2"><apply id="S5.SS4.p4.4.m4.3.3.1.1.cmml" xref="S5.SS4.p4.4.m4.3.3.1.1"><times id="S5.SS4.p4.4.m4.3.3.1.1.1.cmml" xref="S5.SS4.p4.4.m4.3.3.1.1.1"></times><cn id="S5.SS4.p4.4.m4.3.3.1.1.2.cmml" type="float" xref="S5.SS4.p4.4.m4.3.3.1.1.2">1000.0</cn><ci id="S5.SS4.p4.4.m4.3.3.1.1.3a.cmml" xref="S5.SS4.p4.4.m4.3.3.1.1.3"><mtext id="S5.SS4.p4.4.m4.3.3.1.1.3.cmml" xref="S5.SS4.p4.4.m4.3.3.1.1.3"> Mpc</mtext></ci></apply><cn id="S5.SS4.p4.4.m4.1.1.cmml" type="float" xref="S5.SS4.p4.4.m4.1.1">1.0</cn><apply id="S5.SS4.p4.4.m4.4.4.2.2.cmml" xref="S5.SS4.p4.4.m4.4.4.2.2"><times id="S5.SS4.p4.4.m4.4.4.2.2.1.cmml" xref="S5.SS4.p4.4.m4.4.4.2.2.1"></times><cn id="S5.SS4.p4.4.m4.4.4.2.2.2.cmml" type="float" xref="S5.SS4.p4.4.m4.4.4.2.2.2">45.0</cn><apply id="S5.SS4.p4.4.m4.4.4.2.2.3.cmml" xref="S5.SS4.p4.4.m4.4.4.2.2.3"><csymbol cd="ambiguous" id="S5.SS4.p4.4.m4.4.4.2.2.3.1.cmml" xref="S5.SS4.p4.4.m4.4.4.2.2.3">subscript</csymbol><ci id="S5.SS4.p4.4.m4.4.4.2.2.3.2.cmml" xref="S5.SS4.p4.4.m4.4.4.2.2.3.2">𝑀</ci><csymbol cd="latexml" id="S5.SS4.p4.4.m4.4.4.2.2.3.3.cmml" xref="S5.SS4.p4.4.m4.4.4.2.2.3.3">direct-product</csymbol></apply></apply><cn id="S5.SS4.p4.4.m4.2.2.cmml" type="float" xref="S5.SS4.p4.4.m4.2.2">1.0</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.4.m4.4c">1000.0\textrm{ Mpc},1.0,45.0\,M_{\odot},1.0</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.4.m4.4d">1000.0 Mpc , 1.0 , 45.0 italic_M start_POSTSUBSCRIPT ⊙ end_POSTSUBSCRIPT , 1.0</annotation></semantics></math>], with narrower margins for chirp mass and luminosity distance to facilitate a straightforward example. For density estimation, we utilize the <span class="ltx_text ltx_font_typewriter" id="S5.SS4.p4.4.1">sbi</span> backend with a MAF and a 1D convolutional embedding network, undergoing five rounds of training with 1000 simulations per round.</p>
</div>
<div class="ltx_para" id="S5.SS4.p5">
<p class="ltx_p" id="S5.SS4.p5.2">Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F8.sf2" title="8b ‣ Figure 8 ‣ 5.4 Multi-round Inference for Gravitational Waves ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">8b</span></a> illustrates the progression of the cumulative posterior probability, as defined in Equation <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.E4" title="4 ‣ 2.2.1 Neural Posterior Estimation (NPE) ‣ 2.2 Neural Density Estimation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">4</span></a>, as a function of training time. The noticeable increase in probability mass for both training and validation datasets is attributed to the model’s focus on learning the posterior density near the target observation <math alttext="\mathcal{P}(\bm{\theta}|\bm{x}=\bm{x}_{0})" class="ltx_Math" display="inline" id="S5.SS4.p5.1.m1.1"><semantics id="S5.SS4.p5.1.m1.1a"><mrow id="S5.SS4.p5.1.m1.1.1" xref="S5.SS4.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p5.1.m1.1.1.3" xref="S5.SS4.p5.1.m1.1.1.3.cmml">𝒫</mi><mo id="S5.SS4.p5.1.m1.1.1.2" xref="S5.SS4.p5.1.m1.1.1.2.cmml">⁢</mo><mrow id="S5.SS4.p5.1.m1.1.1.1.1" xref="S5.SS4.p5.1.m1.1.1.1.1.1.cmml"><mo id="S5.SS4.p5.1.m1.1.1.1.1.2" stretchy="false" xref="S5.SS4.p5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS4.p5.1.m1.1.1.1.1.1" xref="S5.SS4.p5.1.m1.1.1.1.1.1.cmml"><mrow id="S5.SS4.p5.1.m1.1.1.1.1.1.2" xref="S5.SS4.p5.1.m1.1.1.1.1.1.2.cmml"><mi id="S5.SS4.p5.1.m1.1.1.1.1.1.2.2" xref="S5.SS4.p5.1.m1.1.1.1.1.1.2.2.cmml">𝜽</mi><mo fence="false" id="S5.SS4.p5.1.m1.1.1.1.1.1.2.1" xref="S5.SS4.p5.1.m1.1.1.1.1.1.2.1.cmml">|</mo><mi id="S5.SS4.p5.1.m1.1.1.1.1.1.2.3" xref="S5.SS4.p5.1.m1.1.1.1.1.1.2.3.cmml">𝒙</mi></mrow><mo id="S5.SS4.p5.1.m1.1.1.1.1.1.1" xref="S5.SS4.p5.1.m1.1.1.1.1.1.1.cmml">=</mo><msub id="S5.SS4.p5.1.m1.1.1.1.1.1.3" xref="S5.SS4.p5.1.m1.1.1.1.1.1.3.cmml"><mi id="S5.SS4.p5.1.m1.1.1.1.1.1.3.2" xref="S5.SS4.p5.1.m1.1.1.1.1.1.3.2.cmml">𝒙</mi><mn id="S5.SS4.p5.1.m1.1.1.1.1.1.3.3" xref="S5.SS4.p5.1.m1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S5.SS4.p5.1.m1.1.1.1.1.3" stretchy="false" xref="S5.SS4.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p5.1.m1.1b"><apply id="S5.SS4.p5.1.m1.1.1.cmml" xref="S5.SS4.p5.1.m1.1.1"><times id="S5.SS4.p5.1.m1.1.1.2.cmml" xref="S5.SS4.p5.1.m1.1.1.2"></times><ci id="S5.SS4.p5.1.m1.1.1.3.cmml" xref="S5.SS4.p5.1.m1.1.1.3">𝒫</ci><apply id="S5.SS4.p5.1.m1.1.1.1.1.1.cmml" xref="S5.SS4.p5.1.m1.1.1.1.1"><eq id="S5.SS4.p5.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS4.p5.1.m1.1.1.1.1.1.1"></eq><apply id="S5.SS4.p5.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS4.p5.1.m1.1.1.1.1.1.2"><csymbol cd="latexml" id="S5.SS4.p5.1.m1.1.1.1.1.1.2.1.cmml" xref="S5.SS4.p5.1.m1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S5.SS4.p5.1.m1.1.1.1.1.1.2.2.cmml" xref="S5.SS4.p5.1.m1.1.1.1.1.1.2.2">𝜽</ci><ci id="S5.SS4.p5.1.m1.1.1.1.1.1.2.3.cmml" xref="S5.SS4.p5.1.m1.1.1.1.1.1.2.3">𝒙</ci></apply><apply id="S5.SS4.p5.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS4.p5.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.p5.1.m1.1.1.1.1.1.3.1.cmml" xref="S5.SS4.p5.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS4.p5.1.m1.1.1.1.1.1.3.2.cmml" xref="S5.SS4.p5.1.m1.1.1.1.1.1.3.2">𝒙</ci><cn id="S5.SS4.p5.1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="S5.SS4.p5.1.m1.1.1.1.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p5.1.m1.1c">\mathcal{P}(\bm{\theta}|\bm{x}=\bm{x}_{0})</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p5.1.m1.1d">caligraphic_P ( bold_italic_θ | bold_italic_x = bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>. However, an early increase in validation loss during subsequent rounds suggests the potential for overfitting, indicating the model’s limitations in gleaning further insights from the simulation inputs. Sampling the posterior at <math alttext="\bm{x}=\bm{x_{0}}" class="ltx_Math" display="inline" id="S5.SS4.p5.2.m2.1"><semantics id="S5.SS4.p5.2.m2.1a"><mrow id="S5.SS4.p5.2.m2.1.1" xref="S5.SS4.p5.2.m2.1.1.cmml"><mi id="S5.SS4.p5.2.m2.1.1.2" xref="S5.SS4.p5.2.m2.1.1.2.cmml">𝒙</mi><mo id="S5.SS4.p5.2.m2.1.1.1" xref="S5.SS4.p5.2.m2.1.1.1.cmml">=</mo><msub id="S5.SS4.p5.2.m2.1.1.3" xref="S5.SS4.p5.2.m2.1.1.3.cmml"><mi id="S5.SS4.p5.2.m2.1.1.3.2" xref="S5.SS4.p5.2.m2.1.1.3.2.cmml">𝒙</mi><mn id="S5.SS4.p5.2.m2.1.1.3.3" xref="S5.SS4.p5.2.m2.1.1.3.3.cmml">𝟎</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p5.2.m2.1b"><apply id="S5.SS4.p5.2.m2.1.1.cmml" xref="S5.SS4.p5.2.m2.1.1"><eq id="S5.SS4.p5.2.m2.1.1.1.cmml" xref="S5.SS4.p5.2.m2.1.1.1"></eq><ci id="S5.SS4.p5.2.m2.1.1.2.cmml" xref="S5.SS4.p5.2.m2.1.1.2">𝒙</ci><apply id="S5.SS4.p5.2.m2.1.1.3.cmml" xref="S5.SS4.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.p5.2.m2.1.1.3.1.cmml" xref="S5.SS4.p5.2.m2.1.1.3">subscript</csymbol><ci id="S5.SS4.p5.2.m2.1.1.3.2.cmml" xref="S5.SS4.p5.2.m2.1.1.3.2">𝒙</ci><cn id="S5.SS4.p5.2.m2.1.1.3.3.cmml" type="integer" xref="S5.SS4.p5.2.m2.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p5.2.m2.1c">\bm{x}=\bm{x_{0}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p5.2.m2.1d">bold_italic_x = bold_italic_x start_POSTSUBSCRIPT bold_0 end_POSTSUBSCRIPT</annotation></semantics></math> depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F8.sf3" title="8c ‣ Figure 8 ‣ 5.4 Multi-round Inference for Gravitational Waves ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">8c</span></a>, reveals that we are able to constrain each of the four parameters around the fiducial point.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Inferring Dust Parameters</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">Dust makes up approximately 1% of the interstellar medium, but reprocesses around 30% of stellar emission <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx136" title="">Silva <em class="ltx_emph ltx_font_italic">et al.</em>(1998)Silva, Granato, Bressan, and Danese</a>)</cite>.
Understanding the properties of dust and its impact on observables is, therefore, a key goal of galactic and extragalactic astronomy, and a fundamental uncertainty in downstream cosmological inference analyses.
Dust leads to an overall reddening of the emission, parametrized by the optical depth and attenuation law; these are analogous to the normalization and slope, particularly where the latter is parametrized as a power law.
Below we show how these parameters can be inferred from observational properties using a simple dust model <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx137" title="">Trayford <em class="ltx_emph ltx_font_italic">et al.</em>(2015)Trayford, Theuns, Bower, Schaye, Furlong, Schaller, Frenk, Crain, Vecchia, and McCarthy</a>)</cite> applied to the Simba cosmological hydrodynamic simulation <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx138" title="">Davé <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Davé, Anglés-Alcázar, Narayanan, Li, Rafieferantsoa, and Appleby</a>)</cite> within an SBI framework.
</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.2">We first briefly describe our forward model for the stellar emission and dust attenuation.
We generated spectra for all galaxies with stellar mass <math alttext="&gt;10^{10}\;\mathrm{M_{\odot}}" class="ltx_Math" display="inline" id="S5.SS5.p2.1.m1.1"><semantics id="S5.SS5.p2.1.m1.1a"><mrow id="S5.SS5.p2.1.m1.1.1" xref="S5.SS5.p2.1.m1.1.1.cmml"><mi id="S5.SS5.p2.1.m1.1.1.2" xref="S5.SS5.p2.1.m1.1.1.2.cmml"></mi><mo id="S5.SS5.p2.1.m1.1.1.1" xref="S5.SS5.p2.1.m1.1.1.1.cmml">&gt;</mo><mrow id="S5.SS5.p2.1.m1.1.1.3" xref="S5.SS5.p2.1.m1.1.1.3.cmml"><msup id="S5.SS5.p2.1.m1.1.1.3.2" xref="S5.SS5.p2.1.m1.1.1.3.2.cmml"><mn id="S5.SS5.p2.1.m1.1.1.3.2.2" xref="S5.SS5.p2.1.m1.1.1.3.2.2.cmml">10</mn><mn id="S5.SS5.p2.1.m1.1.1.3.2.3" xref="S5.SS5.p2.1.m1.1.1.3.2.3.cmml">10</mn></msup><mo id="S5.SS5.p2.1.m1.1.1.3.1" xref="S5.SS5.p2.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S5.SS5.p2.1.m1.1.1.3.3" xref="S5.SS5.p2.1.m1.1.1.3.3.cmml"><mi id="S5.SS5.p2.1.m1.1.1.3.3.2" mathvariant="normal" xref="S5.SS5.p2.1.m1.1.1.3.3.2.cmml">M</mi><mo id="S5.SS5.p2.1.m1.1.1.3.3.3" xref="S5.SS5.p2.1.m1.1.1.3.3.3.cmml">⊙</mo></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.1.m1.1b"><apply id="S5.SS5.p2.1.m1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1"><gt id="S5.SS5.p2.1.m1.1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S5.SS5.p2.1.m1.1.1.2.cmml" xref="S5.SS5.p2.1.m1.1.1.2">absent</csymbol><apply id="S5.SS5.p2.1.m1.1.1.3.cmml" xref="S5.SS5.p2.1.m1.1.1.3"><times id="S5.SS5.p2.1.m1.1.1.3.1.cmml" xref="S5.SS5.p2.1.m1.1.1.3.1"></times><apply id="S5.SS5.p2.1.m1.1.1.3.2.cmml" xref="S5.SS5.p2.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.SS5.p2.1.m1.1.1.3.2.1.cmml" xref="S5.SS5.p2.1.m1.1.1.3.2">superscript</csymbol><cn id="S5.SS5.p2.1.m1.1.1.3.2.2.cmml" type="integer" xref="S5.SS5.p2.1.m1.1.1.3.2.2">10</cn><cn id="S5.SS5.p2.1.m1.1.1.3.2.3.cmml" type="integer" xref="S5.SS5.p2.1.m1.1.1.3.2.3">10</cn></apply><apply id="S5.SS5.p2.1.m1.1.1.3.3.cmml" xref="S5.SS5.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS5.p2.1.m1.1.1.3.3.1.cmml" xref="S5.SS5.p2.1.m1.1.1.3.3">subscript</csymbol><ci id="S5.SS5.p2.1.m1.1.1.3.3.2.cmml" xref="S5.SS5.p2.1.m1.1.1.3.3.2">M</ci><csymbol cd="latexml" id="S5.SS5.p2.1.m1.1.1.3.3.3.cmml" xref="S5.SS5.p2.1.m1.1.1.3.3.3">direct-product</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.1.m1.1c">&gt;10^{10}\;\mathrm{M_{\odot}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.1.m1.1d">&gt; 10 start_POSTSUPERSCRIPT 10 end_POSTSUPERSCRIPT roman_M start_POSTSUBSCRIPT ⊙ end_POSTSUBSCRIPT</annotation></semantics></math> in the Simba simulation using <span class="ltx_text ltx_font_typewriter" id="S5.SS5.p2.2.1">Synthesizer</span> (Lovell et al. <span class="ltx_text ltx_font_italic" id="S5.SS5.p2.2.2">in prep.</span>)<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://flaresimulations.github.io/synthesizer" title="">https://flaresimulations.github.io/synthesizer</a></span></span></span>.
The integrated intrinsic stellar emission of each galaxy was obtained by linking each stellar particle to the BC03 stellar population synthesis models <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx139" title="">Bruzual and Charlot(2003)</a>)</cite> based on their age and metallicity.
We then modelled the dust attenuation as a wavelength-dependent power law, with slope <math alttext="\alpha" class="ltx_Math" display="inline" id="S5.SS5.p2.2.m2.1"><semantics id="S5.SS5.p2.2.m2.1a"><mi id="S5.SS5.p2.2.m2.1.1" xref="S5.SS5.p2.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.2.m2.1b"><ci id="S5.SS5.p2.2.m2.1.1.cmml" xref="S5.SS5.p2.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.2.m2.1d">italic_α</annotation></semantics></math>,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx1">
<tbody id="S5.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle T(\lambda,t)=\mathrm{exp}\left[\tau(t)\left(\frac{\lambda}{%
\lambda_{\mathrm{V}}}\right)^{-\alpha}\right]\;\;," class="ltx_Math" display="inline" id="S5.E15.m1.5"><semantics id="S5.E15.m1.5a"><mrow id="S5.E15.m1.5.5.1" xref="S5.E15.m1.5.5.1.1.cmml"><mrow id="S5.E15.m1.5.5.1.1" xref="S5.E15.m1.5.5.1.1.cmml"><mrow id="S5.E15.m1.5.5.1.1.3" xref="S5.E15.m1.5.5.1.1.3.cmml"><mi id="S5.E15.m1.5.5.1.1.3.2" xref="S5.E15.m1.5.5.1.1.3.2.cmml">T</mi><mo id="S5.E15.m1.5.5.1.1.3.1" xref="S5.E15.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S5.E15.m1.5.5.1.1.3.3.2" xref="S5.E15.m1.5.5.1.1.3.3.1.cmml"><mo id="S5.E15.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S5.E15.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S5.E15.m1.1.1" xref="S5.E15.m1.1.1.cmml">λ</mi><mo id="S5.E15.m1.5.5.1.1.3.3.2.2" xref="S5.E15.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S5.E15.m1.2.2" xref="S5.E15.m1.2.2.cmml">t</mi><mo id="S5.E15.m1.5.5.1.1.3.3.2.3" stretchy="false" xref="S5.E15.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E15.m1.5.5.1.1.2" xref="S5.E15.m1.5.5.1.1.2.cmml">=</mo><mrow id="S5.E15.m1.5.5.1.1.1" xref="S5.E15.m1.5.5.1.1.1.cmml"><mi id="S5.E15.m1.5.5.1.1.1.3" xref="S5.E15.m1.5.5.1.1.1.3.cmml">exp</mi><mo id="S5.E15.m1.5.5.1.1.1.2" xref="S5.E15.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S5.E15.m1.5.5.1.1.1.1.1" xref="S5.E15.m1.5.5.1.1.1.1.2.cmml"><mo id="S5.E15.m1.5.5.1.1.1.1.1.2" xref="S5.E15.m1.5.5.1.1.1.1.2.1.cmml">[</mo><mrow id="S5.E15.m1.5.5.1.1.1.1.1.1" xref="S5.E15.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S5.E15.m1.5.5.1.1.1.1.1.1.2" xref="S5.E15.m1.5.5.1.1.1.1.1.1.2.cmml">τ</mi><mo id="S5.E15.m1.5.5.1.1.1.1.1.1.1" xref="S5.E15.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S5.E15.m1.5.5.1.1.1.1.1.1.3.2" xref="S5.E15.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S5.E15.m1.5.5.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S5.E15.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S5.E15.m1.3.3" xref="S5.E15.m1.3.3.cmml">t</mi><mo id="S5.E15.m1.5.5.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S5.E15.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.E15.m1.5.5.1.1.1.1.1.1.1a" xref="S5.E15.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S5.E15.m1.5.5.1.1.1.1.1.1.4" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4.cmml"><mrow id="S5.E15.m1.5.5.1.1.1.1.1.1.4.2.2" xref="S5.E15.m1.4.4.cmml"><mo id="S5.E15.m1.5.5.1.1.1.1.1.1.4.2.2.1" xref="S5.E15.m1.4.4.cmml">(</mo><mstyle displaystyle="true" id="S5.E15.m1.4.4" xref="S5.E15.m1.4.4.cmml"><mfrac id="S5.E15.m1.4.4a" xref="S5.E15.m1.4.4.cmml"><mi id="S5.E15.m1.4.4.2" xref="S5.E15.m1.4.4.2.cmml">λ</mi><msub id="S5.E15.m1.4.4.3" xref="S5.E15.m1.4.4.3.cmml"><mi id="S5.E15.m1.4.4.3.2" xref="S5.E15.m1.4.4.3.2.cmml">λ</mi><mi id="S5.E15.m1.4.4.3.3" mathvariant="normal" xref="S5.E15.m1.4.4.3.3.cmml">V</mi></msub></mfrac></mstyle><mo id="S5.E15.m1.5.5.1.1.1.1.1.1.4.2.2.2" xref="S5.E15.m1.4.4.cmml">)</mo></mrow><mrow id="S5.E15.m1.5.5.1.1.1.1.1.1.4.3" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4.3.cmml"><mo id="S5.E15.m1.5.5.1.1.1.1.1.1.4.3a" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4.3.cmml">−</mo><mi id="S5.E15.m1.5.5.1.1.1.1.1.1.4.3.2" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4.3.2.cmml">α</mi></mrow></msup></mrow><mo id="S5.E15.m1.5.5.1.1.1.1.1.3" rspace="0.560em" xref="S5.E15.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S5.E15.m1.5.5.1.2" xref="S5.E15.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E15.m1.5b"><apply id="S5.E15.m1.5.5.1.1.cmml" xref="S5.E15.m1.5.5.1"><eq id="S5.E15.m1.5.5.1.1.2.cmml" xref="S5.E15.m1.5.5.1.1.2"></eq><apply id="S5.E15.m1.5.5.1.1.3.cmml" xref="S5.E15.m1.5.5.1.1.3"><times id="S5.E15.m1.5.5.1.1.3.1.cmml" xref="S5.E15.m1.5.5.1.1.3.1"></times><ci id="S5.E15.m1.5.5.1.1.3.2.cmml" xref="S5.E15.m1.5.5.1.1.3.2">𝑇</ci><interval closure="open" id="S5.E15.m1.5.5.1.1.3.3.1.cmml" xref="S5.E15.m1.5.5.1.1.3.3.2"><ci id="S5.E15.m1.1.1.cmml" xref="S5.E15.m1.1.1">𝜆</ci><ci id="S5.E15.m1.2.2.cmml" xref="S5.E15.m1.2.2">𝑡</ci></interval></apply><apply id="S5.E15.m1.5.5.1.1.1.cmml" xref="S5.E15.m1.5.5.1.1.1"><times id="S5.E15.m1.5.5.1.1.1.2.cmml" xref="S5.E15.m1.5.5.1.1.1.2"></times><ci id="S5.E15.m1.5.5.1.1.1.3.cmml" xref="S5.E15.m1.5.5.1.1.1.3">exp</ci><apply id="S5.E15.m1.5.5.1.1.1.1.2.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S5.E15.m1.5.5.1.1.1.1.2.1.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S5.E15.m1.5.5.1.1.1.1.1.1.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.1"><times id="S5.E15.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.1.1"></times><ci id="S5.E15.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.1.2">𝜏</ci><ci id="S5.E15.m1.3.3.cmml" xref="S5.E15.m1.3.3">𝑡</ci><apply id="S5.E15.m1.5.5.1.1.1.1.1.1.4.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S5.E15.m1.5.5.1.1.1.1.1.1.4.1.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4">superscript</csymbol><apply id="S5.E15.m1.4.4.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4.2.2"><divide id="S5.E15.m1.4.4.1.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4.2.2"></divide><ci id="S5.E15.m1.4.4.2.cmml" xref="S5.E15.m1.4.4.2">𝜆</ci><apply id="S5.E15.m1.4.4.3.cmml" xref="S5.E15.m1.4.4.3"><csymbol cd="ambiguous" id="S5.E15.m1.4.4.3.1.cmml" xref="S5.E15.m1.4.4.3">subscript</csymbol><ci id="S5.E15.m1.4.4.3.2.cmml" xref="S5.E15.m1.4.4.3.2">𝜆</ci><ci id="S5.E15.m1.4.4.3.3.cmml" xref="S5.E15.m1.4.4.3.3">V</ci></apply></apply><apply id="S5.E15.m1.5.5.1.1.1.1.1.1.4.3.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4.3"><minus id="S5.E15.m1.5.5.1.1.1.1.1.1.4.3.1.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4.3"></minus><ci id="S5.E15.m1.5.5.1.1.1.1.1.1.4.3.2.cmml" xref="S5.E15.m1.5.5.1.1.1.1.1.1.4.3.2">𝛼</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E15.m1.5c">\displaystyle T(\lambda,t)=\mathrm{exp}\left[\tau(t)\left(\frac{\lambda}{%
\lambda_{\mathrm{V}}}\right)^{-\alpha}\right]\;\;,</annotation><annotation encoding="application/x-llamapun" id="S5.E15.m1.5d">italic_T ( italic_λ , italic_t ) = roman_exp [ italic_τ ( italic_t ) ( divide start_ARG italic_λ end_ARG start_ARG italic_λ start_POSTSUBSCRIPT roman_V end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT - italic_α end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS5.p2.6">where <math alttext="\lambda_{\mathrm{V}}" class="ltx_Math" display="inline" id="S5.SS5.p2.3.m1.1"><semantics id="S5.SS5.p2.3.m1.1a"><msub id="S5.SS5.p2.3.m1.1.1" xref="S5.SS5.p2.3.m1.1.1.cmml"><mi id="S5.SS5.p2.3.m1.1.1.2" xref="S5.SS5.p2.3.m1.1.1.2.cmml">λ</mi><mi id="S5.SS5.p2.3.m1.1.1.3" mathvariant="normal" xref="S5.SS5.p2.3.m1.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.3.m1.1b"><apply id="S5.SS5.p2.3.m1.1.1.cmml" xref="S5.SS5.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.3.m1.1.1.1.cmml" xref="S5.SS5.p2.3.m1.1.1">subscript</csymbol><ci id="S5.SS5.p2.3.m1.1.1.2.cmml" xref="S5.SS5.p2.3.m1.1.1.2">𝜆</ci><ci id="S5.SS5.p2.3.m1.1.1.3.cmml" xref="S5.SS5.p2.3.m1.1.1.3">V</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.3.m1.1c">\lambda_{\mathrm{V}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.3.m1.1d">italic_λ start_POSTSUBSCRIPT roman_V end_POSTSUBSCRIPT</annotation></semantics></math> is the wavelength of the V band (<math alttext="550\;\mathrm{nm}" class="ltx_Math" display="inline" id="S5.SS5.p2.4.m2.1"><semantics id="S5.SS5.p2.4.m2.1a"><mrow id="S5.SS5.p2.4.m2.1.1" xref="S5.SS5.p2.4.m2.1.1.cmml"><mn id="S5.SS5.p2.4.m2.1.1.2" xref="S5.SS5.p2.4.m2.1.1.2.cmml">550</mn><mo id="S5.SS5.p2.4.m2.1.1.1" lspace="0.280em" xref="S5.SS5.p2.4.m2.1.1.1.cmml">⁢</mo><mi id="S5.SS5.p2.4.m2.1.1.3" xref="S5.SS5.p2.4.m2.1.1.3.cmml">nm</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.4.m2.1b"><apply id="S5.SS5.p2.4.m2.1.1.cmml" xref="S5.SS5.p2.4.m2.1.1"><times id="S5.SS5.p2.4.m2.1.1.1.cmml" xref="S5.SS5.p2.4.m2.1.1.1"></times><cn id="S5.SS5.p2.4.m2.1.1.2.cmml" type="integer" xref="S5.SS5.p2.4.m2.1.1.2">550</cn><ci id="S5.SS5.p2.4.m2.1.1.3.cmml" xref="S5.SS5.p2.4.m2.1.1.3">nm</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.4.m2.1c">550\;\mathrm{nm}</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.4.m2.1d">550 roman_nm</annotation></semantics></math>).
Here the optical depth <math alttext="\tau" class="ltx_Math" display="inline" id="S5.SS5.p2.5.m3.1"><semantics id="S5.SS5.p2.5.m3.1a"><mi id="S5.SS5.p2.5.m3.1.1" xref="S5.SS5.p2.5.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.5.m3.1b"><ci id="S5.SS5.p2.5.m3.1.1.cmml" xref="S5.SS5.p2.5.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.5.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.5.m3.1d">italic_τ</annotation></semantics></math> is dependent on the age of the stellar population <math alttext="t" class="ltx_Math" display="inline" id="S5.SS5.p2.6.m4.1"><semantics id="S5.SS5.p2.6.m4.1a"><mi id="S5.SS5.p2.6.m4.1.1" xref="S5.SS5.p2.6.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.6.m4.1b"><ci id="S5.SS5.p2.6.m4.1.1.cmml" xref="S5.SS5.p2.6.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.6.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.6.m4.1d">italic_t</annotation></semantics></math>; star particles younger than 10 Myr are assumed to still reside within their birth clouds (BC), and therefore experience an extra source of attenuation,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx2">
<tbody id="S5.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tau(t)=\begin{cases}\tau_{\mathrm{BC}}+\tau_{\mathrm{ISM}}&amp;;%
\quad t\leqslant 10{\rm Myr}\\
\tau_{\mathrm{ISM}}&amp;;\quad t&gt;10{\rm Myr}\end{cases}\;\;." class="ltx_math_unparsed" display="inline" id="S5.E16.m1.6"><semantics id="S5.E16.m1.6a"><mrow id="S5.E16.m1.6.6.1"><mrow id="S5.E16.m1.6.6.1.1"><mrow id="S5.E16.m1.6.6.1.1.2"><mi id="S5.E16.m1.6.6.1.1.2.2">τ</mi><mo id="S5.E16.m1.6.6.1.1.2.1">⁢</mo><mrow id="S5.E16.m1.6.6.1.1.2.3.2"><mo id="S5.E16.m1.6.6.1.1.2.3.2.1" stretchy="false">(</mo><mi id="S5.E16.m1.5.5">t</mi><mo id="S5.E16.m1.6.6.1.1.2.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S5.E16.m1.6.6.1.1.1">=</mo><mrow id="S5.E16.m1.4.4a"><mo id="S5.E16.m1.4.4a.5">{</mo><mtable columnspacing="5pt" id="S5.E16.m1.4.4.4a" rowspacing="0pt"><mtr id="S5.E16.m1.4.4.4aa"><mtd class="ltx_align_left" columnalign="left" id="S5.E16.m1.4.4.4ab"><mrow id="S5.E16.m1.1.1.1.1.1.1"><msub id="S5.E16.m1.1.1.1.1.1.1.2"><mi id="S5.E16.m1.1.1.1.1.1.1.2.2">τ</mi><mi id="S5.E16.m1.1.1.1.1.1.1.2.3">BC</mi></msub><mo id="S5.E16.m1.1.1.1.1.1.1.1">+</mo><msub id="S5.E16.m1.1.1.1.1.1.1.3"><mi id="S5.E16.m1.1.1.1.1.1.1.3.2">τ</mi><mi id="S5.E16.m1.1.1.1.1.1.1.3.3">ISM</mi></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S5.E16.m1.4.4.4ac"><mrow id="S5.E16.m1.2.2.2.2.2.1"><mo id="S5.E16.m1.2.2.2.2.2.1.1" rspace="1.167em">;</mo><mi id="S5.E16.m1.2.2.2.2.2.1.2">t</mi><mo id="S5.E16.m1.2.2.2.2.2.1.3">⩽</mo><mn id="S5.E16.m1.2.2.2.2.2.1.4">10</mn><mi id="S5.E16.m1.2.2.2.2.2.1.5" mathvariant="normal">M</mi><mi id="S5.E16.m1.2.2.2.2.2.1.6" mathvariant="normal">y</mi><mi id="S5.E16.m1.2.2.2.2.2.1.7" mathvariant="normal">r</mi></mrow></mtd></mtr><mtr id="S5.E16.m1.4.4.4ad"><mtd class="ltx_align_left" columnalign="left" id="S5.E16.m1.4.4.4ae"><msub id="S5.E16.m1.3.3.3.3.1.1"><mi id="S5.E16.m1.3.3.3.3.1.1.2">τ</mi><mi id="S5.E16.m1.3.3.3.3.1.1.3">ISM</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S5.E16.m1.4.4.4af"><mrow id="S5.E16.m1.4.4.4.4.2.1"><mo id="S5.E16.m1.4.4.4.4.2.1.1" rspace="1.167em">;</mo><mi id="S5.E16.m1.4.4.4.4.2.1.2">t</mi><mo id="S5.E16.m1.4.4.4.4.2.1.3">&gt;</mo><mn id="S5.E16.m1.4.4.4.4.2.1.4">10</mn><mi id="S5.E16.m1.4.4.4.4.2.1.5" mathvariant="normal">M</mi><mi id="S5.E16.m1.4.4.4.4.2.1.6" mathvariant="normal">y</mi><mi id="S5.E16.m1.4.4.4.4.2.1.7" mathvariant="normal">r</mi></mrow></mtd></mtr></mtable></mrow></mrow><mo id="S5.E16.m1.6.6.1.2" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S5.E16.m1.6b">\displaystyle\tau(t)=\begin{cases}\tau_{\mathrm{BC}}+\tau_{\mathrm{ISM}}&amp;;%
\quad t\leqslant 10{\rm Myr}\\
\tau_{\mathrm{ISM}}&amp;;\quad t&gt;10{\rm Myr}\end{cases}\;\;.</annotation><annotation encoding="application/x-llamapun" id="S5.E16.m1.6c">italic_τ ( italic_t ) = { start_ROW start_CELL italic_τ start_POSTSUBSCRIPT roman_BC end_POSTSUBSCRIPT + italic_τ start_POSTSUBSCRIPT roman_ISM end_POSTSUBSCRIPT end_CELL start_CELL ; italic_t ⩽ 10 roman_M roman_y roman_r end_CELL end_ROW start_ROW start_CELL italic_τ start_POSTSUBSCRIPT roman_ISM end_POSTSUBSCRIPT end_CELL start_CELL ; italic_t &gt; 10 roman_M roman_y roman_r end_CELL end_ROW .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.9">Assuming the same underlying stellar emission model, we generated rest frame optical photometry in the <math alttext="g" class="ltx_Math" display="inline" id="S5.SS5.p3.1.m1.1"><semantics id="S5.SS5.p3.1.m1.1a"><mi id="S5.SS5.p3.1.m1.1.1" xref="S5.SS5.p3.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.1.m1.1b"><ci id="S5.SS5.p3.1.m1.1.1.cmml" xref="S5.SS5.p3.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.1.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p3.1.m1.1d">italic_g</annotation></semantics></math> and <math alttext="r" class="ltx_Math" display="inline" id="S5.SS5.p3.2.m2.1"><semantics id="S5.SS5.p3.2.m2.1a"><mi id="S5.SS5.p3.2.m2.1.1" xref="S5.SS5.p3.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.2.m2.1b"><ci id="S5.SS5.p3.2.m2.1.1.cmml" xref="S5.SS5.p3.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p3.2.m2.1d">italic_r</annotation></semantics></math> bands for all galaxies in Simba for 1000 simulations on a Latin hypercube, with flat priors on the parameters in the range <math alttext="\alpha\in[0.5,2.0]" class="ltx_Math" display="inline" id="S5.SS5.p3.3.m3.2"><semantics id="S5.SS5.p3.3.m3.2a"><mrow id="S5.SS5.p3.3.m3.2.3" xref="S5.SS5.p3.3.m3.2.3.cmml"><mi id="S5.SS5.p3.3.m3.2.3.2" xref="S5.SS5.p3.3.m3.2.3.2.cmml">α</mi><mo id="S5.SS5.p3.3.m3.2.3.1" xref="S5.SS5.p3.3.m3.2.3.1.cmml">∈</mo><mrow id="S5.SS5.p3.3.m3.2.3.3.2" xref="S5.SS5.p3.3.m3.2.3.3.1.cmml"><mo id="S5.SS5.p3.3.m3.2.3.3.2.1" stretchy="false" xref="S5.SS5.p3.3.m3.2.3.3.1.cmml">[</mo><mn id="S5.SS5.p3.3.m3.1.1" xref="S5.SS5.p3.3.m3.1.1.cmml">0.5</mn><mo id="S5.SS5.p3.3.m3.2.3.3.2.2" xref="S5.SS5.p3.3.m3.2.3.3.1.cmml">,</mo><mn id="S5.SS5.p3.3.m3.2.2" xref="S5.SS5.p3.3.m3.2.2.cmml">2.0</mn><mo id="S5.SS5.p3.3.m3.2.3.3.2.3" stretchy="false" xref="S5.SS5.p3.3.m3.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.3.m3.2b"><apply id="S5.SS5.p3.3.m3.2.3.cmml" xref="S5.SS5.p3.3.m3.2.3"><in id="S5.SS5.p3.3.m3.2.3.1.cmml" xref="S5.SS5.p3.3.m3.2.3.1"></in><ci id="S5.SS5.p3.3.m3.2.3.2.cmml" xref="S5.SS5.p3.3.m3.2.3.2">𝛼</ci><interval closure="closed" id="S5.SS5.p3.3.m3.2.3.3.1.cmml" xref="S5.SS5.p3.3.m3.2.3.3.2"><cn id="S5.SS5.p3.3.m3.1.1.cmml" type="float" xref="S5.SS5.p3.3.m3.1.1">0.5</cn><cn id="S5.SS5.p3.3.m3.2.2.cmml" type="float" xref="S5.SS5.p3.3.m3.2.2">2.0</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.3.m3.2c">\alpha\in[0.5,2.0]</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p3.3.m3.2d">italic_α ∈ [ 0.5 , 2.0 ]</annotation></semantics></math>, <math alttext="\tau_{\mathrm{ISM}}\in[0.01,0.5]" class="ltx_Math" display="inline" id="S5.SS5.p3.4.m4.2"><semantics id="S5.SS5.p3.4.m4.2a"><mrow id="S5.SS5.p3.4.m4.2.3" xref="S5.SS5.p3.4.m4.2.3.cmml"><msub id="S5.SS5.p3.4.m4.2.3.2" xref="S5.SS5.p3.4.m4.2.3.2.cmml"><mi id="S5.SS5.p3.4.m4.2.3.2.2" xref="S5.SS5.p3.4.m4.2.3.2.2.cmml">τ</mi><mi id="S5.SS5.p3.4.m4.2.3.2.3" xref="S5.SS5.p3.4.m4.2.3.2.3.cmml">ISM</mi></msub><mo id="S5.SS5.p3.4.m4.2.3.1" xref="S5.SS5.p3.4.m4.2.3.1.cmml">∈</mo><mrow id="S5.SS5.p3.4.m4.2.3.3.2" xref="S5.SS5.p3.4.m4.2.3.3.1.cmml"><mo id="S5.SS5.p3.4.m4.2.3.3.2.1" stretchy="false" xref="S5.SS5.p3.4.m4.2.3.3.1.cmml">[</mo><mn id="S5.SS5.p3.4.m4.1.1" xref="S5.SS5.p3.4.m4.1.1.cmml">0.01</mn><mo id="S5.SS5.p3.4.m4.2.3.3.2.2" xref="S5.SS5.p3.4.m4.2.3.3.1.cmml">,</mo><mn id="S5.SS5.p3.4.m4.2.2" xref="S5.SS5.p3.4.m4.2.2.cmml">0.5</mn><mo id="S5.SS5.p3.4.m4.2.3.3.2.3" stretchy="false" xref="S5.SS5.p3.4.m4.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.4.m4.2b"><apply id="S5.SS5.p3.4.m4.2.3.cmml" xref="S5.SS5.p3.4.m4.2.3"><in id="S5.SS5.p3.4.m4.2.3.1.cmml" xref="S5.SS5.p3.4.m4.2.3.1"></in><apply id="S5.SS5.p3.4.m4.2.3.2.cmml" xref="S5.SS5.p3.4.m4.2.3.2"><csymbol cd="ambiguous" id="S5.SS5.p3.4.m4.2.3.2.1.cmml" xref="S5.SS5.p3.4.m4.2.3.2">subscript</csymbol><ci id="S5.SS5.p3.4.m4.2.3.2.2.cmml" xref="S5.SS5.p3.4.m4.2.3.2.2">𝜏</ci><ci id="S5.SS5.p3.4.m4.2.3.2.3.cmml" xref="S5.SS5.p3.4.m4.2.3.2.3">ISM</ci></apply><interval closure="closed" id="S5.SS5.p3.4.m4.2.3.3.1.cmml" xref="S5.SS5.p3.4.m4.2.3.3.2"><cn id="S5.SS5.p3.4.m4.1.1.cmml" type="float" xref="S5.SS5.p3.4.m4.1.1">0.01</cn><cn id="S5.SS5.p3.4.m4.2.2.cmml" type="float" xref="S5.SS5.p3.4.m4.2.2">0.5</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.4.m4.2c">\tau_{\mathrm{ISM}}\in[0.01,0.5]</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p3.4.m4.2d">italic_τ start_POSTSUBSCRIPT roman_ISM end_POSTSUBSCRIPT ∈ [ 0.01 , 0.5 ]</annotation></semantics></math> and <math alttext="\tau_{\mathrm{BC}}\in[0.3,1.5]" class="ltx_Math" display="inline" id="S5.SS5.p3.5.m5.2"><semantics id="S5.SS5.p3.5.m5.2a"><mrow id="S5.SS5.p3.5.m5.2.3" xref="S5.SS5.p3.5.m5.2.3.cmml"><msub id="S5.SS5.p3.5.m5.2.3.2" xref="S5.SS5.p3.5.m5.2.3.2.cmml"><mi id="S5.SS5.p3.5.m5.2.3.2.2" xref="S5.SS5.p3.5.m5.2.3.2.2.cmml">τ</mi><mi id="S5.SS5.p3.5.m5.2.3.2.3" xref="S5.SS5.p3.5.m5.2.3.2.3.cmml">BC</mi></msub><mo id="S5.SS5.p3.5.m5.2.3.1" xref="S5.SS5.p3.5.m5.2.3.1.cmml">∈</mo><mrow id="S5.SS5.p3.5.m5.2.3.3.2" xref="S5.SS5.p3.5.m5.2.3.3.1.cmml"><mo id="S5.SS5.p3.5.m5.2.3.3.2.1" stretchy="false" xref="S5.SS5.p3.5.m5.2.3.3.1.cmml">[</mo><mn id="S5.SS5.p3.5.m5.1.1" xref="S5.SS5.p3.5.m5.1.1.cmml">0.3</mn><mo id="S5.SS5.p3.5.m5.2.3.3.2.2" xref="S5.SS5.p3.5.m5.2.3.3.1.cmml">,</mo><mn id="S5.SS5.p3.5.m5.2.2" xref="S5.SS5.p3.5.m5.2.2.cmml">1.5</mn><mo id="S5.SS5.p3.5.m5.2.3.3.2.3" stretchy="false" xref="S5.SS5.p3.5.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.5.m5.2b"><apply id="S5.SS5.p3.5.m5.2.3.cmml" xref="S5.SS5.p3.5.m5.2.3"><in id="S5.SS5.p3.5.m5.2.3.1.cmml" xref="S5.SS5.p3.5.m5.2.3.1"></in><apply id="S5.SS5.p3.5.m5.2.3.2.cmml" xref="S5.SS5.p3.5.m5.2.3.2"><csymbol cd="ambiguous" id="S5.SS5.p3.5.m5.2.3.2.1.cmml" xref="S5.SS5.p3.5.m5.2.3.2">subscript</csymbol><ci id="S5.SS5.p3.5.m5.2.3.2.2.cmml" xref="S5.SS5.p3.5.m5.2.3.2.2">𝜏</ci><ci id="S5.SS5.p3.5.m5.2.3.2.3.cmml" xref="S5.SS5.p3.5.m5.2.3.2.3">BC</ci></apply><interval closure="closed" id="S5.SS5.p3.5.m5.2.3.3.1.cmml" xref="S5.SS5.p3.5.m5.2.3.3.2"><cn id="S5.SS5.p3.5.m5.1.1.cmml" type="float" xref="S5.SS5.p3.5.m5.1.1">0.3</cn><cn id="S5.SS5.p3.5.m5.2.2.cmml" type="float" xref="S5.SS5.p3.5.m5.2.2">1.5</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.5.m5.2c">\tau_{\mathrm{BC}}\in[0.3,1.5]</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p3.5.m5.2d">italic_τ start_POSTSUBSCRIPT roman_BC end_POSTSUBSCRIPT ∈ [ 0.3 , 1.5 ]</annotation></semantics></math>.
We then take these simulations and measure the <math alttext="r" class="ltx_Math" display="inline" id="S5.SS5.p3.6.m6.1"><semantics id="S5.SS5.p3.6.m6.1a"><mi id="S5.SS5.p3.6.m6.1.1" xref="S5.SS5.p3.6.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.6.m6.1b"><ci id="S5.SS5.p3.6.m6.1.1.cmml" xref="S5.SS5.p3.6.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.6.m6.1c">r</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p3.6.m6.1d">italic_r</annotation></semantics></math>-band luminosity function and the <math alttext="g-r" class="ltx_Math" display="inline" id="S5.SS5.p3.7.m7.1"><semantics id="S5.SS5.p3.7.m7.1a"><mrow id="S5.SS5.p3.7.m7.1.1" xref="S5.SS5.p3.7.m7.1.1.cmml"><mi id="S5.SS5.p3.7.m7.1.1.2" xref="S5.SS5.p3.7.m7.1.1.2.cmml">g</mi><mo id="S5.SS5.p3.7.m7.1.1.1" xref="S5.SS5.p3.7.m7.1.1.1.cmml">−</mo><mi id="S5.SS5.p3.7.m7.1.1.3" xref="S5.SS5.p3.7.m7.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.7.m7.1b"><apply id="S5.SS5.p3.7.m7.1.1.cmml" xref="S5.SS5.p3.7.m7.1.1"><minus id="S5.SS5.p3.7.m7.1.1.1.cmml" xref="S5.SS5.p3.7.m7.1.1.1"></minus><ci id="S5.SS5.p3.7.m7.1.1.2.cmml" xref="S5.SS5.p3.7.m7.1.1.2">𝑔</ci><ci id="S5.SS5.p3.7.m7.1.1.3.cmml" xref="S5.SS5.p3.7.m7.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.7.m7.1c">g-r</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p3.7.m7.1d">italic_g - italic_r</annotation></semantics></math> color distribution, and use these as our summary statistics.
We perform NPE using an MAF architecture; Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F9" title="Figure 9 ‣ 5.5 Inferring Dust Parameters ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">9</span></a> shows the posteriors on a test parameter – data pair.
We show results from training on just the luminosity function, just the color, and the two combined.
It is clear that the overall normalisation of the luminosity function constrains the ISM optical depth, <math alttext="\tau_{\mathrm{ISM}}" class="ltx_Math" display="inline" id="S5.SS5.p3.8.m8.1"><semantics id="S5.SS5.p3.8.m8.1a"><msub id="S5.SS5.p3.8.m8.1.1" xref="S5.SS5.p3.8.m8.1.1.cmml"><mi id="S5.SS5.p3.8.m8.1.1.2" xref="S5.SS5.p3.8.m8.1.1.2.cmml">τ</mi><mi id="S5.SS5.p3.8.m8.1.1.3" xref="S5.SS5.p3.8.m8.1.1.3.cmml">ISM</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.8.m8.1b"><apply id="S5.SS5.p3.8.m8.1.1.cmml" xref="S5.SS5.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS5.p3.8.m8.1.1.1.cmml" xref="S5.SS5.p3.8.m8.1.1">subscript</csymbol><ci id="S5.SS5.p3.8.m8.1.1.2.cmml" xref="S5.SS5.p3.8.m8.1.1.2">𝜏</ci><ci id="S5.SS5.p3.8.m8.1.1.3.cmml" xref="S5.SS5.p3.8.m8.1.1.3">ISM</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.8.m8.1c">\tau_{\mathrm{ISM}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p3.8.m8.1d">italic_τ start_POSTSUBSCRIPT roman_ISM end_POSTSUBSCRIPT</annotation></semantics></math>, whereas the colour constrains the slope of the attenuation law, <math alttext="\alpha" class="ltx_Math" display="inline" id="S5.SS5.p3.9.m9.1"><semantics id="S5.SS5.p3.9.m9.1a"><mi id="S5.SS5.p3.9.m9.1.1" xref="S5.SS5.p3.9.m9.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.9.m9.1b"><ci id="S5.SS5.p3.9.m9.1.1.cmml" xref="S5.SS5.p3.9.m9.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.9.m9.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p3.9.m9.1d">italic_α</annotation></semantics></math>.
When combined, these parameters are simultaneously tightly constrained.
The birth cloud attenuation has a more subtle effect on the luminosity function and colour distribution, but the combination leads to tighter constraints.</p>
</div>
<figure class="ltx_figure" id="S5.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="598" id="S5.F9.g1" src="extracted/5393296/figures/dust_example_posteriors.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Dust parameter inference example on the Simba simulation. <span class="ltx_text ltx_font_italic" id="S5.F9.7.1">Left:</span> example posteriors on the ISM and birth cloud optical depth as well as the slope of the attenuation law, from the distribution of <math alttext="g-r" class="ltx_Math" display="inline" id="S5.F9.3.m1.1"><semantics id="S5.F9.3.m1.1b"><mrow id="S5.F9.3.m1.1.1" xref="S5.F9.3.m1.1.1.cmml"><mi id="S5.F9.3.m1.1.1.2" xref="S5.F9.3.m1.1.1.2.cmml">g</mi><mo id="S5.F9.3.m1.1.1.1" xref="S5.F9.3.m1.1.1.1.cmml">−</mo><mi id="S5.F9.3.m1.1.1.3" xref="S5.F9.3.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.F9.3.m1.1c"><apply id="S5.F9.3.m1.1.1.cmml" xref="S5.F9.3.m1.1.1"><minus id="S5.F9.3.m1.1.1.1.cmml" xref="S5.F9.3.m1.1.1.1"></minus><ci id="S5.F9.3.m1.1.1.2.cmml" xref="S5.F9.3.m1.1.1.2">𝑔</ci><ci id="S5.F9.3.m1.1.1.3.cmml" xref="S5.F9.3.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F9.3.m1.1d">g-r</annotation><annotation encoding="application/x-llamapun" id="S5.F9.3.m1.1e">italic_g - italic_r</annotation></semantics></math> colors (blue), the <math alttext="r" class="ltx_Math" display="inline" id="S5.F9.4.m2.1"><semantics id="S5.F9.4.m2.1b"><mi id="S5.F9.4.m2.1.1" xref="S5.F9.4.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.F9.4.m2.1c"><ci id="S5.F9.4.m2.1.1.cmml" xref="S5.F9.4.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F9.4.m2.1d">r</annotation><annotation encoding="application/x-llamapun" id="S5.F9.4.m2.1e">italic_r</annotation></semantics></math>-band magnitude luminosity function (orange), and the combination of both (green).
<span class="ltx_text ltx_font_italic" id="S5.F9.8.2">Right:</span> posterior constraints on each parameter for a range of test simulations.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span>The Mass and Energy Loading of Galactic Winds</h3>
<div class="ltx_para" id="S5.SS6.p1">
<p class="ltx_p" id="S5.SS6.p1.2">A major open question in galaxy formation is the role of feedback in regulating star formation and shaping the stellar-to-halo-mass relation. Recently, <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx140" title="">Carr <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Carr, Bryan, Fielding, Pandya, and Somerville</a></cite> and <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx141" title="">Pandya <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Pandya, Fielding, Bryan, Carr, Somerville, Stern, Faucher-Giguère, Hafen, Anglés-Alcázar, and Forbes</a></cite> showed that supernova-driven galactic winds can heat and stir turbulence in the circumgalactic medium of dwarf galaxies and Milky Way-mass halos. This can suppress the cooling and accretion of gas onto galaxies thereby helping to regulate star formation. The strength of this “preventative feedback” is controlled by two wind parameters: the mass loading factor (<math alttext="\eta_{\rm M}" class="ltx_Math" display="inline" id="S5.SS6.p1.1.m1.1"><semantics id="S5.SS6.p1.1.m1.1a"><msub id="S5.SS6.p1.1.m1.1.1" xref="S5.SS6.p1.1.m1.1.1.cmml"><mi id="S5.SS6.p1.1.m1.1.1.2" xref="S5.SS6.p1.1.m1.1.1.2.cmml">η</mi><mi id="S5.SS6.p1.1.m1.1.1.3" mathvariant="normal" xref="S5.SS6.p1.1.m1.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.1.m1.1b"><apply id="S5.SS6.p1.1.m1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS6.p1.1.m1.1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS6.p1.1.m1.1.1.2.cmml" xref="S5.SS6.p1.1.m1.1.1.2">𝜂</ci><ci id="S5.SS6.p1.1.m1.1.1.3.cmml" xref="S5.SS6.p1.1.m1.1.1.3">M</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.1.m1.1c">\eta_{\rm M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p1.1.m1.1d">italic_η start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT</annotation></semantics></math>) and the energy loading factor (<math alttext="\eta_{\rm E}" class="ltx_Math" display="inline" id="S5.SS6.p1.2.m2.1"><semantics id="S5.SS6.p1.2.m2.1a"><msub id="S5.SS6.p1.2.m2.1.1" xref="S5.SS6.p1.2.m2.1.1.cmml"><mi id="S5.SS6.p1.2.m2.1.1.2" xref="S5.SS6.p1.2.m2.1.1.2.cmml">η</mi><mi id="S5.SS6.p1.2.m2.1.1.3" mathvariant="normal" xref="S5.SS6.p1.2.m2.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.2.m2.1b"><apply id="S5.SS6.p1.2.m2.1.1.cmml" xref="S5.SS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS6.p1.2.m2.1.1.1.cmml" xref="S5.SS6.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS6.p1.2.m2.1.1.2.cmml" xref="S5.SS6.p1.2.m2.1.1.2">𝜂</ci><ci id="S5.SS6.p1.2.m2.1.1.3.cmml" xref="S5.SS6.p1.2.m2.1.1.3">E</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.2.m2.1c">\eta_{\rm E}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p1.2.m2.1d">italic_η start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT</annotation></semantics></math>). Together, these describe the specific energy of winds and summarize the fraction of mass and energy produced by supernovae that leave the galaxy and become available for large-scale heating.</p>
</div>
<div class="ltx_para" id="S5.SS6.p2">
<p class="ltx_p" id="S5.SS6.p2.4">Here we want to explore the connection between <math alttext="(\eta_{\rm M},\eta_{\rm E})" class="ltx_Math" display="inline" id="S5.SS6.p2.1.m1.2"><semantics id="S5.SS6.p2.1.m1.2a"><mrow id="S5.SS6.p2.1.m1.2.2.2" xref="S5.SS6.p2.1.m1.2.2.3.cmml"><mo id="S5.SS6.p2.1.m1.2.2.2.3" stretchy="false" xref="S5.SS6.p2.1.m1.2.2.3.cmml">(</mo><msub id="S5.SS6.p2.1.m1.1.1.1.1" xref="S5.SS6.p2.1.m1.1.1.1.1.cmml"><mi id="S5.SS6.p2.1.m1.1.1.1.1.2" xref="S5.SS6.p2.1.m1.1.1.1.1.2.cmml">η</mi><mi id="S5.SS6.p2.1.m1.1.1.1.1.3" mathvariant="normal" xref="S5.SS6.p2.1.m1.1.1.1.1.3.cmml">M</mi></msub><mo id="S5.SS6.p2.1.m1.2.2.2.4" xref="S5.SS6.p2.1.m1.2.2.3.cmml">,</mo><msub id="S5.SS6.p2.1.m1.2.2.2.2" xref="S5.SS6.p2.1.m1.2.2.2.2.cmml"><mi id="S5.SS6.p2.1.m1.2.2.2.2.2" xref="S5.SS6.p2.1.m1.2.2.2.2.2.cmml">η</mi><mi id="S5.SS6.p2.1.m1.2.2.2.2.3" mathvariant="normal" xref="S5.SS6.p2.1.m1.2.2.2.2.3.cmml">E</mi></msub><mo id="S5.SS6.p2.1.m1.2.2.2.5" stretchy="false" xref="S5.SS6.p2.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.1.m1.2b"><interval closure="open" id="S5.SS6.p2.1.m1.2.2.3.cmml" xref="S5.SS6.p2.1.m1.2.2.2"><apply id="S5.SS6.p2.1.m1.1.1.1.1.cmml" xref="S5.SS6.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.1.m1.1.1.1.1.1.cmml" xref="S5.SS6.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S5.SS6.p2.1.m1.1.1.1.1.2.cmml" xref="S5.SS6.p2.1.m1.1.1.1.1.2">𝜂</ci><ci id="S5.SS6.p2.1.m1.1.1.1.1.3.cmml" xref="S5.SS6.p2.1.m1.1.1.1.1.3">M</ci></apply><apply id="S5.SS6.p2.1.m1.2.2.2.2.cmml" xref="S5.SS6.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS6.p2.1.m1.2.2.2.2.1.cmml" xref="S5.SS6.p2.1.m1.2.2.2.2">subscript</csymbol><ci id="S5.SS6.p2.1.m1.2.2.2.2.2.cmml" xref="S5.SS6.p2.1.m1.2.2.2.2.2">𝜂</ci><ci id="S5.SS6.p2.1.m1.2.2.2.2.3.cmml" xref="S5.SS6.p2.1.m1.2.2.2.2.3">E</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.1.m1.2c">(\eta_{\rm M},\eta_{\rm E})</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.1.m1.2d">( italic_η start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT , italic_η start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT )</annotation></semantics></math> and the stellar-to-halo-mass relation predicted by numerous realizations of the next-generation semi-analytic model <span class="ltx_text ltx_font_typewriter" id="S5.SS6.p2.4.1">sapphire</span> (Pandya et al <span class="ltx_text ltx_font_italic" id="S5.SS6.p2.4.2">in prep.</span>). The model used here is more similar to <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx140" title="">Carr <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Carr, Bryan, Fielding, Pandya, and Somerville</a></cite> than <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx141" title="">Pandya <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Pandya, Fielding, Bryan, Carr, Somerville, Stern, Faucher-Giguère, Hafen, Anglés-Alcázar, and Forbes</a></cite> in that it neglects turbulence and assumes purely thermal heating of the circumgalactic medium (CGM) for simplicity. We assume that <math alttext="\eta_{\rm M}" class="ltx_Math" display="inline" id="S5.SS6.p2.2.m2.1"><semantics id="S5.SS6.p2.2.m2.1a"><msub id="S5.SS6.p2.2.m2.1.1" xref="S5.SS6.p2.2.m2.1.1.cmml"><mi id="S5.SS6.p2.2.m2.1.1.2" xref="S5.SS6.p2.2.m2.1.1.2.cmml">η</mi><mi id="S5.SS6.p2.2.m2.1.1.3" mathvariant="normal" xref="S5.SS6.p2.2.m2.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.2.m2.1b"><apply id="S5.SS6.p2.2.m2.1.1.cmml" xref="S5.SS6.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.2.m2.1.1.1.cmml" xref="S5.SS6.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS6.p2.2.m2.1.1.2.cmml" xref="S5.SS6.p2.2.m2.1.1.2">𝜂</ci><ci id="S5.SS6.p2.2.m2.1.1.3.cmml" xref="S5.SS6.p2.2.m2.1.1.3">M</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.2.m2.1c">\eta_{\rm M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.2.m2.1d">italic_η start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\eta_{\rm E}" class="ltx_Math" display="inline" id="S5.SS6.p2.3.m3.1"><semantics id="S5.SS6.p2.3.m3.1a"><msub id="S5.SS6.p2.3.m3.1.1" xref="S5.SS6.p2.3.m3.1.1.cmml"><mi id="S5.SS6.p2.3.m3.1.1.2" xref="S5.SS6.p2.3.m3.1.1.2.cmml">η</mi><mi id="S5.SS6.p2.3.m3.1.1.3" mathvariant="normal" xref="S5.SS6.p2.3.m3.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.3.m3.1b"><apply id="S5.SS6.p2.3.m3.1.1.cmml" xref="S5.SS6.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.3.m3.1.1.1.cmml" xref="S5.SS6.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS6.p2.3.m3.1.1.2.cmml" xref="S5.SS6.p2.3.m3.1.1.2">𝜂</ci><ci id="S5.SS6.p2.3.m3.1.1.3.cmml" xref="S5.SS6.p2.3.m3.1.1.3">E</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.3.m3.1c">\eta_{\rm E}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.3.m3.1d">italic_η start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT</annotation></semantics></math> both follow power law scalings with halo virial velocity <math alttext="V_{\rm vir}" class="ltx_Math" display="inline" id="S5.SS6.p2.4.m4.1"><semantics id="S5.SS6.p2.4.m4.1a"><msub id="S5.SS6.p2.4.m4.1.1" xref="S5.SS6.p2.4.m4.1.1.cmml"><mi id="S5.SS6.p2.4.m4.1.1.2" xref="S5.SS6.p2.4.m4.1.1.2.cmml">V</mi><mi id="S5.SS6.p2.4.m4.1.1.3" xref="S5.SS6.p2.4.m4.1.1.3.cmml">vir</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.4.m4.1b"><apply id="S5.SS6.p2.4.m4.1.1.cmml" xref="S5.SS6.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.4.m4.1.1.1.cmml" xref="S5.SS6.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS6.p2.4.m4.1.1.2.cmml" xref="S5.SS6.p2.4.m4.1.1.2">𝑉</ci><ci id="S5.SS6.p2.4.m4.1.1.3.cmml" xref="S5.SS6.p2.4.m4.1.1.3">vir</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.4.m4.1c">V_{\rm vir}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.4.m4.1d">italic_V start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT</annotation></semantics></math> (a proxy for halo mass):
</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\eta_{\rm M}=A_{\rm M}\left(\frac{V_{\rm vir}}{125\rm{km\;s^{-1}}}\right)^{%
\alpha_{\rm M}}" class="ltx_Math" display="block" id="S5.E17.m1.1"><semantics id="S5.E17.m1.1a"><mrow id="S5.E17.m1.1.2" xref="S5.E17.m1.1.2.cmml"><msub id="S5.E17.m1.1.2.2" xref="S5.E17.m1.1.2.2.cmml"><mi id="S5.E17.m1.1.2.2.2" xref="S5.E17.m1.1.2.2.2.cmml">η</mi><mi id="S5.E17.m1.1.2.2.3" mathvariant="normal" xref="S5.E17.m1.1.2.2.3.cmml">M</mi></msub><mo id="S5.E17.m1.1.2.1" xref="S5.E17.m1.1.2.1.cmml">=</mo><mrow id="S5.E17.m1.1.2.3" xref="S5.E17.m1.1.2.3.cmml"><msub id="S5.E17.m1.1.2.3.2" xref="S5.E17.m1.1.2.3.2.cmml"><mi id="S5.E17.m1.1.2.3.2.2" xref="S5.E17.m1.1.2.3.2.2.cmml">A</mi><mi id="S5.E17.m1.1.2.3.2.3" mathvariant="normal" xref="S5.E17.m1.1.2.3.2.3.cmml">M</mi></msub><mo id="S5.E17.m1.1.2.3.1" xref="S5.E17.m1.1.2.3.1.cmml">⁢</mo><msup id="S5.E17.m1.1.2.3.3" xref="S5.E17.m1.1.2.3.3.cmml"><mrow id="S5.E17.m1.1.2.3.3.2.2" xref="S5.E17.m1.1.1.cmml"><mo id="S5.E17.m1.1.2.3.3.2.2.1" xref="S5.E17.m1.1.1.cmml">(</mo><mfrac id="S5.E17.m1.1.1" xref="S5.E17.m1.1.1.cmml"><msub id="S5.E17.m1.1.1.2" xref="S5.E17.m1.1.1.2.cmml"><mi id="S5.E17.m1.1.1.2.2" xref="S5.E17.m1.1.1.2.2.cmml">V</mi><mi id="S5.E17.m1.1.1.2.3" xref="S5.E17.m1.1.1.2.3.cmml">vir</mi></msub><mrow id="S5.E17.m1.1.1.3" xref="S5.E17.m1.1.1.3.cmml"><mn id="S5.E17.m1.1.1.3.2" xref="S5.E17.m1.1.1.3.2.cmml">125</mn><mo id="S5.E17.m1.1.1.3.1" xref="S5.E17.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.E17.m1.1.1.3.3" mathvariant="normal" xref="S5.E17.m1.1.1.3.3.cmml">k</mi><mo id="S5.E17.m1.1.1.3.1a" xref="S5.E17.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.E17.m1.1.1.3.4" mathvariant="normal" xref="S5.E17.m1.1.1.3.4.cmml">m</mi><mo id="S5.E17.m1.1.1.3.1b" lspace="0.280em" xref="S5.E17.m1.1.1.3.1.cmml">⁢</mo><msup id="S5.E17.m1.1.1.3.5" xref="S5.E17.m1.1.1.3.5.cmml"><mi id="S5.E17.m1.1.1.3.5.2" mathvariant="normal" xref="S5.E17.m1.1.1.3.5.2.cmml">s</mi><mrow id="S5.E17.m1.1.1.3.5.3" xref="S5.E17.m1.1.1.3.5.3.cmml"><mo id="S5.E17.m1.1.1.3.5.3a" xref="S5.E17.m1.1.1.3.5.3.cmml">−</mo><mn id="S5.E17.m1.1.1.3.5.3.2" xref="S5.E17.m1.1.1.3.5.3.2.cmml">1</mn></mrow></msup></mrow></mfrac><mo id="S5.E17.m1.1.2.3.3.2.2.2" xref="S5.E17.m1.1.1.cmml">)</mo></mrow><msub id="S5.E17.m1.1.2.3.3.3" xref="S5.E17.m1.1.2.3.3.3.cmml"><mi id="S5.E17.m1.1.2.3.3.3.2" xref="S5.E17.m1.1.2.3.3.3.2.cmml">α</mi><mi id="S5.E17.m1.1.2.3.3.3.3" mathvariant="normal" xref="S5.E17.m1.1.2.3.3.3.3.cmml">M</mi></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E17.m1.1b"><apply id="S5.E17.m1.1.2.cmml" xref="S5.E17.m1.1.2"><eq id="S5.E17.m1.1.2.1.cmml" xref="S5.E17.m1.1.2.1"></eq><apply id="S5.E17.m1.1.2.2.cmml" xref="S5.E17.m1.1.2.2"><csymbol cd="ambiguous" id="S5.E17.m1.1.2.2.1.cmml" xref="S5.E17.m1.1.2.2">subscript</csymbol><ci id="S5.E17.m1.1.2.2.2.cmml" xref="S5.E17.m1.1.2.2.2">𝜂</ci><ci id="S5.E17.m1.1.2.2.3.cmml" xref="S5.E17.m1.1.2.2.3">M</ci></apply><apply id="S5.E17.m1.1.2.3.cmml" xref="S5.E17.m1.1.2.3"><times id="S5.E17.m1.1.2.3.1.cmml" xref="S5.E17.m1.1.2.3.1"></times><apply id="S5.E17.m1.1.2.3.2.cmml" xref="S5.E17.m1.1.2.3.2"><csymbol cd="ambiguous" id="S5.E17.m1.1.2.3.2.1.cmml" xref="S5.E17.m1.1.2.3.2">subscript</csymbol><ci id="S5.E17.m1.1.2.3.2.2.cmml" xref="S5.E17.m1.1.2.3.2.2">𝐴</ci><ci id="S5.E17.m1.1.2.3.2.3.cmml" xref="S5.E17.m1.1.2.3.2.3">M</ci></apply><apply id="S5.E17.m1.1.2.3.3.cmml" xref="S5.E17.m1.1.2.3.3"><csymbol cd="ambiguous" id="S5.E17.m1.1.2.3.3.1.cmml" xref="S5.E17.m1.1.2.3.3">superscript</csymbol><apply id="S5.E17.m1.1.1.cmml" xref="S5.E17.m1.1.2.3.3.2.2"><divide id="S5.E17.m1.1.1.1.cmml" xref="S5.E17.m1.1.2.3.3.2.2"></divide><apply id="S5.E17.m1.1.1.2.cmml" xref="S5.E17.m1.1.1.2"><csymbol cd="ambiguous" id="S5.E17.m1.1.1.2.1.cmml" xref="S5.E17.m1.1.1.2">subscript</csymbol><ci id="S5.E17.m1.1.1.2.2.cmml" xref="S5.E17.m1.1.1.2.2">𝑉</ci><ci id="S5.E17.m1.1.1.2.3.cmml" xref="S5.E17.m1.1.1.2.3">vir</ci></apply><apply id="S5.E17.m1.1.1.3.cmml" xref="S5.E17.m1.1.1.3"><times id="S5.E17.m1.1.1.3.1.cmml" xref="S5.E17.m1.1.1.3.1"></times><cn id="S5.E17.m1.1.1.3.2.cmml" type="integer" xref="S5.E17.m1.1.1.3.2">125</cn><ci id="S5.E17.m1.1.1.3.3.cmml" xref="S5.E17.m1.1.1.3.3">k</ci><ci id="S5.E17.m1.1.1.3.4.cmml" xref="S5.E17.m1.1.1.3.4">m</ci><apply id="S5.E17.m1.1.1.3.5.cmml" xref="S5.E17.m1.1.1.3.5"><csymbol cd="ambiguous" id="S5.E17.m1.1.1.3.5.1.cmml" xref="S5.E17.m1.1.1.3.5">superscript</csymbol><ci id="S5.E17.m1.1.1.3.5.2.cmml" xref="S5.E17.m1.1.1.3.5.2">s</ci><apply id="S5.E17.m1.1.1.3.5.3.cmml" xref="S5.E17.m1.1.1.3.5.3"><minus id="S5.E17.m1.1.1.3.5.3.1.cmml" xref="S5.E17.m1.1.1.3.5.3"></minus><cn id="S5.E17.m1.1.1.3.5.3.2.cmml" type="integer" xref="S5.E17.m1.1.1.3.5.3.2">1</cn></apply></apply></apply></apply><apply id="S5.E17.m1.1.2.3.3.3.cmml" xref="S5.E17.m1.1.2.3.3.3"><csymbol cd="ambiguous" id="S5.E17.m1.1.2.3.3.3.1.cmml" xref="S5.E17.m1.1.2.3.3.3">subscript</csymbol><ci id="S5.E17.m1.1.2.3.3.3.2.cmml" xref="S5.E17.m1.1.2.3.3.3.2">𝛼</ci><ci id="S5.E17.m1.1.2.3.3.3.3.cmml" xref="S5.E17.m1.1.2.3.3.3.3">M</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E17.m1.1c">\eta_{\rm M}=A_{\rm M}\left(\frac{V_{\rm vir}}{125\rm{km\;s^{-1}}}\right)^{%
\alpha_{\rm M}}</annotation><annotation encoding="application/x-llamapun" id="S5.E17.m1.1d">italic_η start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT = italic_A start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT ( divide start_ARG italic_V start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT end_ARG start_ARG 125 roman_k roman_m roman_s start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT end_ARG ) start_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S5.SS6.p3">
<table class="ltx_equation ltx_eqn_table" id="S5.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\eta_{\rm E}=A_{\rm E}\left(\frac{V_{\rm vir}}{125\rm{km\;s^{-1}}}\right)^{%
\alpha_{\rm E}}" class="ltx_Math" display="block" id="S5.E18.m1.1"><semantics id="S5.E18.m1.1a"><mrow id="S5.E18.m1.1.2" xref="S5.E18.m1.1.2.cmml"><msub id="S5.E18.m1.1.2.2" xref="S5.E18.m1.1.2.2.cmml"><mi id="S5.E18.m1.1.2.2.2" xref="S5.E18.m1.1.2.2.2.cmml">η</mi><mi id="S5.E18.m1.1.2.2.3" mathvariant="normal" xref="S5.E18.m1.1.2.2.3.cmml">E</mi></msub><mo id="S5.E18.m1.1.2.1" xref="S5.E18.m1.1.2.1.cmml">=</mo><mrow id="S5.E18.m1.1.2.3" xref="S5.E18.m1.1.2.3.cmml"><msub id="S5.E18.m1.1.2.3.2" xref="S5.E18.m1.1.2.3.2.cmml"><mi id="S5.E18.m1.1.2.3.2.2" xref="S5.E18.m1.1.2.3.2.2.cmml">A</mi><mi id="S5.E18.m1.1.2.3.2.3" mathvariant="normal" xref="S5.E18.m1.1.2.3.2.3.cmml">E</mi></msub><mo id="S5.E18.m1.1.2.3.1" xref="S5.E18.m1.1.2.3.1.cmml">⁢</mo><msup id="S5.E18.m1.1.2.3.3" xref="S5.E18.m1.1.2.3.3.cmml"><mrow id="S5.E18.m1.1.2.3.3.2.2" xref="S5.E18.m1.1.1.cmml"><mo id="S5.E18.m1.1.2.3.3.2.2.1" xref="S5.E18.m1.1.1.cmml">(</mo><mfrac id="S5.E18.m1.1.1" xref="S5.E18.m1.1.1.cmml"><msub id="S5.E18.m1.1.1.2" xref="S5.E18.m1.1.1.2.cmml"><mi id="S5.E18.m1.1.1.2.2" xref="S5.E18.m1.1.1.2.2.cmml">V</mi><mi id="S5.E18.m1.1.1.2.3" xref="S5.E18.m1.1.1.2.3.cmml">vir</mi></msub><mrow id="S5.E18.m1.1.1.3" xref="S5.E18.m1.1.1.3.cmml"><mn id="S5.E18.m1.1.1.3.2" xref="S5.E18.m1.1.1.3.2.cmml">125</mn><mo id="S5.E18.m1.1.1.3.1" xref="S5.E18.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.E18.m1.1.1.3.3" mathvariant="normal" xref="S5.E18.m1.1.1.3.3.cmml">k</mi><mo id="S5.E18.m1.1.1.3.1a" xref="S5.E18.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.E18.m1.1.1.3.4" mathvariant="normal" xref="S5.E18.m1.1.1.3.4.cmml">m</mi><mo id="S5.E18.m1.1.1.3.1b" lspace="0.280em" xref="S5.E18.m1.1.1.3.1.cmml">⁢</mo><msup id="S5.E18.m1.1.1.3.5" xref="S5.E18.m1.1.1.3.5.cmml"><mi id="S5.E18.m1.1.1.3.5.2" mathvariant="normal" xref="S5.E18.m1.1.1.3.5.2.cmml">s</mi><mrow id="S5.E18.m1.1.1.3.5.3" xref="S5.E18.m1.1.1.3.5.3.cmml"><mo id="S5.E18.m1.1.1.3.5.3a" xref="S5.E18.m1.1.1.3.5.3.cmml">−</mo><mn id="S5.E18.m1.1.1.3.5.3.2" xref="S5.E18.m1.1.1.3.5.3.2.cmml">1</mn></mrow></msup></mrow></mfrac><mo id="S5.E18.m1.1.2.3.3.2.2.2" xref="S5.E18.m1.1.1.cmml">)</mo></mrow><msub id="S5.E18.m1.1.2.3.3.3" xref="S5.E18.m1.1.2.3.3.3.cmml"><mi id="S5.E18.m1.1.2.3.3.3.2" xref="S5.E18.m1.1.2.3.3.3.2.cmml">α</mi><mi id="S5.E18.m1.1.2.3.3.3.3" mathvariant="normal" xref="S5.E18.m1.1.2.3.3.3.3.cmml">E</mi></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E18.m1.1b"><apply id="S5.E18.m1.1.2.cmml" xref="S5.E18.m1.1.2"><eq id="S5.E18.m1.1.2.1.cmml" xref="S5.E18.m1.1.2.1"></eq><apply id="S5.E18.m1.1.2.2.cmml" xref="S5.E18.m1.1.2.2"><csymbol cd="ambiguous" id="S5.E18.m1.1.2.2.1.cmml" xref="S5.E18.m1.1.2.2">subscript</csymbol><ci id="S5.E18.m1.1.2.2.2.cmml" xref="S5.E18.m1.1.2.2.2">𝜂</ci><ci id="S5.E18.m1.1.2.2.3.cmml" xref="S5.E18.m1.1.2.2.3">E</ci></apply><apply id="S5.E18.m1.1.2.3.cmml" xref="S5.E18.m1.1.2.3"><times id="S5.E18.m1.1.2.3.1.cmml" xref="S5.E18.m1.1.2.3.1"></times><apply id="S5.E18.m1.1.2.3.2.cmml" xref="S5.E18.m1.1.2.3.2"><csymbol cd="ambiguous" id="S5.E18.m1.1.2.3.2.1.cmml" xref="S5.E18.m1.1.2.3.2">subscript</csymbol><ci id="S5.E18.m1.1.2.3.2.2.cmml" xref="S5.E18.m1.1.2.3.2.2">𝐴</ci><ci id="S5.E18.m1.1.2.3.2.3.cmml" xref="S5.E18.m1.1.2.3.2.3">E</ci></apply><apply id="S5.E18.m1.1.2.3.3.cmml" xref="S5.E18.m1.1.2.3.3"><csymbol cd="ambiguous" id="S5.E18.m1.1.2.3.3.1.cmml" xref="S5.E18.m1.1.2.3.3">superscript</csymbol><apply id="S5.E18.m1.1.1.cmml" xref="S5.E18.m1.1.2.3.3.2.2"><divide id="S5.E18.m1.1.1.1.cmml" xref="S5.E18.m1.1.2.3.3.2.2"></divide><apply id="S5.E18.m1.1.1.2.cmml" xref="S5.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S5.E18.m1.1.1.2.1.cmml" xref="S5.E18.m1.1.1.2">subscript</csymbol><ci id="S5.E18.m1.1.1.2.2.cmml" xref="S5.E18.m1.1.1.2.2">𝑉</ci><ci id="S5.E18.m1.1.1.2.3.cmml" xref="S5.E18.m1.1.1.2.3">vir</ci></apply><apply id="S5.E18.m1.1.1.3.cmml" xref="S5.E18.m1.1.1.3"><times id="S5.E18.m1.1.1.3.1.cmml" xref="S5.E18.m1.1.1.3.1"></times><cn id="S5.E18.m1.1.1.3.2.cmml" type="integer" xref="S5.E18.m1.1.1.3.2">125</cn><ci id="S5.E18.m1.1.1.3.3.cmml" xref="S5.E18.m1.1.1.3.3">k</ci><ci id="S5.E18.m1.1.1.3.4.cmml" xref="S5.E18.m1.1.1.3.4">m</ci><apply id="S5.E18.m1.1.1.3.5.cmml" xref="S5.E18.m1.1.1.3.5"><csymbol cd="ambiguous" id="S5.E18.m1.1.1.3.5.1.cmml" xref="S5.E18.m1.1.1.3.5">superscript</csymbol><ci id="S5.E18.m1.1.1.3.5.2.cmml" xref="S5.E18.m1.1.1.3.5.2">s</ci><apply id="S5.E18.m1.1.1.3.5.3.cmml" xref="S5.E18.m1.1.1.3.5.3"><minus id="S5.E18.m1.1.1.3.5.3.1.cmml" xref="S5.E18.m1.1.1.3.5.3"></minus><cn id="S5.E18.m1.1.1.3.5.3.2.cmml" type="integer" xref="S5.E18.m1.1.1.3.5.3.2">1</cn></apply></apply></apply></apply><apply id="S5.E18.m1.1.2.3.3.3.cmml" xref="S5.E18.m1.1.2.3.3.3"><csymbol cd="ambiguous" id="S5.E18.m1.1.2.3.3.3.1.cmml" xref="S5.E18.m1.1.2.3.3.3">subscript</csymbol><ci id="S5.E18.m1.1.2.3.3.3.2.cmml" xref="S5.E18.m1.1.2.3.3.3.2">𝛼</ci><ci id="S5.E18.m1.1.2.3.3.3.3.cmml" xref="S5.E18.m1.1.2.3.3.3.3">E</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E18.m1.1c">\eta_{\rm E}=A_{\rm E}\left(\frac{V_{\rm vir}}{125\rm{km\;s^{-1}}}\right)^{%
\alpha_{\rm E}}</annotation><annotation encoding="application/x-llamapun" id="S5.E18.m1.1d">italic_η start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT = italic_A start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT ( divide start_ARG italic_V start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT end_ARG start_ARG 125 roman_k roman_m roman_s start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT end_ARG ) start_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S5.SS6.p4">
<p class="ltx_p" id="S5.SS6.p4.10">Here, <math alttext="A_{\rm M}" class="ltx_Math" display="inline" id="S5.SS6.p4.1.m1.1"><semantics id="S5.SS6.p4.1.m1.1a"><msub id="S5.SS6.p4.1.m1.1.1" xref="S5.SS6.p4.1.m1.1.1.cmml"><mi id="S5.SS6.p4.1.m1.1.1.2" xref="S5.SS6.p4.1.m1.1.1.2.cmml">A</mi><mi id="S5.SS6.p4.1.m1.1.1.3" mathvariant="normal" xref="S5.SS6.p4.1.m1.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.1.m1.1b"><apply id="S5.SS6.p4.1.m1.1.1.cmml" xref="S5.SS6.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS6.p4.1.m1.1.1.1.cmml" xref="S5.SS6.p4.1.m1.1.1">subscript</csymbol><ci id="S5.SS6.p4.1.m1.1.1.2.cmml" xref="S5.SS6.p4.1.m1.1.1.2">𝐴</ci><ci id="S5.SS6.p4.1.m1.1.1.3.cmml" xref="S5.SS6.p4.1.m1.1.1.3">M</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.1.m1.1c">A_{\rm M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.1.m1.1d">italic_A start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\alpha_{\rm M}" class="ltx_Math" display="inline" id="S5.SS6.p4.2.m2.1"><semantics id="S5.SS6.p4.2.m2.1a"><msub id="S5.SS6.p4.2.m2.1.1" xref="S5.SS6.p4.2.m2.1.1.cmml"><mi id="S5.SS6.p4.2.m2.1.1.2" xref="S5.SS6.p4.2.m2.1.1.2.cmml">α</mi><mi id="S5.SS6.p4.2.m2.1.1.3" mathvariant="normal" xref="S5.SS6.p4.2.m2.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.2.m2.1b"><apply id="S5.SS6.p4.2.m2.1.1.cmml" xref="S5.SS6.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS6.p4.2.m2.1.1.1.cmml" xref="S5.SS6.p4.2.m2.1.1">subscript</csymbol><ci id="S5.SS6.p4.2.m2.1.1.2.cmml" xref="S5.SS6.p4.2.m2.1.1.2">𝛼</ci><ci id="S5.SS6.p4.2.m2.1.1.3.cmml" xref="S5.SS6.p4.2.m2.1.1.3">M</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.2.m2.1c">\alpha_{\rm M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.2.m2.1d">italic_α start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="A_{\rm E}" class="ltx_Math" display="inline" id="S5.SS6.p4.3.m3.1"><semantics id="S5.SS6.p4.3.m3.1a"><msub id="S5.SS6.p4.3.m3.1.1" xref="S5.SS6.p4.3.m3.1.1.cmml"><mi id="S5.SS6.p4.3.m3.1.1.2" xref="S5.SS6.p4.3.m3.1.1.2.cmml">A</mi><mi id="S5.SS6.p4.3.m3.1.1.3" mathvariant="normal" xref="S5.SS6.p4.3.m3.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.3.m3.1b"><apply id="S5.SS6.p4.3.m3.1.1.cmml" xref="S5.SS6.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS6.p4.3.m3.1.1.1.cmml" xref="S5.SS6.p4.3.m3.1.1">subscript</csymbol><ci id="S5.SS6.p4.3.m3.1.1.2.cmml" xref="S5.SS6.p4.3.m3.1.1.2">𝐴</ci><ci id="S5.SS6.p4.3.m3.1.1.3.cmml" xref="S5.SS6.p4.3.m3.1.1.3">E</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.3.m3.1c">A_{\rm E}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.3.m3.1d">italic_A start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\alpha_{\rm E}" class="ltx_Math" display="inline" id="S5.SS6.p4.4.m4.1"><semantics id="S5.SS6.p4.4.m4.1a"><msub id="S5.SS6.p4.4.m4.1.1" xref="S5.SS6.p4.4.m4.1.1.cmml"><mi id="S5.SS6.p4.4.m4.1.1.2" xref="S5.SS6.p4.4.m4.1.1.2.cmml">α</mi><mi id="S5.SS6.p4.4.m4.1.1.3" mathvariant="normal" xref="S5.SS6.p4.4.m4.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.4.m4.1b"><apply id="S5.SS6.p4.4.m4.1.1.cmml" xref="S5.SS6.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS6.p4.4.m4.1.1.1.cmml" xref="S5.SS6.p4.4.m4.1.1">subscript</csymbol><ci id="S5.SS6.p4.4.m4.1.1.2.cmml" xref="S5.SS6.p4.4.m4.1.1.2">𝛼</ci><ci id="S5.SS6.p4.4.m4.1.1.3.cmml" xref="S5.SS6.p4.4.m4.1.1.3">E</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.4.m4.1c">\alpha_{\rm E}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.4.m4.1d">italic_α start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT</annotation></semantics></math> are hyperparameters that govern these power law scalings, and we have ignored any redshift dependence. We generate 5,000 model realizations on a Latin hypercube by uniformly sampling combinations of <math alttext="A_{\rm M}\in[0.01,100]" class="ltx_Math" display="inline" id="S5.SS6.p4.5.m5.2"><semantics id="S5.SS6.p4.5.m5.2a"><mrow id="S5.SS6.p4.5.m5.2.3" xref="S5.SS6.p4.5.m5.2.3.cmml"><msub id="S5.SS6.p4.5.m5.2.3.2" xref="S5.SS6.p4.5.m5.2.3.2.cmml"><mi id="S5.SS6.p4.5.m5.2.3.2.2" xref="S5.SS6.p4.5.m5.2.3.2.2.cmml">A</mi><mi id="S5.SS6.p4.5.m5.2.3.2.3" mathvariant="normal" xref="S5.SS6.p4.5.m5.2.3.2.3.cmml">M</mi></msub><mo id="S5.SS6.p4.5.m5.2.3.1" xref="S5.SS6.p4.5.m5.2.3.1.cmml">∈</mo><mrow id="S5.SS6.p4.5.m5.2.3.3.2" xref="S5.SS6.p4.5.m5.2.3.3.1.cmml"><mo id="S5.SS6.p4.5.m5.2.3.3.2.1" stretchy="false" xref="S5.SS6.p4.5.m5.2.3.3.1.cmml">[</mo><mn id="S5.SS6.p4.5.m5.1.1" xref="S5.SS6.p4.5.m5.1.1.cmml">0.01</mn><mo id="S5.SS6.p4.5.m5.2.3.3.2.2" xref="S5.SS6.p4.5.m5.2.3.3.1.cmml">,</mo><mn id="S5.SS6.p4.5.m5.2.2" xref="S5.SS6.p4.5.m5.2.2.cmml">100</mn><mo id="S5.SS6.p4.5.m5.2.3.3.2.3" stretchy="false" xref="S5.SS6.p4.5.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.5.m5.2b"><apply id="S5.SS6.p4.5.m5.2.3.cmml" xref="S5.SS6.p4.5.m5.2.3"><in id="S5.SS6.p4.5.m5.2.3.1.cmml" xref="S5.SS6.p4.5.m5.2.3.1"></in><apply id="S5.SS6.p4.5.m5.2.3.2.cmml" xref="S5.SS6.p4.5.m5.2.3.2"><csymbol cd="ambiguous" id="S5.SS6.p4.5.m5.2.3.2.1.cmml" xref="S5.SS6.p4.5.m5.2.3.2">subscript</csymbol><ci id="S5.SS6.p4.5.m5.2.3.2.2.cmml" xref="S5.SS6.p4.5.m5.2.3.2.2">𝐴</ci><ci id="S5.SS6.p4.5.m5.2.3.2.3.cmml" xref="S5.SS6.p4.5.m5.2.3.2.3">M</ci></apply><interval closure="closed" id="S5.SS6.p4.5.m5.2.3.3.1.cmml" xref="S5.SS6.p4.5.m5.2.3.3.2"><cn id="S5.SS6.p4.5.m5.1.1.cmml" type="float" xref="S5.SS6.p4.5.m5.1.1">0.01</cn><cn id="S5.SS6.p4.5.m5.2.2.cmml" type="integer" xref="S5.SS6.p4.5.m5.2.2">100</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.5.m5.2c">A_{\rm M}\in[0.01,100]</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.5.m5.2d">italic_A start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT ∈ [ 0.01 , 100 ]</annotation></semantics></math>, <math alttext="\alpha_{\rm M}\in[-2,2]" class="ltx_Math" display="inline" id="S5.SS6.p4.6.m6.2"><semantics id="S5.SS6.p4.6.m6.2a"><mrow id="S5.SS6.p4.6.m6.2.2" xref="S5.SS6.p4.6.m6.2.2.cmml"><msub id="S5.SS6.p4.6.m6.2.2.3" xref="S5.SS6.p4.6.m6.2.2.3.cmml"><mi id="S5.SS6.p4.6.m6.2.2.3.2" xref="S5.SS6.p4.6.m6.2.2.3.2.cmml">α</mi><mi id="S5.SS6.p4.6.m6.2.2.3.3" mathvariant="normal" xref="S5.SS6.p4.6.m6.2.2.3.3.cmml">M</mi></msub><mo id="S5.SS6.p4.6.m6.2.2.2" xref="S5.SS6.p4.6.m6.2.2.2.cmml">∈</mo><mrow id="S5.SS6.p4.6.m6.2.2.1.1" xref="S5.SS6.p4.6.m6.2.2.1.2.cmml"><mo id="S5.SS6.p4.6.m6.2.2.1.1.2" stretchy="false" xref="S5.SS6.p4.6.m6.2.2.1.2.cmml">[</mo><mrow id="S5.SS6.p4.6.m6.2.2.1.1.1" xref="S5.SS6.p4.6.m6.2.2.1.1.1.cmml"><mo id="S5.SS6.p4.6.m6.2.2.1.1.1a" xref="S5.SS6.p4.6.m6.2.2.1.1.1.cmml">−</mo><mn id="S5.SS6.p4.6.m6.2.2.1.1.1.2" xref="S5.SS6.p4.6.m6.2.2.1.1.1.2.cmml">2</mn></mrow><mo id="S5.SS6.p4.6.m6.2.2.1.1.3" xref="S5.SS6.p4.6.m6.2.2.1.2.cmml">,</mo><mn id="S5.SS6.p4.6.m6.1.1" xref="S5.SS6.p4.6.m6.1.1.cmml">2</mn><mo id="S5.SS6.p4.6.m6.2.2.1.1.4" stretchy="false" xref="S5.SS6.p4.6.m6.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.6.m6.2b"><apply id="S5.SS6.p4.6.m6.2.2.cmml" xref="S5.SS6.p4.6.m6.2.2"><in id="S5.SS6.p4.6.m6.2.2.2.cmml" xref="S5.SS6.p4.6.m6.2.2.2"></in><apply id="S5.SS6.p4.6.m6.2.2.3.cmml" xref="S5.SS6.p4.6.m6.2.2.3"><csymbol cd="ambiguous" id="S5.SS6.p4.6.m6.2.2.3.1.cmml" xref="S5.SS6.p4.6.m6.2.2.3">subscript</csymbol><ci id="S5.SS6.p4.6.m6.2.2.3.2.cmml" xref="S5.SS6.p4.6.m6.2.2.3.2">𝛼</ci><ci id="S5.SS6.p4.6.m6.2.2.3.3.cmml" xref="S5.SS6.p4.6.m6.2.2.3.3">M</ci></apply><interval closure="closed" id="S5.SS6.p4.6.m6.2.2.1.2.cmml" xref="S5.SS6.p4.6.m6.2.2.1.1"><apply id="S5.SS6.p4.6.m6.2.2.1.1.1.cmml" xref="S5.SS6.p4.6.m6.2.2.1.1.1"><minus id="S5.SS6.p4.6.m6.2.2.1.1.1.1.cmml" xref="S5.SS6.p4.6.m6.2.2.1.1.1"></minus><cn id="S5.SS6.p4.6.m6.2.2.1.1.1.2.cmml" type="integer" xref="S5.SS6.p4.6.m6.2.2.1.1.1.2">2</cn></apply><cn id="S5.SS6.p4.6.m6.1.1.cmml" type="integer" xref="S5.SS6.p4.6.m6.1.1">2</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.6.m6.2c">\alpha_{\rm M}\in[-2,2]</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.6.m6.2d">italic_α start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT ∈ [ - 2 , 2 ]</annotation></semantics></math>, <math alttext="A_{\rm E}\in[0.01,1]" class="ltx_Math" display="inline" id="S5.SS6.p4.7.m7.2"><semantics id="S5.SS6.p4.7.m7.2a"><mrow id="S5.SS6.p4.7.m7.2.3" xref="S5.SS6.p4.7.m7.2.3.cmml"><msub id="S5.SS6.p4.7.m7.2.3.2" xref="S5.SS6.p4.7.m7.2.3.2.cmml"><mi id="S5.SS6.p4.7.m7.2.3.2.2" xref="S5.SS6.p4.7.m7.2.3.2.2.cmml">A</mi><mi id="S5.SS6.p4.7.m7.2.3.2.3" mathvariant="normal" xref="S5.SS6.p4.7.m7.2.3.2.3.cmml">E</mi></msub><mo id="S5.SS6.p4.7.m7.2.3.1" xref="S5.SS6.p4.7.m7.2.3.1.cmml">∈</mo><mrow id="S5.SS6.p4.7.m7.2.3.3.2" xref="S5.SS6.p4.7.m7.2.3.3.1.cmml"><mo id="S5.SS6.p4.7.m7.2.3.3.2.1" stretchy="false" xref="S5.SS6.p4.7.m7.2.3.3.1.cmml">[</mo><mn id="S5.SS6.p4.7.m7.1.1" xref="S5.SS6.p4.7.m7.1.1.cmml">0.01</mn><mo id="S5.SS6.p4.7.m7.2.3.3.2.2" xref="S5.SS6.p4.7.m7.2.3.3.1.cmml">,</mo><mn id="S5.SS6.p4.7.m7.2.2" xref="S5.SS6.p4.7.m7.2.2.cmml">1</mn><mo id="S5.SS6.p4.7.m7.2.3.3.2.3" stretchy="false" xref="S5.SS6.p4.7.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.7.m7.2b"><apply id="S5.SS6.p4.7.m7.2.3.cmml" xref="S5.SS6.p4.7.m7.2.3"><in id="S5.SS6.p4.7.m7.2.3.1.cmml" xref="S5.SS6.p4.7.m7.2.3.1"></in><apply id="S5.SS6.p4.7.m7.2.3.2.cmml" xref="S5.SS6.p4.7.m7.2.3.2"><csymbol cd="ambiguous" id="S5.SS6.p4.7.m7.2.3.2.1.cmml" xref="S5.SS6.p4.7.m7.2.3.2">subscript</csymbol><ci id="S5.SS6.p4.7.m7.2.3.2.2.cmml" xref="S5.SS6.p4.7.m7.2.3.2.2">𝐴</ci><ci id="S5.SS6.p4.7.m7.2.3.2.3.cmml" xref="S5.SS6.p4.7.m7.2.3.2.3">E</ci></apply><interval closure="closed" id="S5.SS6.p4.7.m7.2.3.3.1.cmml" xref="S5.SS6.p4.7.m7.2.3.3.2"><cn id="S5.SS6.p4.7.m7.1.1.cmml" type="float" xref="S5.SS6.p4.7.m7.1.1">0.01</cn><cn id="S5.SS6.p4.7.m7.2.2.cmml" type="integer" xref="S5.SS6.p4.7.m7.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.7.m7.2c">A_{\rm E}\in[0.01,1]</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.7.m7.2d">italic_A start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT ∈ [ 0.01 , 1 ]</annotation></semantics></math> and <math alttext="\alpha_{\rm E}\in[-2,2]" class="ltx_Math" display="inline" id="S5.SS6.p4.8.m8.2"><semantics id="S5.SS6.p4.8.m8.2a"><mrow id="S5.SS6.p4.8.m8.2.2" xref="S5.SS6.p4.8.m8.2.2.cmml"><msub id="S5.SS6.p4.8.m8.2.2.3" xref="S5.SS6.p4.8.m8.2.2.3.cmml"><mi id="S5.SS6.p4.8.m8.2.2.3.2" xref="S5.SS6.p4.8.m8.2.2.3.2.cmml">α</mi><mi id="S5.SS6.p4.8.m8.2.2.3.3" mathvariant="normal" xref="S5.SS6.p4.8.m8.2.2.3.3.cmml">E</mi></msub><mo id="S5.SS6.p4.8.m8.2.2.2" xref="S5.SS6.p4.8.m8.2.2.2.cmml">∈</mo><mrow id="S5.SS6.p4.8.m8.2.2.1.1" xref="S5.SS6.p4.8.m8.2.2.1.2.cmml"><mo id="S5.SS6.p4.8.m8.2.2.1.1.2" stretchy="false" xref="S5.SS6.p4.8.m8.2.2.1.2.cmml">[</mo><mrow id="S5.SS6.p4.8.m8.2.2.1.1.1" xref="S5.SS6.p4.8.m8.2.2.1.1.1.cmml"><mo id="S5.SS6.p4.8.m8.2.2.1.1.1a" xref="S5.SS6.p4.8.m8.2.2.1.1.1.cmml">−</mo><mn id="S5.SS6.p4.8.m8.2.2.1.1.1.2" xref="S5.SS6.p4.8.m8.2.2.1.1.1.2.cmml">2</mn></mrow><mo id="S5.SS6.p4.8.m8.2.2.1.1.3" xref="S5.SS6.p4.8.m8.2.2.1.2.cmml">,</mo><mn id="S5.SS6.p4.8.m8.1.1" xref="S5.SS6.p4.8.m8.1.1.cmml">2</mn><mo id="S5.SS6.p4.8.m8.2.2.1.1.4" stretchy="false" xref="S5.SS6.p4.8.m8.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.8.m8.2b"><apply id="S5.SS6.p4.8.m8.2.2.cmml" xref="S5.SS6.p4.8.m8.2.2"><in id="S5.SS6.p4.8.m8.2.2.2.cmml" xref="S5.SS6.p4.8.m8.2.2.2"></in><apply id="S5.SS6.p4.8.m8.2.2.3.cmml" xref="S5.SS6.p4.8.m8.2.2.3"><csymbol cd="ambiguous" id="S5.SS6.p4.8.m8.2.2.3.1.cmml" xref="S5.SS6.p4.8.m8.2.2.3">subscript</csymbol><ci id="S5.SS6.p4.8.m8.2.2.3.2.cmml" xref="S5.SS6.p4.8.m8.2.2.3.2">𝛼</ci><ci id="S5.SS6.p4.8.m8.2.2.3.3.cmml" xref="S5.SS6.p4.8.m8.2.2.3.3">E</ci></apply><interval closure="closed" id="S5.SS6.p4.8.m8.2.2.1.2.cmml" xref="S5.SS6.p4.8.m8.2.2.1.1"><apply id="S5.SS6.p4.8.m8.2.2.1.1.1.cmml" xref="S5.SS6.p4.8.m8.2.2.1.1.1"><minus id="S5.SS6.p4.8.m8.2.2.1.1.1.1.cmml" xref="S5.SS6.p4.8.m8.2.2.1.1.1"></minus><cn id="S5.SS6.p4.8.m8.2.2.1.1.1.2.cmml" type="integer" xref="S5.SS6.p4.8.m8.2.2.1.1.1.2">2</cn></apply><cn id="S5.SS6.p4.8.m8.1.1.cmml" type="integer" xref="S5.SS6.p4.8.m8.1.1">2</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.8.m8.2c">\alpha_{\rm E}\in[-2,2]</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.8.m8.2d">italic_α start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT ∈ [ - 2 , 2 ]</annotation></semantics></math>. All other parameters of the model were fixed to reasonable values following <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx141" title="">Pandya <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Pandya, Fielding, Bryan, Carr, Somerville, Stern, Faucher-Giguère, Hafen, Anglés-Alcázar, and Forbes</a></cite>. With these parameters, the system of ordinary differential equations describing the model (Equations 1, 2, and 4-8 of <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx141" title="">Pandya <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Pandya, Fielding, Bryan, Carr, Somerville, Stern, Faucher-Giguère, Hafen, Anglés-Alcázar, and Forbes</a></cite>) is evolved using mass accretion histories of 120 halos randomly selected from five subvolumes of the TNG100 simulation <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx142" title="">Pillepich <em class="ltx_emph ltx_font_italic">et al.</em>(2018)Pillepich, Springel, Nelson, Genel, Naiman, Pakmor, Hernquist, Torrey, Vogelsberger, Weinberger, and Marinacci</a>)</cite>. We find that this is a sufficient number of halos to capture variations in the stellar-to-halo-mass relation with model parameters. We restrict to halos with <math alttext="\log M_{\rm vir}/M_{\odot}=10-12.4" class="ltx_Math" display="inline" id="S5.SS6.p4.9.m9.1"><semantics id="S5.SS6.p4.9.m9.1a"><mrow id="S5.SS6.p4.9.m9.1.1" xref="S5.SS6.p4.9.m9.1.1.cmml"><mrow id="S5.SS6.p4.9.m9.1.1.2" xref="S5.SS6.p4.9.m9.1.1.2.cmml"><mi id="S5.SS6.p4.9.m9.1.1.2.1" xref="S5.SS6.p4.9.m9.1.1.2.1.cmml">log</mi><mo id="S5.SS6.p4.9.m9.1.1.2a" lspace="0.167em" xref="S5.SS6.p4.9.m9.1.1.2.cmml">⁡</mo><mrow id="S5.SS6.p4.9.m9.1.1.2.2" xref="S5.SS6.p4.9.m9.1.1.2.2.cmml"><msub id="S5.SS6.p4.9.m9.1.1.2.2.2" xref="S5.SS6.p4.9.m9.1.1.2.2.2.cmml"><mi id="S5.SS6.p4.9.m9.1.1.2.2.2.2" xref="S5.SS6.p4.9.m9.1.1.2.2.2.2.cmml">M</mi><mi id="S5.SS6.p4.9.m9.1.1.2.2.2.3" xref="S5.SS6.p4.9.m9.1.1.2.2.2.3.cmml">vir</mi></msub><mo id="S5.SS6.p4.9.m9.1.1.2.2.1" xref="S5.SS6.p4.9.m9.1.1.2.2.1.cmml">/</mo><msub id="S5.SS6.p4.9.m9.1.1.2.2.3" xref="S5.SS6.p4.9.m9.1.1.2.2.3.cmml"><mi id="S5.SS6.p4.9.m9.1.1.2.2.3.2" xref="S5.SS6.p4.9.m9.1.1.2.2.3.2.cmml">M</mi><mo id="S5.SS6.p4.9.m9.1.1.2.2.3.3" xref="S5.SS6.p4.9.m9.1.1.2.2.3.3.cmml">⊙</mo></msub></mrow></mrow><mo id="S5.SS6.p4.9.m9.1.1.1" xref="S5.SS6.p4.9.m9.1.1.1.cmml">=</mo><mrow id="S5.SS6.p4.9.m9.1.1.3" xref="S5.SS6.p4.9.m9.1.1.3.cmml"><mn id="S5.SS6.p4.9.m9.1.1.3.2" xref="S5.SS6.p4.9.m9.1.1.3.2.cmml">10</mn><mo id="S5.SS6.p4.9.m9.1.1.3.1" xref="S5.SS6.p4.9.m9.1.1.3.1.cmml">−</mo><mn id="S5.SS6.p4.9.m9.1.1.3.3" xref="S5.SS6.p4.9.m9.1.1.3.3.cmml">12.4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.9.m9.1b"><apply id="S5.SS6.p4.9.m9.1.1.cmml" xref="S5.SS6.p4.9.m9.1.1"><eq id="S5.SS6.p4.9.m9.1.1.1.cmml" xref="S5.SS6.p4.9.m9.1.1.1"></eq><apply id="S5.SS6.p4.9.m9.1.1.2.cmml" xref="S5.SS6.p4.9.m9.1.1.2"><log id="S5.SS6.p4.9.m9.1.1.2.1.cmml" xref="S5.SS6.p4.9.m9.1.1.2.1"></log><apply id="S5.SS6.p4.9.m9.1.1.2.2.cmml" xref="S5.SS6.p4.9.m9.1.1.2.2"><divide id="S5.SS6.p4.9.m9.1.1.2.2.1.cmml" xref="S5.SS6.p4.9.m9.1.1.2.2.1"></divide><apply id="S5.SS6.p4.9.m9.1.1.2.2.2.cmml" xref="S5.SS6.p4.9.m9.1.1.2.2.2"><csymbol cd="ambiguous" id="S5.SS6.p4.9.m9.1.1.2.2.2.1.cmml" xref="S5.SS6.p4.9.m9.1.1.2.2.2">subscript</csymbol><ci id="S5.SS6.p4.9.m9.1.1.2.2.2.2.cmml" xref="S5.SS6.p4.9.m9.1.1.2.2.2.2">𝑀</ci><ci id="S5.SS6.p4.9.m9.1.1.2.2.2.3.cmml" xref="S5.SS6.p4.9.m9.1.1.2.2.2.3">vir</ci></apply><apply id="S5.SS6.p4.9.m9.1.1.2.2.3.cmml" xref="S5.SS6.p4.9.m9.1.1.2.2.3"><csymbol cd="ambiguous" id="S5.SS6.p4.9.m9.1.1.2.2.3.1.cmml" xref="S5.SS6.p4.9.m9.1.1.2.2.3">subscript</csymbol><ci id="S5.SS6.p4.9.m9.1.1.2.2.3.2.cmml" xref="S5.SS6.p4.9.m9.1.1.2.2.3.2">𝑀</ci><csymbol cd="latexml" id="S5.SS6.p4.9.m9.1.1.2.2.3.3.cmml" xref="S5.SS6.p4.9.m9.1.1.2.2.3.3">direct-product</csymbol></apply></apply></apply><apply id="S5.SS6.p4.9.m9.1.1.3.cmml" xref="S5.SS6.p4.9.m9.1.1.3"><minus id="S5.SS6.p4.9.m9.1.1.3.1.cmml" xref="S5.SS6.p4.9.m9.1.1.3.1"></minus><cn id="S5.SS6.p4.9.m9.1.1.3.2.cmml" type="integer" xref="S5.SS6.p4.9.m9.1.1.3.2">10</cn><cn id="S5.SS6.p4.9.m9.1.1.3.3.cmml" type="float" xref="S5.SS6.p4.9.m9.1.1.3.3">12.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.9.m9.1c">\log M_{\rm vir}/M_{\odot}=10-12.4</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.9.m9.1d">roman_log italic_M start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT / italic_M start_POSTSUBSCRIPT ⊙ end_POSTSUBSCRIPT = 10 - 12.4</annotation></semantics></math> at <math alttext="z=0" class="ltx_Math" display="inline" id="S5.SS6.p4.10.m10.1"><semantics id="S5.SS6.p4.10.m10.1a"><mrow id="S5.SS6.p4.10.m10.1.1" xref="S5.SS6.p4.10.m10.1.1.cmml"><mi id="S5.SS6.p4.10.m10.1.1.2" xref="S5.SS6.p4.10.m10.1.1.2.cmml">z</mi><mo id="S5.SS6.p4.10.m10.1.1.1" xref="S5.SS6.p4.10.m10.1.1.1.cmml">=</mo><mn id="S5.SS6.p4.10.m10.1.1.3" xref="S5.SS6.p4.10.m10.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.10.m10.1b"><apply id="S5.SS6.p4.10.m10.1.1.cmml" xref="S5.SS6.p4.10.m10.1.1"><eq id="S5.SS6.p4.10.m10.1.1.1.cmml" xref="S5.SS6.p4.10.m10.1.1.1"></eq><ci id="S5.SS6.p4.10.m10.1.1.2.cmml" xref="S5.SS6.p4.10.m10.1.1.2">𝑧</ci><cn id="S5.SS6.p4.10.m10.1.1.3.cmml" type="integer" xref="S5.SS6.p4.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.10.m10.1c">z=0</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.10.m10.1d">italic_z = 0</annotation></semantics></math>, spanning the dwarf and Milky Way regime in which supernova feedback is thought to dominate.
</p>
</div>
<figure class="ltx_figure" id="S5.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="316" id="S5.F10.g1" src="extracted/5393296/figures/sapphire_annotated_full_ili.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Sets of galaxies with properties <math alttext="\textbf{d}=\{(M_{\rm vir},M_{*})\}_{i=1}^{n_{d}=120}" class="ltx_Math" display="inline" id="S5.F10.6.m1.1"><semantics id="S5.F10.6.m1.1b"><mrow id="S5.F10.6.m1.1.1" xref="S5.F10.6.m1.1.1.cmml"><mtext id="S5.F10.6.m1.1.1.3" xref="S5.F10.6.m1.1.1.3a.cmml">𝐝</mtext><mo id="S5.F10.6.m1.1.1.2" xref="S5.F10.6.m1.1.1.2.cmml">=</mo><msubsup id="S5.F10.6.m1.1.1.1" xref="S5.F10.6.m1.1.1.1.cmml"><mrow id="S5.F10.6.m1.1.1.1.1.1.1" xref="S5.F10.6.m1.1.1.1.1.1.2.cmml"><mo id="S5.F10.6.m1.1.1.1.1.1.1.2" stretchy="false" xref="S5.F10.6.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S5.F10.6.m1.1.1.1.1.1.1.1.2" xref="S5.F10.6.m1.1.1.1.1.1.1.1.3.cmml"><mo id="S5.F10.6.m1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S5.F10.6.m1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S5.F10.6.m1.1.1.1.1.1.1.1.1.1" xref="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.2" xref="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.2.cmml">M</mi><mi id="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.3" xref="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.3.cmml">vir</mi></msub><mo id="S5.F10.6.m1.1.1.1.1.1.1.1.2.4" xref="S5.F10.6.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S5.F10.6.m1.1.1.1.1.1.1.1.2.2" xref="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.2" xref="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.2.cmml">M</mi><mo id="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.3" xref="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.3.cmml">*</mo></msub><mo id="S5.F10.6.m1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S5.F10.6.m1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S5.F10.6.m1.1.1.1.1.1.1.3" stretchy="false" xref="S5.F10.6.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S5.F10.6.m1.1.1.1.1.3" xref="S5.F10.6.m1.1.1.1.1.3.cmml"><mi id="S5.F10.6.m1.1.1.1.1.3.2" xref="S5.F10.6.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S5.F10.6.m1.1.1.1.1.3.1" xref="S5.F10.6.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S5.F10.6.m1.1.1.1.1.3.3" xref="S5.F10.6.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S5.F10.6.m1.1.1.1.3" xref="S5.F10.6.m1.1.1.1.3.cmml"><msub id="S5.F10.6.m1.1.1.1.3.2" xref="S5.F10.6.m1.1.1.1.3.2.cmml"><mi id="S5.F10.6.m1.1.1.1.3.2.2" xref="S5.F10.6.m1.1.1.1.3.2.2.cmml">n</mi><mi id="S5.F10.6.m1.1.1.1.3.2.3" xref="S5.F10.6.m1.1.1.1.3.2.3.cmml">d</mi></msub><mo id="S5.F10.6.m1.1.1.1.3.1" xref="S5.F10.6.m1.1.1.1.3.1.cmml">=</mo><mn id="S5.F10.6.m1.1.1.1.3.3" xref="S5.F10.6.m1.1.1.1.3.3.cmml">120</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.F10.6.m1.1c"><apply id="S5.F10.6.m1.1.1.cmml" xref="S5.F10.6.m1.1.1"><eq id="S5.F10.6.m1.1.1.2.cmml" xref="S5.F10.6.m1.1.1.2"></eq><ci id="S5.F10.6.m1.1.1.3a.cmml" xref="S5.F10.6.m1.1.1.3"><mtext id="S5.F10.6.m1.1.1.3.cmml" xref="S5.F10.6.m1.1.1.3">𝐝</mtext></ci><apply id="S5.F10.6.m1.1.1.1.cmml" xref="S5.F10.6.m1.1.1.1"><csymbol cd="ambiguous" id="S5.F10.6.m1.1.1.1.2.cmml" xref="S5.F10.6.m1.1.1.1">superscript</csymbol><apply id="S5.F10.6.m1.1.1.1.1.cmml" xref="S5.F10.6.m1.1.1.1"><csymbol cd="ambiguous" id="S5.F10.6.m1.1.1.1.1.2.cmml" xref="S5.F10.6.m1.1.1.1">subscript</csymbol><set id="S5.F10.6.m1.1.1.1.1.1.2.cmml" xref="S5.F10.6.m1.1.1.1.1.1.1"><interval closure="open" id="S5.F10.6.m1.1.1.1.1.1.1.1.3.cmml" xref="S5.F10.6.m1.1.1.1.1.1.1.1.2"><apply id="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.F10.6.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.F10.6.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.2">𝑀</ci><ci id="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.F10.6.m1.1.1.1.1.1.1.1.1.1.3">vir</ci></apply><apply id="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.F10.6.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.F10.6.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.2">𝑀</ci><times id="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.F10.6.m1.1.1.1.1.1.1.1.2.2.3"></times></apply></interval></set><apply id="S5.F10.6.m1.1.1.1.1.3.cmml" xref="S5.F10.6.m1.1.1.1.1.3"><eq id="S5.F10.6.m1.1.1.1.1.3.1.cmml" xref="S5.F10.6.m1.1.1.1.1.3.1"></eq><ci id="S5.F10.6.m1.1.1.1.1.3.2.cmml" xref="S5.F10.6.m1.1.1.1.1.3.2">𝑖</ci><cn id="S5.F10.6.m1.1.1.1.1.3.3.cmml" type="integer" xref="S5.F10.6.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S5.F10.6.m1.1.1.1.3.cmml" xref="S5.F10.6.m1.1.1.1.3"><eq id="S5.F10.6.m1.1.1.1.3.1.cmml" xref="S5.F10.6.m1.1.1.1.3.1"></eq><apply id="S5.F10.6.m1.1.1.1.3.2.cmml" xref="S5.F10.6.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.F10.6.m1.1.1.1.3.2.1.cmml" xref="S5.F10.6.m1.1.1.1.3.2">subscript</csymbol><ci id="S5.F10.6.m1.1.1.1.3.2.2.cmml" xref="S5.F10.6.m1.1.1.1.3.2.2">𝑛</ci><ci id="S5.F10.6.m1.1.1.1.3.2.3.cmml" xref="S5.F10.6.m1.1.1.1.3.2.3">𝑑</ci></apply><cn id="S5.F10.6.m1.1.1.1.3.3.cmml" type="integer" xref="S5.F10.6.m1.1.1.1.3.3">120</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.6.m1.1d">\textbf{d}=\{(M_{\rm vir},M_{*})\}_{i=1}^{n_{d}=120}</annotation><annotation encoding="application/x-llamapun" id="S5.F10.6.m1.1e">d = { ( italic_M start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT * end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 120 end_POSTSUPERSCRIPT</annotation></semantics></math> are sensitive to <span class="ltx_text ltx_font_typewriter" id="S5.F10.13.1">sapphire</span> mass and energy loading parameters <math alttext="\theta=(\eta_{M},\eta_{E})" class="ltx_Math" display="inline" id="S5.F10.7.m2.2"><semantics id="S5.F10.7.m2.2b"><mrow id="S5.F10.7.m2.2.2" xref="S5.F10.7.m2.2.2.cmml"><mi id="S5.F10.7.m2.2.2.4" xref="S5.F10.7.m2.2.2.4.cmml">θ</mi><mo id="S5.F10.7.m2.2.2.3" xref="S5.F10.7.m2.2.2.3.cmml">=</mo><mrow id="S5.F10.7.m2.2.2.2.2" xref="S5.F10.7.m2.2.2.2.3.cmml"><mo id="S5.F10.7.m2.2.2.2.2.3" stretchy="false" xref="S5.F10.7.m2.2.2.2.3.cmml">(</mo><msub id="S5.F10.7.m2.1.1.1.1.1" xref="S5.F10.7.m2.1.1.1.1.1.cmml"><mi id="S5.F10.7.m2.1.1.1.1.1.2" xref="S5.F10.7.m2.1.1.1.1.1.2.cmml">η</mi><mi id="S5.F10.7.m2.1.1.1.1.1.3" xref="S5.F10.7.m2.1.1.1.1.1.3.cmml">M</mi></msub><mo id="S5.F10.7.m2.2.2.2.2.4" xref="S5.F10.7.m2.2.2.2.3.cmml">,</mo><msub id="S5.F10.7.m2.2.2.2.2.2" xref="S5.F10.7.m2.2.2.2.2.2.cmml"><mi id="S5.F10.7.m2.2.2.2.2.2.2" xref="S5.F10.7.m2.2.2.2.2.2.2.cmml">η</mi><mi id="S5.F10.7.m2.2.2.2.2.2.3" xref="S5.F10.7.m2.2.2.2.2.2.3.cmml">E</mi></msub><mo id="S5.F10.7.m2.2.2.2.2.5" stretchy="false" xref="S5.F10.7.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.F10.7.m2.2c"><apply id="S5.F10.7.m2.2.2.cmml" xref="S5.F10.7.m2.2.2"><eq id="S5.F10.7.m2.2.2.3.cmml" xref="S5.F10.7.m2.2.2.3"></eq><ci id="S5.F10.7.m2.2.2.4.cmml" xref="S5.F10.7.m2.2.2.4">𝜃</ci><interval closure="open" id="S5.F10.7.m2.2.2.2.3.cmml" xref="S5.F10.7.m2.2.2.2.2"><apply id="S5.F10.7.m2.1.1.1.1.1.cmml" xref="S5.F10.7.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.F10.7.m2.1.1.1.1.1.1.cmml" xref="S5.F10.7.m2.1.1.1.1.1">subscript</csymbol><ci id="S5.F10.7.m2.1.1.1.1.1.2.cmml" xref="S5.F10.7.m2.1.1.1.1.1.2">𝜂</ci><ci id="S5.F10.7.m2.1.1.1.1.1.3.cmml" xref="S5.F10.7.m2.1.1.1.1.1.3">𝑀</ci></apply><apply id="S5.F10.7.m2.2.2.2.2.2.cmml" xref="S5.F10.7.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.F10.7.m2.2.2.2.2.2.1.cmml" xref="S5.F10.7.m2.2.2.2.2.2">subscript</csymbol><ci id="S5.F10.7.m2.2.2.2.2.2.2.cmml" xref="S5.F10.7.m2.2.2.2.2.2.2">𝜂</ci><ci id="S5.F10.7.m2.2.2.2.2.2.3.cmml" xref="S5.F10.7.m2.2.2.2.2.2.3">𝐸</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.7.m2.2d">\theta=(\eta_{M},\eta_{E})</annotation><annotation encoding="application/x-llamapun" id="S5.F10.7.m2.2e">italic_θ = ( italic_η start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_η start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT )</annotation></semantics></math>. Here we utilize the <span class="ltx_text ltx_font_typewriter" id="S5.F10.14.2">fishnets</span> architecture to aggregate sets of galaxy properties before performing NPE. Contours are shown at the central <math alttext="68\%" class="ltx_Math" display="inline" id="S5.F10.8.m3.1"><semantics id="S5.F10.8.m3.1b"><mrow id="S5.F10.8.m3.1.1" xref="S5.F10.8.m3.1.1.cmml"><mn id="S5.F10.8.m3.1.1.2" xref="S5.F10.8.m3.1.1.2.cmml">68</mn><mo id="S5.F10.8.m3.1.1.1" xref="S5.F10.8.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F10.8.m3.1c"><apply id="S5.F10.8.m3.1.1.cmml" xref="S5.F10.8.m3.1.1"><csymbol cd="latexml" id="S5.F10.8.m3.1.1.1.cmml" xref="S5.F10.8.m3.1.1.1">percent</csymbol><cn id="S5.F10.8.m3.1.1.2.cmml" type="integer" xref="S5.F10.8.m3.1.1.2">68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.8.m3.1d">68\%</annotation><annotation encoding="application/x-llamapun" id="S5.F10.8.m3.1e">68 %</annotation></semantics></math> and <math alttext="95\%" class="ltx_Math" display="inline" id="S5.F10.9.m4.1"><semantics id="S5.F10.9.m4.1b"><mrow id="S5.F10.9.m4.1.1" xref="S5.F10.9.m4.1.1.cmml"><mn id="S5.F10.9.m4.1.1.2" xref="S5.F10.9.m4.1.1.2.cmml">95</mn><mo id="S5.F10.9.m4.1.1.1" xref="S5.F10.9.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F10.9.m4.1c"><apply id="S5.F10.9.m4.1.1.cmml" xref="S5.F10.9.m4.1.1"><csymbol cd="latexml" id="S5.F10.9.m4.1.1.1.cmml" xref="S5.F10.9.m4.1.1.1">percent</csymbol><cn id="S5.F10.9.m4.1.1.2.cmml" type="integer" xref="S5.F10.9.m4.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.9.m4.1d">95\%</annotation><annotation encoding="application/x-llamapun" id="S5.F10.9.m4.1e">95 %</annotation></semantics></math> confidence intervals for a single data realization (left). Posterior predictive plots show our NPE network is sensitive to both energy loading hyper-parameters but cannot learn the mass loading hyper-parameters with the <math alttext="M_{*}-M_{\rm vir}" class="ltx_Math" display="inline" id="S5.F10.10.m5.1"><semantics id="S5.F10.10.m5.1b"><mrow id="S5.F10.10.m5.1.1" xref="S5.F10.10.m5.1.1.cmml"><msub id="S5.F10.10.m5.1.1.2" xref="S5.F10.10.m5.1.1.2.cmml"><mi id="S5.F10.10.m5.1.1.2.2" xref="S5.F10.10.m5.1.1.2.2.cmml">M</mi><mo id="S5.F10.10.m5.1.1.2.3" xref="S5.F10.10.m5.1.1.2.3.cmml">*</mo></msub><mo id="S5.F10.10.m5.1.1.1" xref="S5.F10.10.m5.1.1.1.cmml">−</mo><msub id="S5.F10.10.m5.1.1.3" xref="S5.F10.10.m5.1.1.3.cmml"><mi id="S5.F10.10.m5.1.1.3.2" xref="S5.F10.10.m5.1.1.3.2.cmml">M</mi><mi id="S5.F10.10.m5.1.1.3.3" xref="S5.F10.10.m5.1.1.3.3.cmml">vir</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.F10.10.m5.1c"><apply id="S5.F10.10.m5.1.1.cmml" xref="S5.F10.10.m5.1.1"><minus id="S5.F10.10.m5.1.1.1.cmml" xref="S5.F10.10.m5.1.1.1"></minus><apply id="S5.F10.10.m5.1.1.2.cmml" xref="S5.F10.10.m5.1.1.2"><csymbol cd="ambiguous" id="S5.F10.10.m5.1.1.2.1.cmml" xref="S5.F10.10.m5.1.1.2">subscript</csymbol><ci id="S5.F10.10.m5.1.1.2.2.cmml" xref="S5.F10.10.m5.1.1.2.2">𝑀</ci><times id="S5.F10.10.m5.1.1.2.3.cmml" xref="S5.F10.10.m5.1.1.2.3"></times></apply><apply id="S5.F10.10.m5.1.1.3.cmml" xref="S5.F10.10.m5.1.1.3"><csymbol cd="ambiguous" id="S5.F10.10.m5.1.1.3.1.cmml" xref="S5.F10.10.m5.1.1.3">subscript</csymbol><ci id="S5.F10.10.m5.1.1.3.2.cmml" xref="S5.F10.10.m5.1.1.3.2">𝑀</ci><ci id="S5.F10.10.m5.1.1.3.3.cmml" xref="S5.F10.10.m5.1.1.3.3">vir</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.10.m5.1d">M_{*}-M_{\rm vir}</annotation><annotation encoding="application/x-llamapun" id="S5.F10.10.m5.1e">italic_M start_POSTSUBSCRIPT * end_POSTSUBSCRIPT - italic_M start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT</annotation></semantics></math> relation alone.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS6.p5">
<p class="ltx_p" id="S5.SS6.p5.7">We use the <span class="ltx_text ltx_font_typewriter" id="S5.SS6.p5.7.1">fishnets</span> architecture by <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx143" title="">Makinen <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Makinen, Alsing, and Wandelt</a></cite> to extract what information the stellar-to-halo-mass relation contains about <math alttext="\theta=(\eta_{\rm M},\eta_{\rm E})" class="ltx_Math" display="inline" id="S5.SS6.p5.1.m1.2"><semantics id="S5.SS6.p5.1.m1.2a"><mrow id="S5.SS6.p5.1.m1.2.2" xref="S5.SS6.p5.1.m1.2.2.cmml"><mi id="S5.SS6.p5.1.m1.2.2.4" xref="S5.SS6.p5.1.m1.2.2.4.cmml">θ</mi><mo id="S5.SS6.p5.1.m1.2.2.3" xref="S5.SS6.p5.1.m1.2.2.3.cmml">=</mo><mrow id="S5.SS6.p5.1.m1.2.2.2.2" xref="S5.SS6.p5.1.m1.2.2.2.3.cmml"><mo id="S5.SS6.p5.1.m1.2.2.2.2.3" stretchy="false" xref="S5.SS6.p5.1.m1.2.2.2.3.cmml">(</mo><msub id="S5.SS6.p5.1.m1.1.1.1.1.1" xref="S5.SS6.p5.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS6.p5.1.m1.1.1.1.1.1.2" xref="S5.SS6.p5.1.m1.1.1.1.1.1.2.cmml">η</mi><mi id="S5.SS6.p5.1.m1.1.1.1.1.1.3" mathvariant="normal" xref="S5.SS6.p5.1.m1.1.1.1.1.1.3.cmml">M</mi></msub><mo id="S5.SS6.p5.1.m1.2.2.2.2.4" xref="S5.SS6.p5.1.m1.2.2.2.3.cmml">,</mo><msub id="S5.SS6.p5.1.m1.2.2.2.2.2" xref="S5.SS6.p5.1.m1.2.2.2.2.2.cmml"><mi id="S5.SS6.p5.1.m1.2.2.2.2.2.2" xref="S5.SS6.p5.1.m1.2.2.2.2.2.2.cmml">η</mi><mi id="S5.SS6.p5.1.m1.2.2.2.2.2.3" mathvariant="normal" xref="S5.SS6.p5.1.m1.2.2.2.2.2.3.cmml">E</mi></msub><mo id="S5.SS6.p5.1.m1.2.2.2.2.5" stretchy="false" xref="S5.SS6.p5.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p5.1.m1.2b"><apply id="S5.SS6.p5.1.m1.2.2.cmml" xref="S5.SS6.p5.1.m1.2.2"><eq id="S5.SS6.p5.1.m1.2.2.3.cmml" xref="S5.SS6.p5.1.m1.2.2.3"></eq><ci id="S5.SS6.p5.1.m1.2.2.4.cmml" xref="S5.SS6.p5.1.m1.2.2.4">𝜃</ci><interval closure="open" id="S5.SS6.p5.1.m1.2.2.2.3.cmml" xref="S5.SS6.p5.1.m1.2.2.2.2"><apply id="S5.SS6.p5.1.m1.1.1.1.1.1.cmml" xref="S5.SS6.p5.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS6.p5.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS6.p5.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS6.p5.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS6.p5.1.m1.1.1.1.1.1.2">𝜂</ci><ci id="S5.SS6.p5.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS6.p5.1.m1.1.1.1.1.1.3">M</ci></apply><apply id="S5.SS6.p5.1.m1.2.2.2.2.2.cmml" xref="S5.SS6.p5.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS6.p5.1.m1.2.2.2.2.2.1.cmml" xref="S5.SS6.p5.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S5.SS6.p5.1.m1.2.2.2.2.2.2.cmml" xref="S5.SS6.p5.1.m1.2.2.2.2.2.2">𝜂</ci><ci id="S5.SS6.p5.1.m1.2.2.2.2.2.3.cmml" xref="S5.SS6.p5.1.m1.2.2.2.2.2.3">E</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p5.1.m1.2c">\theta=(\eta_{\rm M},\eta_{\rm E})</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p5.1.m1.2d">italic_θ = ( italic_η start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT , italic_η start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT )</annotation></semantics></math>. The output from each <span class="ltx_text ltx_font_typewriter" id="S5.SS6.p5.7.2">sapphire</span> realization is a set of 120 independently-evolved halos <math alttext="\textbf{d}=\{(M_{\rm vir},M_{*},\frac{M_{\rm vir}}{M_{*}})\}_{i=1}^{n_{d}=120}" class="ltx_Math" display="inline" id="S5.SS6.p5.2.m2.2"><semantics id="S5.SS6.p5.2.m2.2a"><mrow id="S5.SS6.p5.2.m2.2.2" xref="S5.SS6.p5.2.m2.2.2.cmml"><mtext id="S5.SS6.p5.2.m2.2.2.3" xref="S5.SS6.p5.2.m2.2.2.3a.cmml">𝐝</mtext><mo id="S5.SS6.p5.2.m2.2.2.2" xref="S5.SS6.p5.2.m2.2.2.2.cmml">=</mo><msubsup id="S5.SS6.p5.2.m2.2.2.1" xref="S5.SS6.p5.2.m2.2.2.1.cmml"><mrow id="S5.SS6.p5.2.m2.2.2.1.1.1.1" xref="S5.SS6.p5.2.m2.2.2.1.1.1.2.cmml"><mo id="S5.SS6.p5.2.m2.2.2.1.1.1.1.2" stretchy="false" xref="S5.SS6.p5.2.m2.2.2.1.1.1.2.cmml">{</mo><mrow id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.3.cmml"><mo id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.3" stretchy="false" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.3.cmml">(</mo><msub id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.2" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.2.cmml">M</mi><mi id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.3" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.3.cmml">vir</mi></msub><mo id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.4" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.3.cmml">,</mo><msub id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.cmml"><mi id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.2" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.2.cmml">M</mi><mo id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.3" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.3.cmml">*</mo></msub><mo id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.5" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.3.cmml">,</mo><mfrac id="S5.SS6.p5.2.m2.1.1" xref="S5.SS6.p5.2.m2.1.1.cmml"><msub id="S5.SS6.p5.2.m2.1.1.2" xref="S5.SS6.p5.2.m2.1.1.2.cmml"><mi id="S5.SS6.p5.2.m2.1.1.2.2" xref="S5.SS6.p5.2.m2.1.1.2.2.cmml">M</mi><mi id="S5.SS6.p5.2.m2.1.1.2.3" xref="S5.SS6.p5.2.m2.1.1.2.3.cmml">vir</mi></msub><msub id="S5.SS6.p5.2.m2.1.1.3" xref="S5.SS6.p5.2.m2.1.1.3.cmml"><mi id="S5.SS6.p5.2.m2.1.1.3.2" xref="S5.SS6.p5.2.m2.1.1.3.2.cmml">M</mi><mo id="S5.SS6.p5.2.m2.1.1.3.3" xref="S5.SS6.p5.2.m2.1.1.3.3.cmml">*</mo></msub></mfrac><mo id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.6" stretchy="false" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S5.SS6.p5.2.m2.2.2.1.1.1.1.3" stretchy="false" xref="S5.SS6.p5.2.m2.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S5.SS6.p5.2.m2.2.2.1.1.3" xref="S5.SS6.p5.2.m2.2.2.1.1.3.cmml"><mi id="S5.SS6.p5.2.m2.2.2.1.1.3.2" xref="S5.SS6.p5.2.m2.2.2.1.1.3.2.cmml">i</mi><mo id="S5.SS6.p5.2.m2.2.2.1.1.3.1" xref="S5.SS6.p5.2.m2.2.2.1.1.3.1.cmml">=</mo><mn id="S5.SS6.p5.2.m2.2.2.1.1.3.3" xref="S5.SS6.p5.2.m2.2.2.1.1.3.3.cmml">1</mn></mrow><mrow id="S5.SS6.p5.2.m2.2.2.1.3" xref="S5.SS6.p5.2.m2.2.2.1.3.cmml"><msub id="S5.SS6.p5.2.m2.2.2.1.3.2" xref="S5.SS6.p5.2.m2.2.2.1.3.2.cmml"><mi id="S5.SS6.p5.2.m2.2.2.1.3.2.2" xref="S5.SS6.p5.2.m2.2.2.1.3.2.2.cmml">n</mi><mi id="S5.SS6.p5.2.m2.2.2.1.3.2.3" xref="S5.SS6.p5.2.m2.2.2.1.3.2.3.cmml">d</mi></msub><mo id="S5.SS6.p5.2.m2.2.2.1.3.1" xref="S5.SS6.p5.2.m2.2.2.1.3.1.cmml">=</mo><mn id="S5.SS6.p5.2.m2.2.2.1.3.3" xref="S5.SS6.p5.2.m2.2.2.1.3.3.cmml">120</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p5.2.m2.2b"><apply id="S5.SS6.p5.2.m2.2.2.cmml" xref="S5.SS6.p5.2.m2.2.2"><eq id="S5.SS6.p5.2.m2.2.2.2.cmml" xref="S5.SS6.p5.2.m2.2.2.2"></eq><ci id="S5.SS6.p5.2.m2.2.2.3a.cmml" xref="S5.SS6.p5.2.m2.2.2.3"><mtext id="S5.SS6.p5.2.m2.2.2.3.cmml" xref="S5.SS6.p5.2.m2.2.2.3">𝐝</mtext></ci><apply id="S5.SS6.p5.2.m2.2.2.1.cmml" xref="S5.SS6.p5.2.m2.2.2.1"><csymbol cd="ambiguous" id="S5.SS6.p5.2.m2.2.2.1.2.cmml" xref="S5.SS6.p5.2.m2.2.2.1">superscript</csymbol><apply id="S5.SS6.p5.2.m2.2.2.1.1.cmml" xref="S5.SS6.p5.2.m2.2.2.1"><csymbol cd="ambiguous" id="S5.SS6.p5.2.m2.2.2.1.1.2.cmml" xref="S5.SS6.p5.2.m2.2.2.1">subscript</csymbol><set id="S5.SS6.p5.2.m2.2.2.1.1.1.2.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1"><vector id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.3.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2"><apply id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.2">𝑀</ci><ci id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.1.1.3">vir</ci></apply><apply id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.1.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.2.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.2">𝑀</ci><times id="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.3.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.1.1.1.2.2.3"></times></apply><apply id="S5.SS6.p5.2.m2.1.1.cmml" xref="S5.SS6.p5.2.m2.1.1"><divide id="S5.SS6.p5.2.m2.1.1.1.cmml" xref="S5.SS6.p5.2.m2.1.1"></divide><apply id="S5.SS6.p5.2.m2.1.1.2.cmml" xref="S5.SS6.p5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS6.p5.2.m2.1.1.2.1.cmml" xref="S5.SS6.p5.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS6.p5.2.m2.1.1.2.2.cmml" xref="S5.SS6.p5.2.m2.1.1.2.2">𝑀</ci><ci id="S5.SS6.p5.2.m2.1.1.2.3.cmml" xref="S5.SS6.p5.2.m2.1.1.2.3">vir</ci></apply><apply id="S5.SS6.p5.2.m2.1.1.3.cmml" xref="S5.SS6.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p5.2.m2.1.1.3.1.cmml" xref="S5.SS6.p5.2.m2.1.1.3">subscript</csymbol><ci id="S5.SS6.p5.2.m2.1.1.3.2.cmml" xref="S5.SS6.p5.2.m2.1.1.3.2">𝑀</ci><times id="S5.SS6.p5.2.m2.1.1.3.3.cmml" xref="S5.SS6.p5.2.m2.1.1.3.3"></times></apply></apply></vector></set><apply id="S5.SS6.p5.2.m2.2.2.1.1.3.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.3"><eq id="S5.SS6.p5.2.m2.2.2.1.1.3.1.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.3.1"></eq><ci id="S5.SS6.p5.2.m2.2.2.1.1.3.2.cmml" xref="S5.SS6.p5.2.m2.2.2.1.1.3.2">𝑖</ci><cn id="S5.SS6.p5.2.m2.2.2.1.1.3.3.cmml" type="integer" xref="S5.SS6.p5.2.m2.2.2.1.1.3.3">1</cn></apply></apply><apply id="S5.SS6.p5.2.m2.2.2.1.3.cmml" xref="S5.SS6.p5.2.m2.2.2.1.3"><eq id="S5.SS6.p5.2.m2.2.2.1.3.1.cmml" xref="S5.SS6.p5.2.m2.2.2.1.3.1"></eq><apply id="S5.SS6.p5.2.m2.2.2.1.3.2.cmml" xref="S5.SS6.p5.2.m2.2.2.1.3.2"><csymbol cd="ambiguous" id="S5.SS6.p5.2.m2.2.2.1.3.2.1.cmml" xref="S5.SS6.p5.2.m2.2.2.1.3.2">subscript</csymbol><ci id="S5.SS6.p5.2.m2.2.2.1.3.2.2.cmml" xref="S5.SS6.p5.2.m2.2.2.1.3.2.2">𝑛</ci><ci id="S5.SS6.p5.2.m2.2.2.1.3.2.3.cmml" xref="S5.SS6.p5.2.m2.2.2.1.3.2.3">𝑑</ci></apply><cn id="S5.SS6.p5.2.m2.2.2.1.3.3.cmml" type="integer" xref="S5.SS6.p5.2.m2.2.2.1.3.3">120</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p5.2.m2.2c">\textbf{d}=\{(M_{\rm vir},M_{*},\frac{M_{\rm vir}}{M_{*}})\}_{i=1}^{n_{d}=120}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p5.2.m2.2d">d = { ( italic_M start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT * end_POSTSUBSCRIPT , divide start_ARG italic_M start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT end_ARG start_ARG italic_M start_POSTSUBSCRIPT * end_POSTSUBSCRIPT end_ARG ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 120 end_POSTSUPERSCRIPT</annotation></semantics></math> where <math alttext="M_{\rm vir}" class="ltx_Math" display="inline" id="S5.SS6.p5.3.m3.1"><semantics id="S5.SS6.p5.3.m3.1a"><msub id="S5.SS6.p5.3.m3.1.1" xref="S5.SS6.p5.3.m3.1.1.cmml"><mi id="S5.SS6.p5.3.m3.1.1.2" xref="S5.SS6.p5.3.m3.1.1.2.cmml">M</mi><mi id="S5.SS6.p5.3.m3.1.1.3" xref="S5.SS6.p5.3.m3.1.1.3.cmml">vir</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p5.3.m3.1b"><apply id="S5.SS6.p5.3.m3.1.1.cmml" xref="S5.SS6.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS6.p5.3.m3.1.1.1.cmml" xref="S5.SS6.p5.3.m3.1.1">subscript</csymbol><ci id="S5.SS6.p5.3.m3.1.1.2.cmml" xref="S5.SS6.p5.3.m3.1.1.2">𝑀</ci><ci id="S5.SS6.p5.3.m3.1.1.3.cmml" xref="S5.SS6.p5.3.m3.1.1.3">vir</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p5.3.m3.1c">M_{\rm vir}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p5.3.m3.1d">italic_M start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="M_{*}" class="ltx_Math" display="inline" id="S5.SS6.p5.4.m4.1"><semantics id="S5.SS6.p5.4.m4.1a"><msub id="S5.SS6.p5.4.m4.1.1" xref="S5.SS6.p5.4.m4.1.1.cmml"><mi id="S5.SS6.p5.4.m4.1.1.2" xref="S5.SS6.p5.4.m4.1.1.2.cmml">M</mi><mo id="S5.SS6.p5.4.m4.1.1.3" xref="S5.SS6.p5.4.m4.1.1.3.cmml">*</mo></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p5.4.m4.1b"><apply id="S5.SS6.p5.4.m4.1.1.cmml" xref="S5.SS6.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS6.p5.4.m4.1.1.1.cmml" xref="S5.SS6.p5.4.m4.1.1">subscript</csymbol><ci id="S5.SS6.p5.4.m4.1.1.2.cmml" xref="S5.SS6.p5.4.m4.1.1.2">𝑀</ci><times id="S5.SS6.p5.4.m4.1.1.3.cmml" xref="S5.SS6.p5.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p5.4.m4.1c">M_{*}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p5.4.m4.1d">italic_M start_POSTSUBSCRIPT * end_POSTSUBSCRIPT</annotation></semantics></math> are the <math alttext="z=0" class="ltx_Math" display="inline" id="S5.SS6.p5.5.m5.1"><semantics id="S5.SS6.p5.5.m5.1a"><mrow id="S5.SS6.p5.5.m5.1.1" xref="S5.SS6.p5.5.m5.1.1.cmml"><mi id="S5.SS6.p5.5.m5.1.1.2" xref="S5.SS6.p5.5.m5.1.1.2.cmml">z</mi><mo id="S5.SS6.p5.5.m5.1.1.1" xref="S5.SS6.p5.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS6.p5.5.m5.1.1.3" xref="S5.SS6.p5.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p5.5.m5.1b"><apply id="S5.SS6.p5.5.m5.1.1.cmml" xref="S5.SS6.p5.5.m5.1.1"><eq id="S5.SS6.p5.5.m5.1.1.1.cmml" xref="S5.SS6.p5.5.m5.1.1.1"></eq><ci id="S5.SS6.p5.5.m5.1.1.2.cmml" xref="S5.SS6.p5.5.m5.1.1.2">𝑧</ci><cn id="S5.SS6.p5.5.m5.1.1.3.cmml" type="integer" xref="S5.SS6.p5.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p5.5.m5.1c">z=0</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p5.5.m5.1d">italic_z = 0</annotation></semantics></math> halo mass and stellar mass, respectively. The likelihood here is a product of each individual halos’ likelihoods, <math alttext="\mathcal{L}(\{d_{i}\}|\theta)=\prod^{n_{d}=120}_{i=0}\mathcal{L}(d_{i}|\theta)" class="ltx_Math" display="inline" id="S5.SS6.p5.6.m6.2"><semantics id="S5.SS6.p5.6.m6.2a"><mrow id="S5.SS6.p5.6.m6.2.2" xref="S5.SS6.p5.6.m6.2.2.cmml"><mrow id="S5.SS6.p5.6.m6.1.1.1" xref="S5.SS6.p5.6.m6.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS6.p5.6.m6.1.1.1.3" xref="S5.SS6.p5.6.m6.1.1.1.3.cmml">ℒ</mi><mo id="S5.SS6.p5.6.m6.1.1.1.2" xref="S5.SS6.p5.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS6.p5.6.m6.1.1.1.1.1" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.cmml"><mo id="S5.SS6.p5.6.m6.1.1.1.1.1.2" stretchy="false" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS6.p5.6.m6.1.1.1.1.1.1" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.cmml"><mrow id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.2.cmml"><mo id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.2" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.3" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo fence="false" id="S5.SS6.p5.6.m6.1.1.1.1.1.1.2" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.2.cmml">|</mo><mi id="S5.SS6.p5.6.m6.1.1.1.1.1.1.3" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.3.cmml">θ</mi></mrow><mo id="S5.SS6.p5.6.m6.1.1.1.1.1.3" stretchy="false" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS6.p5.6.m6.2.2.3" rspace="0.111em" xref="S5.SS6.p5.6.m6.2.2.3.cmml">=</mo><mrow id="S5.SS6.p5.6.m6.2.2.2" xref="S5.SS6.p5.6.m6.2.2.2.cmml"><msubsup id="S5.SS6.p5.6.m6.2.2.2.2" xref="S5.SS6.p5.6.m6.2.2.2.2.cmml"><mo id="S5.SS6.p5.6.m6.2.2.2.2.2.2" xref="S5.SS6.p5.6.m6.2.2.2.2.2.2.cmml">∏</mo><mrow id="S5.SS6.p5.6.m6.2.2.2.2.3" xref="S5.SS6.p5.6.m6.2.2.2.2.3.cmml"><mi id="S5.SS6.p5.6.m6.2.2.2.2.3.2" xref="S5.SS6.p5.6.m6.2.2.2.2.3.2.cmml">i</mi><mo id="S5.SS6.p5.6.m6.2.2.2.2.3.1" xref="S5.SS6.p5.6.m6.2.2.2.2.3.1.cmml">=</mo><mn id="S5.SS6.p5.6.m6.2.2.2.2.3.3" xref="S5.SS6.p5.6.m6.2.2.2.2.3.3.cmml">0</mn></mrow><mrow id="S5.SS6.p5.6.m6.2.2.2.2.2.3" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.cmml"><msub id="S5.SS6.p5.6.m6.2.2.2.2.2.3.2" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.cmml"><mi id="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.2" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.2.cmml">n</mi><mi id="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.3" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.3.cmml">d</mi></msub><mo id="S5.SS6.p5.6.m6.2.2.2.2.2.3.1" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.1.cmml">=</mo><mn id="S5.SS6.p5.6.m6.2.2.2.2.2.3.3" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.3.cmml">120</mn></mrow></msubsup><mrow id="S5.SS6.p5.6.m6.2.2.2.1" xref="S5.SS6.p5.6.m6.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS6.p5.6.m6.2.2.2.1.3" xref="S5.SS6.p5.6.m6.2.2.2.1.3.cmml">ℒ</mi><mo id="S5.SS6.p5.6.m6.2.2.2.1.2" xref="S5.SS6.p5.6.m6.2.2.2.1.2.cmml">⁢</mo><mrow id="S5.SS6.p5.6.m6.2.2.2.1.1.1" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.cmml"><mo id="S5.SS6.p5.6.m6.2.2.2.1.1.1.2" stretchy="false" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.cmml"><msub id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.cmml"><mi id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.2" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.2.cmml">d</mi><mi id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.3" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.1" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.1.cmml">|</mo><mi id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.3" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.3.cmml">θ</mi></mrow><mo id="S5.SS6.p5.6.m6.2.2.2.1.1.1.3" stretchy="false" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p5.6.m6.2b"><apply id="S5.SS6.p5.6.m6.2.2.cmml" xref="S5.SS6.p5.6.m6.2.2"><eq id="S5.SS6.p5.6.m6.2.2.3.cmml" xref="S5.SS6.p5.6.m6.2.2.3"></eq><apply id="S5.SS6.p5.6.m6.1.1.1.cmml" xref="S5.SS6.p5.6.m6.1.1.1"><times id="S5.SS6.p5.6.m6.1.1.1.2.cmml" xref="S5.SS6.p5.6.m6.1.1.1.2"></times><ci id="S5.SS6.p5.6.m6.1.1.1.3.cmml" xref="S5.SS6.p5.6.m6.1.1.1.3">ℒ</ci><apply id="S5.SS6.p5.6.m6.1.1.1.1.1.1.cmml" xref="S5.SS6.p5.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="S5.SS6.p5.6.m6.1.1.1.1.1.1.2.cmml" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.2">conditional</csymbol><set id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.2.cmml" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1"><apply id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.2">𝑑</ci><ci id="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="S5.SS6.p5.6.m6.1.1.1.1.1.1.3.cmml" xref="S5.SS6.p5.6.m6.1.1.1.1.1.1.3">𝜃</ci></apply></apply><apply id="S5.SS6.p5.6.m6.2.2.2.cmml" xref="S5.SS6.p5.6.m6.2.2.2"><apply id="S5.SS6.p5.6.m6.2.2.2.2.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS6.p5.6.m6.2.2.2.2.1.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2">subscript</csymbol><apply id="S5.SS6.p5.6.m6.2.2.2.2.2.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS6.p5.6.m6.2.2.2.2.2.1.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2">superscript</csymbol><csymbol cd="latexml" id="S5.SS6.p5.6.m6.2.2.2.2.2.2.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2.2.2">product</csymbol><apply id="S5.SS6.p5.6.m6.2.2.2.2.2.3.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3"><eq id="S5.SS6.p5.6.m6.2.2.2.2.2.3.1.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.1"></eq><apply id="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.1.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.2">subscript</csymbol><ci id="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.2.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.2">𝑛</ci><ci id="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.3.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.2.3">𝑑</ci></apply><cn id="S5.SS6.p5.6.m6.2.2.2.2.2.3.3.cmml" type="integer" xref="S5.SS6.p5.6.m6.2.2.2.2.2.3.3">120</cn></apply></apply><apply id="S5.SS6.p5.6.m6.2.2.2.2.3.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2.3"><eq id="S5.SS6.p5.6.m6.2.2.2.2.3.1.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2.3.1"></eq><ci id="S5.SS6.p5.6.m6.2.2.2.2.3.2.cmml" xref="S5.SS6.p5.6.m6.2.2.2.2.3.2">𝑖</ci><cn id="S5.SS6.p5.6.m6.2.2.2.2.3.3.cmml" type="integer" xref="S5.SS6.p5.6.m6.2.2.2.2.3.3">0</cn></apply></apply><apply id="S5.SS6.p5.6.m6.2.2.2.1.cmml" xref="S5.SS6.p5.6.m6.2.2.2.1"><times id="S5.SS6.p5.6.m6.2.2.2.1.2.cmml" xref="S5.SS6.p5.6.m6.2.2.2.1.2"></times><ci id="S5.SS6.p5.6.m6.2.2.2.1.3.cmml" xref="S5.SS6.p5.6.m6.2.2.2.1.3">ℒ</ci><apply id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.cmml" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1"><csymbol cd="latexml" id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.1.cmml" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.1">conditional</csymbol><apply id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.cmml" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.1.cmml" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.2.cmml" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.2">𝑑</ci><ci id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.3.cmml" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.3.cmml" xref="S5.SS6.p5.6.m6.2.2.2.1.1.1.1.3">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p5.6.m6.2c">\mathcal{L}(\{d_{i}\}|\theta)=\prod^{n_{d}=120}_{i=0}\mathcal{L}(d_{i}|\theta)</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p5.6.m6.2d">caligraphic_L ( { italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } | italic_θ ) = ∏ start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 120 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT caligraphic_L ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_θ )</annotation></semantics></math>, requiring an aggregation over heterogeneous data distributions. Following the optimal <span class="ltx_text ltx_font_typewriter" id="S5.SS6.p5.7.3">fishnets</span> formalism presented in <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx143" title="">Makinen <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Makinen, Alsing, and Wandelt</a></cite>, we embed data into neural score embeddings and Fisher weights, each parameterized by fully-connected networks of size <math alttext="[128,128,128]" class="ltx_Math" display="inline" id="S5.SS6.p5.7.m7.3"><semantics id="S5.SS6.p5.7.m7.3a"><mrow id="S5.SS6.p5.7.m7.3.4.2" xref="S5.SS6.p5.7.m7.3.4.1.cmml"><mo id="S5.SS6.p5.7.m7.3.4.2.1" stretchy="false" xref="S5.SS6.p5.7.m7.3.4.1.cmml">[</mo><mn id="S5.SS6.p5.7.m7.1.1" xref="S5.SS6.p5.7.m7.1.1.cmml">128</mn><mo id="S5.SS6.p5.7.m7.3.4.2.2" xref="S5.SS6.p5.7.m7.3.4.1.cmml">,</mo><mn id="S5.SS6.p5.7.m7.2.2" xref="S5.SS6.p5.7.m7.2.2.cmml">128</mn><mo id="S5.SS6.p5.7.m7.3.4.2.3" xref="S5.SS6.p5.7.m7.3.4.1.cmml">,</mo><mn id="S5.SS6.p5.7.m7.3.3" xref="S5.SS6.p5.7.m7.3.3.cmml">128</mn><mo id="S5.SS6.p5.7.m7.3.4.2.4" stretchy="false" xref="S5.SS6.p5.7.m7.3.4.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p5.7.m7.3b"><list id="S5.SS6.p5.7.m7.3.4.1.cmml" xref="S5.SS6.p5.7.m7.3.4.2"><cn id="S5.SS6.p5.7.m7.1.1.cmml" type="integer" xref="S5.SS6.p5.7.m7.1.1">128</cn><cn id="S5.SS6.p5.7.m7.2.2.cmml" type="integer" xref="S5.SS6.p5.7.m7.2.2">128</cn><cn id="S5.SS6.p5.7.m7.3.3.cmml" type="integer" xref="S5.SS6.p5.7.m7.3.3">128</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p5.7.m7.3c">[128,128,128]</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p5.7.m7.3d">[ 128 , 128 , 128 ]</annotation></semantics></math> with <span class="ltx_text ltx_font_typewriter" id="S5.SS6.p5.7.4">LeakyRelu</span> activations before passing the weighted scores to two NPE networks.</p>
</div>
<div class="ltx_para" id="S5.SS6.p6">
<p class="ltx_p" id="S5.SS6.p6.8">We show the resulting posterior for one test simulation in Figure <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5.F10" title="Figure 10 ‣ 5.6 The Mass and Energy Loading of Galactic Winds ‣ 5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">10</span></a>. We find that galaxy energy loading factors are extremely sensitive to halo and stellar mass properties (as expected), while mass loading factors prove more difficult to constrain. This is consistent with <cite class="ltx_cite ltx_citemacro_citet"><a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx140" title="">Carr <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Carr, Bryan, Fielding, Pandya, and Somerville</a></cite> who showed that the stellar-to-halo-mass relation is largely insensitive to variations in <math alttext="\eta_{\rm M}" class="ltx_Math" display="inline" id="S5.SS6.p6.1.m1.1"><semantics id="S5.SS6.p6.1.m1.1a"><msub id="S5.SS6.p6.1.m1.1.1" xref="S5.SS6.p6.1.m1.1.1.cmml"><mi id="S5.SS6.p6.1.m1.1.1.2" xref="S5.SS6.p6.1.m1.1.1.2.cmml">η</mi><mi id="S5.SS6.p6.1.m1.1.1.3" mathvariant="normal" xref="S5.SS6.p6.1.m1.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p6.1.m1.1b"><apply id="S5.SS6.p6.1.m1.1.1.cmml" xref="S5.SS6.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS6.p6.1.m1.1.1.1.cmml" xref="S5.SS6.p6.1.m1.1.1">subscript</csymbol><ci id="S5.SS6.p6.1.m1.1.1.2.cmml" xref="S5.SS6.p6.1.m1.1.1.2">𝜂</ci><ci id="S5.SS6.p6.1.m1.1.1.3.cmml" xref="S5.SS6.p6.1.m1.1.1.3">M</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p6.1.m1.1c">\eta_{\rm M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p6.1.m1.1d">italic_η start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT</annotation></semantics></math> but very responsive to changes in <math alttext="\eta_{\rm E}" class="ltx_Math" display="inline" id="S5.SS6.p6.2.m2.1"><semantics id="S5.SS6.p6.2.m2.1a"><msub id="S5.SS6.p6.2.m2.1.1" xref="S5.SS6.p6.2.m2.1.1.cmml"><mi id="S5.SS6.p6.2.m2.1.1.2" xref="S5.SS6.p6.2.m2.1.1.2.cmml">η</mi><mi id="S5.SS6.p6.2.m2.1.1.3" mathvariant="normal" xref="S5.SS6.p6.2.m2.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p6.2.m2.1b"><apply id="S5.SS6.p6.2.m2.1.1.cmml" xref="S5.SS6.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS6.p6.2.m2.1.1.1.cmml" xref="S5.SS6.p6.2.m2.1.1">subscript</csymbol><ci id="S5.SS6.p6.2.m2.1.1.2.cmml" xref="S5.SS6.p6.2.m2.1.1.2">𝜂</ci><ci id="S5.SS6.p6.2.m2.1.1.3.cmml" xref="S5.SS6.p6.2.m2.1.1.3">E</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p6.2.m2.1c">\eta_{\rm E}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p6.2.m2.1d">italic_η start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT</annotation></semantics></math>. The physical reason for this is that increasing <math alttext="\eta_{\rm M}" class="ltx_Math" display="inline" id="S5.SS6.p6.3.m3.1"><semantics id="S5.SS6.p6.3.m3.1a"><msub id="S5.SS6.p6.3.m3.1.1" xref="S5.SS6.p6.3.m3.1.1.cmml"><mi id="S5.SS6.p6.3.m3.1.1.2" xref="S5.SS6.p6.3.m3.1.1.2.cmml">η</mi><mi id="S5.SS6.p6.3.m3.1.1.3" mathvariant="normal" xref="S5.SS6.p6.3.m3.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p6.3.m3.1b"><apply id="S5.SS6.p6.3.m3.1.1.cmml" xref="S5.SS6.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS6.p6.3.m3.1.1.1.cmml" xref="S5.SS6.p6.3.m3.1.1">subscript</csymbol><ci id="S5.SS6.p6.3.m3.1.1.2.cmml" xref="S5.SS6.p6.3.m3.1.1.2">𝜂</ci><ci id="S5.SS6.p6.3.m3.1.1.3.cmml" xref="S5.SS6.p6.3.m3.1.1.3">M</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p6.3.m3.1c">\eta_{\rm M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p6.3.m3.1d">italic_η start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT</annotation></semantics></math> leads to a higher CGM density and enhanced cooling of gas back into the galaxy without suppressing star formation, thus leading to a similar <math alttext="M_{*}-M_{\rm vir}" class="ltx_Math" display="inline" id="S5.SS6.p6.4.m4.1"><semantics id="S5.SS6.p6.4.m4.1a"><mrow id="S5.SS6.p6.4.m4.1.1" xref="S5.SS6.p6.4.m4.1.1.cmml"><msub id="S5.SS6.p6.4.m4.1.1.2" xref="S5.SS6.p6.4.m4.1.1.2.cmml"><mi id="S5.SS6.p6.4.m4.1.1.2.2" xref="S5.SS6.p6.4.m4.1.1.2.2.cmml">M</mi><mo id="S5.SS6.p6.4.m4.1.1.2.3" xref="S5.SS6.p6.4.m4.1.1.2.3.cmml">*</mo></msub><mo id="S5.SS6.p6.4.m4.1.1.1" xref="S5.SS6.p6.4.m4.1.1.1.cmml">−</mo><msub id="S5.SS6.p6.4.m4.1.1.3" xref="S5.SS6.p6.4.m4.1.1.3.cmml"><mi id="S5.SS6.p6.4.m4.1.1.3.2" xref="S5.SS6.p6.4.m4.1.1.3.2.cmml">M</mi><mi id="S5.SS6.p6.4.m4.1.1.3.3" xref="S5.SS6.p6.4.m4.1.1.3.3.cmml">vir</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p6.4.m4.1b"><apply id="S5.SS6.p6.4.m4.1.1.cmml" xref="S5.SS6.p6.4.m4.1.1"><minus id="S5.SS6.p6.4.m4.1.1.1.cmml" xref="S5.SS6.p6.4.m4.1.1.1"></minus><apply id="S5.SS6.p6.4.m4.1.1.2.cmml" xref="S5.SS6.p6.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS6.p6.4.m4.1.1.2.1.cmml" xref="S5.SS6.p6.4.m4.1.1.2">subscript</csymbol><ci id="S5.SS6.p6.4.m4.1.1.2.2.cmml" xref="S5.SS6.p6.4.m4.1.1.2.2">𝑀</ci><times id="S5.SS6.p6.4.m4.1.1.2.3.cmml" xref="S5.SS6.p6.4.m4.1.1.2.3"></times></apply><apply id="S5.SS6.p6.4.m4.1.1.3.cmml" xref="S5.SS6.p6.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p6.4.m4.1.1.3.1.cmml" xref="S5.SS6.p6.4.m4.1.1.3">subscript</csymbol><ci id="S5.SS6.p6.4.m4.1.1.3.2.cmml" xref="S5.SS6.p6.4.m4.1.1.3.2">𝑀</ci><ci id="S5.SS6.p6.4.m4.1.1.3.3.cmml" xref="S5.SS6.p6.4.m4.1.1.3.3">vir</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p6.4.m4.1c">M_{*}-M_{\rm vir}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p6.4.m4.1d">italic_M start_POSTSUBSCRIPT * end_POSTSUBSCRIPT - italic_M start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT</annotation></semantics></math> relation. Instead, increasing <math alttext="\eta_{\rm E}" class="ltx_Math" display="inline" id="S5.SS6.p6.5.m5.1"><semantics id="S5.SS6.p6.5.m5.1a"><msub id="S5.SS6.p6.5.m5.1.1" xref="S5.SS6.p6.5.m5.1.1.cmml"><mi id="S5.SS6.p6.5.m5.1.1.2" xref="S5.SS6.p6.5.m5.1.1.2.cmml">η</mi><mi id="S5.SS6.p6.5.m5.1.1.3" mathvariant="normal" xref="S5.SS6.p6.5.m5.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p6.5.m5.1b"><apply id="S5.SS6.p6.5.m5.1.1.cmml" xref="S5.SS6.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS6.p6.5.m5.1.1.1.cmml" xref="S5.SS6.p6.5.m5.1.1">subscript</csymbol><ci id="S5.SS6.p6.5.m5.1.1.2.cmml" xref="S5.SS6.p6.5.m5.1.1.2">𝜂</ci><ci id="S5.SS6.p6.5.m5.1.1.3.cmml" xref="S5.SS6.p6.5.m5.1.1.3">E</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p6.5.m5.1c">\eta_{\rm E}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p6.5.m5.1d">italic_η start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT</annotation></semantics></math> can heat the CGM, prevent gas accretion, reduce star formation and alter the normalization and shape of the <math alttext="M_{*}-M_{\rm vir}" class="ltx_Math" display="inline" id="S5.SS6.p6.6.m6.1"><semantics id="S5.SS6.p6.6.m6.1a"><mrow id="S5.SS6.p6.6.m6.1.1" xref="S5.SS6.p6.6.m6.1.1.cmml"><msub id="S5.SS6.p6.6.m6.1.1.2" xref="S5.SS6.p6.6.m6.1.1.2.cmml"><mi id="S5.SS6.p6.6.m6.1.1.2.2" xref="S5.SS6.p6.6.m6.1.1.2.2.cmml">M</mi><mo id="S5.SS6.p6.6.m6.1.1.2.3" xref="S5.SS6.p6.6.m6.1.1.2.3.cmml">*</mo></msub><mo id="S5.SS6.p6.6.m6.1.1.1" xref="S5.SS6.p6.6.m6.1.1.1.cmml">−</mo><msub id="S5.SS6.p6.6.m6.1.1.3" xref="S5.SS6.p6.6.m6.1.1.3.cmml"><mi id="S5.SS6.p6.6.m6.1.1.3.2" xref="S5.SS6.p6.6.m6.1.1.3.2.cmml">M</mi><mi id="S5.SS6.p6.6.m6.1.1.3.3" xref="S5.SS6.p6.6.m6.1.1.3.3.cmml">vir</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p6.6.m6.1b"><apply id="S5.SS6.p6.6.m6.1.1.cmml" xref="S5.SS6.p6.6.m6.1.1"><minus id="S5.SS6.p6.6.m6.1.1.1.cmml" xref="S5.SS6.p6.6.m6.1.1.1"></minus><apply id="S5.SS6.p6.6.m6.1.1.2.cmml" xref="S5.SS6.p6.6.m6.1.1.2"><csymbol cd="ambiguous" id="S5.SS6.p6.6.m6.1.1.2.1.cmml" xref="S5.SS6.p6.6.m6.1.1.2">subscript</csymbol><ci id="S5.SS6.p6.6.m6.1.1.2.2.cmml" xref="S5.SS6.p6.6.m6.1.1.2.2">𝑀</ci><times id="S5.SS6.p6.6.m6.1.1.2.3.cmml" xref="S5.SS6.p6.6.m6.1.1.2.3"></times></apply><apply id="S5.SS6.p6.6.m6.1.1.3.cmml" xref="S5.SS6.p6.6.m6.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p6.6.m6.1.1.3.1.cmml" xref="S5.SS6.p6.6.m6.1.1.3">subscript</csymbol><ci id="S5.SS6.p6.6.m6.1.1.3.2.cmml" xref="S5.SS6.p6.6.m6.1.1.3.2">𝑀</ci><ci id="S5.SS6.p6.6.m6.1.1.3.3.cmml" xref="S5.SS6.p6.6.m6.1.1.3.3">vir</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p6.6.m6.1c">M_{*}-M_{\rm vir}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p6.6.m6.1d">italic_M start_POSTSUBSCRIPT * end_POSTSUBSCRIPT - italic_M start_POSTSUBSCRIPT roman_vir end_POSTSUBSCRIPT</annotation></semantics></math> relation. In the future, it will be compelling to use <span class="ltx_text ltx_font_typewriter" id="S5.SS6.p6.8.1">fishnets</span> to understand what additional galaxy properties output by <span class="ltx_text ltx_font_typewriter" id="S5.SS6.p6.8.2">sapphire</span> contain the information needed to better learn both <math alttext="\eta_{\rm M}" class="ltx_Math" display="inline" id="S5.SS6.p6.7.m7.1"><semantics id="S5.SS6.p6.7.m7.1a"><msub id="S5.SS6.p6.7.m7.1.1" xref="S5.SS6.p6.7.m7.1.1.cmml"><mi id="S5.SS6.p6.7.m7.1.1.2" xref="S5.SS6.p6.7.m7.1.1.2.cmml">η</mi><mi id="S5.SS6.p6.7.m7.1.1.3" mathvariant="normal" xref="S5.SS6.p6.7.m7.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p6.7.m7.1b"><apply id="S5.SS6.p6.7.m7.1.1.cmml" xref="S5.SS6.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS6.p6.7.m7.1.1.1.cmml" xref="S5.SS6.p6.7.m7.1.1">subscript</csymbol><ci id="S5.SS6.p6.7.m7.1.1.2.cmml" xref="S5.SS6.p6.7.m7.1.1.2">𝜂</ci><ci id="S5.SS6.p6.7.m7.1.1.3.cmml" xref="S5.SS6.p6.7.m7.1.1.3">M</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p6.7.m7.1c">\eta_{\rm M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p6.7.m7.1d">italic_η start_POSTSUBSCRIPT roman_M end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\eta_{\rm E}" class="ltx_Math" display="inline" id="S5.SS6.p6.8.m8.1"><semantics id="S5.SS6.p6.8.m8.1a"><msub id="S5.SS6.p6.8.m8.1.1" xref="S5.SS6.p6.8.m8.1.1.cmml"><mi id="S5.SS6.p6.8.m8.1.1.2" xref="S5.SS6.p6.8.m8.1.1.2.cmml">η</mi><mi id="S5.SS6.p6.8.m8.1.1.3" mathvariant="normal" xref="S5.SS6.p6.8.m8.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p6.8.m8.1b"><apply id="S5.SS6.p6.8.m8.1.1.cmml" xref="S5.SS6.p6.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS6.p6.8.m8.1.1.1.cmml" xref="S5.SS6.p6.8.m8.1.1">subscript</csymbol><ci id="S5.SS6.p6.8.m8.1.1.2.cmml" xref="S5.SS6.p6.8.m8.1.1.2">𝜂</ci><ci id="S5.SS6.p6.8.m8.1.1.3.cmml" xref="S5.SS6.p6.8.m8.1.1.3">E</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p6.8.m8.1c">\eta_{\rm E}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p6.8.m8.1d">italic_η start_POSTSUBSCRIPT roman_E end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">ILI methods are guaranteed to recover the true posterior under the assumptions that:</p>
<ol class="ltx_enumerate" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.1">There is a sufficient amount of training data to cover data and parameter space.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S6.I1.i2.p1">
<p class="ltx_p" id="S6.I1.i2.p1.1">The training data or simulator is reflective of reality.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S6.I1.i3.p1">
<p class="ltx_p" id="S6.I1.i3.p1.1">The chosen neural architecture is sufficiently flexible to capture the data-parameter relationship.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S6.p1.2">Despite the best practices implemented in <span class="ltx_text ltx_font_smallcaps" id="S6.p1.2.1">LtU-ILI</span>, biases may occur when these assumptions are violated. Before applying these approaches to real observational data, it is crucial to understand these failure modes, as well as how to build inference pipelines to be robust to them.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">When training data is limited, ILI methods may overfit to a subset of parameter space and suffer from poor out-of-sample performance. This behavior has led to recent discussion as to whether ILI methods are systematically overconfident <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx98" title="">Hermans <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Hermans, Delaunoy, Rozet, Wehenkel, Begy, and Louppe</a>)</cite>. PIT tests
(§<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S2.SS4" title="2.4 Validation ‣ 2 Implicit Likelihood Inference ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">2.4</span></a>) on independent validation sets are a useful diagnostic tool for detecting overconfidence. For a fixed simulation budget, this problem can be mitigated through the use of ensembling <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx98" title="">Hermans <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Hermans, Delaunoy, Rozet, Wehenkel, Begy, and Louppe</a>)</cite>. Ensembling averages the predictions of multiple, independently trained models together, naturally inflating predictive uncertainty to account for epistemic bias <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx27" title="">Lakshminarayanan <em class="ltx_emph ltx_font_italic">et al.</em>(2017)Lakshminarayanan, Pritzel, and Blundell</a>)</cite>. Another approach is the frequentist recalibration of error bars <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx144" title="">Masserano <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Masserano, Dorigo, Izbicki, Kuusela, and Lee</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">Model misspecification occurs when the data-generating function for creating training data is poorly representative of physical processes in the real world <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx145" title="">Cannon <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Cannon, Ward, and Schmon</a>)</cite>. This can cause an implicit model to interpret the wrong data-parameter connection, resulting in biased predictions. In astrophysics and cosmology, combating model misspecification often requires running more realistic, high-resolution simulators which can be more computationally demanding. In turn, this reduces the number of available simulations, damaging assumption (1). Alternative approaches include increasing the noise model of a given simulation <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S6.p3.1.1.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx33" title="">Modi <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Modi, Pandey, Ho, Hahn, Blancard, and Wandelt</a>)</cite>, training NDEs with a conservative loss to inflate uncertainties and counteract misspecification <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S6.p3.1.2.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx146" title="">Kelly <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Kelly, Nott, Frazier, Warne, and Drovandi</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx147" title="">Huang <em class="ltx_emph ltx_font_italic">et al.</em>(2023)Huang, Bharti, Souza, Acerbi, and Kaski</a>)</cite>,
or using latent functions present within intermediate layers of the Bayesian hierarchical model as diagnostics <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S6.p3.1.3.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx148" title="">Leclercq(2022)</a>)</cite>. In addition, Bayesian model comparison <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx136" title="">Silva <em class="ltx_emph ltx_font_italic">et al.</em>(1998)Silva, Granato, Bressan, and Danese</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx149" title="">Handley <em class="ltx_emph ltx_font_italic">et al.</em>(2015)Handley, Hobson, and Lasenby</a>)</cite> is an effective tool for distinguishing between various models conditioned on real data, but also relies on massive simulation budgets. Recent work such as Evidence Networks <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx150" title="">Jeffrey and Wandelt(2024)</a>)</cite> has shown that this process can be greatly accelerated through the application of neural networks.
</p>
</div>
<div class="ltx_para" id="S6.p4">
<p class="ltx_p" id="S6.p4.2">Lastly, implicit inference can be very challenging in the high-dimensional parameter regime (<em class="ltx_emph ltx_font_italic" id="S6.p4.2.1">i.e.,</em> when <math alttext="\operatorname{dim}(\bm{\theta})\gg 100" class="ltx_Math" display="inline" id="S6.p4.1.m1.2"><semantics id="S6.p4.1.m1.2a"><mrow id="S6.p4.1.m1.2.3" xref="S6.p4.1.m1.2.3.cmml"><mrow id="S6.p4.1.m1.2.3.2.2" xref="S6.p4.1.m1.2.3.2.1.cmml"><mi id="S6.p4.1.m1.1.1" xref="S6.p4.1.m1.1.1.cmml">dim</mi><mo id="S6.p4.1.m1.2.3.2.2a" xref="S6.p4.1.m1.2.3.2.1.cmml">⁡</mo><mrow id="S6.p4.1.m1.2.3.2.2.1" xref="S6.p4.1.m1.2.3.2.1.cmml"><mo id="S6.p4.1.m1.2.3.2.2.1.1" stretchy="false" xref="S6.p4.1.m1.2.3.2.1.cmml">(</mo><mi id="S6.p4.1.m1.2.2" xref="S6.p4.1.m1.2.2.cmml">𝜽</mi><mo id="S6.p4.1.m1.2.3.2.2.1.2" stretchy="false" xref="S6.p4.1.m1.2.3.2.1.cmml">)</mo></mrow></mrow><mo id="S6.p4.1.m1.2.3.1" xref="S6.p4.1.m1.2.3.1.cmml">≫</mo><mn id="S6.p4.1.m1.2.3.3" xref="S6.p4.1.m1.2.3.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p4.1.m1.2b"><apply id="S6.p4.1.m1.2.3.cmml" xref="S6.p4.1.m1.2.3"><csymbol cd="latexml" id="S6.p4.1.m1.2.3.1.cmml" xref="S6.p4.1.m1.2.3.1">much-greater-than</csymbol><apply id="S6.p4.1.m1.2.3.2.1.cmml" xref="S6.p4.1.m1.2.3.2.2"><ci id="S6.p4.1.m1.1.1.cmml" xref="S6.p4.1.m1.1.1">dim</ci><ci id="S6.p4.1.m1.2.2.cmml" xref="S6.p4.1.m1.2.2">𝜽</ci></apply><cn id="S6.p4.1.m1.2.3.3.cmml" type="integer" xref="S6.p4.1.m1.2.3.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.1.m1.2c">\operatorname{dim}(\bm{\theta})\gg 100</annotation><annotation encoding="application/x-llamapun" id="S6.p4.1.m1.2d">roman_dim ( bold_italic_θ ) ≫ 100</annotation></semantics></math>). As the dimensionality of <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S6.p4.2.m2.1"><semantics id="S6.p4.2.m2.1a"><mi id="S6.p4.2.m2.1.1" xref="S6.p4.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S6.p4.2.m2.1b"><ci id="S6.p4.2.m2.1.1.cmml" xref="S6.p4.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.2.m2.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S6.p4.2.m2.1d">bold_italic_θ</annotation></semantics></math> increases, the number of parameters necessary to specify a highly-correlated posterior increases exponentially. This problem is of particular relevance in astrophysics and cosmology, in which we often would like to infer voxelized 2D or 3D fields <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S6.p4.2.2.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx151" title="">Jasche and Wandelt(2013)</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx152" title="">de Andres <em class="ltx_emph ltx_font_italic">et al.</em>(2024)de Andres, Cui, Yepes, De Petris, Ferragamo, De Luca, Aversano, and Rennehan</a>)</cite>.
Recent empirical evidence suggests that Moment Networks <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx153" title="">Jeffrey and Wandelt(2020)</a>)</cite> and diffusion-based generative models <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx75" title="">Song <em class="ltx_emph ltx_font_italic">et al.</em>(2020)Song, Sohl-Dickstein, Kingma, Kumar, Ermon, and Poole</a>; <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx154" title="">Legin <em class="ltx_emph ltx_font_italic">et al.</em>(2024)Legin, Ho, Lemos, Perreault-Levasseur, Ho, Hezaveh, and Wandelt</a>)</cite> are incredibly effective neural architectures for these tasks. Though <span class="ltx_text ltx_font_smallcaps" id="S6.p4.2.3">LtU-ILI</span> does not currently include these models, we intend to implement them in future work.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In conclusion, we have introduced <span class="ltx_text ltx_font_smallcaps" id="S7.p1.1.1">LtU-ILI</span>, a comprehensive framework designed for implicit inference in scientific applications.
<span class="ltx_text ltx_font_smallcaps" id="S7.p1.1.2">LtU-ILI</span> provides extensive routines to facilitate the training of neural networks for regression posterior inference, aimed in particular at cases in which the likelihood is intractable. The code encapsulates best practices and state-of-the-art models, ensuring adaptability to a broad spectrum of scientific domains. By consolidating the training, testing, and robustness assessment of ILI models into a unified, modular package, <span class="ltx_text ltx_font_smallcaps" id="S7.p1.1.3">LtU-ILI</span> streamlines the process of addressing novel inference problems while providing for production-level inference and hyperparameter searches, making it accessible to researchers both experienced and novice.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">In this manuscript, we have explained the theoretical basis of ILI, described the current features of <span class="ltx_text ltx_font_smallcaps" id="S7.p2.1.1">LtU-ILI</span> in detail, and provided benchmarks and science examples on a variety of astronomy and cosmology inference problems. Our results demonstrate that <span class="ltx_text ltx_font_smallcaps" id="S7.p2.1.2">LtU-ILI</span> yields competitive constraints on both synthetic and real science examples, indicating that these methods are ready out-of-the-box for application to new problems.</p>
</div>
<div class="ltx_para" id="S7.p3">
<p class="ltx_p" id="S7.p3.1">Looking ahead, this framework can be applied to accelerate the analyses of large surveys such as SDSS, Planck, VRO, Euclid, DESI, and JWST.
We also aim to provide exhaustive benchmarks on the variety of problems described in Section <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#S5" title="5 Science Experiments ‣ LtU-ILI: An All-in-One Framework for Implicit Inference in Astrophysics and Cosmology"><span class="ltx_text ltx_ref_tag">5</span></a>, contributing to the formalization of machine learning analyses in astronomy and beyond.
We intend to integrate <span class="ltx_text ltx_font_smallcaps" id="S7.p3.1.1">LtU-ILI</span> with state-of-the-art hyperparameter tuning <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S7.p3.1.2.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx155" title="">Akiba <em class="ltx_emph ltx_font_italic">et al.</em>(2019)Akiba, Sano, Yanase, Ohta, and Koyama</a>)</cite> to provide an automatic, yet principled way for doing model selection.
In addition, current approaches for calibrating posterior coverage rely on tweaking hyperparameters and retraining. An alternative approach is to implement recalibration methods <cite class="ltx_cite ltx_citemacro_citep">(<em class="ltx_emph ltx_font_italic" id="S7.p3.1.3.1">e.g.,</em> <a class="ltx_ref" href="https://arxiv.org/html/2402.05137v1#bib.bibx144" title="">Masserano <em class="ltx_emph ltx_font_italic">et al.</em>(2022)Masserano, Dorigo, Izbicki, Kuusela, and Lee</a>)</cite> which correctly calibrate posteriors given an independent validation set. We reserve implementation and analysis of these improvements to future work.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
We thank Rosa Malandrino, Niall Jeffrey, and Justin Alsing for useful comments and suggestions on developing the codebase and writing the manuscript.
This project was developed as part of the Simons Collaboration on “Learning the Universe.”

</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bibx1">
<span class="ltx_tag ltx_tag_bibitem">[Feigelson and Babu(2012)]</span>
<span class="ltx_bibblock">E. D. Feigelson and G. J. Babu, <em class="ltx_emph ltx_font_italic" id="bib.bibx1.1.1">Modern statistical methods for astronomy: with R applications</em> (Cambridge University Press, 2012). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx2">
<span class="ltx_tag ltx_tag_bibitem">[Dodelson and Schmidt(2020)]</span>
<span class="ltx_bibblock">S. Dodelson and F. Schmidt, <em class="ltx_emph ltx_font_italic" id="bib.bibx2.1.1">Modern cosmology</em> (Academic press, 2020). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx3">
<span class="ltx_tag ltx_tag_bibitem">[Eadie <em class="ltx_emph ltx_font_italic" id="bib.bibx3.1.1.1">et al.</em>(2023)Eadie, Speagle, Cisewski-Kehe, Foreman-Mackey, Huppenkothen, Jones, Springford, and Tak]</span>
<span class="ltx_bibblock">G. M. Eadie, J. S. Speagle, J. Cisewski-Kehe, D. Foreman-Mackey, D. Huppenkothen, D. E. Jones, A. Springford,  and H. Tak, arXiv preprint arXiv:2302.04703  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx4">
<span class="ltx_tag ltx_tag_bibitem">[National Academies of Sciences, Engineering, and Medicine(2023)]</span>
<span class="ltx_bibblock">National Academies of Sciences, Engineering, and Medicine, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.17226/26141" title=""><em class="ltx_emph ltx_font_italic" id="bib.bibx4.1.1.1">Pathways to Discovery in Astronomy and Astrophysics for the 2020s</em></a> (The National Academies Press, Washington, DC, 2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx5">
<span class="ltx_tag ltx_tag_bibitem">[Carleo <em class="ltx_emph ltx_font_italic" id="bib.bibx5.1.1.1">et al.</em>(2019)Carleo, Cirac, Cranmer, Daudet, Schuld, Tishby, Vogt-Maranto, and Zdeborová]</span>
<span class="ltx_bibblock">G. Carleo, I. Cirac, K. Cranmer, L. Daudet, M. Schuld, N. Tishby, L. Vogt-Maranto,  and L. Zdeborová, Reviews of Modern Physics <span class="ltx_text ltx_font_bold" id="bib.bibx5.4.1">91</span>, 045002 (2019). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx6">
<span class="ltx_tag ltx_tag_bibitem">[Huppenkothen <em class="ltx_emph ltx_font_italic" id="bib.bibx6.1.1.1">et al.</em>(2023)Huppenkothen, Ntampaka, Ho, Fouesneau, Nord, Peek, Walmsley, Wu, Avestruz, Buck <em class="ltx_emph ltx_font_italic" id="bib.bibx6.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">D. Huppenkothen, M. Ntampaka, M. Ho, M. Fouesneau, B. Nord, J. Peek, M. Walmsley, J. F. Wu, C. Avestruz, T. Buck, <em class="ltx_emph ltx_font_italic" id="bib.bibx6.7.1">et al.</em>, arXiv preprint arXiv:2310.12528  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx7">
<span class="ltx_tag ltx_tag_bibitem">[Cranmer <em class="ltx_emph ltx_font_italic" id="bib.bibx7.1.1.1">et al.</em>(2020)Cranmer, Brehmer, and Louppe]</span>
<span class="ltx_bibblock">K. Cranmer, J. Brehmer,  and G. Louppe, Proceedings of the National Academy of Sciences <span class="ltx_text ltx_font_bold" id="bib.bibx7.4.1">117</span>, 30055 (2020). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx8">
<span class="ltx_tag ltx_tag_bibitem">[Marin <em class="ltx_emph ltx_font_italic" id="bib.bibx8.1.1.1">et al.</em>(2012)Marin, Pudlo, Robert, and Ryder]</span>
<span class="ltx_bibblock">J.-M. Marin, P. Pudlo, C. P. Robert,  and R. J. Ryder, Statistics and computing <span class="ltx_text ltx_font_bold" id="bib.bibx8.4.1">22</span>, 1167 (2012). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx9">
<span class="ltx_tag ltx_tag_bibitem">[Christensen <em class="ltx_emph ltx_font_italic" id="bib.bibx9.1.1.1">et al.</em>(2001)Christensen, Meyer, Knox, and Luey]</span>
<span class="ltx_bibblock">N. Christensen, R. Meyer, L. Knox,  and B. Luey, Classical and Quantum Gravity <span class="ltx_text ltx_font_bold" id="bib.bibx9.4.1">18</span>, 2677 (2001). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx10">
<span class="ltx_tag ltx_tag_bibitem">[Brooks <em class="ltx_emph ltx_font_italic" id="bib.bibx10.1.1.1">et al.</em>(2011)Brooks, Gelman, Jones, and Meng]</span>
<span class="ltx_bibblock">S. Brooks, A. Gelman, G. Jones,  and X.-L. Meng, <em class="ltx_emph ltx_font_italic" id="bib.bibx10.4.1">Handbook of markov chain monte carlo</em> (CRC press, 2011). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx11">
<span class="ltx_tag ltx_tag_bibitem">[Jeffrey <em class="ltx_emph ltx_font_italic" id="bib.bibx11.1.1.1">et al.</em>(2021)Jeffrey, Alsing, and Lanusse]</span>
<span class="ltx_bibblock">N. Jeffrey, J. Alsing,  and F. Lanusse, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx11.4.1">501</span>, 954 (2021). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx12">
<span class="ltx_tag ltx_tag_bibitem">[Makinen <em class="ltx_emph ltx_font_italic" id="bib.bibx12.1.1.1">et al.</em>(2021)Makinen, Charnock, Alsing, and Wandelt]</span>
<span class="ltx_bibblock">T. L. Makinen, T. Charnock, J. Alsing,  and B. D. Wandelt, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1088/1475-7516/2021/11/049" title="">Journal of Cosmology and Astroparticle Physics <span class="ltx_text ltx_font_bold" id="bib.bibx12.4.1.1">2021</span>, 049 (2021)</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx13">
<span class="ltx_tag ltx_tag_bibitem">[Makinen <em class="ltx_emph ltx_font_italic" id="bib.bibx13.1.1.1">et al.</em>(2022a)Makinen, Charnock, Lemos, Porqueres, Heavens, and Wandelt]</span>
<span class="ltx_bibblock">T. L. Makinen, T. Charnock, P. Lemos, N. Porqueres, A. F. Heavens,  and B. D. Wandelt, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.21105/astro.2207.05202" title="">The Open Journal of Astrophysics <span class="ltx_text ltx_font_bold" id="bib.bibx13.4.1.1">5</span> (2022a), 10.21105/astro.2207.05202</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx14">
<span class="ltx_tag ltx_tag_bibitem">[de Santi <em class="ltx_emph ltx_font_italic" id="bib.bibx14.1.1.1">et al.</em>(2023a)de Santi, Shao, Villaescusa-Navarro, Abramo, Teyssier, Villanueva-Domingo, Ni, Anglés-Alcázar, Genel, Hernandez-Martinez <em class="ltx_emph ltx_font_italic" id="bib.bibx14.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">N. S. de Santi, H. Shao, F. Villaescusa-Navarro, L. R. Abramo, R. Teyssier, P. Villanueva-Domingo, Y. Ni, D. Anglés-Alcázar, S. Genel, E. Hernandez-Martinez, <em class="ltx_emph ltx_font_italic" id="bib.bibx14.7.1">et al.</em>, arXiv preprint arXiv:2302.14101  (2023a). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx15">
<span class="ltx_tag ltx_tag_bibitem">[Hahn <em class="ltx_emph ltx_font_italic" id="bib.bibx15.1.1.1">et al.</em>(2023)Hahn, Lemos, Parker, Blancard, Eickenberg, Ho, Hou, Massara, Modi, Dizgah <em class="ltx_emph ltx_font_italic" id="bib.bibx15.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">C. Hahn, P. Lemos, L. Parker, B. R.-S. Blancard, M. Eickenberg, S. Ho, J. Hou, E. Massara, C. Modi, A. M. Dizgah, <em class="ltx_emph ltx_font_italic" id="bib.bibx15.7.1">et al.</em>, arXiv preprint arXiv:2310.15246  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx16">
<span class="ltx_tag ltx_tag_bibitem">[Dax <em class="ltx_emph ltx_font_italic" id="bib.bibx16.1.1.1">et al.</em>(2021a)Dax, Green, Gair, Macke, Buonanno, and Schölkopf]</span>
<span class="ltx_bibblock">M. Dax, S. R. Green, J. Gair, J. H. Macke, A. Buonanno,  and B. Schölkopf, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevLett.127.241103" title="">Phys. Rev. Lett. <span class="ltx_text ltx_font_bold" id="bib.bibx16.4.1.1">127</span>, 241103 (2021a)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2106.12594" title="">arXiv:2106.12594 [gr-qc]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx17">
<span class="ltx_tag ltx_tag_bibitem">[Cheung <em class="ltx_emph ltx_font_italic" id="bib.bibx17.1.1.1">et al.</em>(2022)Cheung, Wong, Hannuksela, Li, and Ho]</span>
<span class="ltx_bibblock">D. H. Cheung, K. W. Wong, O. A. Hannuksela, T. G. Li,  and S. Ho, Physical Review D <span class="ltx_text ltx_font_bold" id="bib.bibx17.4.1">106</span>, 083014 (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx18">
<span class="ltx_tag ltx_tag_bibitem">[Ho <em class="ltx_emph ltx_font_italic" id="bib.bibx18.1.1.1">et al.</em>(2022)Ho, Ntampaka, Rau, Chen, Lansberry, Ruehle, and Trac]</span>
<span class="ltx_bibblock">M. Ho, M. Ntampaka, M. M. Rau, M. Chen, A. Lansberry, F. Ruehle,  and H. Trac, Nature Astronomy <span class="ltx_text ltx_font_bold" id="bib.bibx18.4.1">6</span>, 936 (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx19">
<span class="ltx_tag ltx_tag_bibitem">[de Andres <em class="ltx_emph ltx_font_italic" id="bib.bibx19.1.1.1">et al.</em>(2022)de Andres, Cui, Ruppin, De Petris, Yepes, Gianfagna, Lahouli, Aversano, Dupuis, Jarraya <em class="ltx_emph ltx_font_italic" id="bib.bibx19.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">D. de Andres, W. Cui, F. Ruppin, M. De Petris, G. Yepes, G. Gianfagna, I. Lahouli, G. Aversano, R. Dupuis, M. Jarraya, <em class="ltx_emph ltx_font_italic" id="bib.bibx19.7.1">et al.</em>, Nature Astronomy <span class="ltx_text ltx_font_bold" id="bib.bibx19.8.2">6</span>, 1325 (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx20">
<span class="ltx_tag ltx_tag_bibitem">[Walmsley <em class="ltx_emph ltx_font_italic" id="bib.bibx20.1.1.1">et al.</em>(2020)Walmsley, Smith, Lintott, Gal, Bamford, Dickinson, Fortson, Kruk, Masters, Scarlata <em class="ltx_emph ltx_font_italic" id="bib.bibx20.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">M. Walmsley, L. Smith, C. Lintott, Y. Gal, S. Bamford, H. Dickinson, L. Fortson, S. Kruk, K. Masters, C. Scarlata, <em class="ltx_emph ltx_font_italic" id="bib.bibx20.7.1">et al.</em>, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx20.8.2">491</span>, 1554 (2020). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx21">
<span class="ltx_tag ltx_tag_bibitem">[Ghosh <em class="ltx_emph ltx_font_italic" id="bib.bibx21.1.1.1">et al.</em>(2022)Ghosh, Urry, Rau, Perreault-Levasseur, Cranmer, Schawinski, Stark, Tian, Ofman, Ananna <em class="ltx_emph ltx_font_italic" id="bib.bibx21.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">A. Ghosh, C. M. Urry, A. Rau, L. Perreault-Levasseur, M. Cranmer, K. Schawinski, D. Stark, C. Tian, R. Ofman, T. T. Ananna, <em class="ltx_emph ltx_font_italic" id="bib.bibx21.7.1">et al.</em>, The Astrophysical Journal <span class="ltx_text ltx_font_bold" id="bib.bibx21.8.2">935</span>, 138 (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx22">
<span class="ltx_tag ltx_tag_bibitem">[Hermans <em class="ltx_emph ltx_font_italic" id="bib.bibx22.1.1.1">et al.</em>(2021)Hermans, Banik, Weniger, Bertone, and Louppe]</span>
<span class="ltx_bibblock">J. Hermans, N. Banik, C. Weniger, G. Bertone,  and G. Louppe, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx22.4.1">507</span>, 1999 (2021). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx23">
<span class="ltx_tag ltx_tag_bibitem">[Alvey <em class="ltx_emph ltx_font_italic" id="bib.bibx23.1.1.1">et al.</em>(2023)Alvey, Gerdes, and Weniger]</span>
<span class="ltx_bibblock">J. Alvey, M. Gerdes,  and C. Weniger, arXiv preprint arXiv:2304.02032  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx24">
<span class="ltx_tag ltx_tag_bibitem">[Rogers <em class="ltx_emph ltx_font_italic" id="bib.bibx24.1.1.1">et al.</em>(2023)Rogers, Janó Muñoz, Owen, and Makinen]</span>
<span class="ltx_bibblock">J. G. Rogers, C. Janó Muñoz, J. E. Owen,  and T. L. Makinen, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx24.4.1">519</span>, 6028 (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx25">
<span class="ltx_tag ltx_tag_bibitem">[Aubin <em class="ltx_emph ltx_font_italic" id="bib.bibx25.1.1.1">et al.</em>(2023)Aubin, Cuesta-Lazaro, Tregidga, Viaña, Garraffo, Gordon, López-Morales, Hargreaves, Makhnev, Drake <em class="ltx_emph ltx_font_italic" id="bib.bibx25.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">M. Aubin, C. Cuesta-Lazaro, E. Tregidga, J. Viaña, C. Garraffo, I. E. Gordon, M. López-Morales, R. J. Hargreaves, V. Y. Makhnev, J. J. Drake, <em class="ltx_emph ltx_font_italic" id="bib.bibx25.7.1">et al.</em>, arXiv preprint arXiv:2309.09337  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx26">
<span class="ltx_tag ltx_tag_bibitem">[Gal and Ghahramani(2016)]</span>
<span class="ltx_bibblock">Y. Gal and Z. Ghahramani, in <em class="ltx_emph ltx_font_italic" id="bib.bibx26.1.1">international conference on machine learning</em> (PMLR, 2016) pp. 1050–1059. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx27">
<span class="ltx_tag ltx_tag_bibitem">[Lakshminarayanan <em class="ltx_emph ltx_font_italic" id="bib.bibx27.1.1.1">et al.</em>(2017)Lakshminarayanan, Pritzel, and Blundell]</span>
<span class="ltx_bibblock">B. Lakshminarayanan, A. Pritzel,  and C. Blundell, Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bibx27.4.1">30</span> (2017). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx28">
<span class="ltx_tag ltx_tag_bibitem">[Maddox <em class="ltx_emph ltx_font_italic" id="bib.bibx28.1.1.1">et al.</em>(2019)Maddox, Izmailov, Garipov, Vetrov, and Wilson]</span>
<span class="ltx_bibblock">W. J. Maddox, P. Izmailov, T. Garipov, D. P. Vetrov,  and A. G. Wilson, Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bibx28.4.1">32</span> (2019). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx29">
<span class="ltx_tag ltx_tag_bibitem">[Lemos <em class="ltx_emph ltx_font_italic" id="bib.bibx29.1.1.1">et al.</em>(2023)Lemos, Cranmer, Abidi, Hahn, Eickenberg, Massara, Yallup, and Ho]</span>
<span class="ltx_bibblock">P. Lemos, M. Cranmer, M. Abidi, C. Hahn, M. Eickenberg, E. Massara, D. Yallup,  and S. Ho, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1088/2632-2153/acbb53" title="">Machine Learning: Science and Technology <span class="ltx_text ltx_font_bold" id="bib.bibx29.4.1.1">4</span>, 01LT01 (2023)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2207.08435" title="">arXiv:2207.08435 [astro-ph.CO]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx30">
<span class="ltx_tag ltx_tag_bibitem">[Jin <em class="ltx_emph ltx_font_italic" id="bib.bibx30.1.1.1">et al.</em>(2019)Jin, Song, and Hu]</span>
<span class="ltx_bibblock">H. Jin, Q. Song,  and X. Hu, in <em class="ltx_emph ltx_font_italic" id="bib.bibx30.4.1">Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em> (2019) pp. 1946–1956. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx31">
<span class="ltx_tag ltx_tag_bibitem">[White <em class="ltx_emph ltx_font_italic" id="bib.bibx31.1.1.1">et al.</em>(2021)White, Neiswanger, and Savani]</span>
<span class="ltx_bibblock">C. White, W. Neiswanger,  and Y. Savani, in <em class="ltx_emph ltx_font_italic" id="bib.bibx31.4.1">Proceedings of the AAAI Conference on Artificial Intelligence</em> (2021). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx32">
<span class="ltx_tag ltx_tag_bibitem">[Wang <em class="ltx_emph ltx_font_italic" id="bib.bibx32.1.1.1">et al.</em>(2023)Wang, Leja, Villar, and Speagle]</span>
<span class="ltx_bibblock">B. Wang, J. Leja, V. A. Villar,  and J. S. Speagle, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.3847/2041-8213/ace361" title="">ApJ <span class="ltx_text ltx_font_bold" id="bib.bibx32.4.1.1">952</span>, L10 (2023)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2304.05281" title="">arXiv:2304.05281 [astro-ph.IM]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx33">
<span class="ltx_tag ltx_tag_bibitem">[Modi <em class="ltx_emph ltx_font_italic" id="bib.bibx33.1.1.1">et al.</em>(2023)Modi, Pandey, Ho, Hahn, Blancard, and Wandelt]</span>
<span class="ltx_bibblock">C. Modi, S. Pandey, M. Ho, C. Hahn, B. Blancard,  and B. Wandelt, arXiv preprint arXiv:2309.15071  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx34">
<span class="ltx_tag ltx_tag_bibitem">[Tejero-Cantero <em class="ltx_emph ltx_font_italic" id="bib.bibx34.1.1.1">et al.</em>(2020)Tejero-Cantero, Boelts, Deistler, Lueckmann, Durkan, Gonçalves, Greenberg, and Macke]</span>
<span class="ltx_bibblock">A. Tejero-Cantero, J. Boelts, M. Deistler, J.-M. Lueckmann, C. Durkan, P. J. Gonçalves, D. S. Greenberg,  and J. H. Macke, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.21105/joss.02505" title="">Journal of Open Source Software <span class="ltx_text ltx_font_bold" id="bib.bibx34.4.1.1">5</span>, 2505 (2020)</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx35">
<span class="ltx_tag ltx_tag_bibitem">[Alsing <em class="ltx_emph ltx_font_italic" id="bib.bibx35.1.1.1">et al.</em>(2019)Alsing, Charnock, Feeney, and Wandelt]</span>
<span class="ltx_bibblock">J. Alsing, T. Charnock, S. Feeney,  and B. Wandelt, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx35.4.1">488</span>, 4440 (2019). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx36">
<span class="ltx_tag ltx_tag_bibitem">[Rozet <em class="ltx_emph ltx_font_italic" id="bib.bibx36.1.1.1">et al.</em>(2021)Rozet, Delaunoy, Miller <em class="ltx_emph ltx_font_italic" id="bib.bibx36.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">F. Rozet, A. Delaunoy, B. Miller, <em class="ltx_emph ltx_font_italic" id="bib.bibx36.7.1">et al.</em>, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.5281/zenodo.8405782" title="">“LAMPE: Likelihood-free amortized posterior estimation,” </a> (2021). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx37">
<span class="ltx_tag ltx_tag_bibitem">[Lemos <em class="ltx_emph ltx_font_italic" id="bib.bibx37.1.1.1">et al.</em>(2023)Lemos, Coogan, Hezaveh, and Levasseur]</span>
<span class="ltx_bibblock">P. Lemos, A. Coogan, Y. Hezaveh,  and L. P. Levasseur, in <a class="ltx_ref ltx_href" href="https://proceedings.mlr.press/v202/lemos23a.html" title=""><em class="ltx_emph ltx_font_italic" id="bib.bibx37.4.1.1">International Conference on Machine Learning, ICML 2023, 23-29 July 2023, Honolulu, Hawaii, USA</em></a>, Proceedings of Machine Learning Research, Vol. 202, edited by A. Krause, E. Brunskill, K. Cho, B. Engelhardt, S. Sabato,  and J. Scarlett (PMLR, 2023) pp. 19256–19273. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx38">
<span class="ltx_tag ltx_tag_bibitem">[Zhang <em class="ltx_emph ltx_font_italic" id="bib.bibx38.1.1.1">et al.</em>(2023)Zhang, Bloom, and Hernitschek]</span>
<span class="ltx_bibblock">K. Zhang, J. Bloom,  and N. Hernitschek, in <em class="ltx_emph ltx_font_italic" id="bib.bibx38.4.1">NeurIPS 2023 Workshop on Deep Learning and Inverse Problems</em> (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx39">
<span class="ltx_tag ltx_tag_bibitem">[Tegmark <em class="ltx_emph ltx_font_italic" id="bib.bibx39.1.1.1">et al.</em>(2004)Tegmark, Blanton, Strauss, Hoyle, Schlegel, Scoccimarro, Vogeley, Weinberg, Zehavi, Berlind, Budavari, Connolly, Eisenstein, Finkbeiner, Frieman, Gunn, Hamilton, Hui, Jain, Johnston, Kent, Lin, Nakajima, Nichol, Ostriker, Pope, Scranton, Seljak, Sheth, Stebbins, Szalay, Szapudi, Verde, Xu, Annis, Bahcall,
Brinkmann, Burles, Castander, Csabai, Loveday, Doi, Fukugita, Gott, Hennessy, Hogg, Ivezić, Knapp, Lamb, Lee, Lupton, McKay, Kunszt, Munn, O’Connell, Peoples, Pier, Richmond, Rockosi, Schneider, Stoughton, Tucker, Vanden Berk, Yanny, York, and SDSS Collaboration]</span>
<span class="ltx_bibblock">M. Tegmark, M. R. Blanton, M. A. Strauss, F. Hoyle, D. Schlegel, R. Scoccimarro, M. S. Vogeley, D. H. Weinberg, I. Zehavi, A. Berlind, T. Budavari, A. Connolly, D. J. Eisenstein, D. Finkbeiner, J. A. Frieman, J. E. Gunn, A. J. S. Hamilton, L. Hui, B. Jain, D. Johnston, S. Kent, H. Lin, R. Nakajima, R. C. Nichol, J. P. Ostriker, A. Pope, R. Scranton, U. Seljak, R. K. Sheth, A. Stebbins, A. S. Szalay, I. Szapudi, L. Verde, Y. Xu, J. Annis, N. A. Bahcall, J. Brinkmann, S. Burles, F. J. Castander, I. Csabai, J. Loveday, M. Doi, M. Fukugita, I. Gott, J. Richard, G. Hennessy, D. W. Hogg, Ž. Ivezić, G. R. Knapp, D. Q. Lamb, B. C. Lee, R. H. Lupton, T. A. McKay, P. Kunszt, J. A. Munn, L. O’Connell, J. Peoples, J. R. Pier, M. Richmond, C. Rockosi, D. P. Schneider, C. Stoughton, D. L. Tucker, D. E. Vanden Berk, B. Yanny, D. G. York,  and SDSS Collaboration, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1086/382125" title="">ApJ <span class="ltx_text ltx_font_bold" id="bib.bibx39.4.1.1">606</span>, 702 (2004)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/astro-ph/0310725" title="">arXiv:astro-ph/0310725 [astro-ph]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx40">
<span class="ltx_tag ltx_tag_bibitem">[Christensen and Meyer(2022)]</span>
<span class="ltx_bibblock">N. Christensen and R. Meyer, Reviews of Modern Physics <span class="ltx_text ltx_font_bold" id="bib.bibx40.1.1">94</span>, 025001 (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx41">
<span class="ltx_tag ltx_tag_bibitem">[Porqueres <em class="ltx_emph ltx_font_italic" id="bib.bibx41.1.1.1">et al.</em>(2022)Porqueres, Heavens, Mortlock, and Lavaux]</span>
<span class="ltx_bibblock">N. Porqueres, A. Heavens, D. Mortlock,  and G. Lavaux, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx41.4.1">509</span>, 3194 (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx42">
<span class="ltx_tag ltx_tag_bibitem">[Boese and Doebereiner(2001)]</span>
<span class="ltx_bibblock">F. Boese and S. Doebereiner, Astronomy &amp; Astrophysics <span class="ltx_text ltx_font_bold" id="bib.bibx42.1.1">370</span>, 649 (2001). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx43">
<span class="ltx_tag ltx_tag_bibitem">[Braun <em class="ltx_emph ltx_font_italic" id="bib.bibx43.1.1.1">et al.</em>(2008)Braun, Dumm, De Palma, Finley, Karle, and Montaruli]</span>
<span class="ltx_bibblock">J. Braun, J. Dumm, F. De Palma, C. Finley, A. Karle,  and T. Montaruli, Astroparticle Physics <span class="ltx_text ltx_font_bold" id="bib.bibx43.4.1">29</span>, 299 (2008). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx44">
<span class="ltx_tag ltx_tag_bibitem">[Tsaprazi <em class="ltx_emph ltx_font_italic" id="bib.bibx44.1.1.1">et al.</em>(2022)Tsaprazi, Nguyen, Jasche, Schmidt, and Lavaux]</span>
<span class="ltx_bibblock">E. Tsaprazi, N.-M. Nguyen, J. Jasche, F. Schmidt,  and G. Lavaux, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1088/1475-7516/2022/08/003" title="">J. Cosmology Astropart. Phys <span class="ltx_text ltx_font_bold" id="bib.bibx44.4.1.1">2022</span>, 003 (2022)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2112.04484" title="">arXiv:2112.04484 [astro-ph.CO]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx45">
<span class="ltx_tag ltx_tag_bibitem">[Dingeldein <em class="ltx_emph ltx_font_italic" id="bib.bibx45.1.1.1">et al.</em>(2023)Dingeldein, Cossio, and Covino]</span>
<span class="ltx_bibblock">L. Dingeldein, P. Cossio,  and R. Covino, Machine Learning: Science and Technology <span class="ltx_text ltx_font_bold" id="bib.bibx45.4.1">4</span>, 025009 (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx46">
<span class="ltx_tag ltx_tag_bibitem">[Ntampaka <em class="ltx_emph ltx_font_italic" id="bib.bibx46.1.1.1">et al.</em>(2019)Ntampaka, ZuHone, Eisenstein, Nagai, Vikhlinin, Hernquist, Marinacci, Nelson, Pakmor, Pillepich <em class="ltx_emph ltx_font_italic" id="bib.bibx46.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">M. Ntampaka, J. ZuHone, D. Eisenstein, D. Nagai, A. Vikhlinin, L. Hernquist, F. Marinacci, D. Nelson, R. Pakmor, A. Pillepich, <em class="ltx_emph ltx_font_italic" id="bib.bibx46.7.1">et al.</em>, The Astrophysical Journal <span class="ltx_text ltx_font_bold" id="bib.bibx46.8.2">876</span>, 82 (2019). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx47">
<span class="ltx_tag ltx_tag_bibitem">[Fluri <em class="ltx_emph ltx_font_italic" id="bib.bibx47.1.1.1">et al.</em>(2022)Fluri, Kacprzak, Lucchi, Schneider, Refregier, and Hofmann]</span>
<span class="ltx_bibblock">J. Fluri, T. Kacprzak, A. Lucchi, A. Schneider, A. Refregier,  and T. Hofmann, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevD.105.083518" title="">Phys. Rev. D <span class="ltx_text ltx_font_bold" id="bib.bibx47.4.1.1">105</span>, 083518 (2022)</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx48">
<span class="ltx_tag ltx_tag_bibitem">[Lanusse <em class="ltx_emph ltx_font_italic" id="bib.bibx48.1.1.1">et al.</em>(2018)Lanusse, Ma, Li, Collett, Li, Ravanbakhsh, Mandelbaum, and Póczos]</span>
<span class="ltx_bibblock">F. Lanusse, Q. Ma, N. Li, T. E. Collett, C.-L. Li, S. Ravanbakhsh, R. Mandelbaum,  and B. Póczos, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx48.4.1">473</span>, 3895 (2018). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx49">
<span class="ltx_tag ltx_tag_bibitem">[Rubin(1984)]</span>
<span class="ltx_bibblock">D. B. Rubin, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1214/aos/1176346785" title="">The Annals of Statistics <span class="ltx_text ltx_font_bold" id="bib.bibx49.1.1.1">12</span>, 1151  (1984)</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx50">
<span class="ltx_tag ltx_tag_bibitem">[Schafer and Freeman(2012)]</span>
<span class="ltx_bibblock">C. M. Schafer and P. E. Freeman, in <em class="ltx_emph ltx_font_italic" id="bib.bibx50.1.1">Statistical Challenges in Modern Astronomy V</em> (Springer, 2012) pp. 3–19. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx51">
<span class="ltx_tag ltx_tag_bibitem">[Cameron and Pettitt(2012)]</span>
<span class="ltx_bibblock">E. Cameron and A. Pettitt, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx51.1.1">425</span>, 44 (2012). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx52">
<span class="ltx_tag ltx_tag_bibitem">[Hahn <em class="ltx_emph ltx_font_italic" id="bib.bibx52.1.1.1">et al.</em>(2017)Hahn, Vakili, Walsh, Hearin, Hogg, and Campbell]</span>
<span class="ltx_bibblock">C. Hahn, M. Vakili, K. Walsh, A. P. Hearin, D. W. Hogg,  and D. Campbell, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx52.4.1">469</span>, 2791 (2017). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx53">
<span class="ltx_tag ltx_tag_bibitem">[Alsing <em class="ltx_emph ltx_font_italic" id="bib.bibx53.1.1.1">et al.</em>(2018)Alsing, Wandelt, and Feeney]</span>
<span class="ltx_bibblock">J. Alsing, B. Wandelt,  and S. Feeney, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1093/mnras/sty819" title="">MNRAS <span class="ltx_text ltx_font_bold" id="bib.bibx53.4.1.1">477</span>, 2874 (2018)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1801.01497" title="">arXiv:1801.01497 [astro-ph.CO]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx54">
<span class="ltx_tag ltx_tag_bibitem">[Papamakarios(2019)]</span>
<span class="ltx_bibblock">G. Papamakarios, arXiv preprint arXiv:1910.13233  (2019). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx55">
<span class="ltx_tag ltx_tag_bibitem">[Bishop(1994)]</span>
<span class="ltx_bibblock">C. M. Bishop, <em class="ltx_emph ltx_font_italic" id="bib.bibx55.1.1">Mixture density networks</em>, WorkingPaper (Aston University, 1994). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx56">
<span class="ltx_tag ltx_tag_bibitem">[Papamakarios and Murray(2016)]</span>
<span class="ltx_bibblock">G. Papamakarios and I. Murray, Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bibx56.1.1">29</span> (2016). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx57">
<span class="ltx_tag ltx_tag_bibitem">[Papamakarios <em class="ltx_emph ltx_font_italic" id="bib.bibx57.1.1.1">et al.</em>(2021)Papamakarios, Nalisnick, Rezende, Mohamed, and Lakshminarayanan]</span>
<span class="ltx_bibblock">G. Papamakarios, E. Nalisnick, D. J. Rezende, S. Mohamed,  and B. Lakshminarayanan, The Journal of Machine Learning Research <span class="ltx_text ltx_font_bold" id="bib.bibx57.4.1">22</span>, 2617 (2021). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx58">
<span class="ltx_tag ltx_tag_bibitem">[Greenberg <em class="ltx_emph ltx_font_italic" id="bib.bibx58.1.1.1">et al.</em>(2019)Greenberg, Nonnenmacher, and Macke]</span>
<span class="ltx_bibblock">D. Greenberg, M. Nonnenmacher,  and J. Macke, in <em class="ltx_emph ltx_font_italic" id="bib.bibx58.4.1">International Conference on Machine Learning</em> (PMLR, 2019) pp. 2404–2414. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx59">
<span class="ltx_tag ltx_tag_bibitem">[Vasist <em class="ltx_emph ltx_font_italic" id="bib.bibx59.1.1.1">et al.</em>(2023)Vasist, Rozet, Absil, Mollière, Nasedkin, and Louppe]</span>
<span class="ltx_bibblock">M. Vasist, F. Rozet, O. Absil, P. Mollière, E. Nasedkin,  and G. Louppe, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1051/0004-6361/202245263" title="">A&amp;A <span class="ltx_text ltx_font_bold" id="bib.bibx59.4.1.1">672</span>, A147 (2023)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2301.06575" title="">arXiv:2301.06575 [astro-ph.EP]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx60">
<span class="ltx_tag ltx_tag_bibitem">[Crisostomi <em class="ltx_emph ltx_font_italic" id="bib.bibx60.1.1.1">et al.</em>(2023)Crisostomi, Dey, Barausse, and Trotta]</span>
<span class="ltx_bibblock">M. Crisostomi, K. Dey, E. Barausse,  and R. Trotta, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevD.108.044029" title="">Phys. Rev. D <span class="ltx_text ltx_font_bold" id="bib.bibx60.4.1.1">108</span>, 044029 (2023)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2305.18528" title="">arXiv:2305.18528 [gr-qc]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx61">
<span class="ltx_tag ltx_tag_bibitem">[Alsing <em class="ltx_emph ltx_font_italic" id="bib.bibx61.1.1.1">et al.</em>(2019)Alsing, Charnock, Feeney, and Wandelt]</span>
<span class="ltx_bibblock">J. Alsing, T. Charnock, S. Feeney,  and B. Wandelt, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1093/mnras/stz1960" title="">MNRAS <span class="ltx_text ltx_font_bold" id="bib.bibx61.4.1.1">488</span>, 4440 (2019)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1903.00007" title="">arXiv:1903.00007 [astro-ph.CO]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx62">
<span class="ltx_tag ltx_tag_bibitem">[Papamakarios <em class="ltx_emph ltx_font_italic" id="bib.bibx62.1.1.1">et al.</em>(2019)Papamakarios, Sterratt, and Murray]</span>
<span class="ltx_bibblock">G. Papamakarios, D. Sterratt,  and I. Murray, in <em class="ltx_emph ltx_font_italic" id="bib.bibx62.4.1">The 22nd International Conference on Artificial Intelligence and Statistics</em> (PMLR, 2019) pp. 837–848. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx63">
<span class="ltx_tag ltx_tag_bibitem">[Robert <em class="ltx_emph ltx_font_italic" id="bib.bibx63.1.1.1">et al.</em>(1999)Robert, Casella, and Casella]</span>
<span class="ltx_bibblock">C. P. Robert, G. Casella,  and G. Casella, <em class="ltx_emph ltx_font_italic" id="bib.bibx63.4.1">Monte Carlo statistical methods</em>, Vol. 2 (Springer, 1999). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx64">
<span class="ltx_tag ltx_tag_bibitem">[Blei <em class="ltx_emph ltx_font_italic" id="bib.bibx64.1.1.1">et al.</em>(2017)Blei, Kucukelbir, and McAuliffe]</span>
<span class="ltx_bibblock">D. M. Blei, A. Kucukelbir,  and J. D. McAuliffe, Journal of the American statistical Association <span class="ltx_text ltx_font_bold" id="bib.bibx64.4.1">112</span>, 859 (2017). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx65">
<span class="ltx_tag ltx_tag_bibitem">[Robert <em class="ltx_emph ltx_font_italic" id="bib.bibx65.1.1.1">et al.</em>(2004)Robert, Casella, Robert, and Casella]</span>
<span class="ltx_bibblock">C. P. Robert, G. Casella, C. P. Robert,  and G. Casella, Monte Carlo statistical methods , 267 (2004). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx66">
<span class="ltx_tag ltx_tag_bibitem">[Jeffrey <em class="ltx_emph ltx_font_italic" id="bib.bibx66.1.1.1">et al.</em>(2021)Jeffrey, Alsing, and Lanusse]</span>
<span class="ltx_bibblock">N. Jeffrey, J. Alsing,  and F. Lanusse, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1093/mnras/staa3594" title="">MNRAS <span class="ltx_text ltx_font_bold" id="bib.bibx66.4.1.1">501</span>, 954 (2021)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2009.08459" title="">arXiv:2009.08459 [astro-ph.CO]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx67">
<span class="ltx_tag ltx_tag_bibitem">[Brehmer <em class="ltx_emph ltx_font_italic" id="bib.bibx67.1.1.1">et al.</em>(2020)Brehmer, Kling, Espejo, and Cranmer]</span>
<span class="ltx_bibblock">J. Brehmer, F. Kling, I. Espejo,  and K. Cranmer, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1007/s41781-020-0035-2" title="">Comput. Softw. Big Sci. <span class="ltx_text ltx_font_bold" id="bib.bibx67.4.1.1">4</span>, 3 (2020)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1907.10621" title="">arXiv:1907.10621 [hep-ph]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx68">
<span class="ltx_tag ltx_tag_bibitem">[Hermans <em class="ltx_emph ltx_font_italic" id="bib.bibx68.1.1.1">et al.</em>(2020)Hermans, Begy, and Louppe]</span>
<span class="ltx_bibblock">J. Hermans, V. Begy,  and G. Louppe, in <em class="ltx_emph ltx_font_italic" id="bib.bibx68.4.1">International conference on machine learning</em> (PMLR, 2020) pp. 4239–4248. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx69">
<span class="ltx_tag ltx_tag_bibitem">[Cranmer <em class="ltx_emph ltx_font_italic" id="bib.bibx69.1.1.1">et al.</em>(2015)Cranmer, Pavez, and Louppe]</span>
<span class="ltx_bibblock">K. Cranmer, J. Pavez,  and G. Louppe, arXiv preprint arXiv:1506.02169  (2015). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx70">
<span class="ltx_tag ltx_tag_bibitem">[Cole <em class="ltx_emph ltx_font_italic" id="bib.bibx70.1.1.1">et al.</em>(2022)Cole, Miller, Witte, Cai, Grootes, Nattino, and Weniger]</span>
<span class="ltx_bibblock">A. Cole, B. K. Miller, S. J. Witte, M. X. Cai, M. W. Grootes, F. Nattino,  and C. Weniger, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1088/1475-7516/2022/09/004" title="">J. Cosmology Astropart. Phys <span class="ltx_text ltx_font_bold" id="bib.bibx70.4.1.1">2022</span>, 004 (2022)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2111.08030" title="">arXiv:2111.08030 [astro-ph.CO]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx71">
<span class="ltx_tag ltx_tag_bibitem">[Karchev <em class="ltx_emph ltx_font_italic" id="bib.bibx71.1.1.1">et al.</em>(2023)Karchev, Trotta, and Weniger]</span>
<span class="ltx_bibblock">K. Karchev, R. Trotta,  and C. Weniger, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1093/mnras/stac3785" title="">MNRAS <span class="ltx_text ltx_font_bold" id="bib.bibx71.4.1.1">520</span>, 1056 (2023)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2209.06733" title="">arXiv:2209.06733 [astro-ph.CO]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx72">
<span class="ltx_tag ltx_tag_bibitem">[Miller <em class="ltx_emph ltx_font_italic" id="bib.bibx72.1.1.1">et al.</em>(2021)Miller, Cole, Forré, Louppe, and Weniger]</span>
<span class="ltx_bibblock">B. Miller, A. Cole, P. Forré, G. Louppe,  and C. Weniger, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.48550/arXiv.2107.01214" title="">Advances in Neural Information Processing Systems <span class="ltx_text ltx_font_bold" id="bib.bibx72.4.1.1">34</span>, 129 (2021)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2107.01214" title="">arXiv:2107.01214 [stat.ML]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx73">
<span class="ltx_tag ltx_tag_bibitem">[Delaunoy <em class="ltx_emph ltx_font_italic" id="bib.bibx73.1.1.1">et al.</em>(2020)Delaunoy, Wehenkel, Hinderer, Nissanke, Weniger, Williamson, and Louppe]</span>
<span class="ltx_bibblock">A. Delaunoy, A. Wehenkel, T. Hinderer, S. Nissanke, C. Weniger, A. R. Williamson,  and G. Louppe, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.48550/arXiv.2010.12931" title="">arXiv e-prints , arXiv:2010.12931 (2020)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2010.12931" title="">arXiv:2010.12931 [astro-ph.IM]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx74">
<span class="ltx_tag ltx_tag_bibitem">[Bhardwaj <em class="ltx_emph ltx_font_italic" id="bib.bibx74.1.1.1">et al.</em>(2023)Bhardwaj, Alvey, Miller, Nissanke, and Weniger]</span>
<span class="ltx_bibblock">U. Bhardwaj, J. Alvey, B. K. Miller, S. Nissanke,  and C. Weniger, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevD.108.042004" title="">Phys. Rev. D <span class="ltx_text ltx_font_bold" id="bib.bibx74.4.1.1">108</span>, 042004 (2023)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2304.02035" title="">arXiv:2304.02035 [gr-qc]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx75">
<span class="ltx_tag ltx_tag_bibitem">[Song <em class="ltx_emph ltx_font_italic" id="bib.bibx75.1.1.1">et al.</em>(2020)Song, Sohl-Dickstein, Kingma, Kumar, Ermon, and Poole]</span>
<span class="ltx_bibblock">Y. Song, J. Sohl-Dickstein, D. P. Kingma, A. Kumar, S. Ermon,  and B. Poole, arXiv preprint arXiv:2011.13456  (2020). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx76">
<span class="ltx_tag ltx_tag_bibitem">[Lueckmann <em class="ltx_emph ltx_font_italic" id="bib.bibx76.1.1.1">et al.</em>(2021)Lueckmann, Boelts, Greenberg, Goncalves, and Macke]</span>
<span class="ltx_bibblock">J.-M. Lueckmann, J. Boelts, D. Greenberg, P. Goncalves,  and J. Macke, in <em class="ltx_emph ltx_font_italic" id="bib.bibx76.4.1">International conference on artificial intelligence and statistics</em> (PMLR, 2021) pp. 343–351. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx77">
<span class="ltx_tag ltx_tag_bibitem">[Watson-Parris <em class="ltx_emph ltx_font_italic" id="bib.bibx77.1.1.1">et al.</em>(2021)Watson-Parris, Williams, Deaconu, and Stier]</span>
<span class="ltx_bibblock">D. Watson-Parris, A. Williams, L. Deaconu,  and P. Stier, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.5194/gmd-14-7659-2021" title="">Geoscientific Model Development <span class="ltx_text ltx_font_bold" id="bib.bibx77.4.1.1">14</span>, 7659 (2021)</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx78">
<span class="ltx_tag ltx_tag_bibitem">[Gutmann <em class="ltx_emph ltx_font_italic" id="bib.bibx78.1.1.1">et al.</em>(2016)Gutmann, Cor <em class="ltx_emph ltx_font_italic" id="bib.bibx78.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">M. U. Gutmann, J. Cor, <em class="ltx_emph ltx_font_italic" id="bib.bibx78.7.1">et al.</em>, Journal of Machine Learning Research <span class="ltx_text ltx_font_bold" id="bib.bibx78.8.2">17</span>, 1 (2016). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx79">
<span class="ltx_tag ltx_tag_bibitem">[Leclercq(2018)]</span>
<span class="ltx_bibblock">F. Leclercq, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevD.98.063511" title="">Phys. Rev. D <span class="ltx_text ltx_font_bold" id="bib.bibx79.1.1.1">98</span>, 063511 (2018)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1805.07152" title="">arXiv:1805.07152 [astro-ph.CO]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx80">
<span class="ltx_tag ltx_tag_bibitem">[Lopez-Paz and Oquab(2016)]</span>
<span class="ltx_bibblock">D. Lopez-Paz and M. Oquab, arXiv preprint arXiv:1610.06545  (2016). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx81">
<span class="ltx_tag ltx_tag_bibitem">[Cook <em class="ltx_emph ltx_font_italic" id="bib.bibx81.1.1.1">et al.</em>(2006)Cook, Gelman, and Rubin]</span>
<span class="ltx_bibblock">S. R. Cook, A. Gelman,  and D. B. Rubin, <a class="ltx_ref ltx_href" href="http://www.jstor.org/stable/27594203" title="">Journal of Computational and Graphical Statistics <span class="ltx_text ltx_font_bold" id="bib.bibx81.4.1.1">15</span>, 675 (2006)</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx82">
<span class="ltx_tag ltx_tag_bibitem">[Zhao <em class="ltx_emph ltx_font_italic" id="bib.bibx82.1.1.1">et al.</em>(2021)Zhao, Dalmasso, Izbicki, and Lee]</span>
<span class="ltx_bibblock">D. Zhao, N. Dalmasso, R. Izbicki,  and A. B. Lee, in <em class="ltx_emph ltx_font_italic" id="bib.bibx82.4.1">Uncertainty in Artificial Intelligence</em> (PMLR, 2021) pp. 1830–1840. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx83">
<span class="ltx_tag ltx_tag_bibitem">[Bordoloi <em class="ltx_emph ltx_font_italic" id="bib.bibx83.1.1.1">et al.</em>(2010)Bordoloi, Lilly, and Amara]</span>
<span class="ltx_bibblock">R. Bordoloi, S. J. Lilly,  and A. Amara, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx83.4.1">406</span>, 881 (2010). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx84">
<span class="ltx_tag ltx_tag_bibitem">[Tanaka <em class="ltx_emph ltx_font_italic" id="bib.bibx84.1.1.1">et al.</em>(2018)Tanaka, Coupon, Hsieh, Mineo, Nishizawa, Speagle, Furusawa, Miyazaki, and Murayama]</span>
<span class="ltx_bibblock">M. Tanaka, J. Coupon, B.-C. Hsieh, S. Mineo, A. J. Nishizawa, J. Speagle, H. Furusawa, S. Miyazaki,  and H. Murayama, Publications of the Astronomical Society of Japan <span class="ltx_text ltx_font_bold" id="bib.bibx84.4.1">70</span>, S9 (2018). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx85">
<span class="ltx_tag ltx_tag_bibitem">[Talts <em class="ltx_emph ltx_font_italic" id="bib.bibx85.1.1.1">et al.</em>(2018)Talts, Betancourt, Simpson, Vehtari, and Gelman]</span>
<span class="ltx_bibblock">S. Talts, M. Betancourt, D. Simpson, A. Vehtari,  and A. Gelman, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.48550/arXiv.1804.06788" title="">arXiv e-prints , arXiv:1804.06788 (2018)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1804.06788" title="">arXiv:1804.06788 [stat.ME]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx86">
<span class="ltx_tag ltx_tag_bibitem">[Wang <em class="ltx_emph ltx_font_italic" id="bib.bibx86.1.1.1">et al.</em>(2019)Wang, Mittal, Brooks, and Oney]</span>
<span class="ltx_bibblock">A. Y. Wang, A. Mittal, C. Brooks,  and S. Oney, Proceedings of the ACM on Human-Computer Interaction <span class="ltx_text ltx_font_bold" id="bib.bibx86.4.1">3</span>, 1 (2019). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx87">
<span class="ltx_tag ltx_tag_bibitem">[Singh and Singh(2020)]</span>
<span class="ltx_bibblock">D. Singh and B. Singh, Applied Soft Computing <span class="ltx_text ltx_font_bold" id="bib.bibx87.1.1">97</span>, 105524 (2020). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx88">
<span class="ltx_tag ltx_tag_bibitem">[Kingma and Ba(2014)]</span>
<span class="ltx_bibblock">D. P. Kingma and J. Ba, arXiv preprint arXiv:1412.6980  (2014). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx89">
<span class="ltx_tag ltx_tag_bibitem">[Bai <em class="ltx_emph ltx_font_italic" id="bib.bibx89.1.1.1">et al.</em>(2021)Bai, Yang, Han, Yang, Li, Mao, Niu, and Liu]</span>
<span class="ltx_bibblock">Y. Bai, E. Yang, B. Han, Y. Yang, J. Li, Y. Mao, G. Niu,  and T. Liu, Advances in Neural Information Processing Systems <span class="ltx_text ltx_font_bold" id="bib.bibx89.4.1">34</span>, 24392 (2021). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx90">
<span class="ltx_tag ltx_tag_bibitem">[Abadi <em class="ltx_emph ltx_font_italic" id="bib.bibx90.1.1.1">et al.</em>(2016)Abadi, Barham, Chen, Chen, Davis, Dean, Devin, Ghemawat, Irving, Isard <em class="ltx_emph ltx_font_italic" id="bib.bibx90.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">M. Abadi, P. Barham, J. Chen, Z. Chen, A. Davis, J. Dean, M. Devin, S. Ghemawat, G. Irving, M. Isard, <em class="ltx_emph ltx_font_italic" id="bib.bibx90.7.1">et al.</em>, in <em class="ltx_emph ltx_font_italic" id="bib.bibx90.8.2">12th USENIX symposium on operating systems design and implementation (OSDI 16)</em> (2016) pp. 265–283. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx91">
<span class="ltx_tag ltx_tag_bibitem">[Paszke <em class="ltx_emph ltx_font_italic" id="bib.bibx91.1.1.1">et al.</em>(2019)Paszke, Gross, Massa, Lerer, Bradbury, Chanan, Killeen, Lin, Gimelshein, Antiga <em class="ltx_emph ltx_font_italic" id="bib.bibx91.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">A. Paszke, S. Gross, F. Massa, A. Lerer, J. Bradbury, G. Chanan, T. Killeen, Z. Lin, N. Gimelshein, L. Antiga, <em class="ltx_emph ltx_font_italic" id="bib.bibx91.7.1">et al.</em>, Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bibx91.8.2">32</span> (2019). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx92">
<span class="ltx_tag ltx_tag_bibitem">[Charnock <em class="ltx_emph ltx_font_italic" id="bib.bibx92.1.1.1">et al.</em>(2018)Charnock, Lavaux, and Wandelt]</span>
<span class="ltx_bibblock">T. Charnock, G. Lavaux,  and B. D. Wandelt, Physical Review D <span class="ltx_text ltx_font_bold" id="bib.bibx92.4.1">97</span>, 083004 (2018). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx93">
<span class="ltx_tag ltx_tag_bibitem">[Alsing and Wandelt(2018)]</span>
<span class="ltx_bibblock">J. Alsing and B. Wandelt, Monthly Notices of the Royal Astronomical Society: Letters <span class="ltx_text ltx_font_bold" id="bib.bibx93.1.1">476</span>, L60 (2018). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx94">
<span class="ltx_tag ltx_tag_bibitem">[Alsing <em class="ltx_emph ltx_font_italic" id="bib.bibx94.1.1.1">et al.</em>(2018)Alsing, Wandelt, and Feeney]</span>
<span class="ltx_bibblock">J. Alsing, B. Wandelt,  and S. Feeney, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx94.4.1">477</span>, 2874 (2018). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx95">
<span class="ltx_tag ltx_tag_bibitem">[Lueckmann <em class="ltx_emph ltx_font_italic" id="bib.bibx95.1.1.1">et al.</em>(2017)Lueckmann, Goncalves, Bassetto, Öcal, Nonnenmacher, and Macke]</span>
<span class="ltx_bibblock">J.-M. Lueckmann, P. J. Goncalves, G. Bassetto, K. Öcal, M. Nonnenmacher,  and J. H. Macke, Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bibx95.4.1">30</span> (2017). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx96">
<span class="ltx_tag ltx_tag_bibitem">[Durkan <em class="ltx_emph ltx_font_italic" id="bib.bibx96.1.1.1">et al.</em>(2020)Durkan, Bekasov, Murray, and Papamakarios]</span>
<span class="ltx_bibblock">C. Durkan, A. Bekasov, I. Murray,  and G. Papamakarios, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.5281/zenodo.4296287" title="">“nflows: normalizing flows in PyTorch,” </a> (2020). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx97">
<span class="ltx_tag ltx_tag_bibitem">[Rozet <em class="ltx_emph ltx_font_italic" id="bib.bibx97.1.1.1">et al.</em>(2022)Rozet <em class="ltx_emph ltx_font_italic" id="bib.bibx97.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">F. Rozet <em class="ltx_emph ltx_font_italic" id="bib.bibx97.7.1">et al.</em>, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.5281/zenodo.7625672" title=""><em class="ltx_emph ltx_font_italic" id="bib.bibx97.8.2.1">Zuko: Normalizing flows in PyTorch</em></a> (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx98">
<span class="ltx_tag ltx_tag_bibitem">[Hermans <em class="ltx_emph ltx_font_italic" id="bib.bibx98.1.1.1">et al.</em>(2022)Hermans, Delaunoy, Rozet, Wehenkel, Begy, and Louppe]</span>
<span class="ltx_bibblock">J. Hermans, A. Delaunoy, F. Rozet, A. Wehenkel, V. Begy,  and G. Louppe, stat. <span class="ltx_text ltx_font_bold" id="bib.bibx98.4.1">1050</span> (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx99">
<span class="ltx_tag ltx_tag_bibitem">[Blundell <em class="ltx_emph ltx_font_italic" id="bib.bibx99.1.1.1">et al.</em>(2015)Blundell, Cornebise, Kavukcuoglu, and Wierstra]</span>
<span class="ltx_bibblock">C. Blundell, J. Cornebise, K. Kavukcuoglu,  and D. Wierstra, in <em class="ltx_emph ltx_font_italic" id="bib.bibx99.4.1">International conference on machine learning</em> (PMLR, 2015) pp. 1613–1622. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx100">
<span class="ltx_tag ltx_tag_bibitem">[Cobb and Jalaian(2021)]</span>
<span class="ltx_bibblock">A. D. Cobb and B. Jalaian, in <em class="ltx_emph ltx_font_italic" id="bib.bibx100.1.1">Uncertainty in Artificial Intelligence</em> (PMLR, 2021) pp. 675–685. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx101">
<span class="ltx_tag ltx_tag_bibitem">[Chollet <em class="ltx_emph ltx_font_italic" id="bib.bibx101.1.1.1">et al.</em>(2015)Chollet <em class="ltx_emph ltx_font_italic" id="bib.bibx101.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">F. Chollet <em class="ltx_emph ltx_font_italic" id="bib.bibx101.7.1">et al.</em>, “Keras,” <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/fchollet/keras" title="">https://github.com/fchollet/keras</a> (2015). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx102">
<span class="ltx_tag ltx_tag_bibitem">[LeCun <em class="ltx_emph ltx_font_italic" id="bib.bibx102.1.1.1">et al.</em>(1998)LeCun, Bottou, Bengio, and Haffner]</span>
<span class="ltx_bibblock">Y. LeCun, L. Bottou, Y. Bengio,  and P. Haffner, Proceedings of the IEEE <span class="ltx_text ltx_font_bold" id="bib.bibx102.4.1">86</span>, 2278 (1998). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx103">
<span class="ltx_tag ltx_tag_bibitem">[Kipf and Welling(2016)]</span>
<span class="ltx_bibblock">T. N. Kipf and M. Welling, arXiv preprint arXiv:1609.02907  (2016). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx104">
<span class="ltx_tag ltx_tag_bibitem">[Foreman-Mackey <em class="ltx_emph ltx_font_italic" id="bib.bibx104.1.1.1">et al.</em>(2013)Foreman-Mackey, Hogg, Lang, and Goodman]</span>
<span class="ltx_bibblock">D. Foreman-Mackey, D. W. Hogg, D. Lang,  and J. Goodman, Publications of the Astronomical Society of the Pacific <span class="ltx_text ltx_font_bold" id="bib.bibx104.4.1">125</span>, 306 (2013). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx105">
<span class="ltx_tag ltx_tag_bibitem">[Goodman and Weare(2010)]</span>
<span class="ltx_bibblock">J. Goodman and J. Weare, Communications in applied mathematics and computational science <span class="ltx_text ltx_font_bold" id="bib.bibx105.1.1">5</span>, 65 (2010). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx106">
<span class="ltx_tag ltx_tag_bibitem">[Bingham <em class="ltx_emph ltx_font_italic" id="bib.bibx106.1.1.1">et al.</em>(2019)Bingham, Chen, Jankowiak, Obermeyer, Pradhan, Karaletsos, Singh, Szerlip, Horsfall, and Goodman]</span>
<span class="ltx_bibblock">E. Bingham, J. P. Chen, M. Jankowiak, F. Obermeyer, N. Pradhan, T. Karaletsos, R. Singh, P. A. Szerlip, P. Horsfall,  and N. D. Goodman, <a class="ltx_ref ltx_href" href="http://jmlr.org/papers/v20/18-403.html" title="">J. Mach. Learn. Res. <span class="ltx_text ltx_font_bold" id="bib.bibx106.4.1.1">20</span>, 28:1 (2019)</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx107">
<span class="ltx_tag ltx_tag_bibitem">[Neal(2003)]</span>
<span class="ltx_bibblock">R. M. Neal, The annals of statistics <span class="ltx_text ltx_font_bold" id="bib.bibx107.1.1">31</span>, 705 (2003). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx108">
<span class="ltx_tag ltx_tag_bibitem">[Neal <em class="ltx_emph ltx_font_italic" id="bib.bibx108.1.1.1">et al.</em>(2011)Neal <em class="ltx_emph ltx_font_italic" id="bib.bibx108.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">R. M. Neal <em class="ltx_emph ltx_font_italic" id="bib.bibx108.7.1">et al.</em>, Handbook of markov chain monte carlo <span class="ltx_text ltx_font_bold" id="bib.bibx108.8.2">2</span>, 2 (2011). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx109">
<span class="ltx_tag ltx_tag_bibitem">[Hoffman <em class="ltx_emph ltx_font_italic" id="bib.bibx109.1.1.1">et al.</em>(2014)Hoffman, Gelman <em class="ltx_emph ltx_font_italic" id="bib.bibx109.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">M. D. Hoffman, A. Gelman, <em class="ltx_emph ltx_font_italic" id="bib.bibx109.7.1">et al.</em>, J. Mach. Learn. Res. <span class="ltx_text ltx_font_bold" id="bib.bibx109.8.2">15</span>, 1593 (2014). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx110">
<span class="ltx_tag ltx_tag_bibitem">[Graves(2011)]</span>
<span class="ltx_bibblock">A. Graves, Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bibx110.1.1">24</span> (2011). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx111">
<span class="ltx_tag ltx_tag_bibitem">[Bartlett <em class="ltx_emph ltx_font_italic" id="bib.bibx111.1.1.1">et al.</em>(2023)Bartlett, Kammerer, Kronberger, Desmond, Ferreira, Wandelt, Burlacu, Alonso, and Zennaro]</span>
<span class="ltx_bibblock">D. J. Bartlett, L. Kammerer, G. Kronberger, H. Desmond, P. G. Ferreira, B. D. Wandelt, B. Burlacu, D. Alonso,  and M. Zennaro, arXiv preprint arXiv:2311.15865  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx112">
<span class="ltx_tag ltx_tag_bibitem">[Greenberg <em class="ltx_emph ltx_font_italic" id="bib.bibx112.1.1.1">et al.</em>(2019)Greenberg, Nonnenmacher, and Macke]</span>
<span class="ltx_bibblock">D. S. Greenberg, M. Nonnenmacher,  and J. H. Macke, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.48550/arXiv.1905.07488" title="">arXiv e-prints , arXiv:1905.07488 (2019)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1905.07488" title="">arXiv:1905.07488 [cs.LG]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx113">
<span class="ltx_tag ltx_tag_bibitem">[Ramesh <em class="ltx_emph ltx_font_italic" id="bib.bibx113.1.1.1">et al.</em>(2022)Ramesh, Lueckmann, Boelts, Tejero-Cantero, Greenberg, Gonçalves, and Macke]</span>
<span class="ltx_bibblock">P. Ramesh, J.-M. Lueckmann, J. Boelts, Á. Tejero-Cantero, D. S. Greenberg, P. J. Gonçalves,  and J. H. Macke, arXiv preprint arXiv:2203.06481  (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx114">
<span class="ltx_tag ltx_tag_bibitem">[Ho <em class="ltx_emph ltx_font_italic" id="bib.bibx114.1.1.1">et al.</em>(2023)Ho, Soltis, Farahi, Nagai, Evrard, and Ntampaka]</span>
<span class="ltx_bibblock">M. Ho, J. Soltis, A. Farahi, D. Nagai, A. Evrard,  and M. Ntampaka, arXiv preprint arXiv:2303.00005  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx115">
<span class="ltx_tag ltx_tag_bibitem">[Dolag <em class="ltx_emph ltx_font_italic" id="bib.bibx115.1.1.1">et al.</em>(2016)Dolag, Komatsu, and Sunyaev]</span>
<span class="ltx_bibblock">K. Dolag, E. Komatsu,  and R. Sunyaev, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx115.4.1">463</span>, 1797 (2016). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx116">
<span class="ltx_tag ltx_tag_bibitem">[Soltis <em class="ltx_emph ltx_font_italic" id="bib.bibx116.1.1.1">et al.</em>(2022)Soltis, Ntampaka, Wu, ZuHone, Evrard, Farahi, Ho, and Nagai]</span>
<span class="ltx_bibblock">J. Soltis, M. Ntampaka, J. F. Wu, J. ZuHone, A. Evrard, A. Farahi, M. Ho,  and D. Nagai, The Astrophysical Journal <span class="ltx_text ltx_font_bold" id="bib.bibx116.4.1">940</span>, 60 (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx117">
<span class="ltx_tag ltx_tag_bibitem">[Papamakarios <em class="ltx_emph ltx_font_italic" id="bib.bibx117.1.1.1">et al.</em>(2017)Papamakarios, Pavlakou, and Murray]</span>
<span class="ltx_bibblock">G. Papamakarios, T. Pavlakou,  and I. Murray, Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bibx117.4.1">30</span> (2017). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx118">
<span class="ltx_tag ltx_tag_bibitem">[Villaescusa-Navarro <em class="ltx_emph ltx_font_italic" id="bib.bibx118.1.1.1">et al.</em>(2020)Villaescusa-Navarro, Hahn, Massara, Banerjee, Delgado, Ramanah, Charnock, Giusarma, Li, Allys, Brochard, Uhlemann, Chiang, He, Pisani, Obuljen, Feng, Castorina, Contardo, Kreisch, Nicola, Alsing, Scoccimarro, Verde, Viel, Ho, Mallat, Wandelt, and Spergel]</span>
<span class="ltx_bibblock">F. Villaescusa-Navarro, C. Hahn, E. Massara, A. Banerjee, A. M. Delgado, D. K. Ramanah, T. Charnock, E. Giusarma, Y. Li, E. Allys, A. Brochard, C. Uhlemann, C.-T. Chiang, S. He, A. Pisani, A. Obuljen, Y. Feng, E. Castorina, G. Contardo, C. D. Kreisch, A. Nicola, J. Alsing, R. Scoccimarro, L. Verde, M. Viel, S. Ho, S. Mallat, B. Wandelt,  and D. N. Spergel, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.3847/1538-4365/ab9d82" title="">ApJS <span class="ltx_text ltx_font_bold" id="bib.bibx118.4.1.1">250</span>, 2 (2020)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1909.05273" title="">arXiv:1909.05273 [astro-ph.CO]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx119">
<span class="ltx_tag ltx_tag_bibitem">[Makinen <em class="ltx_emph ltx_font_italic" id="bib.bibx119.1.1.1">et al.</em>(2022b)Makinen, Charnock, Lemos, Porqueres, Heavens, and Wandelt]</span>
<span class="ltx_bibblock">T. L. Makinen, T. Charnock, P. Lemos, N. Porqueres, A. Heavens,  and B. D. Wandelt, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.21105/astro.2207.05202" title="">The Open Journal of Astrophysics <span class="ltx_text ltx_font_bold" id="bib.bibx119.4.1.1">5</span> (2022b), 10.21105/astro.2207.05202</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx120">
<span class="ltx_tag ltx_tag_bibitem">[Cuesta-Lazaro and Mishra-Sharma(2023)]</span>
<span class="ltx_bibblock">C. Cuesta-Lazaro and S. Mishra-Sharma, arXiv preprint arXiv:2311.17141  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx121">
<span class="ltx_tag ltx_tag_bibitem">[de Santi <em class="ltx_emph ltx_font_italic" id="bib.bibx121.1.1.1">et al.</em>(2023b)de Santi, Shao, Villaescusa-Navarro, Abramo, Teyssier, Villanueva-Domingo, Ni, Anglés-Alcázar, Genel, Hernández-Martínez, Steinwandel, Lovell, Dolag, Castro, and Vogelsberger]</span>
<span class="ltx_bibblock">N. S. M. de Santi, H. Shao, F. Villaescusa-Navarro, L. R. Abramo, R. Teyssier, P. Villanueva-Domingo, Y. Ni, D. Anglés-Alcázar, S. Genel, E. Hernández-Martínez, U. P. Steinwandel, C. C. Lovell, K. Dolag, T. Castro,  and M. Vogelsberger, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.3847/1538-4357/acd1e2" title="">The Astrophysical Journal <span class="ltx_text ltx_font_bold" id="bib.bibx121.4.1.1">952</span>, 69 (2023b)</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx122">
<span class="ltx_tag ltx_tag_bibitem">[Cutler and Flanagan(1994)]</span>
<span class="ltx_bibblock">C. Cutler and É. E. Flanagan, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevD.49.2658" title="">Phys. Rev. D <span class="ltx_text ltx_font_bold" id="bib.bibx122.1.1.1">49</span>, 2658 (1994)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/gr-qc/9402014" title="">arXiv:gr-qc/9402014 [gr-qc]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx123">
<span class="ltx_tag ltx_tag_bibitem">[Thrane and Talbot(2019)]</span>
<span class="ltx_bibblock">E. Thrane and C. Talbot, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1017/pasa.2019.2" title="">PASA <span class="ltx_text ltx_font_bold" id="bib.bibx123.1.1.1">36</span>, e010 (2019)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1809.02293" title="">arXiv:1809.02293 [astro-ph.IM]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx124">
<span class="ltx_tag ltx_tag_bibitem">[Green <em class="ltx_emph ltx_font_italic" id="bib.bibx124.1.1.1">et al.</em>(2020)Green, Simpson, and Gair]</span>
<span class="ltx_bibblock">S. R. Green, C. Simpson,  and J. Gair, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevD.102.104057" title="">Phys. Rev. D <span class="ltx_text ltx_font_bold" id="bib.bibx124.4.1.1">102</span>, 104057 (2020)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2002.07656" title="">arXiv:2002.07656 [astro-ph.IM]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx125">
<span class="ltx_tag ltx_tag_bibitem">[Green and Gair(2020)]</span>
<span class="ltx_bibblock">S. R. Green and J. Gair, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.48550/arXiv.2008.03312" title="">arXiv e-prints , arXiv:2008.03312 (2020)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2008.03312" title="">arXiv:2008.03312 [astro-ph.IM]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx126">
<span class="ltx_tag ltx_tag_bibitem">[Dax <em class="ltx_emph ltx_font_italic" id="bib.bibx126.1.1.1">et al.</em>(2021b)Dax, Green, Gair, Deistler, Schölkopf, and Macke]</span>
<span class="ltx_bibblock">M. Dax, S. R. Green, J. Gair, M. Deistler, B. Schölkopf,  and J. H. Macke, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.48550/arXiv.2111.13139" title="">arXiv e-prints , arXiv:2111.13139 (2021b)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2111.13139" title="">arXiv:2111.13139 [cs.LG]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx127">
<span class="ltx_tag ltx_tag_bibitem">[Wildberger <em class="ltx_emph ltx_font_italic" id="bib.bibx127.1.1.1">et al.</em>(2023)Wildberger, Dax, Buchholz, Green, Macke, and Schölkopf]</span>
<span class="ltx_bibblock">J. B. Wildberger, M. Dax, S. Buchholz, S. R. Green, J. Macke,  and B. Schölkopf, in <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.48550/arXiv.2305.17161" title=""><em class="ltx_emph ltx_font_italic" id="bib.bibx127.4.1.1">Machine Learning for Astrophysics</em></a> (2023) p. 34, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2305.17161" title="">arXiv:2305.17161 [cs.LG]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx128">
<span class="ltx_tag ltx_tag_bibitem">[Khan <em class="ltx_emph ltx_font_italic" id="bib.bibx128.1.1.1">et al.</em>(2016)Khan, Husa, Hannam, Ohme, Pürrer, Forteza, and Bohé]</span>
<span class="ltx_bibblock">S. Khan, S. Husa, M. Hannam, F. Ohme, M. Pürrer, X. J. Forteza,  and A. Bohé, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevD.93.044007" title="">Phys. Rev. D <span class="ltx_text ltx_font_bold" id="bib.bibx128.4.1.1">93</span>, 044007 (2016)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1508.07253" title="">arXiv:1508.07253 [gr-qc]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx129">
<span class="ltx_tag ltx_tag_bibitem">[Ashton <em class="ltx_emph ltx_font_italic" id="bib.bibx129.1.1.1">et al.</em>(2019)Ashton, Hübner, Lasky, Talbot, Ackley, Biscoveanu, Chu, Divakarla, Easter, Goncharov, Hernandez Vivanco, Harms, Lower, Meadors, Melchor, Payne, Pitkin, Powell, Sarin, Smith, and Thrane]</span>
<span class="ltx_bibblock">G. Ashton, M. Hübner, P. D. Lasky, C. Talbot, K. Ackley, S. Biscoveanu, Q. Chu, A. Divakarla, P. J. Easter, B. Goncharov, F. Hernandez Vivanco, J. Harms, M. E. Lower, G. D. Meadors, D. Melchor,
E. Payne, M. D. Pitkin, J. Powell, N. Sarin, R. J. E. Smith,  and E. Thrane, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.3847/1538-4365/ab06fc" title="">ApJS <span class="ltx_text ltx_font_bold" id="bib.bibx129.4.1.1">241</span>, 27 (2019)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1811.02042" title="">arXiv:1811.02042 [astro-ph.IM]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx130">
<span class="ltx_tag ltx_tag_bibitem">[Romero-Shaw <em class="ltx_emph ltx_font_italic" id="bib.bibx130.1.1.1">et al.</em>(2020)Romero-Shaw, Talbot, Biscoveanu, D’Emilio, Ashton, Berry, Coughlin, Galaudage, Hoy, Hübner, Phukon, Pitkin, Rizzo, Sarin, Smith, Stevenson, Vajpeyi, Arène, Athar, Banagiri, Bose, Carney, Chatziioannou, Clark, Colleoni, Cotesta, Edelman, Estellés, García-Quirós, Ghosh, Green, Haster, Husa, Keitel, Kim,
Hernandez-Vivanco, Magaña Hernandez, Karathanasis, Lasky, De Lillo, Lower, Macleod, Mateu-Lucena, Miller, Millhouse, Morisaki, Oh, Ossokine, Payne, Powell, Pratten, Pürrer, Ramos-Buades, Raymond, Thrane, Veitch, Williams, Williams, and Xiao]</span>
<span class="ltx_bibblock">I. M. Romero-Shaw, C. Talbot, S. Biscoveanu, V. D’Emilio, G. Ashton, C. P. L. Berry, S. Coughlin, S. Galaudage, C. Hoy, M. Hübner, K. S. Phukon, M. Pitkin, M. Rizzo, N. Sarin, R. Smith, S. Stevenson, A. Vajpeyi, M. Arène, K. Athar, S. Banagiri, N. Bose, M. Carney, K. Chatziioannou, J. A. Clark, M. Colleoni, R. Cotesta, B. Edelman, H. Estellés, C. García-Quirós, A. Ghosh, R. Green, C. J. Haster, S. Husa, D. Keitel, A. X. Kim, F. Hernandez-Vivanco, I. Magaña Hernandez, C. Karathanasis, P. D. Lasky, N. De Lillo, M. E. Lower, D. Macleod, M. Mateu-Lucena, A. Miller, M. Millhouse, S. Morisaki, S. H. Oh, S. Ossokine, E. Payne, J. Powell, G. Pratten, M. Pürrer, A. Ramos-Buades, V. Raymond, E. Thrane, J. Veitch, D. Williams, M. J. Williams,  and L. Xiao, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1093/mnras/staa2850" title="">MNRAS <span class="ltx_text ltx_font_bold" id="bib.bibx130.4.1.1">499</span>, 3295 (2020)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2006.00714" title="">arXiv:2006.00714 [astro-ph.IM]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx131">
<span class="ltx_tag ltx_tag_bibitem">[Veitch <em class="ltx_emph ltx_font_italic" id="bib.bibx131.1.1.1">et al.</em>(2015)Veitch, Raymond, Farr, Farr, Graff, Vitale, Aylott, Blackburn, Christensen, Coughlin, Del Pozzo, Feroz, Gair, Haster, Kalogera, Littenberg, Mandel, O’Shaughnessy, Pitkin, Rodriguez, Röver, Sidery, Smith, Van Der Sluys, Vecchio, Vousden, and Wade]</span>
<span class="ltx_bibblock">J. Veitch, V. Raymond, B. Farr, W. Farr, P. Graff, S. Vitale, B. Aylott, K. Blackburn, N. Christensen, M. Coughlin, W. Del Pozzo, F. Feroz, J. Gair, C. J. Haster, V. Kalogera, T. Littenberg, I. Mandel, R. O’Shaughnessy, M. Pitkin, C. Rodriguez, C. Röver, T. Sidery, R. Smith, M. Van Der Sluys, A. Vecchio, W. Vousden,  and L. Wade, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevD.91.042003" title="">Phys. Rev. D <span class="ltx_text ltx_font_bold" id="bib.bibx131.4.1.1">91</span>, 042003 (2015)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1409.7215" title="">arXiv:1409.7215
[gr-qc]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx132">
<span class="ltx_tag ltx_tag_bibitem">[Vitale <em class="ltx_emph ltx_font_italic" id="bib.bibx132.1.1.1">et al.</em>(2017)Vitale, Lynch, Raymond, Sturani, Veitch, and Graff]</span>
<span class="ltx_bibblock">S. Vitale, R. Lynch, V. Raymond, R. Sturani, J. Veitch,  and P. Graff, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevD.95.064053" title="">Phys. Rev. D <span class="ltx_text ltx_font_bold" id="bib.bibx132.4.1.1">95</span>, 064053 (2017)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1611.01122" title="">arXiv:1611.01122 [gr-qc]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx133">
<span class="ltx_tag ltx_tag_bibitem">[Racine(2008)]</span>
<span class="ltx_bibblock">É. Racine, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevD.78.044021" title="">Phys. Rev. D <span class="ltx_text ltx_font_bold" id="bib.bibx133.1.1.1">78</span>, 044021 (2008)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/0803.1820" title="">arXiv:0803.1820 [gr-qc]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx134">
<span class="ltx_tag ltx_tag_bibitem">[Abbott <em class="ltx_emph ltx_font_italic" id="bib.bibx134.1.1.1">et al.</em>(2016)Abbott <em class="ltx_emph ltx_font_italic" id="bib.bibx134.2.2.2">et al.</em>]</span>
<span class="ltx_bibblock">B. P. Abbott <em class="ltx_emph ltx_font_italic" id="bib.bibx134.7.1">et al.</em> (LIGO Scientific, Virgo), <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1103/PhysRevLett.116.241102" title="">Phys. Rev. Lett. <span class="ltx_text ltx_font_bold" id="bib.bibx134.8.2.1">116</span>, 241102 (2016)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1602.03840" title="">arXiv:1602.03840 [gr-qc]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx135">
<span class="ltx_tag ltx_tag_bibitem">[Karathanasis <em class="ltx_emph ltx_font_italic" id="bib.bibx135.1.1.1">et al.</em>(2023)Karathanasis, Revenu, Mukherjee, and Stachurski]</span>
<span class="ltx_bibblock">C. Karathanasis, B. Revenu, S. Mukherjee,  and F. Stachurski, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1051/0004-6361/202245216" title="">Astron. Astrophys. <span class="ltx_text ltx_font_bold" id="bib.bibx135.4.1.1">677</span>, A124 (2023)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2210.05724" title="">arXiv:2210.05724 [astro-ph.CO]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx136">
<span class="ltx_tag ltx_tag_bibitem">[Silva <em class="ltx_emph ltx_font_italic" id="bib.bibx136.1.1.1">et al.</em>(1998)Silva, Granato, Bressan, and Danese]</span>
<span class="ltx_bibblock">L. Silva, G. L. Granato, A. Bressan,  and L. Danese, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1086/306476" title="">ApJ <span class="ltx_text ltx_font_bold" id="bib.bibx136.4.1.1">509</span>, 103 (1998)</a>. 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx137">
<span class="ltx_tag ltx_tag_bibitem">[Trayford <em class="ltx_emph ltx_font_italic" id="bib.bibx137.1.1.1">et al.</em>(2015)Trayford, Theuns, Bower, Schaye, Furlong, Schaller, Frenk, Crain, Vecchia, and McCarthy]</span>
<span class="ltx_bibblock">J. W. Trayford, T. Theuns, R. G. Bower, J. Schaye, M. Furlong, M. Schaller, C. S. Frenk, R. A. Crain, C. D. Vecchia,  and I. G. McCarthy, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1093/mnras/stv1461" title="">Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx137.4.1.1">452</span>, 2879 (2015)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/https://academic.oup.com/mnras/article-pdf/452/3/2879/4922335/stv1461.pdf" title="">https://academic.oup.com/mnras/article-pdf/452/3/2879/4922335/stv1461.pdf</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx138">
<span class="ltx_tag ltx_tag_bibitem">[Davé <em class="ltx_emph ltx_font_italic" id="bib.bibx138.1.1.1">et al.</em>(2019)Davé, Anglés-Alcázar, Narayanan, Li, Rafieferantsoa, and Appleby]</span>
<span class="ltx_bibblock">R. Davé, D. Anglés-Alcázar, D. Narayanan, Q. Li, M. H. Rafieferantsoa,  and S. Appleby, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1093/mnras/stz937" title="">MNRAS <span class="ltx_text ltx_font_bold" id="bib.bibx138.4.1.1">486</span>, 2827 (2019)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1901.10203" title="">arXiv:1901.10203 [astro-ph.GA]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx139">
<span class="ltx_tag ltx_tag_bibitem">[Bruzual and Charlot(2003)]</span>
<span class="ltx_bibblock">G. Bruzual and S. Charlot, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1046/j.1365-8711.2003.06897.x" title="">MNRAS <span class="ltx_text ltx_font_bold" id="bib.bibx139.1.1.1">344</span>, 1000 (2003)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/astro-ph/0309134" title="">arXiv:astro-ph/0309134 [astro-ph]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx140">
<span class="ltx_tag ltx_tag_bibitem">[Carr <em class="ltx_emph ltx_font_italic" id="bib.bibx140.1.1.1">et al.</em>(2023)Carr, Bryan, Fielding, Pandya, and Somerville]</span>
<span class="ltx_bibblock">C. Carr, G. L. Bryan, D. B. Fielding, V. Pandya,  and R. S. Somerville, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.3847/1538-4357/acc4c7" title="">ApJ <span class="ltx_text ltx_font_bold" id="bib.bibx140.4.1.1">949</span>, 21 (2023)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2211.05115" title="">arXiv:2211.05115 [astro-ph.GA]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx141">
<span class="ltx_tag ltx_tag_bibitem">[Pandya <em class="ltx_emph ltx_font_italic" id="bib.bibx141.1.1.1">et al.</em>(2023)Pandya, Fielding, Bryan, Carr, Somerville, Stern, Faucher-Giguère, Hafen, Anglés-Alcázar, and Forbes]</span>
<span class="ltx_bibblock">V. Pandya, D. B. Fielding, G. L. Bryan, C. Carr, R. S. Somerville, J. Stern, C.-A. Faucher-Giguère, Z. Hafen, D. Anglés-Alcázar,  and J. C. Forbes, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.3847/1538-4357/acf3ea" title="">ApJ <span class="ltx_text ltx_font_bold" id="bib.bibx141.4.1.1">956</span>, 118 (2023)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2211.09755" title="">arXiv:2211.09755 [astro-ph.GA]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx142">
<span class="ltx_tag ltx_tag_bibitem">[Pillepich <em class="ltx_emph ltx_font_italic" id="bib.bibx142.1.1.1">et al.</em>(2018)Pillepich, Springel, Nelson, Genel, Naiman, Pakmor, Hernquist, Torrey, Vogelsberger, Weinberger, and Marinacci]</span>
<span class="ltx_bibblock">A. Pillepich, V. Springel, D. Nelson, S. Genel, J. Naiman, R. Pakmor, L. Hernquist, P. Torrey, M. Vogelsberger, R. Weinberger,  and F. Marinacci, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.1093/mnras/stx2656" title="">MNRAS <span class="ltx_text ltx_font_bold" id="bib.bibx142.4.1.1">473</span>, 4077 (2018)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1703.02970" title="">arXiv:1703.02970 [astro-ph.GA]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx143">
<span class="ltx_tag ltx_tag_bibitem">[Makinen <em class="ltx_emph ltx_font_italic" id="bib.bibx143.1.1.1">et al.</em>(2023)Makinen, Alsing, and Wandelt]</span>
<span class="ltx_bibblock">T. L. Makinen, J. Alsing,  and B. D. Wandelt, “Fishnets: Information-optimal, scalable aggregation for sets and graphs,”  (2023), <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2310.03812" title="">arXiv:2310.03812 [cs.LG]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx144">
<span class="ltx_tag ltx_tag_bibitem">[Masserano <em class="ltx_emph ltx_font_italic" id="bib.bibx144.1.1.1">et al.</em>(2022)Masserano, Dorigo, Izbicki, Kuusela, and Lee]</span>
<span class="ltx_bibblock">L. Masserano, T. Dorigo, R. Izbicki, M. Kuusela,  and A. B. Lee, arXiv preprint arXiv:2205.15680  (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx145">
<span class="ltx_tag ltx_tag_bibitem">[Cannon <em class="ltx_emph ltx_font_italic" id="bib.bibx145.1.1.1">et al.</em>(2022)Cannon, Ward, and Schmon]</span>
<span class="ltx_bibblock">P. Cannon, D. Ward,  and S. M. Schmon, arXiv preprint arXiv:2209.01845  (2022). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx146">
<span class="ltx_tag ltx_tag_bibitem">[Kelly <em class="ltx_emph ltx_font_italic" id="bib.bibx146.1.1.1">et al.</em>(2023)Kelly, Nott, Frazier, Warne, and Drovandi]</span>
<span class="ltx_bibblock">R. P. Kelly, D. J. Nott, D. T. Frazier, D. J. Warne,  and C. Drovandi, arXiv preprint arXiv:2301.13368  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx147">
<span class="ltx_tag ltx_tag_bibitem">[Huang <em class="ltx_emph ltx_font_italic" id="bib.bibx147.1.1.1">et al.</em>(2023)Huang, Bharti, Souza, Acerbi, and Kaski]</span>
<span class="ltx_bibblock">D. Huang, A. Bharti, A. Souza, L. Acerbi,  and S. Kaski, arXiv preprint arXiv:2305.15871  (2023). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx148">
<span class="ltx_tag ltx_tag_bibitem">[Leclercq(2022)]</span>
<span class="ltx_bibblock">F. Leclercq, <a class="ltx_ref ltx_href" href="http://dx.doi.org/10.48550/arXiv.2209.11057" title="">arXiv e-prints , arXiv:2209.11057 (2022)</a>, <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2209.11057" title="">arXiv:2209.11057 [stat.ME]</a> . 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx149">
<span class="ltx_tag ltx_tag_bibitem">[Handley <em class="ltx_emph ltx_font_italic" id="bib.bibx149.1.1.1">et al.</em>(2015)Handley, Hobson, and Lasenby]</span>
<span class="ltx_bibblock">W. Handley, M. Hobson,  and A. Lasenby, Monthly Notices of the Royal Astronomical Society: Letters <span class="ltx_text ltx_font_bold" id="bib.bibx149.4.1">450</span>, L61 (2015). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx150">
<span class="ltx_tag ltx_tag_bibitem">[Jeffrey and Wandelt(2024)]</span>
<span class="ltx_bibblock">N. Jeffrey and B. D. Wandelt, Machine Learning: Science and Technology <span class="ltx_text ltx_font_bold" id="bib.bibx150.1.1">5</span>, 015008 (2024). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx151">
<span class="ltx_tag ltx_tag_bibitem">[Jasche and Wandelt(2013)]</span>
<span class="ltx_bibblock">J. Jasche and B. D. Wandelt, Monthly Notices of the Royal Astronomical Society <span class="ltx_text ltx_font_bold" id="bib.bibx151.1.1">432</span>, 894 (2013). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx152">
<span class="ltx_tag ltx_tag_bibitem">[de Andres <em class="ltx_emph ltx_font_italic" id="bib.bibx152.1.1.1">et al.</em>(2024)de Andres, Cui, Yepes, De Petris, Ferragamo, De Luca, Aversano, and Rennehan]</span>
<span class="ltx_bibblock">D. de Andres, W. Cui, G. Yepes, M. De Petris, A. Ferragamo, F. De Luca, G. Aversano,  and D. Rennehan, Monthly Notices of the Royal Astronomical Society , stae071 (2024). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx153">
<span class="ltx_tag ltx_tag_bibitem">[Jeffrey and Wandelt(2020)]</span>
<span class="ltx_bibblock">N. Jeffrey and B. D. Wandelt, arXiv preprint arXiv:2011.05991  (2020). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx154">
<span class="ltx_tag ltx_tag_bibitem">[Legin <em class="ltx_emph ltx_font_italic" id="bib.bibx154.1.1.1">et al.</em>(2024)Legin, Ho, Lemos, Perreault-Levasseur, Ho, Hezaveh, and Wandelt]</span>
<span class="ltx_bibblock">R. Legin, M. Ho, P. Lemos, L. Perreault-Levasseur, S. Ho, Y. Hezaveh,  and B. Wandelt, Monthly Notices of the Royal Astronomical Society: Letters <span class="ltx_text ltx_font_bold" id="bib.bibx154.4.1">527</span>, L173 (2024). 
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx155">
<span class="ltx_tag ltx_tag_bibitem">[Akiba <em class="ltx_emph ltx_font_italic" id="bib.bibx155.1.1.1">et al.</em>(2019)Akiba, Sano, Yanase, Ohta, and Koyama]</span>
<span class="ltx_bibblock">T. Akiba, S. Sano, T. Yanase, T. Ohta,  and M. Koyama, in <em class="ltx_emph ltx_font_italic" id="bib.bibx155.4.1">Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em> (2019) pp. 2623–2631. 
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Feb  6 18:55:46 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
